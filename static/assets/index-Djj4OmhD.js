(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=a(n);fetch(n.href,l)}})();const Zs=!1;var Cs=Array.isArray,pl=Array.prototype.indexOf,zs=Array.from,hl=Object.defineProperty,Da=Object.getOwnPropertyDescriptor,sr=Object.getOwnPropertyDescriptors,_l=Object.prototype,gl=Array.prototype,vn=Object.getPrototypeOf,Ln=Object.isExtensible;function ml(t){return t()}function Js(t){for(var e=0;e<t.length;e++)t[e]()}function nr(){var t,e,a=new Promise((r,n)=>{t=r,e=n});return{promise:a,resolve:t,reject:e}}function un(t,e){if(Array.isArray(t))return t;if(!(Symbol.iterator in t))return Array.from(t);const a=[];for(const r of t)if(a.push(r),a.length===e)break;return a}const pt=2,Ss=4,ss=8,rr=1<<24,ra=16,la=32,Ea=64,dn=128,Rt=512,ft=1024,mt=2048,Xt=4096,jt=8192,Kt=16384,fn=32768,pa=65536,In=1<<17,lr=1<<18,La=1<<19,ir=1<<20,Qt=1<<25,Sa=32768,Vs=1<<21,pn=1<<22,ua=1<<23,ea=Symbol("$state"),bl=Symbol("legacy props"),yl=Symbol(""),za=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function or(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function wl(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function kl(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function xl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Sl(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Tl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ql(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function El(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function jl(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Al(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Pl(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Cl=1,zl=2,cr=4,Dl=8,Rl=16,Ml=1,Nl=2,Ol=4,Ll=8,Il=16,$l=1,Fl=2,dt=Symbol(),Bl="http://www.w3.org/1999/xhtml";function Gl(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Ul(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function vr(t){return t===this.v}function Yl(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function ur(t){return!Yl(t,this.v)}let Ia=!1,Hl=!1;function Xl(){Ia=!0}let nt=null;function Ra(t){nt=t}function He(t,e=!1,a){nt={p:nt,i:!1,c:null,e:null,s:t,x:null,l:Ia&&!e?{s:null,u:null,$:[]}:null}}function Xe(t){var e=nt,a=e.e;if(a!==null){e.e=null;for(var r of a)Ar(r)}return t!==void 0&&(e.x=t),e.i=!0,nt=e.p,t??{}}function ns(){return!Ia||nt!==null&&nt.l===null}let ya=[];function dr(){var t=ya;ya=[],Js(t)}function Yt(t){if(ya.length===0&&!Za){var e=ya;queueMicrotask(()=>{e===ya&&dr()})}ya.push(t)}function Wl(){for(;ya.length>0;)dr()}function fr(t){var e=$e;if(e===null)return Re.f|=ua,t;if((e.f&fn)===0){if((e.f&dn)===0)throw t;e.b.error(t)}else Ma(t,e)}function Ma(t,e){for(;e!==null;){if((e.f&dn)!==0)try{e.b.error(t);return}catch(a){t=a}e=e.parent}throw t}const Zl=-7169;function vt(t,e){t.f=t.f&Zl|e}function hn(t){(t.f&Rt)!==0||t.deps===null?vt(t,ft):vt(t,Xt)}function pr(t){if(t!==null)for(const e of t)(e.f&pt)===0||(e.f&Sa)===0||(e.f^=Sa,pr(e.deps))}function hr(t,e,a){(t.f&mt)!==0?e.add(t):(t.f&Xt)!==0&&a.add(t),pr(t.deps),vt(t,ft)}const bs=new Set;let Ie=null,Ts=null,It=null,Et=[],Ds=null,Qs=!1,Za=!1;class da{committed=!1;current=new Map;previous=new Map;#t=new Set;#l=new Set;#e=0;#n=0;#r=null;#s=new Set;#a=new Set;skipped_effects=new Set;is_fork=!1;#i=!1;is_deferred(){return this.is_fork||this.#n>0}process(e){Et=[],this.apply();var a=[],r=[];for(const n of e)this.#o(n,a,r);if(this.is_deferred())this.#c(r),this.#c(a);else{for(const n of this.#t)n();this.#t.clear(),this.#e===0&&this.#v(),Ts=this,Ie=null,$n(r),$n(a),Ts=null,this.#r?.resolve()}It=null}#o(e,a,r){e.f^=ft;for(var n=e.first,l=null;n!==null;){var i=n.f,u=(i&(la|Ea))!==0,v=u&&(i&ft)!==0,d=v||(i&jt)!==0||this.skipped_effects.has(n);if(!d&&n.fn!==null){u?n.f^=ft:l!==null&&(i&(Ss|ss|rr))!==0?l.b.defer_effect(n):(i&Ss)!==0?a.push(n):$a(n)&&((i&ra)!==0&&this.#s.add(n),Oa(n));var p=n.first;if(p!==null){n=p;continue}}var m=n.parent;for(n=n.next;n===null&&m!==null;)m===l&&(l=null),n=m.next,m=m.parent}}#c(e){for(var a=0;a<e.length;a+=1)hr(e[a],this.#s,this.#a)}capture(e,a){a!==dt&&!this.previous.has(e)&&this.previous.set(e,a),(e.f&ua)===0&&(this.current.set(e,e.v),It?.set(e,e.v))}activate(){Ie=this,this.apply()}deactivate(){Ie===this&&(Ie=null,It=null)}flush(){if(this.activate(),Et.length>0){if(_r(),Ie!==null&&Ie!==this)return}else this.#e===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#l)e(this);this.#l.clear()}#v(){if(bs.size>1){this.previous.clear();var e=It,a=!0;for(const n of bs){if(n===this){a=!1;continue}const l=[];for(const[u,v]of this.current){if(n.current.has(u))if(a&&v!==n.current.get(u))n.current.set(u,v);else continue;l.push(u)}if(l.length===0)continue;const i=[...n.current.keys()].filter(u=>!this.current.has(u));if(i.length>0){var r=Et;Et=[];const u=new Set,v=new Map;for(const d of l)gr(d,i,u,v);if(Et.length>0){Ie=n,n.apply();for(const d of Et)n.#o(d,[],[]);n.deactivate()}Et=r}}Ie=null,It=e}this.committed=!0,bs.delete(this)}increment(e){this.#e+=1,e&&(this.#n+=1)}decrement(e){this.#e-=1,e&&(this.#n-=1),!this.#i&&(this.#i=!0,Yt(()=>{this.#i=!1,this.is_deferred()?Et.length>0&&this.flush():this.revive()}))}revive(){for(const e of this.#s)this.#a.delete(e),vt(e,mt),sa(e);for(const e of this.#a)vt(e,Xt),sa(e);this.flush()}oncommit(e){this.#t.add(e)}ondiscard(e){this.#l.add(e)}settled(){return(this.#r??=nr()).promise}static ensure(){if(Ie===null){const e=Ie=new da;bs.add(Ie),Za||Yt(()=>{Ie===e&&e.flush()})}return Ie}apply(){}}function Jl(t){var e=Za;Za=!0;try{for(var a;;){if(Wl(),Et.length===0&&(Ie?.flush(),Et.length===0))return Ds=null,a;_r()}}finally{Za=e}}function _r(){Qs=!0;var t=null;try{for(var e=0;Et.length>0;){var a=da.ensure();if(e++>1e3){var r,n;Vl()}a.process(Et),fa.clear()}}finally{Qs=!1,Ds=null}}function Vl(){try{Tl()}catch(t){Ma(t,Ds)}}let Vt=null;function $n(t){var e=t.length;if(e!==0){for(var a=0;a<e;){var r=t[a++];if((r.f&(Kt|jt))===0&&$a(r)&&(Vt=new Set,Oa(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?Rr(r):r.fn=null),Vt?.size>0)){fa.clear();for(const n of Vt){if((n.f&(Kt|jt))!==0)continue;const l=[n];let i=n.parent;for(;i!==null;)Vt.has(i)&&(Vt.delete(i),l.push(i)),i=i.parent;for(let u=l.length-1;u>=0;u--){const v=l[u];(v.f&(Kt|jt))===0&&Oa(v)}}Vt.clear()}}Vt=null}}function gr(t,e,a,r){if(!a.has(t)&&(a.add(t),t.reactions!==null))for(const n of t.reactions){const l=n.f;(l&pt)!==0?gr(n,e,a,r):(l&(pn|ra))!==0&&(l&mt)===0&&mr(n,e,r)&&(vt(n,mt),sa(n))}}function mr(t,e,a){const r=a.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const n of t.deps){if(e.includes(n))return!0;if((n.f&pt)!==0&&mr(n,e,a))return a.set(n,!0),!0}return a.set(t,!1),!1}function sa(t){for(var e=Ds=t;e.parent!==null;){e=e.parent;var a=e.f;if(Qs&&e===$e&&(a&ra)!==0&&(a&lr)===0)return;if((a&(Ea|la))!==0){if((a&ft)===0)return;e.f^=ft}}Et.push(e)}function Ql(t){let e=0,a=Ta(0),r;return()=>{bn()&&(s(a),is(()=>(e===0&&(r=_a(()=>t(()=>Ja(a)))),e+=1,()=>{Yt(()=>{e-=1,e===0&&(r?.(),r=void 0,Ja(a))})})))}}var Kl=pa|La|dn;function ei(t,e,a){new ti(t,e,a)}class ti{parent;is_pending=!1;#t;#l=null;#e;#n;#r;#s=null;#a=null;#i=null;#o=null;#c=null;#v=0;#d=0;#p=!1;#f=!1;#h=new Set;#_=new Set;#u=null;#w=Ql(()=>(this.#u=Ta(this.#v),()=>{this.#u=null}));constructor(e,a,r){this.#t=e,this.#e=a,this.#n=r,this.parent=$e.b,this.is_pending=!!this.#e.pending,this.#r=os(()=>{$e.b=this;{var n=this.#b();try{this.#s=Dt(()=>r(n))}catch(l){this.error(l)}this.#d>0?this.#m():this.is_pending=!1}return()=>{this.#c?.remove()}},Kl)}#k(){try{this.#s=Dt(()=>this.#n(this.#t))}catch(e){this.error(e)}}#x(){const e=this.#e.pending;e&&(this.#a=Dt(()=>e(this.#t)),Yt(()=>{var a=this.#b();this.#s=this.#g(()=>(da.ensure(),Dt(()=>this.#n(a)))),this.#d>0?this.#m():(ka(this.#a,()=>{this.#a=null}),this.is_pending=!1)}))}#b(){var e=this.#t;return this.is_pending&&(this.#c=ta(),this.#t.before(this.#c),e=this.#c),e}defer_effect(e){hr(e,this.#h,this.#_)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#e.pending}#g(e){var a=$e,r=Re,n=nt;Ht(this.#r),kt(this.#r),Ra(this.#r.ctx);try{return e()}catch(l){return fr(l),null}finally{Ht(a),kt(r),Ra(n)}}#m(){const e=this.#e.pending;this.#s!==null&&(this.#o=document.createDocumentFragment(),this.#o.append(this.#c),Or(this.#s,this.#o)),this.#a===null&&(this.#a=Dt(()=>e(this.#t)))}#y(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(e);return}if(this.#d+=e,this.#d===0){this.is_pending=!1;for(const a of this.#h)vt(a,mt),sa(a);for(const a of this.#_)vt(a,Xt),sa(a);this.#h.clear(),this.#_.clear(),this.#a&&ka(this.#a,()=>{this.#a=null}),this.#o&&(this.#t.before(this.#o),this.#o=null)}}update_pending_count(e){this.#y(e),this.#v+=e,!(!this.#u||this.#p)&&(this.#p=!0,Yt(()=>{this.#p=!1,this.#u&&Na(this.#u,this.#v)}))}get_effect_pending(){return this.#w(),s(this.#u)}error(e){var a=this.#e.onerror;let r=this.#e.failed;if(this.#f||!a&&!r)throw e;this.#s&&(xt(this.#s),this.#s=null),this.#a&&(xt(this.#a),this.#a=null),this.#i&&(xt(this.#i),this.#i=null);var n=!1,l=!1;const i=()=>{if(n){Ul();return}n=!0,l&&Pl(),da.ensure(),this.#v=0,this.#i!==null&&ka(this.#i,()=>{this.#i=null}),this.is_pending=this.has_pending_snippet(),this.#s=this.#g(()=>(this.#f=!1,Dt(()=>this.#n(this.#t)))),this.#d>0?this.#m():this.is_pending=!1};var u=Re;try{kt(null),l=!0,a?.(e,i),l=!1}catch(v){Ma(v,this.#r&&this.#r.parent)}finally{kt(u)}r&&Yt(()=>{this.#i=this.#g(()=>{da.ensure(),this.#f=!0;try{return Dt(()=>{r(this.#t,()=>e,()=>i)})}catch(v){return Ma(v,this.#r.parent),null}finally{this.#f=!1}})})}}function ai(t,e,a,r){const n=ns()?rs:_n;var l=t.filter(h=>!h.settled);if(a.length===0&&l.length===0){r(e.map(n));return}var i=Ie,u=$e,v=si(),d=l.length===1?l[0].promise:l.length>1?Promise.all(l.map(h=>h.promise)):null;function p(h){v();try{r(h)}catch(_){(u.f&Kt)===0&&Ma(_,u)}i?.deactivate(),Ks()}if(a.length===0){d.then(()=>p(e.map(n)));return}function m(){v(),Promise.all(a.map(h=>ni(h))).then(h=>p([...e.map(n),...h])).catch(h=>Ma(h,u))}d?d.then(m):m()}function si(){var t=$e,e=Re,a=nt,r=Ie;return function(l=!0){Ht(t),kt(e),Ra(a),l&&r?.activate()}}function Ks(){Ht(null),kt(null),Ra(null)}function rs(t){var e=pt|mt,a=Re!==null&&(Re.f&pt)!==0?Re:null;return $e!==null&&($e.f|=La),{ctx:nt,deps:null,effects:null,equals:vr,f:e,fn:t,reactions:null,rv:0,v:dt,wv:0,parent:a??$e,ac:null}}function ni(t,e,a){let r=$e;r===null&&wl();var n=r.b,l=void 0,i=Ta(dt),u=!Re,v=new Map;return _i(()=>{var d=nr();l=d.promise;try{Promise.resolve(t()).then(d.resolve,d.reject).then(()=>{p===Ie&&p.committed&&p.deactivate(),Ks()})}catch(_){d.reject(_),Ks()}var p=Ie;if(u){var m=n.is_rendered();n.update_pending_count(1),p.increment(m),v.get(p)?.reject(za),v.delete(p),v.set(p,d)}const h=(_,x=void 0)=>{if(p.activate(),x)x!==za&&(i.f|=ua,Na(i,x));else{(i.f&ua)!==0&&(i.f^=ua),Na(i,_);for(const[k,g]of v){if(v.delete(k),k===p)break;g.reject(za)}}u&&(n.update_pending_count(-1),p.decrement(m))};d.promise.then(h,_=>h(null,_||"unknown"))}),yn(()=>{for(const d of v.values())d.reject(za)}),new Promise(d=>{function p(m){function h(){m===l?d(i):p(l)}m.then(h,h)}p(l)})}function st(t){const e=rs(t);return Lr(e),e}function _n(t){const e=rs(t);return e.equals=ur,e}function br(t){var e=t.effects;if(e!==null){t.effects=null;for(var a=0;a<e.length;a+=1)xt(e[a])}}function ri(t){for(var e=t.parent;e!==null;){if((e.f&pt)===0)return(e.f&Kt)===0?e:null;e=e.parent}return null}function gn(t){var e,a=$e;Ht(ri(t));try{t.f&=~Sa,br(t),e=Br(t)}finally{Ht(a)}return e}function yr(t){var e=gn(t);if(!t.equals(e)&&(t.wv=$r(),(!Ie?.is_fork||t.deps===null)&&(t.v=e,t.deps===null))){vt(t,ft);return}ha||(It!==null?(bn()||Ie?.is_fork)&&It.set(t,e):hn(t))}let en=new Set;const fa=new Map;let wr=!1;function Ta(t,e){var a={f:0,v:t,reactions:null,equals:vr,rv:0,wv:0};return a}function q(t,e){const a=Ta(t);return Lr(a),a}function Ya(t,e=!1,a=!0){const r=Ta(t);return e||(r.equals=ur),Ia&&a&&nt!==null&&nt.l!==null&&(nt.l.s??=[]).push(r),r}function f(t,e,a=!1){Re!==null&&(!$t||(Re.f&In)!==0)&&ns()&&(Re.f&(pt|ra|pn|In))!==0&&!aa?.includes(t)&&Al();let r=a?qe(e):e;return Na(t,r)}function Na(t,e){if(!t.equals(e)){var a=t.v;ha?fa.set(t,e):fa.set(t,a),t.v=e;var r=da.ensure();if(r.capture(t,a),(t.f&pt)!==0){const n=t;(t.f&mt)!==0&&gn(n),hn(n)}t.wv=$r(),kr(t,mt),ns()&&$e!==null&&($e.f&ft)!==0&&($e.f&(la|Ea))===0&&(zt===null?mi([t]):zt.push(t)),!r.is_fork&&en.size>0&&!wr&&li()}return e}function li(){wr=!1;for(const t of en)(t.f&ft)!==0&&vt(t,Xt),$a(t)&&Oa(t);en.clear()}function Ja(t){f(t,t.v+1)}function kr(t,e){var a=t.reactions;if(a!==null)for(var r=ns(),n=a.length,l=0;l<n;l++){var i=a[l],u=i.f;if(!(!r&&i===$e)){var v=(u&mt)===0;if(v&&vt(i,e),(u&pt)!==0){var d=i;It?.delete(d),(u&Sa)===0&&(u&Rt&&(i.f|=Sa),kr(d,Xt))}else v&&((u&ra)!==0&&Vt!==null&&Vt.add(i),sa(i))}}}function qe(t){if(typeof t!="object"||t===null||ea in t)return t;const e=vn(t);if(e!==_l&&e!==gl)return t;var a=new Map,r=Cs(t),n=q(0),l=xa,i=u=>{if(xa===l)return u();var v=Re,d=xa;kt(null),Un(l);var p=u();return kt(v),Un(d),p};return r&&a.set("length",q(t.length)),new Proxy(t,{defineProperty(u,v,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&El();var p=a.get(v);return p===void 0?p=i(()=>{var m=q(d.value);return a.set(v,m),m}):f(p,d.value,!0),!0},deleteProperty(u,v){var d=a.get(v);if(d===void 0){if(v in u){const p=i(()=>q(dt));a.set(v,p),Ja(n)}}else f(d,dt),Ja(n);return!0},get(u,v,d){if(v===ea)return t;var p=a.get(v),m=v in u;if(p===void 0&&(!m||Da(u,v)?.writable)&&(p=i(()=>{var _=qe(m?u[v]:dt),x=q(_);return x}),a.set(v,p)),p!==void 0){var h=s(p);return h===dt?void 0:h}return Reflect.get(u,v,d)},getOwnPropertyDescriptor(u,v){var d=Reflect.getOwnPropertyDescriptor(u,v);if(d&&"value"in d){var p=a.get(v);p&&(d.value=s(p))}else if(d===void 0){var m=a.get(v),h=m?.v;if(m!==void 0&&h!==dt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return d},has(u,v){if(v===ea)return!0;var d=a.get(v),p=d!==void 0&&d.v!==dt||Reflect.has(u,v);if(d!==void 0||$e!==null&&(!p||Da(u,v)?.writable)){d===void 0&&(d=i(()=>{var h=p?qe(u[v]):dt,_=q(h);return _}),a.set(v,d));var m=s(d);if(m===dt)return!1}return p},set(u,v,d,p){var m=a.get(v),h=v in u;if(r&&v==="length")for(var _=d;_<m.v;_+=1){var x=a.get(_+"");x!==void 0?f(x,dt):_ in u&&(x=i(()=>q(dt)),a.set(_+"",x))}if(m===void 0)(!h||Da(u,v)?.writable)&&(m=i(()=>q(void 0)),f(m,qe(d)),a.set(v,m));else{h=m.v!==dt;var k=i(()=>qe(d));f(m,k)}var g=Reflect.getOwnPropertyDescriptor(u,v);if(g?.set&&g.set.call(p,d),!h){if(r&&typeof v=="string"){var S=a.get("length"),D=Number(v);Number.isInteger(D)&&D>=S.v&&f(S,D+1)}Ja(n)}return!0},ownKeys(u){s(n);var v=Reflect.ownKeys(u).filter(m=>{var h=a.get(m);return h===void 0||h.v!==dt});for(var[d,p]of a)p.v!==dt&&!(d in u)&&v.push(d);return v},setPrototypeOf(){jl()}})}function Fn(t){try{if(t!==null&&typeof t=="object"&&ea in t)return t[ea]}catch{}return t}function ii(t,e){return Object.is(Fn(t),Fn(e))}var tn,xr,Sr,Tr;function oi(){if(tn===void 0){tn=window,xr=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,a=Text.prototype;Sr=Da(e,"firstChild").get,Tr=Da(e,"nextSibling").get,Ln(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Ln(a)&&(a.__t=void 0)}}function ta(t=""){return document.createTextNode(t)}function va(t){return Sr.call(t)}function ls(t){return Tr.call(t)}function o(t,e){return va(t)}function Ee(t,e=!1){{var a=va(t);return a instanceof Comment&&a.data===""?ls(a):a}}function c(t,e=1,a=!1){let r=t;for(;e--;)r=ls(r);return r}function ci(t){t.textContent=""}function qr(){return!1}function mn(t,e){{const a=document.body;t.autofocus=!0,Yt(()=>{document.activeElement===a&&t.focus()})}}let Bn=!1;function vi(){Bn||(Bn=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function Rs(t){var e=Re,a=$e;kt(null),Ht(null);try{return t()}finally{kt(e),Ht(a)}}function Er(t,e,a,r=a){t.addEventListener(e,()=>Rs(a));const n=t.__on_r;n?t.__on_r=()=>{n(),r(!0)}:t.__on_r=()=>r(!0),vi()}function jr(t){$e===null&&(Re===null&&Sl(),xl()),ha&&kl()}function ui(t,e){var a=e.last;a===null?e.last=e.first=t:(a.next=t,t.prev=a,e.last=t)}function Wt(t,e,a){var r=$e;r!==null&&(r.f&jt)!==0&&(t|=jt);var n={ctx:nt,deps:null,nodes:null,f:t|mt|Rt,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(a)try{Oa(n),n.f|=fn}catch(u){throw xt(n),u}else e!==null&&sa(n);var l=n;if(a&&l.deps===null&&l.teardown===null&&l.nodes===null&&l.first===l.last&&(l.f&La)===0&&(l=l.first,(t&ra)!==0&&(t&pa)!==0&&l!==null&&(l.f|=pa)),l!==null&&(l.parent=r,r!==null&&ui(l,r),Re!==null&&(Re.f&pt)!==0&&(t&Ea)===0)){var i=Re;(i.effects??=[]).push(l)}return n}function bn(){return Re!==null&&!$t}function yn(t){const e=Wt(ss,null,!1);return vt(e,ft),e.teardown=t,e}function bt(t){jr();var e=$e.f,a=!Re&&(e&la)!==0&&(e&fn)===0;if(a){var r=nt;(r.e??=[]).push(t)}else return Ar(t)}function Ar(t){return Wt(Ss|ir,t,!1)}function di(t){return jr(),Wt(ss|ir,t,!0)}function fi(t){da.ensure();const e=Wt(Ea|La,t,!0);return(a={})=>new Promise(r=>{a.outro?ka(e,()=>{xt(e),r(void 0)}):(xt(e),r(void 0))})}function Pr(t){return Wt(Ss,t,!1)}function pi(t,e){var a=nt,r={effect:null,ran:!1,deps:t};a.l.$.push(r),r.effect=is(()=>{t(),!r.ran&&(r.ran=!0,_a(e))})}function hi(){var t=nt;is(()=>{for(var e of t.l.$){e.deps();var a=e.effect;(a.f&ft)!==0&&a.deps!==null&&vt(a,Xt),$a(a)&&Oa(a),e.ran=!1}})}function _i(t){return Wt(pn|La,t,!0)}function is(t,e=0){return Wt(ss|e,t,!0)}function G(t,e=[],a=[],r=[]){ai(r,e,a,n=>{Wt(ss,()=>t(...n.map(s)),!0)})}function os(t,e=0){var a=Wt(ra|e,t,!0);return a}function Dt(t){return Wt(la|La,t,!0)}function Cr(t){var e=t.teardown;if(e!==null){const a=ha,r=Re;Gn(!0),kt(null);try{e.call(null)}finally{Gn(a),kt(r)}}}function zr(t,e=!1){var a=t.first;for(t.first=t.last=null;a!==null;){const n=a.ac;n!==null&&Rs(()=>{n.abort(za)});var r=a.next;(a.f&Ea)!==0?a.parent=null:xt(a,e),a=r}}function gi(t){for(var e=t.first;e!==null;){var a=e.next;(e.f&la)===0&&xt(e),e=a}}function xt(t,e=!0){var a=!1;(e||(t.f&lr)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Dr(t.nodes.start,t.nodes.end),a=!0),zr(t,e&&!a),qs(t,0),vt(t,Kt);var r=t.nodes&&t.nodes.t;if(r!==null)for(const l of r)l.stop();Cr(t);var n=t.parent;n!==null&&n.first!==null&&Rr(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Dr(t,e){for(;t!==null;){var a=t===e?null:ls(t);t.remove(),t=a}}function Rr(t){var e=t.parent,a=t.prev,r=t.next;a!==null&&(a.next=r),r!==null&&(r.prev=a),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=a))}function ka(t,e,a=!0){var r=[];Mr(t,r,!0);var n=()=>{a&&xt(t),e&&e()},l=r.length;if(l>0){var i=()=>--l||n();for(var u of r)u.out(i)}else n()}function Mr(t,e,a){if((t.f&jt)===0){t.f^=jt;var r=t.nodes&&t.nodes.t;if(r!==null)for(const u of r)(u.is_global||a)&&e.push(u);for(var n=t.first;n!==null;){var l=n.next,i=(n.f&pa)!==0||(n.f&la)!==0&&(t.f&ra)!==0;Mr(n,e,i?a:!1),n=l}}}function wn(t){Nr(t,!0)}function Nr(t,e){if((t.f&jt)!==0){t.f^=jt,(t.f&ft)===0&&(vt(t,mt),sa(t));for(var a=t.first;a!==null;){var r=a.next,n=(a.f&pa)!==0||(a.f&la)!==0;Nr(a,n?e:!1),a=r}var l=t.nodes&&t.nodes.t;if(l!==null)for(const i of l)(i.is_global||e)&&i.in()}}function Or(t,e){if(t.nodes)for(var a=t.nodes.start,r=t.nodes.end;a!==null;){var n=a===r?null:ls(a);e.append(a),a=n}}let ks=!1,ha=!1;function Gn(t){ha=t}let Re=null,$t=!1;function kt(t){Re=t}let $e=null;function Ht(t){$e=t}let aa=null;function Lr(t){Re!==null&&(aa===null?aa=[t]:aa.push(t))}let wt=null,qt=0,zt=null;function mi(t){zt=t}let Ir=1,wa=0,xa=wa;function Un(t){xa=t}function $r(){return++Ir}function $a(t){var e=t.f;if((e&mt)!==0)return!0;if(e&pt&&(t.f&=~Sa),(e&Xt)!==0){for(var a=t.deps,r=a.length,n=0;n<r;n++){var l=a[n];if($a(l)&&yr(l),l.wv>t.wv)return!0}(e&Rt)!==0&&It===null&&vt(t,ft)}return!1}function Fr(t,e,a=!0){var r=t.reactions;if(r!==null&&!aa?.includes(t))for(var n=0;n<r.length;n++){var l=r[n];(l.f&pt)!==0?Fr(l,e,!1):e===l&&(a?vt(l,mt):(l.f&ft)!==0&&vt(l,Xt),sa(l))}}function Br(t){var e=wt,a=qt,r=zt,n=Re,l=aa,i=nt,u=$t,v=xa,d=t.f;wt=null,qt=0,zt=null,Re=(d&(la|Ea))===0?t:null,aa=null,Ra(t.ctx),$t=!1,xa=++wa,t.ac!==null&&(Rs(()=>{t.ac.abort(za)}),t.ac=null);try{t.f|=Vs;var p=t.fn,m=p(),h=t.deps;if(wt!==null){var _;if(qs(t,qt),h!==null&&qt>0)for(h.length=qt+wt.length,_=0;_<wt.length;_++)h[qt+_]=wt[_];else t.deps=h=wt;if(bn()&&(t.f&Rt)!==0)for(_=qt;_<h.length;_++)(h[_].reactions??=[]).push(t)}else h!==null&&qt<h.length&&(qs(t,qt),h.length=qt);if(ns()&&zt!==null&&!$t&&h!==null&&(t.f&(pt|Xt|mt))===0)for(_=0;_<zt.length;_++)Fr(zt[_],t);if(n!==null&&n!==t){if(wa++,n.deps!==null)for(let x=0;x<a;x+=1)n.deps[x].rv=wa;if(e!==null)for(const x of e)x.rv=wa;zt!==null&&(r===null?r=zt:r.push(...zt))}return(t.f&ua)!==0&&(t.f^=ua),m}catch(x){return fr(x)}finally{t.f^=Vs,wt=e,qt=a,zt=r,Re=n,aa=l,Ra(i),$t=u,xa=v}}function bi(t,e){let a=e.reactions;if(a!==null){var r=pl.call(a,t);if(r!==-1){var n=a.length-1;n===0?a=e.reactions=null:(a[r]=a[n],a.pop())}}if(a===null&&(e.f&pt)!==0&&(wt===null||!wt.includes(e))){var l=e;(l.f&Rt)!==0&&(l.f^=Rt,l.f&=~Sa),hn(l),br(l),qs(l,0)}}function qs(t,e){var a=t.deps;if(a!==null)for(var r=e;r<a.length;r++)bi(t,a[r])}function Oa(t){var e=t.f;if((e&Kt)===0){vt(t,ft);var a=$e,r=ks;$e=t,ks=!0;try{(e&(ra|rr))!==0?gi(t):zr(t),Cr(t);var n=Br(t);t.teardown=typeof n=="function"?n:null,t.wv=Ir;var l;Zs&&Hl&&(t.f&mt)!==0&&t.deps}finally{ks=r,$e=a}}}async function yi(){await Promise.resolve(),Jl()}function s(t){var e=t.f,a=(e&pt)!==0;if(Re!==null&&!$t){var r=$e!==null&&($e.f&Kt)!==0;if(!r&&!aa?.includes(t)){var n=Re.deps;if((Re.f&Vs)!==0)t.rv<wa&&(t.rv=wa,wt===null&&n!==null&&n[qt]===t?qt++:wt===null?wt=[t]:wt.push(t));else{(Re.deps??=[]).push(t);var l=t.reactions;l===null?t.reactions=[Re]:l.includes(Re)||l.push(Re)}}}if(ha&&fa.has(t))return fa.get(t);if(a){var i=t;if(ha){var u=i.v;return((i.f&ft)===0&&i.reactions!==null||Ur(i))&&(u=gn(i)),fa.set(i,u),u}var v=(i.f&Rt)===0&&!$t&&Re!==null&&(ks||(Re.f&Rt)!==0),d=i.deps===null;$a(i)&&(v&&(i.f|=Rt),yr(i)),v&&!d&&Gr(i)}if(It?.has(t))return It.get(t);if((t.f&ua)!==0)throw t.v;return t.v}function Gr(t){if(t.deps!==null){t.f|=Rt;for(const e of t.deps)(e.reactions??=[]).push(t),(e.f&pt)!==0&&(e.f&Rt)===0&&Gr(e)}}function Ur(t){if(t.v===dt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(fa.has(e)||(e.f&pt)!==0&&Ur(e))return!0;return!1}function _a(t){var e=$t;try{return $t=!0,t()}finally{$t=e}}function Yr(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(ea in t)an(t);else if(!Array.isArray(t))for(let e in t){const a=t[e];typeof a=="object"&&a&&ea in a&&an(a)}}}function an(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{an(t[r],e)}catch{}const a=vn(t);if(a!==Object.prototype&&a!==Array.prototype&&a!==Map.prototype&&a!==Set.prototype&&a!==Date.prototype){const r=sr(a);for(let n in r){const l=r[n].get;if(l)try{l.call(t)}catch{}}}}}const wi=["touchstart","touchmove"];function ki(t){return wi.includes(t)}const Hr=new Set,sn=new Set;function xi(t,e,a,r={}){function n(l){if(r.capture||Ha.call(e,l),!l.cancelBubble)return Rs(()=>a?.call(this,l))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Yt(()=>{e.addEventListener(t,n,r)}):e.addEventListener(t,n,r),n}function na(t,e,a,r,n){var l={capture:r,passive:n},i=xi(t,e,a,l);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&yn(()=>{e.removeEventListener(t,i,l)})}function Je(t){for(var e=0;e<t.length;e++)Hr.add(t[e]);for(var a of sn)a(t)}let Yn=null;function Ha(t){var e=this,a=e.ownerDocument,r=t.type,n=t.composedPath?.()||[],l=n[0]||t.target;Yn=t;var i=0,u=Yn===t&&t.__root;if(u){var v=n.indexOf(u);if(v!==-1&&(e===document||e===window)){t.__root=e;return}var d=n.indexOf(e);if(d===-1)return;v<=d&&(i=v)}if(l=n[i]||t.target,l!==e){hl(t,"currentTarget",{configurable:!0,get(){return l||a}});var p=Re,m=$e;kt(null),Ht(null);try{for(var h,_=[];l!==null;){var x=l.assignedSlot||l.parentNode||l.host||null;try{var k=l["__"+r];k!=null&&(!l.disabled||t.target===l)&&k.call(l,t)}catch(g){h?_.push(g):h=g}if(t.cancelBubble||x===e||x===null)break;l=x}if(h){for(let g of _)queueMicrotask(()=>{throw g});throw h}}finally{t.__root=e,delete t.currentTarget,kt(p),Ht(m)}}}function Xr(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function Ka(t,e){var a=$e;a.nodes===null&&(a.nodes={start:t,end:e,a:null,t:null})}function w(t,e){var a=(e&$l)!==0,r=(e&Fl)!==0,n,l=!t.startsWith("<!>");return()=>{n===void 0&&(n=Xr(l?t:"<!>"+t),a||(n=va(n)));var i=r||xr?document.importNode(n,!0):n.cloneNode(!0);if(a){var u=va(i),v=i.lastChild;Ka(u,v)}else Ka(i,i);return i}}function Wr(t=""){{var e=ta(t+"");return Ka(e,e),e}}function et(){var t=document.createDocumentFragment(),e=document.createComment(""),a=ta();return t.append(e,a),Ka(e,a),t}function b(t,e){t!==null&&t.before(e)}function T(t,e){var a=e==null?"":typeof e=="object"?e+"":e;a!==(t.__t??=t.nodeValue)&&(t.__t=a,t.nodeValue=a+"")}function Si(t,e){return Ti(t,e)}const Ca=new Map;function Ti(t,{target:e,anchor:a,props:r={},events:n,context:l,intro:i=!0}){oi();var u=new Set,v=m=>{for(var h=0;h<m.length;h++){var _=m[h];if(!u.has(_)){u.add(_);var x=ki(_);e.addEventListener(_,Ha,{passive:x});var k=Ca.get(_);k===void 0?(document.addEventListener(_,Ha,{passive:x}),Ca.set(_,1)):Ca.set(_,k+1)}}};v(zs(Hr)),sn.add(v);var d=void 0,p=fi(()=>{var m=a??e.appendChild(ta());return ei(m,{pending:()=>{}},h=>{if(l){He({});var _=nt;_.c=l}n&&(r.$$events=n),d=t(h,r)||{},l&&Xe()}),()=>{for(var h of u){e.removeEventListener(h,Ha);var _=Ca.get(h);--_===0?(document.removeEventListener(h,Ha),Ca.delete(h)):Ca.set(h,_)}sn.delete(v),m!==a&&m.parentNode?.removeChild(m)}});return qi.set(d,p),d}let qi=new WeakMap;class kn{anchor;#t=new Map;#l=new Map;#e=new Map;#n=new Set;#r=!0;constructor(e,a=!0){this.anchor=e,this.#r=a}#s=()=>{var e=Ie;if(this.#t.has(e)){var a=this.#t.get(e),r=this.#l.get(a);if(r)wn(r),this.#n.delete(a);else{var n=this.#e.get(a);n&&(this.#l.set(a,n.effect),this.#e.delete(a),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),r=n.effect)}for(const[l,i]of this.#t){if(this.#t.delete(l),l===e)break;const u=this.#e.get(i);u&&(xt(u.effect),this.#e.delete(i))}for(const[l,i]of this.#l){if(l===a||this.#n.has(l))continue;const u=()=>{if(Array.from(this.#t.values()).includes(l)){var d=document.createDocumentFragment();Or(i,d),d.append(ta()),this.#e.set(l,{effect:i,fragment:d})}else xt(i);this.#n.delete(l),this.#l.delete(l)};this.#r||!r?(this.#n.add(l),ka(i,u,!1)):u()}}};#a=e=>{this.#t.delete(e);const a=Array.from(this.#t.values());for(const[r,n]of this.#e)a.includes(r)||(xt(n.effect),this.#e.delete(r))};ensure(e,a){var r=Ie,n=qr();if(a&&!this.#l.has(e)&&!this.#e.has(e))if(n){var l=document.createDocumentFragment(),i=ta();l.append(i),this.#e.set(e,{effect:Dt(()=>a(i)),fragment:l})}else this.#l.set(e,Dt(()=>a(this.anchor)));if(this.#t.set(r,e),n){for(const[u,v]of this.#l)u===e?r.skipped_effects.delete(v):r.skipped_effects.add(v);for(const[u,v]of this.#e)u===e?r.skipped_effects.delete(v.effect):r.skipped_effects.add(v.effect);r.oncommit(this.#s),r.ondiscard(this.#a)}else this.#s()}}function L(t,e,a=!1){var r=new kn(t),n=a?pa:0;function l(i,u){r.ensure(i,u)}os(()=>{var i=!1;e((u,v=!0)=>{i=!0,l(v,u)}),i||l(!1,null)},n)}function Be(t,e){return e}function Ei(t,e,a){for(var r=[],n=e.length,l,i=e.length,u=0;u<n;u++){let m=e[u];ka(m,()=>{if(l){if(l.pending.delete(m),l.done.add(m),l.pending.size===0){var h=t.outrogroups;nn(zs(l.done)),h.delete(l),h.size===0&&(t.outrogroups=null)}}else i-=1},!1)}if(i===0){var v=r.length===0&&a!==null;if(v){var d=a,p=d.parentNode;ci(p),p.append(d),t.items.clear()}nn(e,!v)}else l={pending:new Set(e),done:new Set},(t.outrogroups??=new Set).add(l)}function nn(t,e=!0){for(var a=0;a<t.length;a++)xt(t[a],e)}var Hn;function Ae(t,e,a,r,n,l=null){var i=t,u=new Map,v=(e&cr)!==0;if(v){var d=t;i=d.appendChild(ta())}var p=null,m=_n(()=>{var S=a();return Cs(S)?S:S==null?[]:zs(S)}),h,_=!0;function x(){g.fallback=p,ji(g,h,i,e,r),p!==null&&(h.length===0?(p.f&Qt)===0?wn(p):(p.f^=Qt,Xa(p,null,i)):ka(p,()=>{p=null}))}var k=os(()=>{h=s(m);for(var S=h.length,D=new Set,y=Ie,j=qr(),z=0;z<S;z+=1){var R=h[z],X=r(R,z),I=_?null:u.get(X);I?(I.v&&Na(I.v,R),I.i&&Na(I.i,z),j&&y.skipped_effects.delete(I.e)):(I=Ai(u,_?i:Hn??=ta(),R,X,z,n,e,a),_||(I.e.f|=Qt),u.set(X,I)),D.add(X)}if(S===0&&l&&!p&&(_?p=Dt(()=>l(i)):(p=Dt(()=>l(Hn??=ta())),p.f|=Qt)),!_)if(j){for(const[U,W]of u)D.has(U)||y.skipped_effects.add(W.e);y.oncommit(x),y.ondiscard(()=>{})}else x();s(m)}),g={effect:k,items:u,outrogroups:null,fallback:p};_=!1}function ji(t,e,a,r,n){var l=(r&Dl)!==0,i=e.length,u=t.items,v=t.effect.first,d,p=null,m,h=[],_=[],x,k,g,S;if(l)for(S=0;S<i;S+=1)x=e[S],k=n(x,S),g=u.get(k).e,(g.f&Qt)===0&&(g.nodes?.a?.measure(),(m??=new Set).add(g));for(S=0;S<i;S+=1){if(x=e[S],k=n(x,S),g=u.get(k).e,t.outrogroups!==null)for(const W of t.outrogroups)W.pending.delete(g),W.done.delete(g);if((g.f&Qt)!==0)if(g.f^=Qt,g===v)Xa(g,null,a);else{var D=p?p.next:v;g===t.effect.last&&(t.effect.last=g.prev),g.prev&&(g.prev.next=g.next),g.next&&(g.next.prev=g.prev),oa(t,p,g),oa(t,g,D),Xa(g,D,a),p=g,h=[],_=[],v=p.next;continue}if((g.f&jt)!==0&&(wn(g),l&&(g.nodes?.a?.unfix(),(m??=new Set).delete(g))),g!==v){if(d!==void 0&&d.has(g)){if(h.length<_.length){var y=_[0],j;p=y.prev;var z=h[0],R=h[h.length-1];for(j=0;j<h.length;j+=1)Xa(h[j],y,a);for(j=0;j<_.length;j+=1)d.delete(_[j]);oa(t,z.prev,R.next),oa(t,p,z),oa(t,R,y),v=y,p=R,S-=1,h=[],_=[]}else d.delete(g),Xa(g,v,a),oa(t,g.prev,g.next),oa(t,g,p===null?t.effect.first:p.next),oa(t,p,g),p=g;continue}for(h=[],_=[];v!==null&&v!==g;)(d??=new Set).add(v),_.push(v),v=v.next;if(v===null)continue}(g.f&Qt)===0&&h.push(g),p=g,v=g.next}if(t.outrogroups!==null){for(const W of t.outrogroups)W.pending.size===0&&(nn(zs(W.done)),t.outrogroups?.delete(W));t.outrogroups.size===0&&(t.outrogroups=null)}if(v!==null||d!==void 0){var X=[];if(d!==void 0)for(g of d)(g.f&jt)===0&&X.push(g);for(;v!==null;)(v.f&jt)===0&&v!==t.fallback&&X.push(v),v=v.next;var I=X.length;if(I>0){var U=(r&cr)!==0&&i===0?a:null;if(l){for(S=0;S<I;S+=1)X[S].nodes?.a?.measure();for(S=0;S<I;S+=1)X[S].nodes?.a?.fix()}Ei(t,X,U)}}l&&Yt(()=>{if(m!==void 0)for(g of m)g.nodes?.a?.apply()})}function Ai(t,e,a,r,n,l,i,u){var v=(i&Cl)!==0?(i&Rl)===0?Ya(a,!1,!1):Ta(a):null,d=(i&zl)!==0?Ta(n):null;return{v,i:d,e:Dt(()=>(l(e,v??a,d??n,u),()=>{t.delete(r)}))}}function Xa(t,e,a){if(t.nodes)for(var r=t.nodes.start,n=t.nodes.end,l=e&&(e.f&Qt)===0?e.nodes.start:a;r!==null;){var i=ls(r);if(l.before(r),r===n)return;r=i}}function oa(t,e,a){e===null?t.effect.first=a:e.next=a,a===null?t.effect.last=e:a.prev=e}function Pi(t,e,a=!1,r=!1,n=!1){var l=t,i="";G(()=>{var u=$e;if(i!==(i=e()??"")&&(u.nodes!==null&&(Dr(u.nodes.start,u.nodes.end),u.nodes=null),i!=="")){var v=i+"";a?v=`<svg>${v}</svg>`:r&&(v=`<math>${v}</math>`);var d=Xr(v);if((a||r)&&(d=va(d)),Ka(va(d),d.lastChild),a||r)for(;va(d);)l.before(va(d));else l.before(d)}})}function Ci(t,e,...a){var r=new kn(t);os(()=>{const n=e()??null;r.ensure(n,n&&(l=>n(l,...a)))},pa)}function zi(t,e,a){var r=new kn(t);os(()=>{var n=e()??null;r.ensure(n,n&&(l=>a(l,n)))},pa)}const Xn=[...` 	
\r\f¬†\v\uFEFF`];function Di(t,e,a){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),a){for(var n in a)if(a[n])r=r?r+" "+n:n;else if(r.length)for(var l=n.length,i=0;(i=r.indexOf(n,i))>=0;){var u=i+l;(i===0||Xn.includes(r[i-1]))&&(u===r.length||Xn.includes(r[u]))?r=(i===0?"":r.substring(0,i))+r.substring(u+1):i=u}}return r===""?null:r}function Ri(t,e){return t==null?null:String(t)}function Oe(t,e,a,r,n,l){var i=t.__className;if(i!==a||i===void 0){var u=Di(a,r,l);u==null?t.removeAttribute("class"):t.className=u,t.__className=a}else if(l&&n!==l)for(var v in l){var d=!!l[v];(n==null||d!==!!n[v])&&t.classList.toggle(v,d)}return l}function es(t,e,a,r){var n=t.__style;if(n!==e){var l=Ri(e);l==null?t.removeAttribute("style"):t.style.cssText=l,t.__style=e}return r}function ts(t,e,a=!1){if(t.multiple){if(e==null)return;if(!Cs(e))return Gl();for(var r of t.options)r.selected=e.includes(Va(r));return}for(r of t.options){var n=Va(r);if(ii(n,e)){r.selected=!0;return}}(!a||e!==void 0)&&(t.selectedIndex=-1)}function Es(t){var e=new MutationObserver(()=>{ts(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),yn(()=>{e.disconnect()})}function lt(t,e,a=e){var r=new WeakSet,n=!0;Er(t,"change",l=>{var i=l?"[selected]":":checked",u;if(t.multiple)u=[].map.call(t.querySelectorAll(i),Va);else{var v=t.querySelector(i)??t.querySelector("option:not([disabled])");u=v&&Va(v)}a(u),Ie!==null&&r.add(Ie)}),Pr(()=>{var l=e();if(t===document.activeElement){var i=Ts??Ie;if(r.has(i))return}if(ts(t,l,n),n&&l===void 0){var u=t.querySelector(":checked");u!==null&&(l=Va(u),a(l))}t.__value=l,n=!1}),Es(t)}function Va(t){return"__value"in t?t.__value:t.value}const Mi=Symbol("is custom element"),Ni=Symbol("is html");function Ba(t,e){var a=xn(t);a.value===(a.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function Us(t,e){var a=xn(t);a.checked!==(a.checked=e??void 0)&&(t.checked=e)}function Ue(t,e,a,r){var n=xn(t);n[e]!==(n[e]=a)&&(e==="loading"&&(t[yl]=a),a==null?t.removeAttribute(e):typeof a!="string"&&Oi(t).includes(e)?t[e]=a:t.setAttribute(e,a))}function xn(t){return t.__attributes??={[Mi]:t.nodeName.includes("-"),[Ni]:t.namespaceURI===Bl}}var Wn=new Map;function Oi(t){var e=t.getAttribute("is")||t.nodeName,a=Wn.get(e);if(a)return a;Wn.set(e,a=[]);for(var r,n=t,l=Element.prototype;l!==n;){r=sr(n);for(var i in r)r[i].set&&a.push(i);n=vn(n)}return a}function je(t,e,a=e){var r=new WeakSet;Er(t,"input",async n=>{var l=n?t.defaultValue:t.value;if(l=Ys(t)?Hs(l):l,a(l),Ie!==null&&r.add(Ie),await yi(),l!==(l=e())){var i=t.selectionStart,u=t.selectionEnd,v=t.value.length;if(t.value=l??"",u!==null){var d=t.value.length;i===u&&u===v&&d>v?(t.selectionStart=d,t.selectionEnd=d):(t.selectionStart=i,t.selectionEnd=Math.min(u,d))}}}),_a(e)==null&&t.value&&(a(Ys(t)?Hs(t.value):t.value),Ie!==null&&r.add(Ie)),is(()=>{var n=e();if(t===document.activeElement){var l=Ts??Ie;if(r.has(l))return}Ys(t)&&n===Hs(t.value)||t.type==="date"&&!n&&!t.value||n!==t.value&&(t.value=n??"")})}function Ys(t){var e=t.type;return e==="number"||e==="range"}function Hs(t){return t===""?null:+t}function Zn(t,e){return t===e||t?.[ea]===e}function Sn(t={},e,a,r){return Pr(()=>{var n,l;return is(()=>{n=l,l=[],_a(()=>{t!==a(...l)&&(e(t,...l),n&&Zn(a(...n),t)&&e(null,...n))})}),()=>{Yt(()=>{l&&Zn(a(...l),t)&&e(null,...l)})}}),t}function Zr(t=!1){const e=nt,a=e.l.u;if(!a)return;let r=()=>Yr(e.s);if(t){let n=0,l={};const i=rs(()=>{let u=!1;const v=e.s;for(const d in v)v[d]!==l[d]&&(l[d]=v[d],u=!0);return u&&n++,n});r=()=>s(i)}a.b.length&&di(()=>{Jn(e,r),Js(a.b)}),bt(()=>{const n=_a(()=>a.m.map(ml));return()=>{for(const l of n)typeof l=="function"&&l()}}),a.a.length&&bt(()=>{Jn(e,r),Js(a.a)})}function Jn(t,e){if(t.l.s)for(const a of t.l.s)s(a);e()}let ys=!1;function Li(t){var e=ys;try{return ys=!1,[t(),ys]}finally{ys=e}}function ut(t,e,a,r){var n=!Ia||(a&Nl)!==0,l=(a&Ll)!==0,i=(a&Il)!==0,u=r,v=!0,d=()=>(v&&(v=!1,u=i?_a(r):r),u),p;if(l){var m=ea in t||bl in t;p=Da(t,e)?.set??(m&&e in t?y=>t[e]=y:void 0)}var h,_=!1;l?[h,_]=Li(()=>t[e]):h=t[e],h===void 0&&r!==void 0&&(h=d(),p&&(n&&ql(),p(h)));var x;if(n?x=()=>{var y=t[e];return y===void 0?d():(v=!0,y)}:x=()=>{var y=t[e];return y!==void 0&&(u=void 0),y===void 0?u:y},n&&(a&Ol)===0)return x;if(p){var k=t.$$legacy;return(function(y,j){return arguments.length>0?((!n||!j||k||_)&&p(j?x():y),y):x()})}var g=!1,S=((a&Ml)!==0?rs:_n)(()=>(g=!1,x()));l&&s(S);var D=$e;return(function(y,j){if(arguments.length>0){const z=j?s(S):n&&l?qe(y):y;return f(S,z),g=!0,u!==void 0&&(u=z),y}return ha&&g||(D.f&Kt)!==0?S.v:s(S)})}function At(t){nt===null&&or(),Ia&&nt.l!==null?$i(nt).m.push(t):bt(()=>{const e=_a(t);if(typeof e=="function")return e})}function Ii(t,e,{bubbles:a=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:a,cancelable:r})}function Jr(){const t=nt;return t===null&&or(),(e,a,r)=>{const n=t.s.$$events?.[e];if(n){const l=Cs(n)?n.slice():[n],i=Ii(e,a,r);for(const u of l)u.call(t.x,i);return!i.defaultPrevented}return!0}}function $i(t){var e=t.l;return e.u??={a:[],b:[],m:[]}}const Fi="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Fi);function Ut(t){window.history.pushState({},"",t),window.dispatchEvent(new Event("popstate"))}let rn=qe({path:window.location.pathname});if(typeof window<"u"){const t=history.pushState;history.pushState=function(...e){t.apply(this,e),rn.path=window.location.pathname,window.dispatchEvent(new Event("popstate"))},window.addEventListener("popstate",()=>{rn.path=window.location.pathname})}const ca={get path(){return rn.path}};var Bi=w("<p>404 Not Found</p>");function Gi(t,e){He(e,!0);let a=q(qe(window.location.pathname)),r=q(null);function n(){f(a,window.location.pathname,!0)}bt(()=>{let d=s(a),p=null;if(!e.routes)return;const m=Object.keys(e.routes).sort((h,_)=>_.length-h.length);for(const h of m){if(h===d){p=e.routes[h];break}if(d.startsWith(h)&&h!=="/"){p=e.routes[h];break}}p||(p=e.routes["/"]||null),f(r,p,!0)}),At(()=>(window.addEventListener("popstate",n),()=>{window.removeEventListener("popstate",n)}));var l=et(),i=Ee(l);{var u=d=>{var p=et(),m=Ee(p);zi(m,()=>s(r),(h,_)=>{_(h,{})}),b(d,p)},v=d=>{var p=Bi();b(d,p)};L(i,d=>{s(r)?d(u):d(v,!1)})}b(t,l),Xe()}const Ce="";function ze(t={}){return{"X-User-Role":localStorage.getItem("user_role")||"admin",...t}}async function Tn(t){const e=new FormData;e.append("file",t);const a=await fetch(`${Ce}/upload`,{method:"POST",headers:ze(),body:e});if(!a.ok)throw new Error("Upload failed");return await a.json()}async function qn(t="",e="",a="",r="registration_date",n="desc",l="",i="",u="",v="registration_date",d=""){const p=new URLSearchParams;return t&&p.append("search",t),e&&p.append("type",e),a&&p.append("status",a),l&&p.append("tag",l),i&&p.append("start_date",i),u&&p.append("end_date",u),v&&p.append("date_field",v),r&&p.append("sort_by",r),n&&p.append("sort_order",n),d&&p.append("part_search",d),await(await fetch(`${Ce}/documents/?${p.toString()}`,{headers:ze()})).json()}async function Ui(){return await(await fetch(`${Ce}/tags`,{headers:ze()})).json()}async function Xs(t){const e=await fetch(`${Ce}/settings/${t}`,{headers:ze()});if(!e.ok)throw new Error("Failed to fetch setting");return await e.json()}async function Ws(t,e){const a=await fetch(`${Ce}/settings/`,{method:"PUT",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify({key:t,value:e})});if(!a.ok){const r=await a.json().catch(()=>({}));throw new Error(r.detail||`Failed to update setting (${a.status})`)}return await a.json()}async function Yi(t){return await(await fetch(`${Ce}/settings/test-path`,{method:"POST",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify({path:t})})).json()}async function Hi(t){const e=await fetch(`${Ce}/documents/`,{method:"POST",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify(t)});if(!e.ok){const a=await e.json().catch(()=>({}));throw new Error(a.detail||`Failed to create document (${e.status})`)}return await e.json()}async function Xi(t,e){return await(await fetch(`${Ce}/documents/${t}`,{method:"PUT",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify({status:e})})).json()}async function Wi(t,e){const a=await fetch(`${Ce}/documents/${t}`,{method:"PUT",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!a.ok){const r=await a.json().catch(()=>({}));throw new Error(r.detail||`Failed to update document (${a.status})`)}return await a.json()}async function Zi(t,e){const a=await fetch(`${Ce}/documents/${t}/download-zip`,{headers:ze()});if(!a.ok)throw new Error("Download failed");const r=await a.blob(),n=window.URL.createObjectURL(r),l=document.createElement("a");l.href=n,l.download=`${e}_source.zip`,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(n)}async function Ji(t){return await(await fetch(`${Ce}/documents/${t}`,{method:"DELETE",headers:ze()})).json()}async function Vi(t="",e="",a=""){const r=new URLSearchParams;return t&&r.append("type",t),e&&r.append("status",e),a&&r.append("document_id",a),await(await fetch(`${Ce}/journal/?${r.toString()}`,{headers:ze()})).json()}async function Vr(t){return await(await fetch(`${Ce}/journal/`,{method:"POST",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify(t)})).json()}async function En(t,e){return await(await fetch(`${Ce}/journal/${t}`,{method:"PUT",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify(e)})).json()}async function Qi(t){return await(await fetch(`${Ce}/journal/${t}`,{method:"DELETE",headers:ze()})).json()}async function Ki(t,e){return await(await fetch(`${Ce}/documents/${t}/tasks`,{method:"POST",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify(e)})).json()}async function xs(t,e){return await(await fetch(`${Ce}/tasks/${t}`,{method:"PUT",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify(e)})).json()}async function eo(t){return await(await fetch(`${Ce}/tasks/${t}`,{method:"DELETE",headers:ze()})).json()}async function to(t){return await(await fetch(`${Ce}/attachments/${t}`,{method:"DELETE",headers:ze()})).json()}async function ao(){return await(await fetch(`${Ce}/filter-presets`,{headers:ze()})).json()}async function ja(){return await(await fetch(`${Ce}/materials`,{headers:ze()})).json()}async function so(t){return await(await fetch(`${Ce}/materials`,{method:"POST",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify(t)})).json()}async function no(t,e){return await(await fetch(`${Ce}/materials/${t}?name=${encodeURIComponent(e)}`,{method:"PUT",headers:ze({"Content-Type":"application/json"})})).json()}async function ro(t){return await(await fetch(`${Ce}/materials/${t}`,{method:"DELETE",headers:ze()})).json()}async function lo(t=0,e=100,a={}){const r=new URLSearchParams({skip:String(t),limit:String(e)});return a.search&&r.append("search",a.search),a.material_id&&r.append("material_id",a.material_id),a.min_width&&r.append("min_width",a.min_width),a.max_width&&r.append("max_width",a.max_width),a.min_height&&r.append("min_height",a.min_height),a.max_height&&r.append("max_height",a.max_height),await(await fetch(`${Ce}/parts?${r.toString()}`,{headers:ze()})).json()}async function io(){return await(await fetch(`${Ce}/stock`,{headers:ze()})).json()}async function oo(t){return await(await fetch(`${Ce}/stock`,{method:"POST",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify(t)})).json()}async function co(t){return await(await fetch(`${Ce}/stock/${t}`,{method:"DELETE",headers:ze()})).json()}async function vo(t){const e=new FormData;e.append("file",t);const a=await fetch(`${Ce}/gnc/parse`,{method:"POST",headers:ze(),body:e});if(!a.ok){const r=await a.json().catch(()=>({}));throw new Error(r.detail||"Failed to parse GNC file")}return await a.json()}async function uo(t,e,a=!0){const r=await fetch(`${Ce}/gnc/save`,{method:"PUT",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify({sheet:t,filename:e,overwrite:a})});if(!r.ok){const n=await r.json().catch(()=>({}));throw new Error(n.detail||"Failed to save GNC file")}return await r.json()}async function fo(t){const e=await fetch(`${Ce}/parts/scan`,{method:"POST",headers:ze()});if(!e.ok)throw new Error("Failed to start scan");const a=e.body.getReader(),r=new TextDecoder;for(;;){const{done:n,value:l}=await a.read();if(n)break;const u=r.decode(l).split(`
`).filter(v=>v.trim());for(const v of u)try{const d=JSON.parse(v);t(d)}catch{console.error("Failed to parse progress:",v)}}}async function po(t,e){const a=await fetch(`${Ce}/parts/${t}`,{method:"PUT",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!a.ok)throw new Error("Failed to update part");return await a.json()}async function as(){return await(await fetch(`${Ce}/assignees/`,{headers:ze()})).json()}async function ho(t){return await(await fetch(`${Ce}/assignees/`,{method:"POST",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify(t)})).json()}async function _o(t,e){return await(await fetch(`${Ce}/assignees/${t}`,{method:"PUT",headers:ze({"Content-Type":"application/json"}),body:JSON.stringify({name:e})})).json()}async function go(t){return await(await fetch(`${Ce}/assignees/${t}`,{method:"DELETE",headers:ze()})).json()}var mo=w('<div class="loading svelte-plcxj0">Loading dashboard...</div>'),bo=w('<div class="recent-doc-item svelte-plcxj0"><div class="doc-info svelte-plcxj0"><span class="doc-name svelte-plcxj0"> </span> <span class="doc-date svelte-plcxj0"> </span></div> <span> </span></div>'),yo=w('<div class="empty-state svelte-plcxj0">No documents yet</div>'),wo=w('<div class="dashboard-section svelte-plcxj0"><h2 class="svelte-plcxj0">üìä Overview</h2> <div class="stats-grid svelte-plcxj0"><div class="stat-card documents svelte-plcxj0"><div class="stat-icon svelte-plcxj0">üìÑ</div> <div class="stat-content svelte-plcxj0"><div class="stat-value svelte-plcxj0"> </div> <div class="stat-label svelte-plcxj0">Total Documents</div> <div class="stat-breakdown svelte-plcxj0"><span class="in-progress svelte-plcxj0"> </span> <span class="done svelte-plcxj0"> </span></div></div></div> <div class="stat-card tasks svelte-plcxj0"><div class="stat-icon svelte-plcxj0">‚úì</div> <div class="stat-content svelte-plcxj0"><div class="stat-value svelte-plcxj0"> </div> <div class="stat-label svelte-plcxj0">Total Tasks</div> <div class="stat-breakdown svelte-plcxj0"><span class="planned svelte-plcxj0"> </span> <span class="pending svelte-plcxj0"> </span> <span class="done svelte-plcxj0"> </span></div></div></div> <div class="stat-card materials svelte-plcxj0"><div class="stat-icon svelte-plcxj0">üì¶</div> <div class="stat-content svelte-plcxj0"><div class="stat-value svelte-plcxj0"> </div> <div class="stat-label svelte-plcxj0">Materials</div></div></div> <div class="stat-card completion svelte-plcxj0"><div class="stat-icon svelte-plcxj0">üìà</div> <div class="stat-content svelte-plcxj0"><div class="stat-value svelte-plcxj0"> </div> <div class="stat-label svelte-plcxj0">Completion Rate</div></div></div></div></div> <div class="dashboard-section svelte-plcxj0"><h2 class="svelte-plcxj0">üìÖ Reports</h2> <div class="reports-grid svelte-plcxj0"><div class="report-card svelte-plcxj0"><h3 class="svelte-plcxj0">Today</h3> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Created:</span> <span class="report-value svelte-plcxj0"> </span></div> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Completed:</span> <span class="report-value svelte-plcxj0"> </span></div></div> <div class="report-card svelte-plcxj0"><h3 class="svelte-plcxj0">Last 7 Days</h3> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Created:</span> <span class="report-value svelte-plcxj0"> </span></div> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Completed:</span> <span class="report-value svelte-plcxj0"> </span></div></div> <div class="report-card svelte-plcxj0"><h3 class="svelte-plcxj0">Last 30 Days</h3> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Created:</span> <span class="report-value svelte-plcxj0"> </span></div> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Completed:</span> <span class="report-value svelte-plcxj0"> </span></div></div></div></div> <div class="dashboard-section svelte-plcxj0"><h2 class="svelte-plcxj0">üìù Recent Documents</h2> <div class="recent-documents svelte-plcxj0"><!> <!></div></div>',1),ko=w('<div class="dashboard-container svelte-plcxj0"><!></div>');function xo(t,e){He(e,!0);let a=qe({totalDocuments:0,totalTasks:0,totalMaterials:0,documentsInProgress:0,documentsDone:0,tasksPlanned:0,tasksPending:0,tasksDone:0}),r=qe({tasksCompleted:0,documentsCreated:0,documentsCompleted:0}),n=qe({tasksCompleted:0,documentsCreated:0,documentsCompleted:0}),l=qe({tasksCompleted:0,documentsCreated:0,documentsCompleted:0}),i=q(qe([])),u=q(!0);At(()=>{v()});async function v(){f(u,!0);try{const _=await qn("","","","registration_date","desc"),x=await ja();a.totalDocuments=_.length,a.totalMaterials=x.length,a.documentsInProgress=_.filter(y=>y.status==="in_progress").length,a.documentsDone=_.filter(y=>y.status==="done").length;let k=[];_.forEach(y=>{y.tasks&&(k=k.concat(y.tasks))}),a.totalTasks=k.length,a.tasksPlanned=k.filter(y=>y.status==="planned").length,a.tasksPending=k.filter(y=>y.status==="pending").length,a.tasksDone=k.filter(y=>y.status==="done").length;const g=new Date;g.setHours(0,0,0,0),r.documentsCreated=_.filter(y=>{const j=new Date(y.registration_date);return j.setHours(0,0,0,0),j.getTime()===g.getTime()}).length,r.documentsCompleted=_.filter(y=>{if(!y.done_date)return!1;const j=new Date(y.done_date);return j.setHours(0,0,0,0),j.getTime()===g.getTime()}).length;const S=new Date;S.setDate(S.getDate()-7),S.setHours(0,0,0,0),n.documentsCreated=_.filter(y=>new Date(y.registration_date)>=S).length,n.documentsCompleted=_.filter(y=>y.done_date?new Date(y.done_date)>=S:!1).length;const D=new Date;D.setDate(D.getDate()-30),D.setHours(0,0,0,0),l.documentsCreated=_.filter(y=>new Date(y.registration_date)>=D).length,l.documentsCompleted=_.filter(y=>y.done_date?new Date(y.done_date)>=D:!1).length,f(i,_.slice(0,5),!0)}catch(_){console.error("Failed to load dashboard data",_)}finally{f(u,!1)}}var d=ko(),p=o(d);{var m=_=>{var x=mo();b(_,x)},h=_=>{var x=wo(),k=Ee(x),g=c(o(k),2),S=o(g),D=c(o(S),2),y=o(D),j=o(y),z=c(y,4),R=o(z),X=o(R),I=c(R,2),U=o(I),W=c(S,2),K=c(o(W),2),O=o(K),B=o(O),ce=c(O,4),le=o(ce),me=o(le),_e=c(le,2),ge=o(_e),be=c(_e,2),pe=o(be),V=c(W,2),se=c(o(V),2),P=o(se),E=o(P),$=c(V,2),ne=c(o($),2),Q=o(ne),ye=o(Q),Y=c(k,2),H=c(o(Y),2),ee=o(H),te=c(o(ee),2),C=c(o(te),2),de=o(C),ie=c(te,2),Z=c(o(ie),2),ae=o(Z),oe=c(ee,2),re=c(o(oe),2),fe=c(o(re),2),N=o(fe),he=c(re,2),we=c(o(he),2),M=o(we),A=c(oe,2),J=c(o(A),2),Se=c(o(J),2),Ne=o(Se),Me=c(J,2),xe=c(o(Me),2),tt=o(xe),Ye=c(Y,2),ve=c(o(Ye),2),F=o(ve);Ae(F,17,()=>s(i),Be,(Te,Pe)=>{var Ve=bo(),Fe=o(Ve),at=o(Fe),We=o(at),rt=c(at,2),St=o(rt),Pt=c(Fe,2),ga=o(Pt);G(()=>{T(We,s(Pe).name),T(St,s(Pe).registration_date),Oe(Pt,1,`doc-status ${s(Pe).status??""}`,"svelte-plcxj0"),T(ga,s(Pe).status)}),b(Te,Ve)});var ue=c(F,2);{var ke=Te=>{var Pe=yo();b(Te,Pe)};L(ue,Te=>{s(i).length===0&&Te(ke)})}G(Te=>{T(j,a.totalDocuments),T(X,`${a.documentsInProgress??""} in progress`),T(U,`${a.documentsDone??""} done`),T(B,a.totalTasks),T(me,`${a.tasksPlanned??""} planned`),T(ge,`${a.tasksPending??""} pending`),T(pe,`${a.tasksDone??""} done`),T(E,a.totalMaterials),T(ye,`${Te??""}%`),T(de,r.documentsCreated),T(ae,r.documentsCompleted),T(N,n.documentsCreated),T(M,n.documentsCompleted),T(Ne,l.documentsCreated),T(tt,l.documentsCompleted)},[()=>a.totalDocuments>0?Math.round(a.documentsDone/a.totalDocuments*100):0]),b(_,x)};L(p,_=>{s(u)?_(m):_(h,!1)})}b(t,d),Xe()}var So=w('<div class="modal-backdrop svelte-5awcn0" role="button" tabindex="0"><div class="modal-content svelte-5awcn0" role="document" tabindex="0"><button class="close-btn svelte-5awcn0">&times;</button> <!></div></div>');function jn(t,e){He(e,!0);let a=ut(e,"maxWidth",3,"500px");function r(u){u.key==="Escape"&&e.close()}var n=et(),l=Ee(n);{var i=u=>{var v=So();v.__click=function(...h){e.close?.apply(this,h)},v.__keydown=r;var d=o(v);d.__click=h=>h.stopPropagation(),d.__keydown=h=>h.stopPropagation();var p=o(d);p.__click=function(...h){e.close?.apply(this,h)};var m=c(p,2);Ci(m,()=>e.children),G(()=>es(d,`max-width: ${a()??""}`)),b(u,v)};L(l,u=>{e.isOpen&&u(i)})}b(t,n),Xe()}Je(["click","keydown"]);function An(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Aa=An();function Qr(t){Aa=t}var Qa={exec:()=>null};function Le(t,e=""){let a=typeof t=="string"?t:t.source,r={replace:(n,l)=>{let i=typeof l=="string"?l:l.source;return i=i.replace(gt.caret,"$1"),a=a.replace(n,i),r},getRegex:()=>new RegExp(a,e)};return r}var To=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),gt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},qo=/^(?:[ \t]*(?:\n|$))+/,Eo=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,jo=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,cs=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ao=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Pn=/(?:[*+-]|\d{1,9}[.)])/,Kr=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,el=Le(Kr).replace(/bull/g,Pn).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Po=Le(Kr).replace(/bull/g,Pn).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Cn=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Co=/^[^\n]+/,zn=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,zo=Le(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",zn).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Do=Le(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Pn).getRegex(),Ms="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Dn=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Ro=Le("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Dn).replace("tag",Ms).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),tl=Le(Cn).replace("hr",cs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ms).getRegex(),Mo=Le(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",tl).getRegex(),Rn={blockquote:Mo,code:Eo,def:zo,fences:jo,heading:Ao,hr:cs,html:Ro,lheading:el,list:Do,newline:qo,paragraph:tl,table:Qa,text:Co},Vn=Le("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",cs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ms).getRegex(),No={...Rn,lheading:Po,table:Vn,paragraph:Le(Cn).replace("hr",cs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Vn).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ms).getRegex()},Oo={...Rn,html:Le(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Dn).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Qa,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Le(Cn).replace("hr",cs).replace("heading",` *#{1,6} *[^
]`).replace("lheading",el).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Lo=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Io=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,al=/^( {2,}|\\)\n(?!\s*$)/,$o=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Ns=/[\p{P}\p{S}]/u,Mn=/[\s\p{P}\p{S}]/u,sl=/[^\s\p{P}\p{S}]/u,Fo=Le(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Mn).getRegex(),nl=/(?!~)[\p{P}\p{S}]/u,Bo=/(?!~)[\s\p{P}\p{S}]/u,Go=/(?:[^\s\p{P}\p{S}]|~)/u,Uo=Le(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",To?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),rl=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Yo=Le(rl,"u").replace(/punct/g,Ns).getRegex(),Ho=Le(rl,"u").replace(/punct/g,nl).getRegex(),ll="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Xo=Le(ll,"gu").replace(/notPunctSpace/g,sl).replace(/punctSpace/g,Mn).replace(/punct/g,Ns).getRegex(),Wo=Le(ll,"gu").replace(/notPunctSpace/g,Go).replace(/punctSpace/g,Bo).replace(/punct/g,nl).getRegex(),Zo=Le("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,sl).replace(/punctSpace/g,Mn).replace(/punct/g,Ns).getRegex(),Jo=Le(/\\(punct)/,"gu").replace(/punct/g,Ns).getRegex(),Vo=Le(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Qo=Le(Dn).replace("(?:-->|$)","-->").getRegex(),Ko=Le("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Qo).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),js=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,ec=Le(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",js).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),il=Le(/^!?\[(label)\]\[(ref)\]/).replace("label",js).replace("ref",zn).getRegex(),ol=Le(/^!?\[(ref)\](?:\[\])?/).replace("ref",zn).getRegex(),tc=Le("reflink|nolink(?!\\()","g").replace("reflink",il).replace("nolink",ol).getRegex(),Qn=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Nn={_backpedal:Qa,anyPunctuation:Jo,autolink:Vo,blockSkip:Uo,br:al,code:Io,del:Qa,emStrongLDelim:Yo,emStrongRDelimAst:Xo,emStrongRDelimUnd:Zo,escape:Lo,link:ec,nolink:ol,punctuation:Fo,reflink:il,reflinkSearch:tc,tag:Ko,text:$o,url:Qa},ac={...Nn,link:Le(/^!?\[(label)\]\((.*?)\)/).replace("label",js).getRegex(),reflink:Le(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",js).getRegex()},ln={...Nn,emStrongRDelimAst:Wo,emStrongLDelim:Ho,url:Le(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Qn).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Le(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Qn).getRegex()},sc={...ln,br:Le(al).replace("{2,}","*").getRegex(),text:Le(ln.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ws={normal:Rn,gfm:No,pedantic:Oo},Ga={normal:Nn,gfm:ln,breaks:sc,pedantic:ac},nc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Kn=t=>nc[t];function Jt(t,e){if(e){if(gt.escapeTest.test(t))return t.replace(gt.escapeReplace,Kn)}else if(gt.escapeTestNoEncode.test(t))return t.replace(gt.escapeReplaceNoEncode,Kn);return t}function er(t){try{t=encodeURI(t).replace(gt.percentDecode,"%")}catch{return null}return t}function tr(t,e){let a=t.replace(gt.findPipe,(l,i,u)=>{let v=!1,d=i;for(;--d>=0&&u[d]==="\\";)v=!v;return v?"|":" |"}),r=a.split(gt.splitPipe),n=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;n<r.length;n++)r[n]=r[n].trim().replace(gt.slashPipe,"|");return r}function Ua(t,e,a){let r=t.length;if(r===0)return"";let n=0;for(;n<r&&t.charAt(r-n-1)===e;)n++;return t.slice(0,r-n)}function rc(t,e){if(t.indexOf(e[1])===-1)return-1;let a=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===e[0])a++;else if(t[r]===e[1]&&(a--,a<0))return r;return a>0?-2:-1}function ar(t,e,a,r,n){let l=e.href,i=e.title||null,u=t[1].replace(n.other.outputLinkReplace,"$1");r.state.inLink=!0;let v={type:t[0].charAt(0)==="!"?"image":"link",raw:a,href:l,title:i,text:u,tokens:r.inlineTokens(u)};return r.state.inLink=!1,v}function lc(t,e,a){let r=t.match(a.other.indentCodeCompensation);if(r===null)return e;let n=r[1];return e.split(`
`).map(l=>{let i=l.match(a.other.beginningSpace);if(i===null)return l;let[u]=i;return u.length>=n.length?l.slice(n.length):l}).join(`
`)}var As=class{options;rules;lexer;constructor(t){this.options=t||Aa}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let a=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?a:Ua(a,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let a=e[0],r=lc(a,e[3]||"",this.rules);return{type:"code",raw:a,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let a=e[2].trim();if(this.rules.other.endingHash.test(a)){let r=Ua(a,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(a=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:a,tokens:this.lexer.inline(a)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Ua(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let a=Ua(e[0],`
`).split(`
`),r="",n="",l=[];for(;a.length>0;){let i=!1,u=[],v;for(v=0;v<a.length;v++)if(this.rules.other.blockquoteStart.test(a[v]))u.push(a[v]),i=!0;else if(!i)u.push(a[v]);else break;a=a.slice(v);let d=u.join(`
`),p=d.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${d}`:d,n=n?`${n}
${p}`:p;let m=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(p,l,!0),this.lexer.state.top=m,a.length===0)break;let h=l.at(-1);if(h?.type==="code")break;if(h?.type==="blockquote"){let _=h,x=_.raw+`
`+a.join(`
`),k=this.blockquote(x);l[l.length-1]=k,r=r.substring(0,r.length-_.raw.length)+k.raw,n=n.substring(0,n.length-_.text.length)+k.text;break}else if(h?.type==="list"){let _=h,x=_.raw+`
`+a.join(`
`),k=this.list(x);l[l.length-1]=k,r=r.substring(0,r.length-h.raw.length)+k.raw,n=n.substring(0,n.length-_.raw.length)+k.raw,a=x.substring(l.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:l,text:n}}}list(t){let e=this.rules.block.list.exec(t);if(e){let a=e[1].trim(),r=a.length>1,n={type:"list",raw:"",ordered:r,start:r?+a.slice(0,-1):"",loose:!1,items:[]};a=r?`\\d{1,9}\\${a.slice(-1)}`:`\\${a}`,this.options.pedantic&&(a=r?a:"[*+-]");let l=this.rules.other.listItemRegex(a),i=!1;for(;t;){let v=!1,d="",p="";if(!(e=l.exec(t))||this.rules.block.hr.test(t))break;d=e[0],t=t.substring(d.length);let m=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,k=>" ".repeat(3*k.length)),h=t.split(`
`,1)[0],_=!m.trim(),x=0;if(this.options.pedantic?(x=2,p=m.trimStart()):_?x=e[1].length+1:(x=e[2].search(this.rules.other.nonSpaceChar),x=x>4?1:x,p=m.slice(x),x+=e[1].length),_&&this.rules.other.blankLine.test(h)&&(d+=h+`
`,t=t.substring(h.length+1),v=!0),!v){let k=this.rules.other.nextBulletRegex(x),g=this.rules.other.hrRegex(x),S=this.rules.other.fencesBeginRegex(x),D=this.rules.other.headingBeginRegex(x),y=this.rules.other.htmlBeginRegex(x);for(;t;){let j=t.split(`
`,1)[0],z;if(h=j,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),z=h):z=h.replace(this.rules.other.tabCharGlobal,"    "),S.test(h)||D.test(h)||y.test(h)||k.test(h)||g.test(h))break;if(z.search(this.rules.other.nonSpaceChar)>=x||!h.trim())p+=`
`+z.slice(x);else{if(_||m.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(m)||D.test(m)||g.test(m))break;p+=`
`+h}!_&&!h.trim()&&(_=!0),d+=j+`
`,t=t.substring(j.length+1),m=z.slice(x)}}n.loose||(i?n.loose=!0:this.rules.other.doubleBlankLine.test(d)&&(i=!0)),n.items.push({type:"list_item",raw:d,task:!!this.options.gfm&&this.rules.other.listIsTask.test(p),loose:!1,text:p,tokens:[]}),n.raw+=d}let u=n.items.at(-1);if(u)u.raw=u.raw.trimEnd(),u.text=u.text.trimEnd();else return;n.raw=n.raw.trimEnd();for(let v of n.items){if(this.lexer.state.top=!1,v.tokens=this.lexer.blockTokens(v.text,[]),v.task){if(v.text=v.text.replace(this.rules.other.listReplaceTask,""),v.tokens[0]?.type==="text"||v.tokens[0]?.type==="paragraph"){v.tokens[0].raw=v.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),v.tokens[0].text=v.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let p=this.lexer.inlineQueue.length-1;p>=0;p--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[p].src)){this.lexer.inlineQueue[p].src=this.lexer.inlineQueue[p].src.replace(this.rules.other.listReplaceTask,"");break}}let d=this.rules.other.listTaskCheckbox.exec(v.raw);if(d){let p={type:"checkbox",raw:d[0]+" ",checked:d[0]!=="[ ]"};v.checked=p.checked,n.loose?v.tokens[0]&&["paragraph","text"].includes(v.tokens[0].type)&&"tokens"in v.tokens[0]&&v.tokens[0].tokens?(v.tokens[0].raw=p.raw+v.tokens[0].raw,v.tokens[0].text=p.raw+v.tokens[0].text,v.tokens[0].tokens.unshift(p)):v.tokens.unshift({type:"paragraph",raw:p.raw,text:p.raw,tokens:[p]}):v.tokens.unshift(p)}}if(!n.loose){let d=v.tokens.filter(m=>m.type==="space"),p=d.length>0&&d.some(m=>this.rules.other.anyLine.test(m.raw));n.loose=p}}if(n.loose)for(let v of n.items){v.loose=!0;for(let d of v.tokens)d.type==="text"&&(d.type="paragraph")}return n}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let a=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",n=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:a,raw:e[0],href:r,title:n}}}table(t){let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let a=tr(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),n=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],l={type:"table",raw:e[0],header:[],align:[],rows:[]};if(a.length===r.length){for(let i of r)this.rules.other.tableAlignRight.test(i)?l.align.push("right"):this.rules.other.tableAlignCenter.test(i)?l.align.push("center"):this.rules.other.tableAlignLeft.test(i)?l.align.push("left"):l.align.push(null);for(let i=0;i<a.length;i++)l.header.push({text:a[i],tokens:this.lexer.inline(a[i]),header:!0,align:l.align[i]});for(let i of n)l.rows.push(tr(i,l.header.length).map((u,v)=>({text:u,tokens:this.lexer.inline(u),header:!1,align:l.align[v]})));return l}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let a=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:a,tokens:this.lexer.inline(a)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let a=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(a)){if(!this.rules.other.endAngleBracket.test(a))return;let l=Ua(a.slice(0,-1),"\\");if((a.length-l.length)%2===0)return}else{let l=rc(e[2],"()");if(l===-2)return;if(l>-1){let i=(e[0].indexOf("!")===0?5:4)+e[1].length+l;e[2]=e[2].substring(0,l),e[0]=e[0].substring(0,i).trim(),e[3]=""}}let r=e[2],n="";if(this.options.pedantic){let l=this.rules.other.pedanticHrefTitle.exec(r);l&&(r=l[1],n=l[3])}else n=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(a)?r=r.slice(1):r=r.slice(1,-1)),ar(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:n&&n.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let a;if((a=this.rules.inline.reflink.exec(t))||(a=this.rules.inline.nolink.exec(t))){let r=(a[2]||a[1]).replace(this.rules.other.multipleSpaceGlobal," "),n=e[r.toLowerCase()];if(!n){let l=a[0].charAt(0);return{type:"text",raw:l,text:l}}return ar(a,n,a[0],this.lexer,this.rules)}}emStrong(t,e,a=""){let r=this.rules.inline.emStrongLDelim.exec(t);if(!(!r||r[3]&&a.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!a||this.rules.inline.punctuation.exec(a))){let n=[...r[0]].length-1,l,i,u=n,v=0,d=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,e=e.slice(-1*t.length+n);(r=d.exec(e))!=null;){if(l=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!l)continue;if(i=[...l].length,r[3]||r[4]){u+=i;continue}else if((r[5]||r[6])&&n%3&&!((n+i)%3)){v+=i;continue}if(u-=i,u>0)continue;i=Math.min(i,i+u+v);let p=[...r[0]][0].length,m=t.slice(0,n+r.index+p+i);if(Math.min(n,i)%2){let _=m.slice(1,-1);return{type:"em",raw:m,text:_,tokens:this.lexer.inlineTokens(_)}}let h=m.slice(2,-2);return{type:"strong",raw:m,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let a=e[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(a),n=this.rules.other.startingSpaceChar.test(a)&&this.rules.other.endingSpaceChar.test(a);return r&&n&&(a=a.substring(1,a.length-1)),{type:"codespan",raw:e[0],text:a}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){let e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let a,r;return e[2]==="@"?(a=e[1],r="mailto:"+a):(a=e[1],r=a),{type:"link",raw:e[0],text:a,href:r,tokens:[{type:"text",raw:a,text:a}]}}}url(t){let e;if(e=this.rules.inline.url.exec(t)){let a,r;if(e[2]==="@")a=e[0],r="mailto:"+a;else{let n;do n=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(n!==e[0]);a=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:a,href:r,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let a=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:a}}}},Ot=class on{tokens;options;state;inlineQueue;tokenizer;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Aa,this.options.tokenizer=this.options.tokenizer||new As,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let a={other:gt,block:ws.normal,inline:Ga.normal};this.options.pedantic?(a.block=ws.pedantic,a.inline=Ga.pedantic):this.options.gfm&&(a.block=ws.gfm,this.options.breaks?a.inline=Ga.breaks:a.inline=Ga.gfm),this.tokenizer.rules=a}static get rules(){return{block:ws,inline:Ga}}static lex(e,a){return new on(a).lex(e)}static lexInline(e,a){return new on(a).inlineTokens(e)}lex(e){e=e.replace(gt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let a=0;a<this.inlineQueue.length;a++){let r=this.inlineQueue[a];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,a=[],r=!1){for(this.options.pedantic&&(e=e.replace(gt.tabCharGlobal,"    ").replace(gt.spaceLine,""));e;){let n;if(this.options.extensions?.block?.some(i=>(n=i.call({lexer:this},e,a))?(e=e.substring(n.raw.length),a.push(n),!0):!1))continue;if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length);let i=a.at(-1);n.raw.length===1&&i!==void 0?i.raw+=`
`:a.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length);let i=a.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+n.raw,i.text+=`
`+n.text,this.inlineQueue.at(-1).src=i.text):a.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),a.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),a.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),a.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),a.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),a.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),a.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length);let i=a.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+n.raw,i.text+=`
`+n.raw,this.inlineQueue.at(-1).src=i.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title},a.push(n));continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),a.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),a.push(n);continue}let l=e;if(this.options.extensions?.startBlock){let i=1/0,u=e.slice(1),v;this.options.extensions.startBlock.forEach(d=>{v=d.call({lexer:this},u),typeof v=="number"&&v>=0&&(i=Math.min(i,v))}),i<1/0&&i>=0&&(l=e.substring(0,i+1))}if(this.state.top&&(n=this.tokenizer.paragraph(l))){let i=a.at(-1);r&&i?.type==="paragraph"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+n.raw,i.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):a.push(n),r=l.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length);let i=a.at(-1);i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+n.raw,i.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):a.push(n);continue}if(e){let i="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(i);break}else throw new Error(i)}}return this.state.top=!0,a}inline(e,a=[]){return this.inlineQueue.push({src:e,tokens:a}),a}inlineTokens(e,a=[]){let r=e,n=null;if(this.tokens.links){let v=Object.keys(this.tokens.links);if(v.length>0)for(;(n=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)v.includes(n[0].slice(n[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(n=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,n.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let l;for(;(n=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)l=n[2]?n[2].length:0,r=r.slice(0,n.index+l)+"["+"a".repeat(n[0].length-l-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=this.options.hooks?.emStrongMask?.call({lexer:this},r)??r;let i=!1,u="";for(;e;){i||(u=""),i=!1;let v;if(this.options.extensions?.inline?.some(p=>(v=p.call({lexer:this},e,a))?(e=e.substring(v.raw.length),a.push(v),!0):!1))continue;if(v=this.tokenizer.escape(e)){e=e.substring(v.raw.length),a.push(v);continue}if(v=this.tokenizer.tag(e)){e=e.substring(v.raw.length),a.push(v);continue}if(v=this.tokenizer.link(e)){e=e.substring(v.raw.length),a.push(v);continue}if(v=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(v.raw.length);let p=a.at(-1);v.type==="text"&&p?.type==="text"?(p.raw+=v.raw,p.text+=v.text):a.push(v);continue}if(v=this.tokenizer.emStrong(e,r,u)){e=e.substring(v.raw.length),a.push(v);continue}if(v=this.tokenizer.codespan(e)){e=e.substring(v.raw.length),a.push(v);continue}if(v=this.tokenizer.br(e)){e=e.substring(v.raw.length),a.push(v);continue}if(v=this.tokenizer.del(e)){e=e.substring(v.raw.length),a.push(v);continue}if(v=this.tokenizer.autolink(e)){e=e.substring(v.raw.length),a.push(v);continue}if(!this.state.inLink&&(v=this.tokenizer.url(e))){e=e.substring(v.raw.length),a.push(v);continue}let d=e;if(this.options.extensions?.startInline){let p=1/0,m=e.slice(1),h;this.options.extensions.startInline.forEach(_=>{h=_.call({lexer:this},m),typeof h=="number"&&h>=0&&(p=Math.min(p,h))}),p<1/0&&p>=0&&(d=e.substring(0,p+1))}if(v=this.tokenizer.inlineText(d)){e=e.substring(v.raw.length),v.raw.slice(-1)!=="_"&&(u=v.raw.slice(-1)),i=!0;let p=a.at(-1);p?.type==="text"?(p.raw+=v.raw,p.text+=v.text):a.push(v);continue}if(e){let p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return a}},Ps=class{options;parser;constructor(t){this.options=t||Aa}space(t){return""}code({text:t,lang:e,escaped:a}){let r=(e||"").match(gt.notSpaceStart)?.[0],n=t.replace(gt.endingNewline,"")+`
`;return r?'<pre><code class="language-'+Jt(r)+'">'+(a?n:Jt(n,!0))+`</code></pre>
`:"<pre><code>"+(a?n:Jt(n,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,a=t.start,r="";for(let i=0;i<t.items.length;i++){let u=t.items[i];r+=this.listitem(u)}let n=e?"ol":"ul",l=e&&a!==1?' start="'+a+'"':"";return"<"+n+l+`>
`+r+"</"+n+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",a="";for(let n=0;n<t.header.length;n++)a+=this.tablecell(t.header[n]);e+=this.tablerow({text:a});let r="";for(let n=0;n<t.rows.length;n++){let l=t.rows[n];a="";for(let i=0;i<l.length;i++)a+=this.tablecell(l[i]);r+=this.tablerow({text:a})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),a=t.header?"th":"td";return(t.align?`<${a} align="${t.align}">`:`<${a}>`)+e+`</${a}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${Jt(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:a}){let r=this.parser.parseInline(a),n=er(t);if(n===null)return r;t=n;let l='<a href="'+t+'"';return e&&(l+=' title="'+Jt(e)+'"'),l+=">"+r+"</a>",l}image({href:t,title:e,text:a,tokens:r}){r&&(a=this.parser.parseInline(r,this.parser.textRenderer));let n=er(t);if(n===null)return Jt(a);t=n;let l=`<img src="${t}" alt="${a}"`;return e&&(l+=` title="${Jt(e)}"`),l+=">",l}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:Jt(t.text)}},On=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},Lt=class cn{options;renderer;textRenderer;constructor(e){this.options=e||Aa,this.options.renderer=this.options.renderer||new Ps,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new On}static parse(e,a){return new cn(a).parse(e)}static parseInline(e,a){return new cn(a).parseInline(e)}parse(e){let a="";for(let r=0;r<e.length;r++){let n=e[r];if(this.options.extensions?.renderers?.[n.type]){let i=n,u=this.options.extensions.renderers[i.type].call({parser:this},i);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(i.type)){a+=u||"";continue}}let l=n;switch(l.type){case"space":{a+=this.renderer.space(l);break}case"hr":{a+=this.renderer.hr(l);break}case"heading":{a+=this.renderer.heading(l);break}case"code":{a+=this.renderer.code(l);break}case"table":{a+=this.renderer.table(l);break}case"blockquote":{a+=this.renderer.blockquote(l);break}case"list":{a+=this.renderer.list(l);break}case"checkbox":{a+=this.renderer.checkbox(l);break}case"html":{a+=this.renderer.html(l);break}case"def":{a+=this.renderer.def(l);break}case"paragraph":{a+=this.renderer.paragraph(l);break}case"text":{a+=this.renderer.text(l);break}default:{let i='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return a}parseInline(e,a=this.renderer){let r="";for(let n=0;n<e.length;n++){let l=e[n];if(this.options.extensions?.renderers?.[l.type]){let u=this.options.extensions.renderers[l.type].call({parser:this},l);if(u!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(l.type)){r+=u||"";continue}}let i=l;switch(i.type){case"escape":{r+=a.text(i);break}case"html":{r+=a.html(i);break}case"link":{r+=a.link(i);break}case"image":{r+=a.image(i);break}case"checkbox":{r+=a.checkbox(i);break}case"strong":{r+=a.strong(i);break}case"em":{r+=a.em(i);break}case"codespan":{r+=a.codespan(i);break}case"br":{r+=a.br(i);break}case"del":{r+=a.del(i);break}case"text":{r+=a.text(i);break}default:{let u='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return r}},Wa=class{options;block;constructor(t){this.options=t||Aa}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?Ot.lex:Ot.lexInline}provideParser(){return this.block?Lt.parse:Lt.parseInline}},ic=class{defaults=An();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Lt;Renderer=Ps;TextRenderer=On;Lexer=Ot;Tokenizer=As;Hooks=Wa;constructor(...t){this.use(...t)}walkTokens(t,e){let a=[];for(let r of t)switch(a=a.concat(e.call(this,r)),r.type){case"table":{let n=r;for(let l of n.header)a=a.concat(this.walkTokens(l.tokens,e));for(let l of n.rows)for(let i of l)a=a.concat(this.walkTokens(i.tokens,e));break}case"list":{let n=r;a=a.concat(this.walkTokens(n.items,e));break}default:{let n=r;this.defaults.extensions?.childTokens?.[n.type]?this.defaults.extensions.childTokens[n.type].forEach(l=>{let i=n[l].flat(1/0);a=a.concat(this.walkTokens(i,e))}):n.tokens&&(a=a.concat(this.walkTokens(n.tokens,e)))}}return a}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(a=>{let r={...a};if(r.async=this.defaults.async||r.async||!1,a.extensions&&(a.extensions.forEach(n=>{if(!n.name)throw new Error("extension name required");if("renderer"in n){let l=e.renderers[n.name];l?e.renderers[n.name]=function(...i){let u=n.renderer.apply(this,i);return u===!1&&(u=l.apply(this,i)),u}:e.renderers[n.name]=n.renderer}if("tokenizer"in n){if(!n.level||n.level!=="block"&&n.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let l=e[n.level];l?l.unshift(n.tokenizer):e[n.level]=[n.tokenizer],n.start&&(n.level==="block"?e.startBlock?e.startBlock.push(n.start):e.startBlock=[n.start]:n.level==="inline"&&(e.startInline?e.startInline.push(n.start):e.startInline=[n.start]))}"childTokens"in n&&n.childTokens&&(e.childTokens[n.name]=n.childTokens)}),r.extensions=e),a.renderer){let n=this.defaults.renderer||new Ps(this.defaults);for(let l in a.renderer){if(!(l in n))throw new Error(`renderer '${l}' does not exist`);if(["options","parser"].includes(l))continue;let i=l,u=a.renderer[i],v=n[i];n[i]=(...d)=>{let p=u.apply(n,d);return p===!1&&(p=v.apply(n,d)),p||""}}r.renderer=n}if(a.tokenizer){let n=this.defaults.tokenizer||new As(this.defaults);for(let l in a.tokenizer){if(!(l in n))throw new Error(`tokenizer '${l}' does not exist`);if(["options","rules","lexer"].includes(l))continue;let i=l,u=a.tokenizer[i],v=n[i];n[i]=(...d)=>{let p=u.apply(n,d);return p===!1&&(p=v.apply(n,d)),p}}r.tokenizer=n}if(a.hooks){let n=this.defaults.hooks||new Wa;for(let l in a.hooks){if(!(l in n))throw new Error(`hook '${l}' does not exist`);if(["options","block"].includes(l))continue;let i=l,u=a.hooks[i],v=n[i];Wa.passThroughHooks.has(l)?n[i]=d=>{if(this.defaults.async&&Wa.passThroughHooksRespectAsync.has(l))return(async()=>{let m=await u.call(n,d);return v.call(n,m)})();let p=u.call(n,d);return v.call(n,p)}:n[i]=(...d)=>{if(this.defaults.async)return(async()=>{let m=await u.apply(n,d);return m===!1&&(m=await v.apply(n,d)),m})();let p=u.apply(n,d);return p===!1&&(p=v.apply(n,d)),p}}r.hooks=n}if(a.walkTokens){let n=this.defaults.walkTokens,l=a.walkTokens;r.walkTokens=function(i){let u=[];return u.push(l.call(this,i)),n&&(u=u.concat(n.call(this,i))),u}}this.defaults={...this.defaults,...r}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Ot.lex(t,e??this.defaults)}parser(t,e){return Lt.parse(t,e??this.defaults)}parseMarkdown(t){return(e,a)=>{let r={...a},n={...this.defaults,...r},l=this.onError(!!n.silent,!!n.async);if(this.defaults.async===!0&&r.async===!1)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(n.hooks&&(n.hooks.options=n,n.hooks.block=t),n.async)return(async()=>{let i=n.hooks?await n.hooks.preprocess(e):e,u=await(n.hooks?await n.hooks.provideLexer():t?Ot.lex:Ot.lexInline)(i,n),v=n.hooks?await n.hooks.processAllTokens(u):u;n.walkTokens&&await Promise.all(this.walkTokens(v,n.walkTokens));let d=await(n.hooks?await n.hooks.provideParser():t?Lt.parse:Lt.parseInline)(v,n);return n.hooks?await n.hooks.postprocess(d):d})().catch(l);try{n.hooks&&(e=n.hooks.preprocess(e));let i=(n.hooks?n.hooks.provideLexer():t?Ot.lex:Ot.lexInline)(e,n);n.hooks&&(i=n.hooks.processAllTokens(i)),n.walkTokens&&this.walkTokens(i,n.walkTokens);let u=(n.hooks?n.hooks.provideParser():t?Lt.parse:Lt.parseInline)(i,n);return n.hooks&&(u=n.hooks.postprocess(u)),u}catch(i){return l(i)}}}onError(t,e){return a=>{if(a.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let r="<p>An error occurred:</p><pre>"+Jt(a.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(a);throw a}}},qa=new ic;function Ge(t,e){return qa.parse(t,e)}Ge.options=Ge.setOptions=function(t){return qa.setOptions(t),Ge.defaults=qa.defaults,Qr(Ge.defaults),Ge};Ge.getDefaults=An;Ge.defaults=Aa;Ge.use=function(...t){return qa.use(...t),Ge.defaults=qa.defaults,Qr(Ge.defaults),Ge};Ge.walkTokens=function(t,e){return qa.walkTokens(t,e)};Ge.parseInline=qa.parseInline;Ge.Parser=Lt;Ge.parser=Lt.parse;Ge.Renderer=Ps;Ge.TextRenderer=On;Ge.Lexer=Ot;Ge.lexer=Ot.lex;Ge.Tokenizer=As;Ge.Hooks=Wa;Ge.parse=Ge;Ge.options;Ge.setOptions;Ge.use;Ge.walkTokens;Ge.parseInline;Lt.parse;Ot.lex;var oc=w('<span class="author"> </span>'),cc=w('<span class="date"> </span>'),vc=w('<span class="tag-badge svelte-187zyvb"> </span>'),uc=w('<div class="tags-row svelte-187zyvb"></div>'),dc=w('<img class="svelte-187zyvb"/>'),fc=w('<div class="attachment-card svelte-187zyvb"><!> <a target="_blank" rel="noreferrer" class="svelte-187zyvb"> </a></div>'),pc=w('<div class="attachments svelte-187zyvb"><h3 class="svelte-187zyvb">Attachments</h3> <div class="grid svelte-187zyvb"></div></div>'),hc=w('<a target="_blank" rel="noreferrer" class="note-attachment-link svelte-187zyvb"> </a>'),_c=w('<div class="note-attachments svelte-187zyvb"><strong class="svelte-187zyvb">Attachments:</strong> <!></div>'),gc=w('<div class="note-card svelte-187zyvb"><div class="note-header svelte-187zyvb"><span> </span> <span class="note-author svelte-187zyvb"> </span> <span class="note-date svelte-187zyvb"> </span> <span> </span></div> <p class="note-text svelte-187zyvb"> </p> <!></div>'),mc=w('<div class="notes-section svelte-187zyvb"><h3 class="svelte-187zyvb">Notes</h3> <div class="notes-list svelte-187zyvb"></div></div>'),bc=w('<div class="document-view"><h2 class="svelte-187zyvb"> </h2> <div class="meta svelte-187zyvb"><span> </span> <span> </span> <span class="date"> </span> <!> <!></div> <!> <div class="content markdown-body svelte-187zyvb"><!></div> <!> <!></div>');function yc(t,e){He(e,!0);let a=st(()=>e.document&&e.document.content?Ge.parse(e.document.content):"<p>No content available.</p>");var r=bc(),n=o(r),l=o(n),i=c(n,2),u=o(i),v=o(u),d=c(u,2),p=o(d),m=c(d,2),h=o(m),_=c(m,2);{var x=U=>{var W=oc(),K=o(W);G(()=>T(K,`By ${e.document.author??""}`)),b(U,W)};L(_,U=>{e.document?.author&&U(x)})}var k=c(_,2);{var g=U=>{var W=cc(),K=o(W);G(()=>T(K,`Done: ${e.document.done_date??""}`)),b(U,W)};L(k,U=>{e.document?.done_date&&U(g)})}var S=c(i,2);{var D=U=>{var W=uc();Ae(W,21,()=>e.document.tags,Be,(K,O)=>{var B=vc(),ce=o(B);G(()=>T(ce,`#${s(O).name??""}`)),b(K,B)}),b(U,W)};L(S,U=>{e.document?.tags?.length>0&&U(D)})}var y=c(S,2),j=o(y);Pi(j,()=>s(a));var z=c(y,2);{var R=U=>{var W=pc(),K=c(o(W),2);Ae(K,21,()=>e.document.attachments,Be,(O,B)=>{var ce=fc(),le=o(ce);{var me=be=>{var pe=dc();G(()=>{Ue(pe,"src",s(B).file_path),Ue(pe,"alt",s(B).filename)}),b(be,pe)};L(le,be=>{s(B).media_type&&s(B).media_type.startsWith("image/")&&be(me)})}var _e=c(le,2),ge=o(_e);G(()=>{Ue(_e,"href",s(B).file_path),T(ge,s(B).filename)}),b(O,ce)}),b(U,W)};L(z,U=>{e.document?.attachments?.length>0&&U(R)})}var X=c(z,2);{var I=U=>{var W=mc(),K=c(o(W),2);Ae(K,21,()=>e.document.journal_entries,Be,(O,B)=>{var ce=gc(),le=o(ce),me=o(le),_e=o(me),ge=c(me,2),be=o(ge),pe=c(ge,2),V=o(pe),se=c(pe,2),P=o(se),E=c(le,2),$=o(E),ne=c(E,2);{var Q=ye=>{var Y=_c(),H=c(o(Y),2);Ae(H,17,()=>s(B).attachments,Be,(ee,te)=>{var C=hc(),de=o(C);G(()=>{Ue(C,"href",s(te).file_path),T(de,`üìé ${s(te).filename??""}`)}),b(ee,C)}),b(ye,Y)};L(ne,ye=>{s(B).attachments?.length>0&&ye(Q)})}G(()=>{Oe(me,1,`note-badge ${s(B).type??""}`,"svelte-187zyvb"),T(_e,s(B).type),T(be,s(B).author||"Unknown"),T(V,s(B).created_at),Oe(se,1,`note-status ${s(B).status??""}`,"svelte-187zyvb"),T(P,s(B).status),T($,s(B).text)}),b(O,ce)}),b(U,W)};L(X,U=>{e.document?.journal_entries?.length>0&&U(I)})}G(U=>{T(l,e.document?.name),Oe(u,1,`badge ${e.document?.type??""}`,"svelte-187zyvb"),T(v,e.document?.type),Oe(d,1,`badge status-${e.document?.status??""}`,"svelte-187zyvb"),T(p,U),T(h,e.document?.registration_date)},[()=>e.document?.status.replace("_"," ")]),b(t,r),Xe()}var wc=w('<input type="text" class="edit-input svelte-1b0y5ne"/>'),kc=w('<button class="btn-icon svelte-1b0y5ne" title="Save">‚úì</button> <button class="btn-icon svelte-1b0y5ne" title="Cancel">‚úï</button>',1),xc=w('<button class="btn-icon svelte-1b0y5ne" title="Edit">‚úèÔ∏è</button> <button class="btn-icon delete svelte-1b0y5ne" title="Delete">üóëÔ∏è</button>',1),Sc=w('<tr class="svelte-1b0y5ne"><td class="svelte-1b0y5ne"><!></td><td class="svelte-1b0y5ne"><!></td></tr>'),Tc=w('<div class="empty-state svelte-1b0y5ne">No materials yet. Add one above.</div>'),qc=w('<div class="modal-overlay svelte-1b0y5ne"><div class="modal-content svelte-1b0y5ne"><div class="modal-header svelte-1b0y5ne"><h3 class="svelte-1b0y5ne">Material Library</h3> <button class="close-btn svelte-1b0y5ne">&times;</button></div> <div class="modal-body svelte-1b0y5ne"><div class="add-section svelte-1b0y5ne"><input type="text" placeholder="New material name..." class="svelte-1b0y5ne"/> <button class="btn-add svelte-1b0y5ne">Add</button></div> <table class="materials-table svelte-1b0y5ne"><thead><tr><th class="svelte-1b0y5ne">Name</th><th class="svelte-1b0y5ne">Actions</th></tr></thead><tbody></tbody></table> <!></div></div></div>');function Ec(t,e){He(e,!0);let a=q(qe([])),r=q(""),n=q(null),l=q("");async function i(){e.isOpen&&f(a,await ja(),!0)}bt(()=>{i()});async function u(){if(s(r).trim())try{await so({name:s(r).trim()}),f(r,""),await i()}catch(k){console.error(k),alert("Failed to add material")}}function v(k){f(n,k.id,!0),f(l,k.name,!0)}async function d(){if(!(!s(l).trim()||s(n)===null))try{await no(s(n),s(l).trim()),f(n,null),f(l,""),await i()}catch(k){console.error(k),alert("Failed to update material")}}function p(){f(n,null),f(l,"")}async function m(k){if(confirm("Delete this material?"))try{await ro(k),await i()}catch(g){console.error(g),alert("Failed to delete material")}}var h=et(),_=Ee(h);{var x=k=>{var g=qc();g.__click=function(...O){e.close?.apply(this,O)};var S=o(g);S.__click=O=>O.stopPropagation();var D=o(S),y=c(o(D),2);y.__click=function(...O){e.close?.apply(this,O)};var j=c(D,2),z=o(j),R=o(z);R.__keydown=O=>O.key==="Enter"&&u();var X=c(R,2);X.__click=u;var I=c(z,2),U=c(o(I));Ae(U,21,()=>s(a),O=>O.id,(O,B)=>{var ce=Sc(),le=o(ce),me=o(le);{var _e=P=>{var E=wc();mn(E),E.__keydown=$=>{$.key==="Enter"&&d(),$.key==="Escape"&&p()},je(E,()=>s(l),$=>f(l,$)),b(P,E)},ge=P=>{var E=Wr();G(()=>T(E,s(B).name)),b(P,E)};L(me,P=>{s(n)===s(B).id?P(_e):P(ge,!1)})}var be=c(le),pe=o(be);{var V=P=>{var E=kc(),$=Ee(E);$.__click=d;var ne=c($,2);ne.__click=p,b(P,E)},se=P=>{var E=xc(),$=Ee(E);$.__click=()=>v(s(B));var ne=c($,2);ne.__click=()=>m(s(B).id),b(P,E)};L(pe,P=>{s(n)===s(B).id?P(V):P(se,!1)})}b(O,ce)});var W=c(I,2);{var K=O=>{var B=Tc();b(O,B)};L(W,O=>{s(a).length===0&&O(K)})}je(R,()=>s(r),O=>f(r,O)),b(k,g)};L(_,k=>{e.isOpen&&k(x)})}b(t,h),Xe()}Je(["click","keydown"]);var jc=w('<input type="text" class="edit-input svelte-1w6q42o"/>'),Ac=w('<button class="btn-icon svelte-1w6q42o" title="Save">‚úì</button> <button class="btn-icon svelte-1w6q42o" title="Cancel">‚úï</button>',1),Pc=w('<button class="btn-icon svelte-1w6q42o" title="Edit">‚úèÔ∏è</button> <button class="btn-icon delete svelte-1w6q42o" title="Delete">üóëÔ∏è</button>',1),Cc=w('<tr class="svelte-1w6q42o"><td class="svelte-1w6q42o"><!></td><td class="svelte-1w6q42o"><!></td></tr>'),zc=w('<div class="empty-state svelte-1w6q42o">No assignees yet. Add one above.</div>'),Dc=w('<div class="modal-overlay svelte-1w6q42o"><div class="modal-content svelte-1w6q42o"><div class="modal-header svelte-1w6q42o"><h3 class="svelte-1w6q42o">Assignee Library</h3> <button class="close-btn svelte-1w6q42o">&times;</button></div> <div class="modal-body svelte-1w6q42o"><div class="add-section svelte-1w6q42o"><input type="text" placeholder="New assignee name..." class="svelte-1w6q42o"/> <button class="btn-add svelte-1w6q42o">Add</button></div> <table class="assignees-table svelte-1w6q42o"><thead><tr><th class="svelte-1w6q42o">Name</th><th class="svelte-1w6q42o">Actions</th></tr></thead><tbody></tbody></table> <!></div></div></div>');function cl(t,e){He(e,!0);let a=q(qe([])),r=q(""),n=q(null),l=q("");async function i(){e.isOpen&&f(a,await as(),!0)}bt(()=>{i()});async function u(){if(s(r).trim())try{await ho({name:s(r).trim()}),f(r,""),await i()}catch(k){console.error(k),alert("Failed to add assignee")}}function v(k){f(n,k.id,!0),f(l,k.name,!0)}async function d(){if(!(!s(l).trim()||s(n)===null))try{await _o(s(n),s(l).trim()),f(n,null),f(l,""),await i()}catch(k){console.error(k),alert("Failed to update assignee")}}function p(){f(n,null),f(l,"")}async function m(k){if(confirm("Delete this assignee?"))try{await go(k),await i()}catch(g){console.error(g),alert("Failed to delete assignee")}}var h=et(),_=Ee(h);{var x=k=>{var g=Dc();g.__click=function(...O){e.close?.apply(this,O)};var S=o(g);S.__click=O=>O.stopPropagation();var D=o(S),y=c(o(D),2);y.__click=function(...O){e.close?.apply(this,O)};var j=c(D,2),z=o(j),R=o(z);R.__keydown=O=>O.key==="Enter"&&u();var X=c(R,2);X.__click=u;var I=c(z,2),U=c(o(I));Ae(U,21,()=>s(a),O=>O.id,(O,B)=>{var ce=Cc(),le=o(ce),me=o(le);{var _e=P=>{var E=jc();mn(E),E.__keydown=$=>{$.key==="Enter"&&d(),$.key==="Escape"&&p()},je(E,()=>s(l),$=>f(l,$)),b(P,E)},ge=P=>{var E=Wr();G(()=>T(E,s(B).name)),b(P,E)};L(me,P=>{s(n)===s(B).id?P(_e):P(ge,!1)})}var be=c(le),pe=o(be);{var V=P=>{var E=Ac(),$=Ee(E);$.__click=d;var ne=c($,2);ne.__click=p,b(P,E)},se=P=>{var E=Pc(),$=Ee(E);$.__click=()=>v(s(B));var ne=c($,2);ne.__click=()=>m(s(B).id),b(P,E)};L(pe,P=>{s(n)===s(B).id?P(V):P(se,!1)})}b(O,ce)});var W=c(I,2);{var K=O=>{var B=zc();b(O,B)};L(W,O=>{s(a).length===0&&O(K)})}je(R,()=>s(r),O=>f(r,O)),b(k,g)};L(_,k=>{e.isOpen&&k(x)})}b(t,h),Xe()}Je(["click","keydown"]);var Rc=w("<option> </option>"),Mc=w("<option> </option>"),Nc=w('<div class="modal-overlay svelte-1iwbfq1"><div class="modal-content svelte-1iwbfq1"><div class="modal-header svelte-1iwbfq1"><h3 class="svelte-1iwbfq1"> </h3> <button class="close-btn svelte-1iwbfq1">&times;</button></div> <form class="modal-body svelte-1iwbfq1"><div class="form-group svelte-1iwbfq1"><label for="name" class="svelte-1iwbfq1">Task Name</label> <input id="name" type="text" placeholder="Enter task name..." required class="svelte-1iwbfq1"/></div> <div class="form-group svelte-1iwbfq1"><label for="material" class="svelte-1iwbfq1">Material</label> <div class="material-row svelte-1iwbfq1"><select id="material" class="material-select svelte-1iwbfq1"><option>-- No Material --</option><!></select> <button type="button" class="btn-library svelte-1iwbfq1" title="Edit Material Library">üìö</button></div></div> <div class="form-group svelte-1iwbfq1"><label for="gnc_path" class="svelte-1iwbfq1">GNC File Path</label> <input id="gnc_path" type="text" placeholder="e.g. Z:\\Sidra\\Part1.gnc" class="svelte-1iwbfq1"/></div> <div class="form-group svelte-1iwbfq1"><label for="assignee" class="svelte-1iwbfq1">Assignee</label> <div class="material-row svelte-1iwbfq1"><select id="assignee" class="material-select svelte-1iwbfq1"><option>-- No Assignee --</option><!></select> <button type="button" class="btn-library svelte-1iwbfq1" title="Edit Assignee Library">üë•</button></div></div> <div class="actions svelte-1iwbfq1"><button type="button" class="btn-secondary svelte-1iwbfq1">Cancel</button> <button type="submit" class="btn-primary svelte-1iwbfq1"> </button></div></form></div></div>'),Oc=w("<!> <!> <!>",1);function Lc(t,e){He(e,!0);let a=ut(e,"task",3,null),r=q(""),n=q(""),l=q(null),i=q(""),u=q(!1),v=q(qe([])),d=q(qe([])),p=q(!1),m=q(!1);async function h(){f(v,await ja(),!0)}async function _(){f(d,await as(),!0)}bt(()=>{e.isOpen&&(console.log("TaskModal Opened. Task:",a()),a()?(f(r,a().name,!0),f(n,a().assignee||"",!0),f(l,a().material_id||(a().material?a().material.id:null),!0),f(i,a().gnc_file_path||"",!0)):(f(n,localStorage.getItem("task_assignee")||"",!0),f(r,""),f(l,null),f(i,"")),h(),_())});async function x(I){if(I.preventDefault(),!!s(r)){f(u,!0);try{s(n)&&!a()&&localStorage.setItem("task_assignee",s(n)),await e.onSubmit({id:a()?a().id:void 0,name:s(r),assignee:s(n),material_id:s(l),gnc_file_path:s(i)}),e.close()}catch(U){console.error(U),alert("Failed to add task")}finally{f(u,!1)}}}function k(){f(p,!0)}function g(){f(p,!1),h()}function S(){f(m,!0)}function D(){f(m,!1),_()}var y=Oc(),j=Ee(y);{var z=I=>{var U=Nc();U.__click=function(...Z){e.close?.apply(this,Z)};var W=o(U);W.__click=Z=>Z.stopPropagation();var K=o(W),O=o(K),B=o(O),ce=c(O,2);ce.__click=function(...Z){e.close?.apply(this,Z)};var le=c(K,2),me=o(le),_e=c(o(me),2);mn(_e);var ge=c(me,2),be=c(o(ge),2),pe=o(be),V=o(pe);V.value=(V.__value=null)??"";var se=c(V);Ae(se,17,()=>s(v),Be,(Z,ae)=>{var oe=Rc(),re=o(oe),fe={};G(()=>{T(re,s(ae).name),fe!==(fe=s(ae).id)&&(oe.value=(oe.__value=s(ae).id)??"")}),b(Z,oe)});var P=c(pe,2);P.__click=k;var E=c(ge,2),$=c(o(E),2),ne=c(E,2),Q=c(o(ne),2),ye=o(Q),Y=o(ye);Y.value=Y.__value="";var H=c(Y);Ae(H,17,()=>s(d),Be,(Z,ae)=>{var oe=Mc(),re=o(oe),fe={};G(()=>{T(re,s(ae).name),fe!==(fe=s(ae).name)&&(oe.value=(oe.__value=s(ae).name)??"")}),b(Z,oe)});var ee=c(ye,2);ee.__click=S;var te=c(ne,2),C=o(te);C.__click=function(...Z){e.close?.apply(this,Z)};var de=c(C,2),ie=o(de);G(()=>{T(B,a()?"Edit Task":"Add Task"),de.disabled=s(u),T(ie,s(u)?a()?"Saving...":"Adding...":a()?"Save Changes":"Add Task")}),na("submit",le,x),je(_e,()=>s(r),Z=>f(r,Z)),lt(pe,()=>s(l),Z=>f(l,Z)),je($,()=>s(i),Z=>f(i,Z)),lt(ye,()=>s(n),Z=>f(n,Z)),b(I,U)};L(j,I=>{e.isOpen&&I(z)})}var R=c(j,2);Ec(R,{get isOpen(){return s(p)},close:g});var X=c(R,2);cl(X,{get isOpen(){return s(m)},close:D}),b(t,y),Xe()}Je(["click"]);var Ic=w('<div class="material-group-header svelte-ty272s"><span class="material-group-name svelte-ty272s"> </span> <span class="material-group-count svelte-ty272s"> </span></div>'),$c=w("<option> </option>"),Fc=w('<span class="material-badge svelte-ty272s"> </span>'),Bc=w('<div class="task-item svelte-ty272s"><div class="task-line-1 svelte-ty272s"><span> </span> <div class="task-right-group svelte-ty272s"><select><option>Planned</option><option>Pending</option><option>Done</option></select> <div class="task-actions svelte-ty272s"><button class="edit-btn svelte-ty272s" title="Edit">‚úé</button> <button class="delete-btn svelte-ty272s" title="Delete">√ó</button></div></div></div> <div class="task-line-2 svelte-ty272s"><div class="assignee-container svelte-ty272s"><select class="assignee-select svelte-ty272s"><option>Assignee</option><!></select> <button class="assignee-add-btn svelte-ty272s" title="Manage Assignees">+</button></div> <!></div></div>'),Gc=w("<!> <!>",1),Uc=w('<div class="empty-tasks svelte-ty272s"> </div>'),Yc=w('<div class="embedded-tasks svelte-ty272s"><div class="tasks-header svelte-ty272s"><h4 class="svelte-ty272s">Tasks</h4> <div class="header-actions svelte-ty272s"><button class="group-toggle-btn svelte-ty272s"> </button> <select class="filter-select svelte-ty272s"><option>Hide Done</option><option>Show All</option><option>Pending</option></select> <button class="add-task-btn svelte-ty272s">+ Add</button></div></div> <div class="tasks-list svelte-ty272s"><!> <!></div></div> <!> <!>',1);function Hc(t,e){He(e,!0);let a=ut(e,"filterAssignee",3,""),r=q(qe(e.document.tasks||[]));bt(()=>{f(r,e.document.tasks||[],!0)});let n=q("hide_done"),l=q(!1),i=q(null),u=q(!0),v=q(qe([])),d=q(!1);At(async()=>{f(v,await as(),!0)});async function p(){f(v,await as(),!0)}let m=st(()=>[...s(r)].sort((P,E)=>P.status==="done"&&E.status!=="done"?1:P.status!=="done"&&E.status==="done"?-1:0)),h=st(()=>s(m).filter(P=>{if(s(n)==="hide_done"&&P.status==="done"||s(n)==="pending"&&P.status!=="pending")return!1;if(s(n)==="all"){if(a()&&a().trim()){const E=(P.assignee||"").toLowerCase(),$=a().toLowerCase();return E.includes($)}return!0}if(a()&&a().trim()){const E=(P.assignee||"").toLowerCase(),$=a().toLowerCase();if(!E.includes($))return!1}return!0})),_=st(()=>()=>{if(!s(u))return{"All Tasks":s(h)};const P={};s(h).forEach(ne=>{const Q=ne.material?ne.material.name:"(No Material)";P[Q]||(P[Q]=[]),P[Q].push(ne)});const E={};return Object.keys(P).sort((ne,Q)=>ne==="(No Material)"?1:Q==="(No Material)"?-1:ne.localeCompare(Q)).forEach(ne=>{E[ne]=P[ne]}),E});async function x(P,E){try{P.status=E,await xs(P.id,{status:E}),e.refresh()}catch($){console.error($)}}async function k(P,E){try{await xs(P.id,{assignee:E})}catch($){console.error($)}}async function g(P){if(confirm("Delete task?"))try{await eo(P),f(r,s(r).filter(E=>E.id!==P),!0),e.refresh()}catch(E){console.error(E)}}async function S(P){try{if(P.id){const E=await xs(P.id,{name:P.name,assignee:P.assignee,material_id:P.material_id,gnc_file_path:P.gnc_file_path});f(r,s(r).map($=>$.id===P.id?{...$,...E}:$),!0),e.refresh()}else{const E=await Ki(e.document.id,{name:P.name,assignee:P.assignee,status:"planned",material_id:P.material_id,gnc_file_path:P.gnc_file_path});f(r,[...s(r),E],!0),e.refresh()}}catch(E){throw console.error(E),E}}function D(){f(d,!0)}function y(){f(d,!1),p()}function j(){console.log("Opening Add Modal"),f(i,null),f(l,!0)}function z(P){console.log("Opening Edit Modal for:",P),f(i,P,!0),f(l,!0)}var R=Yc(),X=Ee(R),I=o(X),U=c(o(I),2),W=o(U);W.__click=()=>f(u,!s(u));var K=o(W),O=c(W,2),B=o(O);B.value=B.__value="hide_done";var ce=c(B);ce.value=ce.__value="all";var le=c(ce);le.value=le.__value="pending";var me=c(O,2);me.__click=j;var _e=c(I,2),ge=o(_e);Ae(ge,17,()=>Object.entries(s(_)()),([P,E])=>P,(P,E)=>{var $=st(()=>un(s(E),2));let ne=()=>s($)[0],Q=()=>s($)[1];var ye=Gc(),Y=Ee(ye);{var H=te=>{var C=Ic(),de=o(C),ie=o(de),Z=c(de,2),ae=o(Z);G(()=>{T(ie,ne()),T(ae,`(${Q().length??""})`)}),b(te,C)};L(Y,te=>{s(u)&&Object.keys(s(_)()).length>1&&te(H)})}var ee=c(Y,2);Ae(ee,17,Q,te=>te.id,(te,C)=>{var de=Bc(),ie=o(de),Z=o(ie),ae=o(Z),oe=c(Z,2),re=o(oe);re.__change=ke=>x(s(C),ke.currentTarget.value);var fe=o(re);fe.value=fe.__value="planned";var N=c(fe);N.value=N.__value="pending";var he=c(N);he.value=he.__value="done";var we;Es(re);var M=c(re,2),A=o(M);A.__click=()=>z(s(C));var J=c(A,2);J.__click=()=>g(s(C).id);var Se=c(ie,2),Ne=o(Se),Me=o(Ne);Me.__change=ke=>k(s(C),ke.currentTarget.value);var xe=o(Me);xe.value=xe.__value="";var tt=c(xe);Ae(tt,17,()=>s(v),Be,(ke,Te)=>{var Pe=$c(),Ve=o(Pe),Fe={};G(()=>{T(Ve,s(Te).name),Fe!==(Fe=s(Te).name)&&(Pe.value=(Pe.__value=s(Te).name)??"")}),b(ke,Pe)});var Ye;Es(Me);var ve=c(Me,2);ve.__click=D;var F=c(Ne,2);{var ue=ke=>{var Te=Fc(),Pe=o(Te);G(()=>{Ue(Te,"title",`Material: ${s(C).material.name??""}`),T(Pe,`üì¶ ${s(C).material.name??""}`)}),b(ke,Te)};L(F,ke=>{s(C).material&&ke(ue)})}G(()=>{Oe(Z,1,`task-name ${s(C).status==="done"?"done-text":""}`,"svelte-ty272s"),Ue(Z,"title",s(C).name),T(ae,s(C).name),Oe(re,1,`status-select ${s(C).status??""}`,"svelte-ty272s"),we!==(we=s(C).status)&&(re.value=(re.__value=s(C).status)??"",ts(re,s(C).status)),Ye!==(Ye=s(C).assignee||"")&&(Me.value=(Me.__value=s(C).assignee||"")??"",ts(Me,s(C).assignee||""))}),b(te,de)}),b(P,ye)});var be=c(ge,2);{var pe=P=>{var E=Uc(),$=o(E);G(()=>T($,s(r).length>0?"No tasks match filter.":"No tasks yet.")),b(P,E)};L(be,P=>{s(h).length===0&&P(pe)})}var V=c(X,2);Lc(V,{get isOpen(){return s(l)},close:()=>f(l,!1),onSubmit:S,get task(){return s(i)}});var se=c(V,2);cl(se,{get isOpen(){return s(d)},close:y}),G(()=>{Ue(W,"title",s(u)?"Show flat list":"Group by material"),T(K,s(u)?"üì¶":"üìã")}),lt(O,()=>s(n),P=>f(n,P)),b(t,R),Xe()}Je(["click","change"]);var Xc=w('<p class="upload-status svelte-1yijx0t">Uploading...</p>'),Wc=w('<div class="attachment-item svelte-1yijx0t"><span class="attachment-name svelte-1yijx0t"> </span> <button type="button" class="remove-btn svelte-1yijx0t">√ó</button></div>'),Zc=w('<div class="attachments-list svelte-1yijx0t"></div>'),Jc=w('<div class="modal-overlay svelte-1yijx0t"><div class="modal-content svelte-1yijx0t"><div class="modal-header svelte-1yijx0t"><h3 class="svelte-1yijx0t"> </h3> <button class="close-btn svelte-1yijx0t">&times;</button></div> <form class="modal-body svelte-1yijx0t"><div class="form-group svelte-1yijx0t"><label for="author" class="svelte-1yijx0t">Author</label> <input id="author" type="text" placeholder="Your Name" class="svelte-1yijx0t"/></div> <div class="form-group svelte-1yijx0t"><label for="type" class="svelte-1yijx0t">Type</label> <select id="type" class="svelte-1yijx0t"><option>Info</option><option>Warning</option><option>Error</option></select></div> <div class="form-group svelte-1yijx0t"><label for="text" class="svelte-1yijx0t">Message</label> <textarea id="text" required rows="4" class="svelte-1yijx0t"></textarea></div> <div class="form-group svelte-1yijx0t"><label for="attachments" class="svelte-1yijx0t">Attachments</label> <div class="file-upload-wrapper svelte-1yijx0t"><input id="attachments" type="file" multiple class="svelte-1yijx0t"/> <!></div> <!></div> <div class="actions svelte-1yijx0t"><button type="button" class="btn-secondary svelte-1yijx0t">Cancel</button> <button type="submit" class="btn-primary svelte-1yijx0t"> </button></div></form></div></div>');function vl(t,e){He(e,!0);let a=ut(e,"entry",3,null),r=q(""),n=q("info"),l=q(""),i=q(!1),u=q(qe([])),v=q(!1);bt(()=>{e.isOpen&&(a()?(f(r,a().text||"",!0),f(n,a().type||"info",!0),f(l,a().author||"",!0),f(u,a().attachments||[],!0)):(f(l,localStorage.getItem("journal_author")||"",!0),f(r,""),f(n,"info"),f(u,[],!0)))});async function d(k){const g=Array.from(k.target.files);if(g.length!==0){f(v,!0);try{for(const S of g){const D=await Tn(S);s(u).push({file_path:D.file_path,filename:D.filename,media_type:D.media_type})}}catch(S){console.error("Upload failed",S),alert("Failed to upload attachment")}finally{f(v,!1),k.target.value=""}}}function p(k){s(u).splice(k,1)}async function m(k){k.preventDefault(),f(i,!0),s(l)&&localStorage.setItem("journal_author",s(l));try{const g={text:s(r),type:s(n),status:a()?.status||"pending",author:s(l),document_id:e.documentId,attachments:s(u)};a()?await En(a().id,g):await Vr(g),window.dispatchEvent(new CustomEvent("journal-entries-updated")),e.close()}catch(g){console.error(g),alert(a()?"Failed to update note":"Failed to create note")}finally{f(i,!1)}}var h=et(),_=Ee(h);{var x=k=>{var g=Jc();g.__click=function(...Q){e.close?.apply(this,Q)};var S=o(g);S.__click=Q=>Q.stopPropagation();var D=o(S),y=o(D),j=o(y),z=c(y,2);z.__click=function(...Q){e.close?.apply(this,Q)};var R=c(D,2),X=o(R),I=c(o(X),2),U=c(X,2),W=c(o(U),2),K=o(W);K.value=K.__value="info";var O=c(K);O.value=O.__value="warning";var B=c(O);B.value=B.__value="error";var ce=c(U,2),le=c(o(ce),2),me=c(ce,2),_e=c(o(me),2),ge=o(_e);ge.__change=d;var be=c(ge,2);{var pe=Q=>{var ye=Xc();b(Q,ye)};L(be,Q=>{s(v)&&Q(pe)})}var V=c(_e,2);{var se=Q=>{var ye=Zc();Ae(ye,21,()=>s(u),Be,(Y,H,ee)=>{var te=Wc(),C=o(te),de=o(C),ie=c(C,2);ie.__click=()=>p(ee),G(()=>T(de,s(H).filename)),b(Y,te)}),b(Q,ye)};L(V,Q=>{s(u).length>0&&Q(se)})}var P=c(me,2),E=o(P);E.__click=function(...Q){e.close?.apply(this,Q)};var $=c(E,2),ne=o($);G(()=>{T(j,a()?"Edit Note":`Add Note to ${e.documentName}`),ge.disabled=s(v),$.disabled=s(i),T(ne,s(i)?"Saving...":a()?"Update Note":"Add Note")}),na("submit",R,m),je(I,()=>s(l),Q=>f(l,Q)),lt(W,()=>s(n),Q=>f(n,Q)),je(le,()=>s(r),Q=>f(r,Q)),b(k,g)};L(_,k=>{e.isOpen&&k(x)})}b(t,h),Xe()}Je(["click","change"]);var Vc=w('<img class="svelte-jm2ier"/>'),Qc=w('<div class="file-placeholder svelte-jm2ier"><span> </span> <a target="_blank" rel="noreferrer">Download</a></div>'),Kc=w('<div class="image-wrapper svelte-jm2ier"><!></div>'),ev=w('<div class="modal-overlay svelte-jm2ier"><div class="modal-content svelte-jm2ier"><button class="close-btn svelte-jm2ier">&times;</button> <div class="gallery svelte-jm2ier"></div></div></div>');function ul(t,e){var a=et(),r=Ee(a);{var n=l=>{var i=ev();i.__click=function(...p){e.close?.apply(this,p)};var u=o(i);u.__click=p=>p.stopPropagation();var v=o(u);v.__click=function(...p){e.close?.apply(this,p)};var d=c(v,2);Ae(d,21,()=>e.attachments,Be,(p,m)=>{var h=Kc(),_=o(h);{var x=g=>{var S=Vc();G(()=>{Ue(S,"src",s(m).file_path),Ue(S,"alt",s(m).filename)}),b(g,S)},k=g=>{var S=Qc(),D=o(S),y=o(D),j=c(D,2);G(()=>{T(y,`üìÑ ${s(m).filename??""}`),Ue(j,"href",s(m).file_path)}),b(g,S)};L(_,g=>{s(m).media_type&&s(m).media_type.startsWith("image/")?g(x):g(k,!1)})}b(p,h)}),b(l,i)};L(r,l=>{e.isOpen&&l(n)})}b(t,a)}Je(["click"]);var tv=w("<option> </option>"),av=w("<option> </option>"),sv=w('<div class="modal-overlay svelte-12q38jy"><div class="modal-content svelte-12q38jy"><div class="modal-header svelte-12q38jy"><h3 class="svelte-12q38jy">üîç Filter Documents</h3> <button class="close-btn svelte-12q38jy">&times;</button></div> <div class="modal-body svelte-12q38jy"><div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Document Type</h4> <select class="filter-input svelte-12q38jy"><option>All Types</option><option>Plan</option><option>Mail</option><option>Other</option></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Status</h4> <select class="filter-input svelte-12q38jy"><option>All Statuses</option><option>In Progress</option><option>Done</option></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Tag</h4> <input type="text" placeholder="Filter by tag..." class="filter-input svelte-12q38jy"/></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Assignee</h4> <select class="filter-input svelte-12q38jy"><option>All Assignees</option><!></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Material</h4> <select class="filter-input svelte-12q38jy"><option>All Materials</option><!></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Task Types (Show documents with these task types)</h4> <div class="checkbox-group svelte-12q38jy"><label class="checkbox-label svelte-12q38jy"><input type="checkbox" class="svelte-12q38jy"/> <span class="checkbox-text svelte-12q38jy">Planned</span></label> <label class="checkbox-label svelte-12q38jy"><input type="checkbox" class="svelte-12q38jy"/> <span class="checkbox-text svelte-12q38jy">Pending</span></label> <label class="checkbox-label svelte-12q38jy"><input type="checkbox" class="svelte-12q38jy"/> <span class="checkbox-text svelte-12q38jy">Done</span></label></div></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Date Range</h4> <select class="filter-input svelte-12q38jy"><option>Registration Date</option><option>Done Date</option></select> <div class="date-range svelte-12q38jy"><input type="date" class="filter-input svelte-12q38jy" placeholder="Start Date"/> <span class="date-separator svelte-12q38jy">to</span> <input type="date" class="filter-input svelte-12q38jy" placeholder="End Date"/></div></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Sort By</h4> <div class="sort-controls svelte-12q38jy"><select class="filter-input svelte-12q38jy"><option>Date</option><option>Name</option><option>Author</option><option>Status</option><option>Done Date</option></select> <button class="sort-order-btn svelte-12q38jy" title="Toggle sort order"> </button></div></div></div> <div class="modal-footer svelte-12q38jy"><button class="btn-secondary svelte-12q38jy">Reset All</button> <button class="btn-primary svelte-12q38jy">Apply Filters</button></div></div></div>');function nv(t,e){He(e,!0);let a=q(qe({filterType:"",filterStatus:"",filterTag:"",filterAssignee:"",filterMaterial:"",filterTaskTypes:[],startDate:"",endDate:"",dateField:"registration_date",sortBy:"registration_date",sortOrder:"desc"})),r=q(qe([])),n=q(qe([])),l=!1;bt(()=>{e.isOpen&&!l&&(e.filters&&(f(a,{...e.filters},!0),Array.isArray(s(a).filterTaskTypes)||(s(a).filterTaskTypes=[])),i(),u()),l=e.isOpen});async function i(){try{f(r,await ja(),!0)}catch(x){console.error("Failed to load materials",x)}}async function u(){try{f(n,await as(),!0)}catch(x){console.error("Failed to load assignees",x)}}function v(){e.onApply(s(a)),e.close()}function d(){f(a,{filterType:"",filterStatus:"",filterTag:"",filterAssignee:"",filterMaterial:"",filterTaskTypes:[],startDate:"",endDate:"",dateField:"registration_date",sortBy:"registration_date",sortOrder:"desc"},!0)}function p(x){s(a).filterTaskTypes.includes(x)?s(a).filterTaskTypes=s(a).filterTaskTypes.filter(k=>k!==x):s(a).filterTaskTypes=[...s(a).filterTaskTypes,x]}var m=et(),h=Ee(m);{var _=x=>{var k=sv();k.__click=function(...ve){e.close?.apply(this,ve)};var g=o(k);g.__click=ve=>ve.stopPropagation();var S=o(g),D=c(o(S),2);D.__click=function(...ve){e.close?.apply(this,ve)};var y=c(S,2),j=o(y),z=c(o(j),2),R=o(z);R.value=R.__value="";var X=c(R);X.value=X.__value="plan";var I=c(X);I.value=I.__value="mail";var U=c(I);U.value=U.__value="other";var W=c(j,2),K=c(o(W),2),O=o(K);O.value=O.__value="";var B=c(O);B.value=B.__value="in_progress";var ce=c(B);ce.value=ce.__value="done";var le=c(W,2),me=c(o(le),2),_e=c(le,2),ge=c(o(_e),2),be=o(ge);be.value=be.__value="";var pe=c(be);Ae(pe,17,()=>s(n),Be,(ve,F)=>{var ue=tv(),ke=o(ue),Te={};G(()=>{T(ke,s(F).name),Te!==(Te=s(F).name)&&(ue.value=(ue.__value=s(F).name)??"")}),b(ve,ue)});var V=c(_e,2),se=c(o(V),2),P=o(se);P.value=P.__value="";var E=c(P);Ae(E,17,()=>s(r),Be,(ve,F)=>{var ue=av(),ke=o(ue),Te={};G(()=>{T(ke,s(F).name),Te!==(Te=s(F).id)&&(ue.value=(ue.__value=s(F).id)??"")}),b(ve,ue)});var $=c(V,2),ne=c(o($),2),Q=o(ne),ye=o(Q);ye.__change=()=>p("planned");var Y=c(Q,2),H=o(Y);H.__change=()=>p("pending");var ee=c(Y,2),te=o(ee);te.__change=()=>p("done");var C=c($,2),de=c(o(C),2),ie=o(de);ie.value=ie.__value="registration_date";var Z=c(ie);Z.value=Z.__value="done_date";var ae=c(de,2),oe=o(ae),re=c(oe,4),fe=c(C,2),N=c(o(fe),2),he=o(N),we=o(he);we.value=we.__value="registration_date";var M=c(we);M.value=M.__value="name";var A=c(M);A.value=A.__value="author";var J=c(A);J.value=J.__value="status";var Se=c(J);Se.value=Se.__value="done_date";var Ne=c(he,2);Ne.__click=()=>s(a).sortOrder=s(a).sortOrder==="desc"?"asc":"desc";var Me=o(Ne),xe=c(y,2),tt=o(xe);tt.__click=d;var Ye=c(tt,2);Ye.__click=v,G((ve,F,ue)=>{Us(ye,ve),Us(H,F),Us(te,ue),T(Me,s(a).sortOrder==="desc"?"‚Üì Desc":"‚Üë Asc")},[()=>s(a).filterTaskTypes.includes("planned"),()=>s(a).filterTaskTypes.includes("pending"),()=>s(a).filterTaskTypes.includes("done")]),lt(z,()=>s(a).filterType,ve=>s(a).filterType=ve),lt(K,()=>s(a).filterStatus,ve=>s(a).filterStatus=ve),je(me,()=>s(a).filterTag,ve=>s(a).filterTag=ve),lt(ge,()=>s(a).filterAssignee,ve=>s(a).filterAssignee=ve),lt(se,()=>s(a).filterMaterial,ve=>s(a).filterMaterial=ve),lt(de,()=>s(a).dateField,ve=>s(a).dateField=ve),je(oe,()=>s(a).startDate,ve=>s(a).startDate=ve),je(re,()=>s(a).endDate,ve=>s(a).endDate=ve),lt(he,()=>s(a).sortBy,ve=>s(a).sortBy=ve),b(x,k)};L(h,x=>{e.isOpen&&x(_)})}b(t,m),Xe()}Je(["click","change"]);var rv=w('<span class="tag-chip svelte-1qsxu3n"> <button type="button" class="svelte-1qsxu3n">&times;</button></span>'),lv=w('<li class="svelte-1qsxu3n"> </li>'),iv=w('<ul class="suggestions svelte-1qsxu3n"></ul>'),ov=w('<div class="tag-input-container svelte-1qsxu3n"><!> <div class="input-wrapper svelte-1qsxu3n"><input type="text" class="svelte-1qsxu3n"/> <!></div></div>');function cv(t,e){He(e,!0);let a=ut(e,"selectedTags",31,()=>qe([])),r=ut(e,"placeholder",3,"Add tag..."),n=q(""),l=q(qe([])),i=q(qe([])),u=q(!1),v;At(async()=>{try{f(l,await Ui(),!0)}catch(y){console.error("Failed to fetch tags",y)}});function d(y){if(f(n,y.target.value,!0),s(n).includes(",")){const j=s(n).split(",");for(let z of j)z=z.trim(),z&&(a().includes(z)||a([...a(),z]));f(n,""),f(u,!1);return}s(n)?(f(i,s(l).filter(j=>j.name.toLowerCase().includes(s(n).toLowerCase())&&!a().includes(j.name)),!0),f(u,!0)):f(u,!1)}function p(y){y&&!a().includes(y)&&a([...a(),y]),f(n,""),f(u,!1),v.focus()}function m(y){a(a().filter(j=>j!==y))}function h(y){y.key==="Enter"?(y.preventDefault(),s(n).trim()&&p(s(n).trim())):y.key==="Backspace"&&!s(n)&&a().length>0&&m(a()[a().length-1])}var _=ov(),x=o(_);Ae(x,17,a,Be,(y,j)=>{var z=rv(),R=o(z),X=c(R);X.__click=()=>m(s(j)),G(()=>T(R,`${s(j)??""} `)),b(y,z)});var k=c(x,2),g=o(k);g.__input=d,g.__keydown=h,Sn(g,y=>v=y,()=>v);var S=c(g,2);{var D=y=>{var j=iv();Ae(j,21,()=>s(i),Be,(z,R)=>{var X=lv();X.__click=()=>p(s(R).name);var I=o(X);G(()=>T(I,s(R).name)),b(z,X)}),b(y,j)};L(S,y=>{s(u)&&s(i).length>0&&y(D)})}G(()=>Ue(g,"placeholder",r())),na("blur",g,()=>setTimeout(()=>f(u,!1),200)),na("focus",g,()=>s(n)&&f(u,!0)),je(g,()=>s(n),y=>f(n,y)),b(t,_),Xe()}Je(["click","input","keydown"]);var vv=w('<span class="filter-badge svelte-s90sg6">‚óè</span>'),uv=w('<div class="card-desc svelte-s90sg6"> </div>'),dv=w('<span class="tag-badge svelte-s90sg6"> </span>'),fv=w('<button class="icon-badge attachment-badge svelte-s90sg6" title="View Attachments"> </button>'),pv=w('<span class="icon-badge task-planned svelte-s90sg6" title="Planned Tasks"> </span>'),hv=w('<span class="icon-badge task-pending svelte-s90sg6" title="Pending Tasks"> </span>'),_v=w('<span class="icon-badge task-done svelte-s90sg6" title="Completed Tasks"> </span>'),gv=w("<!> <!> <!>",1),mv=w('<span class="icon-badge journal-info svelte-s90sg6" title="Info Notes"> </span>'),bv=w('<span class="icon-badge journal-warning svelte-s90sg6" title="Warnings"> </span>'),yv=w('<span class="icon-badge journal-error svelte-s90sg6" title="Errors"> </span>'),wv=w("<!> <!> <!>",1),kv=w('<div class="badges-tags-row svelte-s90sg6"><!> <!> <!> <!></div>'),xv=w('<div class="meta-item svelte-s90sg6"><span class="label svelte-s90sg6">Done:</span> <span class="value"> </span></div>'),Sv=w('<button class="note-attachment-btn svelte-s90sg6"> </button>'),Tv=w('<div><div class="note-header svelte-s90sg6"><span> </span> <span class="note-author svelte-s90sg6"> </span> <span class="note-date svelte-s90sg6"> </span> <!> <button class="note-edit-btn svelte-s90sg6" title="Edit note">‚úèÔ∏è</button> <button> </button></div> <p class="note-text svelte-s90sg6"> </p></div>'),qv=w('<div class="embedded-notes svelte-s90sg6"><h4 class="svelte-s90sg6">Notes</h4> <div class="notes-list svelte-s90sg6"></div></div>'),Ev=w('<button class="action-btn primary-btn svelte-s90sg6" title="Register Document"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg> Register</button>'),jv=w('<button class="action-btn primary-btn svelte-s90sg6" title="View Content"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg> View</button>'),Av=w('<button class="dropdown-item svelte-s90sg6">üì¶ Download Zip</button>'),Pv=w('<div class="dropdown-menu svelte-s90sg6"><button class="dropdown-item svelte-s90sg6">üìù Add Note</button> <button class="dropdown-item svelte-s90sg6"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg> Edit</button> <!> <button class="dropdown-item delete-item svelte-s90sg6"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg> Delete</button></div>'),Cv=w('<div class="card svelte-s90sg6"><div class="card-header svelte-s90sg6"><div class="title-group svelte-s90sg6"><h3 class="svelte-s90sg6"> </h3> <span class="badge badge-type svelte-s90sg6"> </span></div> <select><option>Unregistered</option><option>In Progress</option><option>Done</option></select></div> <!> <!> <div class="card-meta svelte-s90sg6"><div class="meta-item svelte-s90sg6"><span class="label svelte-s90sg6">Author:</span> <span class="value"> </span></div> <div class="meta-item svelte-s90sg6"><span class="label svelte-s90sg6">Date:</span> <span class="value"> </span></div> <!></div> <!> <!> <div class="card-actions svelte-s90sg6"><!> <div class="dropdown-container svelte-s90sg6"><button class="action-btn dropdown-btn svelte-s90sg6" title="More actions"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle></svg></button> <!></div></div></div>'),zv=w('<div class="empty-state svelte-s90sg6"><p>No documents found.</p></div>'),Dv=w('<div class="list-container svelte-s90sg6"><div class="filters-bar svelte-s90sg6"><div class="main-filters svelte-s90sg6"><div class="search-box svelte-s90sg6"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon svelte-s90sg6"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> <input type="text" placeholder="Search documents..." class="svelte-s90sg6"/></div> <button class="filter-btn svelte-s90sg6" title="Filter &amp; Sort"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon></svg> Filters <!></button></div></div> <div class="cards-wrapper svelte-s90sg6"><!> <!></div> <!> <!> <!> <!></div>');function Rv(t,e){He(e,!0);let a=q(qe([])),r=q(""),n=q(""),l=q(""),i=q(""),u=q(""),v=q(""),d=q(qe([])),p=q(""),m=q(""),h=q("registration_date"),_=q(qe([])),x=q(null),k=q(null),g=q(null),S=q(null),D=q(!1),y=q("registration_date"),j=q("desc"),z=q(null);async function R(){let M=await qn(s(r),s(n),s(l),s(y),s(j),s(i),s(p),s(m),s(h),s(m),s(h),s(u));s(d)&&s(d).length>0&&(M=M.filter(A=>!A.tasks||A.tasks.length===0?!1:A.tasks.some(J=>s(d).includes(J.status)))),s(v)&&(M=M.filter(A=>!A.tasks||A.tasks.length===0?!1:A.tasks.some(J=>J.material_id&&J.material_id.toString()===s(v).toString()))),f(a,M,!0)}async function X(){f(_,await ao(),!0)}At(()=>{R(),X()});async function I(M,A){await Xi(M.id,A),R()}async function U(M){confirm("Are you sure you want to delete this document?")&&(await Ji(M),R())}function W(){R()}function K(M){f(x,M,!0)}function O(){f(x,null)}function B(M){f(k,M,!0),f(g,null)}function ce(M,A){f(k,M,!0),f(g,A,!0)}function le(){f(k,null),f(g,null),R()}async function me(M,A){const J=A==="pending"?"done":"pending";try{await En(M,{status:J}),R(),window.dispatchEvent(new CustomEvent("journal-entries-updated"))}catch(Se){console.error("Failed to update note status",Se)}}function _e(M){f(S,M,!0)}function ge(){f(S,null)}function be(M){if(!M)return null;const A={planned:0,pending:0,done:0};return M.forEach(J=>{A[J.status]!==void 0&&A[J.status]++}),A}function pe(M){if(!M)return null;const A={info:0,warning:0,error:0};return M.forEach(J=>{A[J.type]!==void 0&&A[J.type]++}),A}function V(){f(D,!0)}function se(){f(D,!1)}function P(M){f(n,M.filterType,!0),f(l,M.filterStatus,!0),f(i,M.filterTag,!0),f(u,M.filterAssignee,!0),f(v,M.filterMaterial||"",!0),f(d,M.filterTaskTypes||[],!0),f(p,M.startDate,!0),f(m,M.endDate,!0),f(h,M.dateField,!0),f(y,M.sortBy,!0),f(j,M.sortOrder,!0),R()}function E(M){f(z,s(z)===M?null:M,!0)}function $(){f(z,null)}async function ne(M){try{await Zi(M.id,M.name)}catch(A){console.error(A),alert("Failed to download zip. Ensure the source folder exists on the server.")}}var Q={refresh:R},ye=Dv(),Y=o(ye),H=o(Y),ee=o(H),te=c(o(ee),2);te.__input=W;var C=c(ee,2);C.__click=V;var de=c(o(C),2);{var ie=M=>{var A=vv();b(M,A)};L(de,M=>{(s(n)||s(l)||s(i)||s(u)||s(p)||s(m)||s(d)&&s(d).length>0)&&M(ie)})}var Z=c(Y,2),ae=o(Z);Ae(ae,17,()=>s(a),M=>M.id,(M,A)=>{const J=st(()=>be(s(A).tasks)),Se=st(()=>pe(s(A).journal_entries));var Ne=Cv(),Me=o(Ne),xe=o(Me),tt=o(xe),Ye=o(tt),ve=c(tt,2),F=o(ve),ue=c(xe,2);ue.__change=De=>I(s(A),De.target.value);var ke=o(ue);ke.value=ke.__value="unregistered";var Te=c(ke);Te.value=Te.__value="in_progress";var Pe=c(Te);Pe.value=Pe.__value="done";var Ve;Es(ue);var Fe=c(Me,2);{var at=De=>{var Qe=uv(),Tt=o(Qe);G(()=>T(Tt,s(A).description)),b(De,Qe)};L(Fe,De=>{s(A).description&&De(at)})}var We=c(Fe,2);{var rt=De=>{var Qe=kv(),Tt=o(Qe);{var ht=it=>{var ot=et(),yt=Ee(ot);Ae(yt,17,()=>s(A).tags,Be,(Bt,Mt)=>{var Nt=dv(),Gt=o(Nt);G(()=>T(Gt,`#${s(Mt).name??""}`)),b(Bt,Nt)}),b(it,ot)};L(Tt,it=>{s(A).tags&&s(A).tags.length>0&&it(ht)})}var Ze=c(Tt,2);{var Ft=it=>{var ot=fv();ot.__click=()=>_e(s(A).attachments);var yt=o(ot);G(()=>T(yt,`üì∑ ${s(A).attachments.length??""}`)),b(it,ot)};L(Ze,it=>{s(A).attachments&&s(A).attachments.length>0&&it(Ft)})}var Zt=c(Ze,2);{var Ct=it=>{var ot=gv(),yt=Ee(ot);{var Bt=Ke=>{var ct=pv(),_t=o(ct);G(()=>T(_t,`üìÖ ${s(J).planned??""}`)),b(Ke,ct)};L(yt,Ke=>{s(J).planned>0&&Ke(Bt)})}var Mt=c(yt,2);{var Nt=Ke=>{var ct=hv(),_t=o(ct);G(()=>T(_t,`‚è≥ ${s(J).pending??""}`)),b(Ke,ct)};L(Mt,Ke=>{s(J).pending>0&&Ke(Nt)})}var Gt=c(Mt,2);{var Fa=Ke=>{var ct=_v(),_t=o(ct);G(()=>T(_t,`‚úÖ ${s(J).done??""}`)),b(Ke,ct)};L(Gt,Ke=>{s(J).done>0&&Ke(Fa)})}b(it,ot)};L(Zt,it=>{s(J)&&it(Ct)})}var ia=c(Zt,2);{var Pa=it=>{var ot=wv(),yt=Ee(ot);{var Bt=Ke=>{var ct=mv(),_t=o(ct);G(()=>T(_t,`‚ÑπÔ∏è ${s(Se).info??""}`)),b(Ke,ct)};L(yt,Ke=>{s(Se).info>0&&Ke(Bt)})}var Mt=c(yt,2);{var Nt=Ke=>{var ct=bv(),_t=o(ct);G(()=>T(_t,`‚ö†Ô∏è ${s(Se).warning??""}`)),b(Ke,ct)};L(Mt,Ke=>{s(Se).warning>0&&Ke(Nt)})}var Gt=c(Mt,2);{var Fa=Ke=>{var ct=yv(),_t=o(ct);G(()=>T(_t,`‚ùå ${s(Se).error??""}`)),b(Ke,ct)};L(Gt,Ke=>{s(Se).error>0&&Ke(Fa)})}b(it,ot)};L(ia,it=>{s(Se)&&it(Pa)})}b(De,Qe)};L(We,De=>{(s(A).tags&&s(A).tags.length>0||s(A).attachments&&s(A).attachments.length>0||s(J)||s(Se))&&De(rt)})}var St=c(We,2),Pt=o(St),ga=c(o(Pt),2),ma=o(ga),ba=c(Pt,2),vs=c(o(ba),2),Os=o(vs),Ls=c(ba,2);{var us=De=>{var Qe=xv(),Tt=c(o(Qe),2),ht=o(Tt);G(()=>T(ht,s(A).done_date)),b(De,Qe)};L(Ls,De=>{s(A).done_date&&De(us)})}var ds=c(St,2);Hc(ds,{get document(){return s(A)},refresh:R,get filterAssignee(){return s(u)}});var fs=c(ds,2);{var Is=De=>{var Qe=qv(),Tt=c(o(Qe),2);Ae(Tt,21,()=>s(A).journal_entries,Be,(ht,Ze)=>{var Ft=Tv(),Zt=o(Ft),Ct=o(Zt),ia=o(Ct),Pa=c(Ct,2),it=o(Pa),ot=c(Pa,2),yt=o(ot),Bt=c(ot,2);{var Mt=_t=>{var ms=Sv();ms.__click=()=>_e(s(Ze).attachments);var fl=o(ms);G(()=>{Ue(ms,"title",`View attachments (${s(Ze).attachments.length??""})`),T(fl,`üìé ${s(Ze).attachments.length??""}`)}),b(_t,ms)};L(Bt,_t=>{s(Ze).attachments&&s(Ze).attachments.length>0&&_t(Mt)})}var Nt=c(Bt,2);Nt.__click=()=>ce(s(A),s(Ze));var Gt=c(Nt,2);Gt.__click=()=>me(s(Ze).id,s(Ze).status);var Fa=o(Gt),Ke=c(Zt,2),ct=o(Ke);G(()=>{Oe(Ft,1,`note-item ${s(Ze).type??""}`,"svelte-s90sg6"),Oe(Ct,1,`note-badge ${s(Ze).type??""}`,"svelte-s90sg6"),T(ia,s(Ze).type),T(it,s(Ze).author||"Unknown"),T(yt,s(Ze).created_at),Oe(Gt,1,`note-status-btn ${s(Ze).status??""}`,"svelte-s90sg6"),Ue(Gt,"title",s(Ze).status==="pending"?"Click to mark as done":"Click to mark as pending"),T(Fa,s(Ze).status),T(ct,s(Ze).text)}),b(ht,Ft)}),b(De,Qe)};L(fs,De=>{s(A).journal_entries&&s(A).journal_entries.length>0&&De(Is)})}var ps=c(fs,2),hs=o(ps);{var $s=De=>{var Qe=Ev();Qe.__click=()=>e.onEdit(s(A)),b(De,Qe)},_s=De=>{var Qe=jv();Qe.__click=()=>K(s(A)),b(De,Qe)};L(hs,De=>{s(A).status==="unregistered"?De($s):De(_s,!1)})}var Fs=c(hs,2),gs=o(Fs);gs.__click=()=>E(s(A).id);var Bs=c(gs,2);{var Gs=De=>{var Qe=Pv(),Tt=o(Qe);Tt.__click=()=>{B(s(A)),$()};var ht=c(Tt,2);ht.__click=()=>{e.onEdit(s(A)),$()};var Ze=c(ht,2);{var Ft=Ct=>{var ia=Av();ia.__click=()=>{ne(s(A)),$()},b(Ct,ia)};L(Ze,Ct=>{s(A).type==="order"&&Ct(Ft)})}var Zt=c(Ze,2);Zt.__click=()=>{U(s(A).id),$()},b(De,Qe)};L(Bs,De=>{s(z)===s(A).id&&De(Gs)})}G(()=>{T(Ye,s(A).name),T(F,s(A).type),Oe(ue,1,`status-select ${s(A).status??""}`,"svelte-s90sg6"),ke.disabled=s(A).status!=="unregistered",Ve!==(Ve=s(A).status)&&(ue.value=(ue.__value=s(A).status)??"",ts(ue,s(A).status)),T(ma,s(A).author||"-"),T(Os,s(A).registration_date)}),b(M,Ne)});var oe=c(ae,2);{var re=M=>{var A=zv();b(M,A)};L(oe,M=>{s(a).length===0&&M(re)})}var fe=c(Z,2);{let M=st(()=>!!s(x));jn(fe,{get isOpen(){return s(M)},close:O,maxWidth:"800px",children:(A,J)=>{yc(A,{get document(){return s(x)}})},$$slots:{default:!0}})}var N=c(fe,2);{let M=st(()=>!!s(k)),A=st(()=>s(k)?.id),J=st(()=>s(k)?.name);vl(N,{get isOpen(){return s(M)},close:le,get documentId(){return s(A)},get documentName(){return s(J)},get entry(){return s(g)}})}var he=c(N,2);{let M=st(()=>!!s(S)),A=st(()=>s(S)||[]);ul(he,{get isOpen(){return s(M)},close:ge,get attachments(){return s(A)}})}var we=c(he,2);{let M=st(()=>({filterType:s(n),filterStatus:s(l),filterTag:s(i),filterAssignee:s(u),filterMaterial:s(v),filterTaskTypes:s(d),startDate:s(p),endDate:s(m),dateField:s(h),sortBy:s(y),sortOrder:s(j)}));nv(we,{get isOpen(){return s(D)},close:se,get filters(){return s(M)},onApply:P})}return je(te,()=>s(r),M=>f(r,M)),b(t,ye),Xe(Q)}Je(["input","click","change"]);var Mv=w('<button type="button" class="btn-outline svelte-f0yvr0">üì∑ View Gallery</button>'),Nv=w('<p class="info-text svelte-f0yvr0">Uploading...</p>'),Ov=w('<p class="error-text svelte-f0yvr0"> </p>'),Lv=w('<div class="attachment-item svelte-f0yvr0"><span class="file-name svelte-f0yvr0"> </span> <button type="button" class="remove-btn svelte-f0yvr0">‚ùå</button></div>'),Iv=w('<div class="attachment-item new svelte-f0yvr0"><span class="file-name svelte-f0yvr0"> </span> <button type="button" class="remove-btn svelte-f0yvr0">‚ùå</button></div>'),$v=w('<div class="attachments-list svelte-f0yvr0"><!> <!></div>'),Fv=w('<span class="part-dims svelte-f0yvr0"> </span>'),Bv=w('<li class="part-item-li svelte-f0yvr0"><span class="part-name svelte-f0yvr0"> </span> <span class="part-reg svelte-f0yvr0"> </span> <!></li>'),Gv=w('<ul class="parts-list svelte-f0yvr0"></ul>'),Uv=w('<p class="no-parts svelte-f0yvr0">No linked parts found in GNC.</p>'),Yv=w('<details class="task-item svelte-f0yvr0"><summary class="svelte-f0yvr0"><span class="task-icon">‚öôÔ∏è</span> <span class="task-name svelte-f0yvr0"> </span> <span> </span></summary> <div class="task-details svelte-f0yvr0"><div class="task-meta svelte-f0yvr0"><div class="meta-item svelte-f0yvr0"><span class="label svelte-f0yvr0">Assignee:</span> <span> </span></div> <div class="meta-item svelte-f0yvr0"><span class="label svelte-f0yvr0">Material:</span> <span> </span></div> <div class="meta-item svelte-f0yvr0"><span class="label svelte-f0yvr0">GNC Path:</span> <span class="path svelte-f0yvr0"> </span></div></div> <div class="linked-parts-section svelte-f0yvr0"><h5 class="svelte-f0yvr0"> </h5> <!></div></div></details>'),Hv=w('<div class="form-section svelte-f0yvr0"><h4 class="svelte-f0yvr0"> </h4> <div class="task-list svelte-f0yvr0"></div></div>'),Xv=w('<div class="form-container svelte-f0yvr0"><h3 class="svelte-f0yvr0"> </h3> <form><div class="form-section upload-section svelte-f0yvr0"><h4 class="svelte-f0yvr0">Files & Scanning</h4> <div class="upload-buttons"><div class="upload-btn-wrapper svelte-f0yvr0"><button type="button" class="btn-outline svelte-f0yvr0">üìÑ Add Attachments</button> <input type="file" multiple title="Add Attachments (No Scan)" class="svelte-f0yvr0"/></div> <!></div> <!> <!> <!></div> <div class="form-group svelte-f0yvr0"><label for="name" class="svelte-f0yvr0">Name</label> <input id="name" type="text" required placeholder="e.g. Project Alpha Specs" class="svelte-f0yvr0"/></div> <div class="form-group svelte-f0yvr0"><label for="description" class="svelte-f0yvr0">Description</label> <textarea id="description" rows="3" placeholder="Brief description of the document..." class="svelte-f0yvr0"></textarea></div> <!> <div class="form-group svelte-f0yvr0"><label for="tags" class="svelte-f0yvr0">Tags</label> <!></div> <div class="form-group svelte-f0yvr0"><label for="content" class="svelte-f0yvr0">Recognized Content (Markdown)</label> <textarea id="content" rows="10" placeholder="Recognized document content will appear here..." class="svelte-f0yvr0"></textarea></div> <div class="row svelte-f0yvr0"><div class="form-group half svelte-f0yvr0"><label for="type" class="svelte-f0yvr0">Type</label> <select id="type" class="svelte-f0yvr0"><option>Plan</option><option>Mail</option><option>Other</option></select></div> <div class="form-group half svelte-f0yvr0"><label for="status" class="svelte-f0yvr0">Status</label> <select id="status" class="svelte-f0yvr0"><option>In Progress</option><option>Done</option></select></div></div> <div class="row svelte-f0yvr0"><div class="form-group half svelte-f0yvr0"><label for="date" class="svelte-f0yvr0">Registration Date</label> <input id="date" type="date" class="svelte-f0yvr0"/></div> <div class="form-group half svelte-f0yvr0"><label for="done_date" class="svelte-f0yvr0">Done Date</label> <input id="done_date" type="date" class="svelte-f0yvr0"/></div></div> <div class="form-group svelte-f0yvr0"><label for="author" class="svelte-f0yvr0">Author</label> <input id="author" type="text" placeholder="Your Name" class="svelte-f0yvr0"/></div> <div class="actions svelte-f0yvr0"><button type="button" class="btn-secondary svelte-f0yvr0">Cancel</button> <button type="submit" class="btn-primary svelte-f0yvr0"> </button></div></form> <!></div>');function Wv(t,e){He(e,!0);let a=ut(e,"document",3,null),r=q(""),n=q(""),l=q("plan"),i=q("in_progress"),u=q(""),v=q(""),d=q(""),p=q(""),m=q(qe([])),h=q(qe([])),_=q(qe([]));bt(()=>{if(a())f(r,a().name||"",!0),f(n,a().description||"",!0),f(l,a().type||"plan",!0),f(i,a().status||"in_progress",!0),f(u,a().registration_date||"",!0),f(v,a().content||"",!0),f(d,a().author||"",!0),f(p,a().done_date||"",!0),f(m,a().attachments||[],!0),a().tags?f(_,a().tags.map(F=>typeof F=="string"?F:F.name),!0):f(_,[],!0);else{const F=typeof localStorage<"u"?localStorage.getItem("doc_author"):"";F&&f(d,F,!0)}});let x=q(!1),k=q(!1),g=q(""),S=q(null);At(()=>{if(s(i)==="unregistered"&&f(i,"in_progress"),!a()){const F=localStorage.getItem("doc_author");F&&f(d,F,!0)}}),bt(()=>{s(i)==="done"&&!s(p)&&f(p,new Date().toISOString().split("T")[0],!0)});async function D(F){const ue=Array.from(F.target.files);if(ue.length!==0){f(x,!0);try{for(const ke of ue){const Te=await Tn(ke);s(h).push({file_path:Te.file_path,filename:Te.filename,media_type:Te.media_type})}}catch(ke){console.error("Upload failed",ke),alert("Failed to upload attachment")}finally{f(x,!1),F.target.value=""}}}function y(){f(S,[...s(m),...s(h)],!0)}async function j(F,ue){if(ue)s(h).splice(F,1);else{if(!confirm("Permanently delete this attachment?"))return;const ke=s(m)[F];try{await to(ke.id),s(m).splice(F,1)}catch(Te){console.error("Failed to delete attachment",Te),alert("Failed to delete attachment")}}}async function z(F){F.preventDefault(),f(k,!0),f(g,"");try{s(d)&&localStorage.setItem("doc_author",s(d));const ue={name:s(r),description:s(n),type:s(l),status:s(i),registration_date:s(u)||void 0,content:s(v),author:s(d),done_date:s(p)||void 0,attachments:s(h),tags:s(_)};a()?await Wi(a().id,ue):await Hi(ue),a()||(f(r,""),f(n,""),f(l,"plan"),f(i,"in_progress"),f(u,""),f(v,""),f(d,localStorage.getItem("doc_author")||"",!0),f(p,""),f(h,[],!0),f(_,[],!0)),e.onDocumentCreated()}catch(ue){console.error("Failed to save document:",ue),f(g,"Failed to save document. Please try again.")}finally{f(k,!1)}}var R=Xv(),X=o(R),I=o(X),U=c(X,2),W=o(U),K=c(o(W),2),O=o(K),B=c(o(O),2);B.__change=D;var ce=c(O,2);{var le=F=>{var ue=Mv();ue.__click=y,b(F,ue)};L(ce,F=>{(s(m).length>0||s(h).length>0)&&F(le)})}var me=c(K,2);{var _e=F=>{var ue=Nv();b(F,ue)};L(me,F=>{s(x)&&F(_e)})}var ge=c(me,2);{var be=F=>{var ue=Ov(),ke=o(ue);G(()=>T(ke,s(g))),b(F,ue)};L(ge,F=>{s(g)&&F(be)})}var pe=c(ge,2);{var V=F=>{var ue=$v(),ke=o(ue);Ae(ke,17,()=>s(m),Be,(Pe,Ve,Fe)=>{var at=Lv(),We=o(at),rt=o(We),St=c(We,2);St.__click=()=>j(Fe,!1),G(()=>{Ue(We,"title",s(Ve).filename),T(rt,s(Ve).filename)}),b(Pe,at)});var Te=c(ke,2);Ae(Te,17,()=>s(h),Be,(Pe,Ve,Fe)=>{var at=Iv(),We=o(at),rt=o(We),St=c(We,2);St.__click=()=>j(Fe,!0),G(()=>{Ue(We,"title",s(Ve).filename),T(rt,`(New) ${s(Ve).filename??""}`)}),b(Pe,at)}),b(F,ue)};L(pe,F=>{(s(m).length>0||s(h).length>0)&&F(V)})}var se=c(W,2),P=c(o(se),2),E=c(se,2),$=c(o(E),2),ne=c(E,2);{var Q=F=>{var ue=Hv(),ke=o(ue),Te=o(ke),Pe=c(ke,2);Ae(Pe,21,()=>a().tasks,Be,(Ve,Fe)=>{var at=Yv(),We=o(at),rt=c(o(We),2),St=o(rt),Pt=c(rt,2),ga=o(Pt),ma=c(We,2),ba=o(ma),vs=o(ba),Os=c(o(vs),2),Ls=o(Os),us=c(vs,2),ds=c(o(us),2),fs=o(ds),Is=c(us,2),ps=c(o(Is),2),hs=o(ps),$s=c(ba,2),_s=o($s),Fs=o(_s),gs=c(_s,2);{var Bs=De=>{var Qe=Gv();Ae(Qe,21,()=>s(Fe).parts,Be,(Tt,ht)=>{var Ze=Bv(),Ft=o(Ze),Zt=o(Ft),Ct=c(Ft,2),ia=o(Ct),Pa=c(Ct,2);{var it=ot=>{var yt=Fv(),Bt=o(yt);G((Mt,Nt)=>T(Bt,`${Mt??""} x ${Nt??""}`),[()=>Math.round(s(ht).width),()=>Math.round(s(ht).height)]),b(ot,yt)};L(Pa,ot=>{(s(ht).width||s(ht).height)&&ot(it)})}G(()=>{T(Zt,s(ht).name),T(ia,`[${s(ht).registration_number??""}]`)}),b(Tt,Ze)}),b(De,Qe)},Gs=De=>{var Qe=Uv();b(De,Qe)};L(gs,De=>{s(Fe).parts?.length>0?De(Bs):De(Gs,!1)})}G(()=>{T(St,s(Fe).name),Oe(Pt,1,`task-status-badge ${s(Fe).status??""}`,"svelte-f0yvr0"),T(ga,s(Fe).status),T(Ls,s(Fe).assignee||"Unassigned"),T(fs,s(Fe).material?.name||"Unknown"),Ue(ps,"title",s(Fe).gnc_file_path),T(hs,s(Fe).gnc_file_path||"N/A"),T(Fs,`Linked Parts (${(s(Fe).parts?.length||0)??""})`)}),b(Ve,at)}),G(()=>T(Te,`Tasks (${a().tasks.length??""})`)),b(F,ue)};L(ne,F=>{a()?.tasks?.length>0&&F(Q)})}var ye=c(ne,2),Y=c(o(ye),2);cv(Y,{get selectedTags(){return s(_)},set selectedTags(F){f(_,F,!0)}});var H=c(ye,2),ee=c(o(H),2),te=c(H,2),C=o(te),de=c(o(C),2),ie=o(de);ie.value=ie.__value="plan";var Z=c(ie);Z.value=Z.__value="mail";var ae=c(Z);ae.value=ae.__value="other";var oe=c(C,2),re=c(o(oe),2),fe=o(re);fe.value=fe.__value="in_progress";var N=c(fe);N.value=N.__value="done";var he=c(te,2),we=o(he),M=c(o(we),2),A=c(we,2),J=c(o(A),2),Se=c(he,2),Ne=c(o(Se),2),Me=c(Se,2),xe=o(Me);xe.__click=function(...F){e.onCancel?.apply(this,F)};var tt=c(xe,2),Ye=o(tt),ve=c(U,2);{let F=st(()=>!!s(S)),ue=st(()=>s(S)||[]);ul(ve,{get isOpen(){return s(F)},close:()=>f(S,null),get attachments(){return s(ue)}})}G(()=>{T(I,a()?"Edit Document":"New Document"),J.disabled=s(i)!=="done",tt.disabled=s(k)||s(x),T(Ye,s(k)?"Saving...":a()?"Save Changes":"Register Document")}),na("submit",U,z),je(P,()=>s(r),F=>f(r,F)),je($,()=>s(n),F=>f(n,F)),je(ee,()=>s(v),F=>f(v,F)),lt(de,()=>s(l),F=>f(l,F)),lt(re,()=>s(i),F=>f(i,F)),je(M,()=>s(u),F=>f(u,F)),je(J,()=>s(p),F=>f(p,F)),je(Ne,()=>s(d),F=>f(d,F)),b(t,R),Xe()}Je(["change","click"]);var Zv=w('<div class="page-container svelte-14q2aho"><div class="actions-bar svelte-14q2aho"><button class="add-btn svelte-14q2aho"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg> New Document</button></div> <!> <!></div>');function Jv(t){let e=q(!1),a=q(null),r=q(null);function n(){f(a,null),f(e,!0)}function l(_){f(a,_,!0),f(e,!0)}function i(){f(e,!1),f(a,null)}function u(){i(),s(r)&&s(r).refresh&&s(r).refresh()}var v=Zv(),d=o(v),p=o(d);p.__click=n;var m=c(d,2);Sn(Rv(m,{onEdit:l}),_=>f(r,_,!0),()=>s(r));var h=c(m,2);jn(h,{get isOpen(){return s(e)},close:i,children:(_,x)=>{Wv(_,{onDocumentCreated:u,onCancel:i,get document(){return s(a)}})},$$slots:{default:!0}}),b(t,v)}Je(["click"]);var Vv=w('<span class="att-badge svelte-v5qqzx"> </span>'),Qv=w('<div class="attachments-preview svelte-v5qqzx"></div>'),Kv=w('<div class="entry-form svelte-v5qqzx"><input type="text" placeholder="Author" class="author-input svelte-v5qqzx"/> <select class="svelte-v5qqzx"><option>Info</option><option>Warning</option><option>Error</option></select> <textarea placeholder="Message..." class="svelte-v5qqzx"></textarea> <div class="file-input-group svelte-v5qqzx"><input type="file" multiple class="svelte-v5qqzx"/> <!></div> <button>Save</button></div>'),eu=w("<p>Loading...</p>"),tu=w('<p class="empty">No entries found.</p>'),au=w('<span class="doc-ref svelte-v5qqzx"> </span>'),su=w('<a target="_blank" class="svelte-v5qqzx"><img class="svelte-v5qqzx"/></a>'),nu=w('<a target="_blank" class="svelte-v5qqzx"> </a>'),ru=w('<div class="attachment-thumb svelte-v5qqzx"><!></div>'),lu=w('<div class="entry-attachments svelte-v5qqzx"></div>'),iu=w('<div><div class="entry-header svelte-v5qqzx"><span> </span> <span class="author svelte-v5qqzx"> </span> <span class="date"> </span> <!> <div class="actions svelte-v5qqzx"><button class="edit-btn svelte-v5qqzx">‚úèÔ∏è Edit</button> <button class="status-btn svelte-v5qqzx"> </button> <button class="delete-btn svelte-v5qqzx">üóë</button></div></div> <p class="text svelte-v5qqzx"> </p> <!></div>'),ou=w('<div class="journal-container svelte-v5qqzx"><div class="toolbar svelte-v5qqzx"><div class="filters svelte-v5qqzx"><select class="svelte-v5qqzx"><option>All Types</option><option>Info</option><option>Warning</option><option>Error</option></select> <select class="svelte-v5qqzx"><option>All Statuses</option><option>Pending</option><option>Done</option></select></div> <button class="add-btn svelte-v5qqzx"> </button></div> <!> <div class="entries-list svelte-v5qqzx"><!></div> <!></div>');function cu(t,e){He(e,!0);let a=q(qe([])),r=q(!1),n=q(null),l=q(""),i=q(""),u=q(!1),v=q(""),d=q("info"),p=q(""),m=q(qe([]));async function h(){f(r,!0);try{f(a,await Vi(s(l),s(i)),!0)}catch(E){console.error(E)}finally{f(r,!1)}}At(()=>{f(p,localStorage.getItem("journal_author")||"",!0),h();const E=()=>{h()};return window.addEventListener("journal-entries-updated",E),()=>{window.removeEventListener("journal-entries-updated",E)}});async function _(E){const $=Array.from(E.target.files);if($.length!==0){for(const ne of $)try{const Q=await Tn(ne);s(m).push(Q)}catch(Q){console.error("Upload failed",Q),alert("Upload failed for "+ne.name)}E.target.value=""}}async function x(){if(!(!s(v)&&s(m).length===0)){s(p)&&localStorage.setItem("journal_author",s(p));try{await Vr({text:s(v),type:s(d),status:"pending",author:s(p),attachments:s(m)}),f(v,""),f(m,[],!0),f(u,!1),h()}catch(E){console.error("Failed to add entry",E)}}}async function k(E){const $=E.status==="pending"?"done":"pending";try{await En(E.id,{status:$}),h()}catch(ne){console.error(ne)}}async function g(E){if(confirm("Are you sure?"))try{await Qi(E),h()}catch($){console.error($)}}function S(E){f(n,E,!0)}function D(){f(n,null),h()}bt(()=>{h()});var y=ou(),j=o(y),z=o(j),R=o(z);R.__change=h;var X=o(R);X.value=X.__value="";var I=c(X);I.value=I.__value="info";var U=c(I);U.value=U.__value="warning";var W=c(U);W.value=W.__value="error";var K=c(R,2);K.__change=h;var O=o(K);O.value=O.__value="";var B=c(O);B.value=B.__value="pending";var ce=c(B);ce.value=ce.__value="done";var le=c(z,2);le.__click=()=>f(u,!s(u));var me=o(le),_e=c(j,2);{var ge=E=>{var $=Kv(),ne=o($),Q=c(ne,2),ye=o(Q);ye.value=ye.__value="info";var Y=c(ye);Y.value=Y.__value="warning";var H=c(Y);H.value=H.__value="error";var ee=c(Q,2),te=c(ee,2),C=o(te);C.__change=_;var de=c(C,2);{var ie=ae=>{var oe=Qv();Ae(oe,21,()=>s(m),Be,(re,fe)=>{var N=Vv(),he=o(N);G(()=>T(he,s(fe).filename)),b(re,N)}),b(ae,oe)};L(de,ae=>{s(m).length>0&&ae(ie)})}var Z=c(te,2);Z.__click=x,je(ne,()=>s(p),ae=>f(p,ae)),lt(Q,()=>s(d),ae=>f(d,ae)),je(ee,()=>s(v),ae=>f(v,ae)),b(E,$)};L(_e,E=>{s(u)&&E(ge)})}var be=c(_e,2),pe=o(be);{var V=E=>{var $=eu();b(E,$)},se=E=>{var $=et(),ne=Ee($);{var Q=Y=>{var H=tu();b(Y,H)},ye=Y=>{var H=et(),ee=Ee(H);Ae(ee,17,()=>s(a),Be,(te,C)=>{var de=iu(),ie=o(de),Z=o(ie),ae=o(Z),oe=c(Z,2),re=o(oe),fe=c(oe,2),N=o(fe),he=c(fe,2);{var we=ve=>{var F=au(),ue=o(F);G(()=>T(ue,`Ref: Doc #${s(C).document_id??""}`)),b(ve,F)};L(he,ve=>{s(C).document_id&&ve(we)})}var M=c(he,2),A=o(M);A.__click=()=>S(s(C));var J=c(A,2);J.__click=()=>k(s(C));var Se=o(J),Ne=c(J,2);Ne.__click=()=>g(s(C).id);var Me=c(ie,2),xe=o(Me),tt=c(Me,2);{var Ye=ve=>{var F=lu();Ae(F,21,()=>s(C).attachments,Be,(ue,ke)=>{var Te=ru(),Pe=o(Te);{var Ve=at=>{var We=su(),rt=o(We);G(()=>{Ue(We,"href",s(ke).file_path),Ue(rt,"src",s(ke).file_path),Ue(rt,"alt",s(ke).filename)}),b(at,We)},Fe=at=>{var We=nu(),rt=o(We);G(()=>{Ue(We,"href",s(ke).file_path),T(rt,`üìÑ ${s(ke).filename??""}`)}),b(at,We)};L(Pe,at=>{s(ke).media_type&&s(ke).media_type.startsWith("image/")?at(Ve):at(Fe,!1)})}b(ue,Te)}),b(ve,F)};L(tt,ve=>{s(C).attachments&&s(C).attachments.length>0&&ve(Ye)})}G(()=>{Oe(de,1,`entry-card ${s(C).type??""} ${s(C).status??""}`,"svelte-v5qqzx"),Oe(Z,1,`badge ${s(C).type??""}`,"svelte-v5qqzx"),T(ae,s(C).type),T(re,s(C).author||"Unknown"),T(N,s(C).created_at),T(Se,s(C).status==="pending"?"‚òë Mark Done":"‚Ü© Reopen"),T(xe,s(C).text)}),b(te,de)}),b(Y,H)};L(ne,Y=>{s(a).length===0?Y(Q):Y(ye,!1)},!0)}b(E,$)};L(pe,E=>{s(r)?E(V):E(se,!1)})}var P=c(be,2);{let E=st(()=>!!s(n)),$=st(()=>s(n)?.document_id);vl(P,{get isOpen(){return s(E)},close:D,get documentId(){return s($)},documentName:"Journal Entry",get entry(){return s(n)}})}G(()=>T(me,s(u)?"Cancel":"+ New Entry")),lt(R,()=>s(l),E=>f(l,E)),lt(K,()=>s(i),E=>f(i,E)),b(t,y),Xe()}Je(["change","click"]);var vu=w('<div class="loading-state svelte-g0byll">Loading tasks...</div>'),uu=w('<div class="empty-state svelte-g0byll">Enter an assignee name above to view their tasks.</div>'),du=w('<div class="empty-state svelte-g0byll">No pending or planned tasks found for this assignee.</div>'),fu=w('<div><div class="task-info svelte-g0byll"><span> </span> <button class="btn-done svelte-g0byll" title="Mark as done">‚úì</button> <span class="task-name svelte-g0byll"> </span></div></div>'),pu=w('<div class="material-group svelte-g0byll"><div class="material-header svelte-g0byll"><span class="material-name svelte-g0byll"> </span> <span class="task-count svelte-g0byll"> </span></div> <div class="tasks-list svelte-g0byll"></div></div>'),hu=w('<div class="doc-group svelte-g0byll"><div class="doc-header svelte-g0byll"><h3 class="svelte-g0byll"> </h3> <span> </span></div> <!></div>'),_u=w('<div class="documents-list svelte-g0byll"></div>'),gu=w('<div class="job-view svelte-g0byll"><div class="assignee-filter svelte-g0byll"><label for="assignee" class="svelte-g0byll">Assignee:</label> <input id="assignee" type="text" placeholder="Enter assignee name..." class="svelte-g0byll"/> <button class="btn-load svelte-g0byll"> </button></div> <!></div>');function mu(t,e){He(e,!0);let a=q(qe([])),r=q(""),n=q(!1);At(()=>{f(r,localStorage.getItem("job_assignee")||"",!0),s(r)&&l()});async function l(){if(!s(r).trim()){f(a,[],!0);return}f(n,!0);try{const S=await qn();f(a,S.map(D=>({...D,tasks:(D.tasks||[]).filter(y=>y.assignee&&y.assignee.toLowerCase().includes(s(r).toLowerCase())&&(y.status==="pending"||y.status==="planned"))})).filter(D=>D.tasks.length>0),!0)}catch(S){console.error(S)}finally{f(n,!1)}}function i(){localStorage.setItem("job_assignee",s(r)),l()}async function u(S){try{await xs(S,{status:"done"}),await l()}catch(D){console.error(D),alert("Failed to update task status")}}function v(S){const y=[...S.tasks||[]].sort((z,R)=>z.status==="pending"&&R.status!=="pending"?-1:z.status!=="pending"&&R.status==="pending"?1:0),j={};return y.forEach(z=>{const R=z.material?z.material.name:"(No Material)";j[R]||(j[R]=[]),j[R].push(z)}),j}var d=gu(),p=o(d),m=c(o(p),2);m.__change=i;var h=c(m,2);h.__click=l;var _=o(h),x=c(p,2);{var k=S=>{var D=vu();b(S,D)},g=S=>{var D=et(),y=Ee(D);{var j=R=>{var X=uu();b(R,X)},z=R=>{var X=et(),I=Ee(X);{var U=K=>{var O=du();b(K,O)},W=K=>{var O=_u();Ae(O,21,()=>s(a),B=>B.id,(B,ce)=>{const le=st(()=>v(s(ce)));var me=hu(),_e=o(me),ge=o(_e),be=o(ge),pe=c(ge,2),V=o(pe),se=c(_e,2);Ae(se,17,()=>Object.entries(s(le)),Be,(P,E)=>{var $=st(()=>un(s(E),2));let ne=()=>s($)[0],Q=()=>s($)[1];var ye=pu(),Y=o(ye),H=o(Y),ee=o(H),te=c(H,2),C=o(te),de=c(Y,2);Ae(de,21,Q,ie=>ie.id,(ie,Z)=>{var ae=fu(),oe=o(ae),re=o(oe),fe=o(re),N=c(re,2);N.__click=()=>u(s(Z).id);var he=c(N,2),we=o(he);G(()=>{Oe(ae,1,`task-row ${s(Z).status??""}`,"svelte-g0byll"),Oe(re,1,`task-status-badge ${s(Z).status??""}`,"svelte-g0byll"),T(fe,s(Z).status),T(we,s(Z).name)}),b(ie,ae)}),G(()=>{T(ee,`üì¶ ${ne()??""}`),T(C,`${Q().length??""} task${Q().length!==1?"s":""}`)}),b(P,ye)}),G(()=>{T(be,s(ce).name),Oe(pe,1,`doc-badge ${s(ce).type??""}`,"svelte-g0byll"),T(V,s(ce).type)}),b(B,me)}),b(K,O)};L(I,K=>{s(a).length===0?K(U):K(W,!1)},!0)}b(R,X)};L(y,R=>{s(r).trim()?R(z,!1):R(j)},!0)}b(S,D)};L(x,S=>{s(n)?S(k):S(g,!1)})}G(S=>{h.disabled=S,T(_,s(n)?"Loading...":"Load")},[()=>s(n)||!s(r).trim()]),je(m,()=>s(r),S=>f(r,S)),b(t,d),Xe()}Je(["change","click"]);var bu=w('<img class="thumbnail-img svelte-10wfxqz"/>'),yu=w('<div class="thumbnail card svelte-10wfxqz" role="button" tabindex="0"><div class="preview svelte-10wfxqz"><!> <div class="placeholder-geo svelte-10wfxqz"><span>‚öôÔ∏è</span></div> <div class="overlay-actions svelte-10wfxqz"><button class="action-btn svelte-10wfxqz" title="Edit Part">‚úèÔ∏è</button> <button class="action-btn svelte-10wfxqz" title="Preview">üëÅÔ∏è</button></div></div> <div class="info svelte-10wfxqz"><h4 class="name svelte-10wfxqz"> </h4> <div class="card-meta svelte-10wfxqz"><div class="meta-item svelte-10wfxqz"><span class="label svelte-10wfxqz">Registration:</span> <span class="value svelte-10wfxqz"> </span></div> <div class="meta-item svelte-10wfxqz"><span class="label svelte-10wfxqz">Dimensions:</span> <span class="value svelte-10wfxqz"> </span></div> <div class="meta-item svelte-10wfxqz"><span class="label svelte-10wfxqz">Material:</span> <span class="value svelte-10wfxqz"> </span></div></div></div></div>');function wu(t,e){He(e,!0);let a=st(()=>e.part.material?e.part.material.name:"Unknown Material"),r=st(()=>`${e.part.width||"?"} x ${e.part.height||"?"}`);function n(K){K.stopPropagation(),e.onedit&&e.onedit(e.part)}function l(K){K.stopPropagation(),e.onpreview&&e.onpreview(e.part)}var i=yu();i.__click=function(...K){e.onclick?.apply(this,K)},i.__keydown=K=>K.key==="Enter"&&e.onclick&&e.onclick();var u=o(i),v=o(u);{var d=K=>{var O=bu();G(()=>{Ue(O,"src",`/uploads/thumbnails/${(e.part.registration_number||e.part.id)??""}.svg`),Ue(O,"alt",e.part.name)}),na("error",O,B=>{B.currentTarget.style.display="none"}),b(K,O)};L(v,K=>{e.part.gnc_file_path&&K(d)})}var p=c(v,2),m=c(p,2),h=o(m);h.__click=n;var _=c(h,2);_.__click=l;var x=c(u,2),k=o(x),g=o(k),S=c(k,2),D=o(S),y=c(o(D),2),j=o(y),z=c(D,2),R=c(o(z),2),X=o(R),I=c(z,2),U=c(o(I),2),W=o(U);G(()=>{es(p,e.part.gnc_file_path?"display: none;":""),Ue(k,"title",e.part.name),T(g,e.part.name),T(j,e.part.registration_number||"-"),T(X,`${s(r)??""} mm`),T(W,s(a))}),b(t,i),Xe()}Je(["click","keydown"]);var ku=w('<div class="message svelte-1y39gna"> </div>'),xu=w('<div class="modal-overlay svelte-1y39gna"><div class="modal svelte-1y39gna"><h2 class="svelte-1y39gna">Scanning Library</h2> <div class="progress-container svelte-1y39gna"><div class="progress-bar svelte-1y39gna"><div class="progress-fill svelte-1y39gna"></div></div> <span class="progress-text svelte-1y39gna"> </span></div> <div class="status svelte-1y39gna"><strong>Status:</strong> </div> <!> <div class="actions svelte-1y39gna"><button class="svelte-1y39gna"> </button></div></div></div>');function Su(t,e){He(e,!0);const a=Jr();let r=ut(e,"show",15,!1),n=ut(e,"progress",3,0),l=ut(e,"status",3,""),i=ut(e,"message",3,"");function u(){l()!=="scanning"&&(r(!1),a("close"))}var v=et(),d=Ee(v);{var p=m=>{var h=xu();h.__click=u;var _=o(h);_.__click=W=>W.stopPropagation();var x=c(o(_),2),k=o(x),g=o(k),S=c(k,2),D=o(S),y=c(x,2),j=c(o(y)),z=c(y,2);{var R=W=>{var K=ku(),O=o(K);G(()=>T(O,i())),b(W,K)};L(z,W=>{i()&&W(R)})}var X=c(z,2),I=o(X);I.__click=u;var U=o(I);G(()=>{es(g,`width: ${n()??""}%`),T(D,`${n()??""}%`),T(j,` ${l()??""}`),I.disabled=l()==="scanning",T(U,l()==="scanning"?"Scanning...":"Close")}),b(m,h)};L(d,m=>{r()&&m(p)})}b(t,v),Xe()}Je(["click"]);var Tu=w("<option> </option>"),qu=w('<div class="modal-overlay svelte-1fna2hh"><div class="modal svelte-1fna2hh"><h2 class="svelte-1fna2hh">Edit Part</h2> <div class="form svelte-1fna2hh"><div class="field svelte-1fna2hh"><label for="name" class="svelte-1fna2hh">Name</label> <input id="name" type="text" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="reg" class="svelte-1fna2hh">Registration Number</label> <input id="reg" type="text" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="width" class="svelte-1fna2hh">Width (mm)</label> <input id="width" type="number" step="0.01" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="height" class="svelte-1fna2hh">Height (mm)</label> <input id="height" type="number" step="0.01" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="material" class="svelte-1fna2hh">Material</label> <select id="material" class="svelte-1fna2hh"><option>No Material</option><!></select></div></div> <div class="actions svelte-1fna2hh"><button class="secondary svelte-1fna2hh">Cancel</button> <button class="primary svelte-1fna2hh">Save</button></div></div></div>');function Eu(t,e){He(e,!0);let a=ut(e,"show",15,!1),r=ut(e,"part",3,null),n=q(qe([])),l=q(qe({name:"",registration_number:"",width:0,height:0,material_id:null}));bt(()=>{a()&&r()&&(f(l,{name:r().name||"",registration_number:r().registration_number||"",width:r().width||0,height:r().height||0,material_id:r().material_id||null},!0),i())});async function i(){try{f(n,await ja(),!0)}catch(h){console.error("Failed to load materials:",h)}}function u(){a(!1)}function v(){e.onsave&&e.onsave(s(l)),u()}var d=et(),p=Ee(d);{var m=h=>{var _=qu();_.__click=u;var x=o(_);x.__click=le=>le.stopPropagation();var k=c(o(x),2),g=o(k),S=c(o(g),2),D=c(g,2),y=c(o(D),2),j=c(D,2),z=c(o(j),2),R=c(j,2),X=c(o(R),2),I=c(R,2),U=c(o(I),2),W=o(U);W.value=(W.__value=null)??"";var K=c(W);Ae(K,17,()=>s(n),Be,(le,me)=>{var _e=Tu(),ge=o(_e),be={};G(()=>{T(ge,s(me).name),be!==(be=s(me).id)&&(_e.value=(_e.__value=s(me).id)??"")}),b(le,_e)});var O=c(k,2),B=o(O);B.__click=u;var ce=c(B,2);ce.__click=v,je(S,()=>s(l).name,le=>s(l).name=le),je(y,()=>s(l).registration_number,le=>s(l).registration_number=le),je(z,()=>s(l).width,le=>s(l).width=le),je(X,()=>s(l).height,le=>s(l).height=le),lt(U,()=>s(l).material_id,le=>s(l).material_id=le),b(h,_)};L(p,h=>{a()&&h(m)})}b(t,d),Xe()}Je(["click"]);var ju=w('<img class="preview-img svelte-17z6zdn"/>'),Au=w('<div class="no-preview svelte-17z6zdn">No preview available</div>'),Pu=w('<div class="modal-backdrop svelte-17z6zdn"><div class="modal svelte-17z6zdn"><header class="svelte-17z6zdn"><h3 class="svelte-17z6zdn"> </h3> <button class="close-btn svelte-17z6zdn">&times;</button></header> <div class="content svelte-17z6zdn"><!> <div class="details svelte-17z6zdn"><p><strong>Registration:</strong> </p> <p><strong>Dimensions:</strong> </p></div></div></div></div>');function Cu(t,e){He(e,!0);let a=ut(e,"show",15,!1);function r(){a(!1)}function n(v){v.key==="Escape"&&r()}var l=et();na("keydown",tn,n);var i=Ee(l);{var u=v=>{var d=Pu();d.__click=r;var p=o(d);p.__click=I=>I.stopPropagation();var m=o(p),h=o(m),_=o(h),x=c(h,2);x.__click=r;var k=c(m,2),g=o(k);{var S=I=>{var U=ju();G(()=>{Ue(U,"src",`/uploads/thumbnails/${(e.part.registration_number||e.part.id)??""}.svg`),Ue(U,"alt",e.part.name)}),b(I,U)},D=I=>{var U=Au();b(I,U)};L(g,I=>{e.part.gnc_file_path?I(S):I(D,!1)})}var y=c(g,2),j=o(y),z=c(o(j)),R=c(j,2),X=c(o(R));G(()=>{T(_,e.part.name),T(z,` ${(e.part.registration_number||"-")??""}`),T(X,` ${(e.part.width||"?")??""} x ${(e.part.height||"?")??""} mm`)}),b(v,d)};L(i,v=>{a()&&e.part&&v(u)})}b(t,l),Xe()}Je(["click"]);var zu=w("<option> </option>"),Du=w('<div class="loading svelte-xfu7xu">Loading parts...</div>'),Ru=w('<div class="empty svelte-xfu7xu">No parts found matching filters.</div>'),Mu=w("<div></div>"),Nu=w('<div class="parts-layout svelte-xfu7xu"><aside class="sidebar svelte-xfu7xu"><h3 class="svelte-xfu7xu">Filters</h3> <div class="filter-group svelte-xfu7xu"><label for="search" class="svelte-xfu7xu">Search</label> <input id="search" type="text" placeholder="Name or Reg #" class="svelte-xfu7xu"/></div> <div class="filter-group svelte-xfu7xu"><label for="material" class="svelte-xfu7xu">Material</label> <select id="material" class="svelte-xfu7xu"><option>All Materials</option><!></select></div> <div class="filter-group svelte-xfu7xu"><label class="svelte-xfu7xu">Width (mm)</label> <div class="range svelte-xfu7xu"><input type="number" placeholder="Min" class="svelte-xfu7xu"/> <span>-</span> <input type="number" placeholder="Max" class="svelte-xfu7xu"/></div></div> <div class="filter-group svelte-xfu7xu"><label class="svelte-xfu7xu">Height (mm)</label> <div class="range svelte-xfu7xu"><input type="number" placeholder="Min" class="svelte-xfu7xu"/> <span>-</span> <input type="number" placeholder="Max" class="svelte-xfu7xu"/></div></div> <button class="reset-btn svelte-xfu7xu">Reset Filters</button></aside> <main class="content svelte-xfu7xu"><header class="svelte-xfu7xu"><div class="title-row svelte-xfu7xu"><h2 class="svelte-xfu7xu">Parts Library</h2></div> <div class="actions svelte-xfu7xu"><button>üîÑ Rescan Library</button> <button>‚Üª Refresh</button></div></header> <!></main> <!> <!> <!></div>');function Ou(t,e){He(e,!0);let a=q(qe([])),r=q(qe([])),n=q(""),l=q(""),i=q(""),u=q(""),v=q(""),d=q(""),p=q(!1),m=q(0);const h=50;let _=q(!1),x=q(0),k=q(""),g=q(""),S=q(!1),D=q(null),y=q(!1),j=q(null);async function z(){f(p,!0);try{const N={};s(n)&&(N.search=s(n)),s(l)&&(N.material_id=s(l)),s(i)&&(N.min_width=s(i)),s(u)&&(N.max_width=s(u)),s(v)&&(N.min_height=s(v)),s(d)&&(N.max_height=s(d));const[he,we]=await Promise.all([lo(s(m)*h,h,N),s(r).length===0?ja():Promise.resolve(s(r))]);f(a,he,!0),s(r).length===0&&f(r,we,!0)}catch(N){console.error(N),alert("Failed to load parts")}finally{f(p,!1)}}function R(){f(m,0),z()}let X;function I(){clearTimeout(X),X=setTimeout(()=>{R()},500)}async function U(){f(_,!0),f(x,0),f(k,"starting"),f(g,"Initializing scan...");try{await fo(N=>{f(x,N.percent||0,!0),f(k,N.status||"",!0),f(g,N.message||"",!0)}),s(k)==="complete"&&await z()}catch(N){console.error("Scan error:",N),f(k,"error"),f(g,`Scan failed: ${N.message}`)}}function W(N){f(D,N,!0),f(S,!0)}function K(N){f(j,N,!0),f(y,!0)}async function O(N){try{await po(s(D).id,N),await z(),alert("Part updated successfully"),f(S,!1)}catch(he){console.error("Update error:",he),alert("Failed to update part")}}At(()=>{z()});var B=Nu(),ce=o(B),le=c(o(ce),2),me=c(o(le),2);me.__input=I;var _e=c(le,2),ge=c(o(_e),2);ge.__change=R;var be=o(ge);be.value=be.__value="";var pe=c(be);Ae(pe,17,()=>s(r),Be,(N,he)=>{var we=zu(),M=o(we),A={};G(()=>{T(M,s(he).name),A!==(A=s(he).id)&&(we.value=(we.__value=s(he).id)??"")}),b(N,we)});var V=c(_e,2),se=c(o(V),2),P=o(se);P.__change=R;var E=c(P,4);E.__change=R;var $=c(V,2),ne=c(o($),2),Q=o(ne);Q.__change=R;var ye=c(Q,4);ye.__change=R;var Y=c($,2);Y.__click=()=>{f(n,""),f(l,""),f(i,""),f(u,""),f(v,""),f(d,""),R()};var H=c(ce,2),ee=o(H),te=c(o(ee),2),C=o(te);C.__click=U;var de=c(C,2);de.__click=()=>z();var ie=c(ee,2);{var Z=N=>{var he=Du();b(N,he)},ae=N=>{var he=et(),we=Ee(he);{var M=J=>{var Se=Ru();b(J,Se)},A=J=>{var Se=Mu();Oe(Se,1,"grid grid svelte-xfu7xu"),Ae(Se,21,()=>s(a),Ne=>Ne.id,(Ne,Me)=>{wu(Ne,{get part(){return s(Me)},onclick:()=>console.log("Part clicked",s(Me).id),onedit:W,onpreview:K})}),b(J,Se)};L(we,J=>{s(a).length===0?J(M):J(A,!1)},!0)}b(N,he)};L(ie,N=>{s(p)?N(Z):N(ae,!1)})}var oe=c(H,2);Su(oe,{get status(){return s(k)},get message(){return s(g)},get progress(){return s(x)},get show(){return s(_)},set show(N){f(_,N,!0)}});var re=c(oe,2);Eu(re,{get part(){return s(D)},onsave:O,get show(){return s(S)},set show(N){f(S,N,!0)}});var fe=c(re,2);Cu(fe,{get part(){return s(j)},get show(){return s(y)},set show(N){f(y,N,!0)}}),je(me,()=>s(n),N=>f(n,N)),lt(ge,()=>s(l),N=>f(l,N)),je(P,()=>s(i),N=>f(i,N)),je(E,()=>s(u),N=>f(u,N)),je(Q,()=>s(v),N=>f(v,N)),je(ye,()=>s(d),N=>f(d,N)),b(t,B),Xe()}Je(["input","change","click"]);Xl();var Lu=w('<div class="canvas-container svelte-1eph566"><div class="toolbar svelte-1eph566"><button title="Navigate (Pan)">‚úã</button> <button title="Select">‚Üñ</button></div>  <canvas class="svelte-1eph566"></canvas> <div class="zoom-controls svelte-1eph566"><button title="Reset Zoom" class="svelte-1eph566">‚ü≤</button> <span class="zoom-level svelte-1eph566"> </span></div></div>');function Iu(t,e){He(e,!1);let a=ut(e,"sheet",8,null),r=ut(e,"width",8,800),n=ut(e,"height",8,600);const l=Jr();let i=Ya(),u=null,v=1,d=Ya(1),p=0,m=0,h=Ya(!1),_=0,x=0,k=Ya("navigate"),g={minX:0,minY:0,maxX:100,maxY:100},S=0,D=0,y=null,j=null;At(()=>{s(i)&&(u=s(i).getContext("2d"),console.log("GncCanvas: mounted, ctx:",u),X())});function z(Y){let H=1/0,ee=1/0,te=-1/0,C=-1/0,de=!1,ie=0,Z=0;console.log("calculateBounds: sheet.parts.length =",Y.parts.length);for(const ae of Y.parts){console.log("calculateBounds: part.contours.length =",ae.contours.length);for(const oe of ae.contours){console.log("calculateBounds: contour.id =",oe.id,"commands.length =",oe.commands.length);for(const re of oe.commands)re.x!==void 0&&(ie=re.x),re.y!==void 0&&(Z=re.y),(re.x!==void 0||re.y!==void 0)&&(de=!0,ie<H&&(H=ie),ie>te&&(te=ie),Z<ee&&(ee=Z),Z>C&&(C=Z),console.log("calculateBounds: found point",ie,Z,"from cmd.type =",re.type))}}return console.log("calculateBounds: hasPoints =",de,"bounds =",{minX:H,minY:ee,maxX:te,maxY:C}),de?{minX:H,minY:ee,maxX:te,maxY:C}:{minX:0,minY:0,maxX:100,maxY:100}}function R(Y,H){return{x:(Y-S)/v+g.minX,y:(n()-H-D)/v+g.minY}}function X(){if(!u||!a()){console.log("GncCanvas draw: skipping - ctx:",!!u,"sheet:",!!a());return}console.log("GncCanvas draw: starting draw with sheet:",a()),u.fillStyle="#1e1e1e",u.fillRect(0,0,r(),n()),g=z(a()),console.log("GncCanvas draw: bounds:",g);const Y=g.maxX-g.minX,H=g.maxY-g.minY;if(Y===0&&H===0){console.log("GncCanvas draw: no data (dataW and dataH are 0)");return}const ee=20,te=r()-ee*2,C=n()-ee*2,de=te/Y,ie=C/H;v=Math.min(de,ie)*.95*s(d);const ae=Y*v,oe=H*v;S=(r()-ae)/2+p,D=(n()-oe)/2+m;const re=N=>S+(N-g.minX)*v,fe=N=>n()-(D+(N-g.minY)*v);a().parts.forEach((N,he)=>{const we=he*137%360;N.contours.forEach(M=>{const A=y===M.id,J=j===M.id;u.beginPath(),u.strokeStyle=A?"#ffffff":J?"#fbbf24":`hsl(${we}, 70%, 60%)`,u.lineWidth=A||J?3:1.5,u.shadowBlur=A?10:J?5:0,u.shadowColor=A?"#ffffff":J?"#fbbf24":"transparent";let Se=null,Ne=null,Me=!1;M.commands.forEach(xe=>{const tt=Se,Ye=Ne;if(xe.x!==void 0&&(Se=xe.x),xe.y!==void 0&&(Ne=xe.y),!(Se===null||Ne===null)){if(xe.type==="G00"||xe.command==="G"&&xe.value===0)u.moveTo(re(Se),fe(Ne)),Me=!0;else if(xe.type==="G01"||xe.command==="G"&&xe.value===1||xe.type==="MODAL"||xe.type==="G41"||xe.type==="G40")Me?u.lineTo(re(Se),fe(Ne)):(u.moveTo(re(Se),fe(Ne)),Me=!0);else if((xe.type==="G02"||xe.type==="G03"||xe.command==="G"&&(xe.value===2||xe.value===3))&&xe.i!==void 0&&xe.j!==void 0&&tt!==null&&Ye!==null){const ve=xe.i,F=xe.j,ue=tt+ve,ke=Ye+F,Te=Math.sqrt(ve*ve+F*F),Pe=re(ue),Ve=fe(ke),Fe=Te*v,at=Math.atan2(fe(Ye)-Ve,re(tt)-Pe),We=Math.atan2(fe(Ne)-Ve,re(Se)-Pe),rt=xe.type==="G02"||xe.command==="G"&&xe.value===2;u.arc(Pe,Ve,Fe,at,We,rt)}}}),u.stroke(),u.shadowBlur=0})})}function I(Y,H){if(!a())return null;const ee=s(i).getBoundingClientRect(),te=Y-ee.left,C=H-ee.top,de=R(te,C),ie=de.x,Z=de.y,ae=5/v;let oe=null,re=null,fe=1/0;for(const N of a().parts)for(const he of N.contours){let we=null,M=null,A=1/0;for(const J of he.commands){const Se=J.x!==void 0?J.x:we,Ne=J.y!==void 0?J.y:M;let Me=1/0;if(we!==null&&M!==null&&Se!==null&&Ne!==null){if(J.type==="G01"||J.command==="G"&&J.value===1||J.type==="MODAL"||J.type==="G41"||J.type==="G40")Me=W(ie,Z,we,M,Se,Ne);else if(J.type==="G02"||J.type==="G03"||J.command==="G"&&(J.value===2||J.value===3)){const xe=J.i||0,tt=J.j||0,Ye=we+xe,ve=M+tt,F=Math.sqrt(xe*xe+tt*tt),ue=Math.sqrt((ie-Ye)**2+(Z-ve)**2);Me=Math.abs(ue-F);const ke=Math.atan2(M-ve,we-Ye),Te=Math.atan2(Ne-ve,Se-Ye),Pe=Math.atan2(Z-ve,ie-Ye),Ve=J.type==="G02"||J.command==="G"&&J.value===2;me(Pe,ke,Te,Ve)||(Me=1/0)}}Me<A&&(A=Me),we=Se,M=Ne}A<ae&&A<fe&&(fe=A,oe=he,re=N)}return oe?{contour:oe,part:re}:null}function U(Y){const H=I(Y.clientX,Y.clientY);H?(y=H.contour.id,l("select",H)):(y=null,l("select",null)),X()}function W(Y,H,ee,te,C,de){const ie=Y-ee,Z=H-te,ae=C-ee,oe=de-te,re=ie*ae+Z*oe,fe=ae*ae+oe*oe;let N=-1;fe!=0&&(N=re/fe);let he,we;N<0?(he=ee,we=te):N>1?(he=C,we=de):(he=ee+N*ae,we=te+N*oe);const M=Y-he,A=H-we;return Math.sqrt(M*M+A*A)}function K(Y){Y.preventDefault();const H=s(i).getBoundingClientRect(),ee=Y.clientX-H.left,te=Y.clientY-H.top,C=R(ee,te),de=Y.deltaY>0?.9:1.1,ie=Math.max(.1,Math.min(10,s(d)*de));if(v===0||s(d)===0)return;const ae=v/s(d)*ie,oe=g.maxX-g.minX,re=g.maxY-g.minY,fe=oe*ae,N=re*ae,he=ee-(C.x-g.minX)*ae,we=n()-te-(C.y-g.minY)*ae;p=he-(r()-fe)/2,m=we-(n()-N)/2,f(d,ie),X()}function O(Y){_=Y.clientX,x=Y.clientY,s(k)==="navigate"&&f(h,!0)}function B(Y){if(s(k)==="navigate"&&s(h)){const H=Y.clientX-_,ee=Y.clientY-x;p+=H,m-=ee,_=Y.clientX,x=Y.clientY,X()}else if(s(k)==="select"){const H=I(Y.clientX,Y.clientY),ee=H?H.contour.id:null;ee!==j&&(j=ee,X())}}function ce(){j!==null&&(j=null,X()),s(h)&&f(h,!1)}function le(Y){const H=Math.abs(Y.clientX-_),ee=Math.abs(Y.clientY-x),te=H<5&&ee<5;s(k)==="navigate"?f(h,!1):s(k)==="select"&&te&&U(Y)}function me(Y,H,ee,te){const C=Math.PI*2,de=(Y%C+C)%C,ie=(H%C+C)%C,Z=(ee%C+C)%C;if(te){const ae=(ie-Z+C)%C;return(ie-de+C)%C<=ae}else{const ae=(Z-ie+C)%C;return(de-ie+C)%C<=ae}}function _e(){f(d,1),p=0,m=0,X()}pi(()=>(Yr(a()),s(i)),()=>{a()&&s(i)&&(console.log("GncCanvas: sheet changed, redrawing...",a()),X())}),hi(),Zr();var ge=Lu(),be=o(ge),pe=o(be);pe.__click=()=>f(k,"navigate");let V;var se=c(pe,2);se.__click=()=>f(k,"select");let P;var E=c(be,2);E.__mousedown=O,E.__mousemove=B,E.__mouseup=le,Sn(E,Y=>f(i,Y),()=>s(i));var $=c(E,2),ne=o($);ne.__click=_e;var Q=c(ne,2),ye=o(Q);G(Y=>{es(ge,`width: ${r()??""}px; height: ${n()??""}px;`),V=Oe(pe,1,"svelte-1eph566",null,V,{active:s(k)==="navigate"}),P=Oe(se,1,"svelte-1eph566",null,P,{active:s(k)==="select"}),Ue(E,"width",r()),Ue(E,"height",n()),es(E,`cursor: ${s(k)==="navigate"?s(h)?"grabbing":"grab":"default"}`),T(ye,`${Y??""}%`)},[()=>(s(d),_a(()=>Math.round(s(d)*100)))]),na("wheel",E,K),na("mouseleave",E,ce),b(t,ge),Xe()}Je(["click","mousedown","mousemove","mouseup"]);var $u=w('<span class="filename svelte-57krl6"> </span>'),Fu=w('<div class="loading svelte-57krl6">Parsing GNC file...</div>'),Bu=w('<div class="placeholder svelte-57krl6"><p>No file loaded.</p> <p class="hint svelte-57krl6">Upload a .GNC file to visualize and edit.</p></div>'),Gu=w('<p class="hint-text svelte-57krl6">Load a GNC file to view properties.</p>'),Uu=w('<h3 class="svelte-57krl6">Sheet Properties</h3> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Program Size (mm):</span> <div class="inline-inputs svelte-57krl6"><input type="number" step="0.1" class="svelte-57krl6"/> <span class="svelte-57krl6">√ó</span> <input type="number" step="0.1" class="svelte-57krl6"/></div></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Thickness (mm):</span> <input type="number" step="0.1"/></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Cut Count:</span> <input type="number" min="1"/></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Material:</span> <span class="value svelte-57krl6"> </span></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Total Parts:</span> <span class="value svelte-57krl6"> </span></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Total Contours:</span> <span class="value svelte-57krl6"> </span></div>',1),Yu=w("<option> </option>"),Hu=w('<div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Part Name:</span> <span class="value svelte-57krl6"> </span></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Contours:</span> <span class="value svelte-57krl6"> </span></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Corner Count:</span> <span class="value svelte-57krl6"> </span></div>',1),Xu=w('<h3 class="svelte-57krl6">Part Properties</h3> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Select Part:</span> <select></select></div> <!>',1),Wu=w('<div class="prop-field svelte-57krl6"><label class="svelte-57krl6"> </label> <input type="text" class="svelte-57krl6"/></div>'),Zu=w('<p class="empty-props">No technological parameters found.</p>'),Ju=w('<div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Contour ID:</span> <span class="value svelte-57krl6"> </span></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Corners:</span> <span class="value svelte-57krl6"> </span></div> <h4 class="section-title svelte-57krl6">Technology Parameters</h4> <div class="p-codes-list"><!></div>',1),Vu=w(`<p class="hint-text svelte-57krl6">Select a contour on the canvas to view and edit its
                        properties.</p>`),Qu=w('<h3 class="svelte-57krl6">Contour Properties</h3> <!>',1),Ku=w('<div class="view-container svelte-57krl6"><div class="header svelte-57krl6"><h2 class="svelte-57krl6">GNC Editor</h2> <div class="actions svelte-57krl6"><input type="file" id="gnc-upload" accept=".gnc,.nc" class="file-input svelte-57krl6"/> <label for="gnc-upload" class="upload-btn svelte-57krl6">Open File</label> <!> <button class="save-btn svelte-57krl6">Save Changes</button></div></div> <div class="workspace svelte-57krl6"><div class="canvas-area svelte-57krl6"><!></div> <div class="properties-panel svelte-57krl6"><div class="mode-selector svelte-57krl6"><button>Sheet</button> <button>Part</button> <button>Contour</button></div> <!></div></div></div>');function ed(t,e){He(e,!0);let a=q(null),r=q(null),n=q(""),l=q(!1),i=q("sheet"),u=q(null);async function v(V){const se=V.target.files[0];if(se){f(n,se.name,!0),f(l,!0),f(a,null),f(r,null);try{f(a,await vo(se),!0),console.log("Parsed GNC sheet:",s(a)),console.log("Parts:",s(a)?.parts),console.log("Total parts:",s(a)?.total_parts),s(a)?.parts?.length>0&&f(u,s(a).parts[0].id,!0)}catch(P){alert("Error parsing GNC file"),console.error(P)}finally{f(l,!1)}}}function d(V){const se=V.detail;if(!se){f(r,null);return}se.contour?(f(r,se.contour,!0),se.part?(f(u,se.part.id,!0),s(i)==="sheet"&&f(i,"contour")):f(i,"contour")):(f(r,se,!0),f(i,"contour"))}async function p(){if(!(!s(a)||!s(n)))try{const V=await uo(s(a),s(n),!0);alert(`Saved successfully to ${V.path}`)}catch{alert("Failed to save file")}}function m(V,se){s(r)&&s(r).metadata&&(s(r).metadata[V]=se)}function h(V,se){s(a)&&(s(a)[V]=se)}let _=st(()=>s(a)?.parts?.find(V=>V.id===s(u)));var x=Ku(),k=o(x),g=c(o(k),2),S=o(g);S.__change=v;var D=c(S,4);{var y=V=>{var se=$u(),P=o(se);G(()=>T(P,s(n))),b(V,se)};L(D,V=>{s(n)&&V(y)})}var j=c(D,2);j.__click=p;var z=c(k,2),R=o(z),X=o(R);{var I=V=>{var se=Fu();b(V,se)},U=V=>{var se=et(),P=Ee(se);{var E=ne=>{Iu(ne,{get sheet(){return s(a)},width:800,height:600,$$events:{select:d}})},$=ne=>{var Q=Bu();b(ne,Q)};L(P,ne=>{s(a)?ne(E):ne($,!1)},!0)}b(V,se)};L(X,V=>{s(l)?V(I):V(U,!1)})}var W=c(R,2),K=o(W),O=o(K);O.__click=()=>f(i,"sheet");let B;var ce=c(O,2);ce.__click=()=>f(i,"part");let le;var me=c(ce,2);me.__click=()=>f(i,"contour");let _e;var ge=c(K,2);{var be=V=>{var se=Gu();b(V,se)},pe=V=>{var se=et(),P=Ee(se);{var E=ne=>{var Q=Uu(),ye=c(Ee(Q),2),Y=c(o(ye),2),H=o(Y);H.__input=A=>h("program_width",parseFloat(A.target.value));var ee=c(H,4);ee.__input=A=>h("program_height",parseFloat(A.target.value));var te=c(ye,2),C=c(o(te),2);C.__input=A=>h("thickness",parseFloat(A.target.value));var de=c(te,2),ie=c(o(de),2);ie.__input=A=>h("cut_count",parseInt(A.target.value));var Z=c(de,2),ae=c(o(Z),2),oe=o(ae),re=c(Z,2),fe=c(o(re),2),N=o(fe),he=c(re,2),we=c(o(he),2),M=o(we);G(()=>{Ba(H,s(a).program_width||0),Ba(ee,s(a).program_height||0),Ba(C,s(a).thickness||0),Ba(ie,s(a).cut_count||1),T(oe,s(a).material||"N/A"),T(N,s(a).total_parts),T(M,s(a).total_contours)}),b(ne,Q)},$=ne=>{var Q=et(),ye=Ee(Q);{var Y=ee=>{var te=Xu(),C=c(Ee(te),2),de=c(o(C),2);Ae(de,21,()=>s(a).parts,Be,(ae,oe)=>{var re=Yu(),fe=o(re),N={};G(()=>{T(fe,s(oe).name||`Part ${s(oe).id}`),N!==(N=s(oe).id)&&(re.value=(re.__value=s(oe).id)??"")}),b(ae,re)});var ie=c(C,2);{var Z=ae=>{var oe=Hu(),re=Ee(oe),fe=c(o(re),2),N=o(fe),he=c(re,2),we=c(o(he),2),M=o(we),A=c(he,2),J=c(o(A),2),Se=o(J);G(()=>{T(N,s(_).name||"N/A"),T(M,s(_).contours.length),T(Se,s(_).corner_count)}),b(ae,oe)};L(ie,ae=>{s(_)&&ae(Z)})}lt(de,()=>s(u),ae=>f(u,ae)),b(ee,te)},H=ee=>{var te=et(),C=Ee(te);{var de=ie=>{var Z=Qu(),ae=c(Ee(Z),2);{var oe=fe=>{var N=Ju(),he=Ee(N),we=c(o(he),2),M=o(we),A=c(he,2),J=c(o(A),2),Se=o(J),Ne=c(A,4),Me=o(Ne);{var xe=Ye=>{var ve=et(),F=Ee(ve);Ae(F,17,()=>Object.entries(s(r).metadata),Be,(ue,ke)=>{var Te=st(()=>un(s(ke),2));let Pe=()=>s(Te)[0],Ve=()=>s(Te)[1];var Fe=et(),at=Ee(Fe);{var We=rt=>{var St=Wu(),Pt=o(St),ga=o(Pt),ma=c(Pt,2);ma.__input=ba=>m(Pe(),ba.target.value),G(()=>{Ue(Pt,"for",Pe()),T(ga,Pe()),Ue(ma,"id",Pe()),Ba(ma,Ve())}),b(rt,St)};L(at,rt=>{Pe().startsWith("P")&&rt(We)})}b(ue,Fe)}),b(Ye,ve)},tt=Ye=>{var ve=Zu();b(Ye,ve)};L(Me,Ye=>{s(r).metadata?Ye(xe):Ye(tt,!1)})}G(()=>{T(M,`#${s(r).id??""}`),T(Se,s(r).corner_count)}),b(fe,N)},re=fe=>{var N=Vu();b(fe,N)};L(ae,fe=>{s(r)?fe(oe):fe(re,!1)})}b(ie,Z)};L(C,ie=>{s(i)==="contour"&&ie(de)},!0)}b(ee,te)};L(ye,ee=>{s(i)==="part"?ee(Y):ee(H,!1)},!0)}b(ne,Q)};L(P,ne=>{s(i)==="sheet"?ne(E):ne($,!1)},!0)}b(V,se)};L(ge,V=>{s(a)?V(pe,!1):V(be)})}G(()=>{j.disabled=!s(a),B=Oe(O,1,"svelte-57krl6",null,B,{active:s(i)==="sheet"}),le=Oe(ce,1,"svelte-57krl6",null,le,{active:s(i)==="part"}),_e=Oe(me,1,"svelte-57krl6",null,_e,{active:s(i)==="contour"})}),b(t,x),Xe()}Je(["change","click","input"]);var td=w("<option> </option>"),ad=w('<div class="form-panel svelte-gim6qq"><h3>New Stock Item</h3> <div class="form-grid svelte-gim6qq"><div class="field svelte-gim6qq"><label class="svelte-gim6qq">Material</label> <select class="svelte-gim6qq"><option>Select Material...</option><!></select></div> <div class="field svelte-gim6qq"><label class="svelte-gim6qq">Width (mm)</label> <input type="number" min="0" class="svelte-gim6qq"/></div> <div class="field svelte-gim6qq"><label class="svelte-gim6qq">Height (mm)</label> <input type="number" min="0" class="svelte-gim6qq"/></div> <div class="field svelte-gim6qq"><label class="svelte-gim6qq">Quantity</label> <input type="number" min="0" class="svelte-gim6qq"/></div> <div class="field svelte-gim6qq"><label class="svelte-gim6qq">Location</label> <input type="text" placeholder="e.g. A-01" class="svelte-gim6qq"/></div> <div class="actions"><button class="save-btn svelte-gim6qq">Save Item</button></div></div></div>'),sd=w('<p class="loading svelte-gim6qq">Loading stock...</p>'),nd=w('<div class="empty-state svelte-gim6qq"><p>No stock items found.</p></div>'),rd=w('<tr><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"><button class="delete-btn svelte-gim6qq">Delete</button></td></tr>'),ld=w('<div class="table-container svelte-gim6qq"><table class="svelte-gim6qq"><thead><tr><th class="svelte-gim6qq">Material</th><th class="svelte-gim6qq">Dimensions</th><th class="svelte-gim6qq">Qty</th><th class="svelte-gim6qq">Reserved</th><th class="svelte-gim6qq">Location</th><th class="svelte-gim6qq">Actions</th></tr></thead><tbody></tbody></table></div>'),id=w('<div class="view-container svelte-gim6qq"><div class="header svelte-gim6qq"><h2 class="svelte-gim6qq">Stock Management</h2> <button class="primary-btn svelte-gim6qq"> </button></div> <!> <!></div>');function od(t,e){He(e,!0);let a=q(qe([])),r=q(qe([])),n=q(!0),l=q(!1),i=q(qe({material_id:"",width:0,height:0,quantity:0,location:""}));async function u(){f(n,!0);try{const[y,j]=await Promise.all([io(),ja()]);f(a,y,!0),f(r,j,!0)}catch(y){console.error(y)}finally{f(n,!1)}}async function v(){if(s(i).material_id)try{const y=await oo(s(i));f(a,[...s(a),y],!0),f(l,!1),f(i,{material_id:"",width:0,height:0,quantity:0,location:""},!0)}catch(y){alert("Failed to add stock item"),console.error(y)}}async function d(y){if(confirm("Are you sure you want to delete this item?"))try{await co(y),f(a,s(a).filter(j=>j.id!==y),!0)}catch{alert("Failed to delete item")}}At(u);var p=id(),m=o(p),h=c(o(m),2);h.__click=()=>f(l,!s(l));var _=o(h),x=c(m,2);{var k=y=>{var j=ad(),z=c(o(j),2),R=o(z),X=c(o(R),2),I=o(X);I.value=I.__value="";var U=c(I);Ae(U,17,()=>s(r),Be,(pe,V)=>{var se=td(),P=o(se),E={};G(()=>{T(P,s(V).name),E!==(E=s(V).id)&&(se.value=(se.__value=s(V).id)??"")}),b(pe,se)});var W=c(R,2),K=c(o(W),2),O=c(W,2),B=c(o(O),2),ce=c(O,2),le=c(o(ce),2),me=c(ce,2),_e=c(o(me),2),ge=c(me,2),be=o(ge);be.__click=v,lt(X,()=>s(i).material_id,pe=>s(i).material_id=pe),je(K,()=>s(i).width,pe=>s(i).width=pe),je(B,()=>s(i).height,pe=>s(i).height=pe),je(le,()=>s(i).quantity,pe=>s(i).quantity=pe),je(_e,()=>s(i).location,pe=>s(i).location=pe),b(y,j)};L(x,y=>{s(l)&&y(k)})}var g=c(x,2);{var S=y=>{var j=sd();b(y,j)},D=y=>{var j=et(),z=Ee(j);{var R=I=>{var U=nd();b(I,U)},X=I=>{var U=ld(),W=o(U),K=c(o(W));Ae(K,21,()=>s(a),Be,(O,B)=>{var ce=rd(),le=o(ce),me=o(le),_e=c(le),ge=o(_e),be=c(_e),pe=o(be),V=c(be),se=o(V),P=c(V),E=o(P),$=c(P),ne=o($);ne.__click=()=>d(s(B).id),G(()=>{T(me,s(B).material?s(B).material.name:"Unknown"),T(ge,`${s(B).width??""} x ${s(B).height??""}`),T(pe,s(B).quantity),T(se,s(B).reserved),T(E,s(B).location||"-")}),b(O,ce)}),b(I,U)};L(z,I=>{s(a).length===0?I(R):I(X,!1)},!0)}b(y,j)};L(g,y=>{s(n)?y(S):y(D,!1)})}G(()=>T(_,s(l)?"Cancel":"Add Stock")),b(t,p),Xe()}Je(["click"]);const dl=qe({userRole:(typeof window<"u"?localStorage.getItem("user_role"):"admin")||"admin",configStatus:"unknown",currentDocument:null,settings:{ocrUrl:"",docNameRegex:"",syncMihtavPath:"",syncSidraPath:""}});function cd(t){dl.configStatus=t}var vd=w("<p> </p>"),ud=w(`<div class="setup-container svelte-1125czv"><div class="card svelte-1125czv"><h1 class="svelte-1125czv">Welcome to DocuFlow</h1> <p class="subtitle svelte-1125czv">Please configure the database connection.</p> <div class="field svelte-1125czv"><label for="db-path" class="svelte-1125czv">Database File Path</label> <p class="help-text svelte-1125czv">Enter the full path to the SQLite database file. For network
                sharing, use a path on the shared drive (e.g., <code>Z:\\DocuFlow\\data.db</code>).</p> <div class="input-group svelte-1125czv"><input id="db-path" type="text" placeholder="C:\\DocuFlow\\data.db" class="svelte-1125czv"/> <button class="svelte-1125czv"> </button></div> <!></div> <div class="actions"><button class="primary svelte-1125czv"> </button></div></div></div>`);function dd(t,e){He(e,!0);let a=q(""),r=q(!1),n=q(null),l=q(!1);At(async()=>{try{const z=await(await fetch("/api/config")).json();z.database_path&&f(a,z.database_path,!0)}catch(j){console.error(j)}});async function i(){if(s(a)){f(r,!0),f(n,null);try{const z=await(await fetch("/api/test-path",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:s(a)})})).json();f(n,{ok:z.accessible||!z.exists,message:z.accessible?"Path exists and is readable.":z.exists?"Path exists but not readable.":"File does not exist (will be created)."},!0)}catch(j){f(n,{ok:!1,message:j.message},!0)}finally{f(r,!1)}}}async function u(){f(l,!0);try{(await(await fetch("/api/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({database_path:s(a)})})).json()).ok?(alert("Configuration saved. Please restart the application (Server) to apply changes."),dl.configStatus="configured",Ut("/")):alert("Failed to save config.")}catch(j){alert("Error saving config: "+j.message)}finally{f(l,!1)}}var v=ud(),d=o(v),p=c(o(d),4),m=c(o(p),4),h=o(m),_=c(h,2);_.__click=i;var x=o(_),k=c(m,2);{var g=j=>{var z=vd(),R=o(z);G(()=>{Oe(z,1,`result ${s(n).ok?"success":"warn"}`,"svelte-1125czv"),T(R,s(n).message)}),b(j,z)};L(k,j=>{s(n)&&j(g)})}var S=c(p,2),D=o(S);D.__click=u;var y=o(D);G(()=>{_.disabled=s(r),T(x,s(r)?"Testing...":"Test Path"),D.disabled=s(l)||!s(a),T(y,s(l)?"Saving...":"Save Configuration")}),je(h,()=>s(a),j=>f(a,j)),b(t,v),Xe()}Je(["click"]);const fd={"/":xo,"/documents":Jv,"/journal":cu,"/job":mu,"/parts":Ou,"/gnc":ed,"/stock":od,"/setup":dd};var pd=w('<aside class="sidebar svelte-1nhzsi7"><div class="sidebar-header svelte-1nhzsi7"><span class="logo-icon svelte-1nhzsi7">DF</span></div> <nav class="svelte-1nhzsi7"><button><span class="icon svelte-1nhzsi7">üìä</span> <span class="label svelte-1nhzsi7">Dashboard</span></button> <button><span class="icon svelte-1nhzsi7">üìÑ</span> <span class="label svelte-1nhzsi7">Documents</span></button> <button><span class="icon svelte-1nhzsi7">‚öôÔ∏è</span> <span class="label svelte-1nhzsi7">Parts Library</span></button> <button><span class="icon svelte-1nhzsi7">üìê</span> <span class="label svelte-1nhzsi7">GNC Editor</span></button> <button><span class="icon svelte-1nhzsi7">üë∑</span> <span class="label svelte-1nhzsi7">Job Processing</span></button> <button><span class="icon svelte-1nhzsi7">üì¶</span> <span class="label svelte-1nhzsi7">Stock</span></button> <button><span class="icon svelte-1nhzsi7">üìì</span> <span class="label svelte-1nhzsi7">Journal</span></button></nav></aside>');function hd(t,e){He(e,!1),Zr();var a=pd(),r=c(o(a),2),n=o(r);n.__click=()=>Ut("/");let l;var i=c(n,2);i.__click=()=>Ut("/documents");let u;var v=c(i,2);v.__click=()=>Ut("/parts");let d;var p=c(v,2);p.__click=()=>Ut("/gnc");let m;var h=c(p,2);h.__click=()=>Ut("/job");let _;var x=c(h,2);x.__click=()=>Ut("/stock");let k;var g=c(x,2);g.__click=()=>Ut("/journal");let S;G((D,y,j,z,R,X)=>{l=Oe(n,1,"svelte-1nhzsi7",null,l,{active:ca.path==="/"}),u=Oe(i,1,"svelte-1nhzsi7",null,u,D),d=Oe(v,1,"svelte-1nhzsi7",null,d,y),m=Oe(p,1,"svelte-1nhzsi7",null,m,j),_=Oe(h,1,"svelte-1nhzsi7",null,_,z),k=Oe(x,1,"svelte-1nhzsi7",null,k,R),S=Oe(g,1,"svelte-1nhzsi7",null,S,X)},[()=>({active:ca.path.includes("/documents")}),()=>({active:ca.path.includes("/parts")}),()=>({active:ca.path.includes("/gnc")}),()=>({active:ca.path.includes("/job")}),()=>({active:ca.path.includes("/stock")}),()=>({active:ca.path.includes("/journal")})]),b(t,a),Xe()}Je(["click"]);var _d=w("<p>Loading...</p>"),gd=w("<span> </span>"),md=w("<span> </span>"),bd=w('<div class="field svelte-w0yg29"><label for="regex" class="svelte-w0yg29">Document Name Regex</label> <input id="regex" type="text" placeholder="Regex Pattern" class="svelte-w0yg29"/></div> <hr class="divider svelte-w0yg29"/> <h3 class="section-title svelte-w0yg29">Sync Folder Paths</h3> <p class="section-hint svelte-w0yg29">Configure paths to network folders for automatic file import.</p> <div class="field path-field svelte-w0yg29"><label for="mihtav-path" class="svelte-w0yg29">Mihtav (Orders) Path</label> <div class="path-input-group svelte-w0yg29"><input id="mihtav-path" type="text" placeholder="Z:\\Mihtavim or \\\\server\\share\\orders" class="svelte-w0yg29"/> <button class="test-btn svelte-w0yg29"> </button></div> <!></div> <div class="field path-field svelte-w0yg29"><label for="sidra-path" class="svelte-w0yg29">Sidra (Parts Library) Path</label> <div class="path-input-group svelte-w0yg29"><input id="sidra-path" type="text" placeholder="Z:\\Sidra or \\\\server\\share\\parts" class="svelte-w0yg29"/> <button class="test-btn svelte-w0yg29"> </button></div> <!></div> <div class="field svelte-w0yg29"><label for="role" class="svelte-w0yg29">User Mode (Simulated)</label> <select id="role" class="svelte-w0yg29"><option>Operator (Read-Only)</option><option>Admin (Full Access)</option></select> <p class="hint svelte-w0yg29">Switching mode will reload the application.</p></div>',1),yd=w('<div class="modal-content svelte-w0yg29"><h2 class="svelte-w0yg29">Settings</h2> <!> <div class="actions svelte-w0yg29"><button class="cancel-btn svelte-w0yg29">Cancel</button> <button class="save-btn svelte-w0yg29">Save</button></div></div>');function wd(t,e){He(e,!0);let a=ut(e,"isOpen",3,!1),r=q(""),n=q("admin"),l=q(""),i=q(""),u=q(!0),v=qe({mihtav:!1,sidra:!1}),d=q(qe({mihtav:null,sidra:null}));async function p(){f(u,!0);try{const[g,S,D]=await Promise.all([Xs("doc_name_regex").catch(()=>({value:""})),Xs("sync_mihtav_path").catch(()=>({value:""})),Xs("sync_sidra_path").catch(()=>({value:""}))]);f(r,g.value||"",!0),f(l,S.value||"",!0),f(i,D.value||"",!0);const y=localStorage.getItem("user_role");y&&f(n,y,!0)}catch(g){console.error(g)}finally{f(u,!1)}}async function m(g){const S=s(g==="mihtav"?l:i);if(!S){s(d)[g]={accessible:!1,error:"Path is empty"};return}v[g]=!0;try{const D=await Yi(S);s(d)[g]={accessible:D.ok,error:D.error}}catch(D){s(d)[g]={accessible:!1,error:D.message}}finally{v[g]=!1}}async function h(){try{await Promise.all([Ws("doc_name_regex",s(r)),Ws("sync_mihtav_path",s(l)),Ws("sync_sidra_path",s(i))]),localStorage.setItem("user_role",s(n)),window.location.reload(),e.close()}catch(g){alert("Failed to save settings. Ensure you have Admin privileges."),console.error(g)}}bt(()=>{a()&&(p(),f(d,{mihtav:null,sidra:null},!0))});var _=et(),x=Ee(_);{var k=g=>{var S=yd(),D=c(o(S),2);{var y=I=>{var U=_d();b(I,U)},j=I=>{var U=bd(),W=Ee(U),K=c(o(W),2),O=c(W,8),B=c(o(O),2),ce=o(B),le=c(ce,2);le.__click=()=>m("mihtav");var me=o(le),_e=c(B,2);{var ge=H=>{var ee=gd();let te;var C=o(ee);G(()=>{te=Oe(ee,1,"test-result svelte-w0yg29",null,te,{success:s(d).mihtav.accessible,error:!s(d).mihtav.accessible}),T(C,s(d).mihtav.accessible?"‚úì Path accessible":`‚úó ${s(d).mihtav.error||"Path not accessible"}`)}),b(H,ee)};L(_e,H=>{s(d).mihtav&&H(ge)})}var be=c(O,2),pe=c(o(be),2),V=o(pe),se=c(V,2);se.__click=()=>m("sidra");var P=o(se),E=c(pe,2);{var $=H=>{var ee=md();let te;var C=o(ee);G(()=>{te=Oe(ee,1,"test-result svelte-w0yg29",null,te,{success:s(d).sidra.accessible,error:!s(d).sidra.accessible}),T(C,s(d).sidra.accessible?"‚úì Path accessible":`‚úó ${s(d).sidra.error||"Path not accessible"}`)}),b(H,ee)};L(E,H=>{s(d).sidra&&H($)})}var ne=c(be,2),Q=c(o(ne),2),ye=o(Q);ye.value=ye.__value="operator";var Y=c(ye);Y.value=Y.__value="admin",G(()=>{le.disabled=v.mihtav,T(me,v.mihtav?"Testing...":"Test"),se.disabled=v.sidra,T(P,v.sidra?"Testing...":"Test")}),je(K,()=>s(r),H=>f(r,H)),je(ce,()=>s(l),H=>f(l,H)),je(V,()=>s(i),H=>f(i,H)),lt(Q,()=>s(n),H=>f(n,H)),b(I,U)};L(D,I=>{s(u)?I(y):I(j,!1)})}var z=c(D,2),R=o(z);R.__click=function(...I){e.close?.apply(this,I)};var X=c(R,2);X.__click=h,b(g,S)};L(x,g=>{a()&&g(k)})}b(t,_),Xe()}Je(["click"]);var kd=w('<div class="app-container svelte-1n46o8q"><!> <main class="main-content svelte-1n46o8q"><div class="top-bar svelte-1n46o8q"><div class="spacer svelte-1n46o8q"></div> <button class="settings-btn svelte-1n46o8q" title="Settings">‚öôÔ∏è</button></div> <div class="route-content svelte-1n46o8q"><!></div></main> <!></div>');function xd(t,e){He(e,!0);let a=q(!1);At(async()=>{try{const x=await(await fetch("/api/config-check")).json();cd(x.status),x.needs_setup&&Ut("/setup")}catch(_){console.error("Config check failed",_),Ut("/setup")}});function r(){f(a,!0)}var n=kd(),l=o(n);{var i=_=>{hd(_,{})};L(l,_=>{ca.path!=="/setup"&&_(i)})}var u=c(l,2),v=o(u),d=c(o(v),2);d.__click=r;var p=c(v,2),m=o(p);Gi(m,{get routes(){return fd}});var h=c(u,2);jn(h,{get isOpen(){return s(a)},close:()=>f(a,!1),children:(_,x)=>{wd(_,{get isOpen(){return s(a)},close:()=>f(a,!1)})},$$slots:{default:!0}}),b(t,n),Xe()}Je(["click"]);window.onerror=function(t,e,a,r,n){const l=document.createElement("div");l.style.position="fixed",l.style.top="0",l.style.left="0",l.style.width="100%",l.style.background="#fee2e2",l.style.color="#991b1b",l.style.padding="20px",l.style.zIndex="999999",l.style.borderBottom="2px solid #7f1d1d",l.innerHTML=`<strong>Error:</strong> ${t}<br><small>${e}:${a}:${r}</small><pre>${n?.stack||""}</pre>`,document.body.appendChild(l)};window.onunhandledrejection=function(t){const e=document.createElement("div");e.innerHTML+=`<br><strong>Unhandled Rejection:</strong> ${t.reason}`,document.body.prepend(e)};Si(xd,{target:document.getElementById("app")});
