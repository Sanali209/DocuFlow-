(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();const sn=!1;var Gs=Array.isArray,Ci=Array.prototype.indexOf,Ys=Array.from,Di=Object.defineProperty,Za=Object.getOwnPropertyDescriptor,mr=Object.getOwnPropertyDescriptors,Ri=Object.prototype,zi=Array.prototype,mn=Object.getPrototypeOf,Vn=Object.isExtensible;function Mi(t){return t()}function nn(t){for(var e=0;e<t.length;e++)t[e]()}function br(){var t,e,s=new Promise((r,n)=>{t=r,e=n});return{promise:s,resolve:t,reject:e}}function bn(t,e){if(Array.isArray(t))return t;if(!(Symbol.iterator in t))return Array.from(t);const s=[];for(const r of t)if(s.push(r),s.length===e)break;return s}const Lt=2,Os=4,xs=8,yr=1<<24,xa=16,Sa=32,Ga=64,yn=128,sa=512,Ft=1024,Gt=2048,Ta=4096,ea=8192,ga=16384,wn=32768,Ra=65536,Zn=1<<17,wr=1<<18,as=1<<19,kr=1<<20,_a=1<<25,Fa=32768,rn=1<<21,kn=1<<22,Pa=1<<23,ma=Symbol("$state"),Ni=Symbol("legacy props"),Oi=Symbol(""),Va=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function xr(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Ii(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Li(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function $i(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Fi(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Bi(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ui(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Gi(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Yi(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Xi(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Ji(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Hi=1,Wi=2,Sr=4,Vi=8,Zi=16,Qi=1,Ki=2,el=4,tl=8,al=16,sl=1,nl=2,It=Symbol(),rl="http://www.w3.org/1999/xhtml";function il(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function ll(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Tr(t){return t===this.v}function ol(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function qr(t){return!ol(t,this.v)}let ss=!1,cl=!1;function vl(){ss=!0}let jt=null;function Qa(t){jt=t}function it(t,e=!1,s){jt={p:jt,i:!1,c:null,e:null,s:t,x:null,l:ss&&!e?{s:null,u:null,$:[]}:null}}function lt(t){var e=jt,s=e.e;if(s!==null){e.e=null;for(var r of s)Gr(r)}return t!==void 0&&(e.x=t),e.i=!0,jt=e.p,t??{}}function Ss(){return!ss||jt!==null&&jt.l===null}let Oa=[];function Er(){var t=Oa;Oa=[],nn(t)}function ua(t){if(Oa.length===0&&!hs){var e=Oa;queueMicrotask(()=>{e===Oa&&Er()})}Oa.push(t)}function ul(){for(;Oa.length>0;)Er()}function jr(t){var e=Qe;if(e===null)return Xe.f|=Pa,t;if((e.f&wn)===0){if((e.f&yn)===0)throw t;e.b.error(t)}else Ka(t,e)}function Ka(t,e){for(;e!==null;){if((e.f&yn)!==0)try{e.b.error(t);return}catch(s){t=s}e=e.parent}throw t}const dl=-7169;function zt(t,e){t.f=t.f&dl|e}function xn(t){(t.f&sa)!==0||t.deps===null?zt(t,Ft):zt(t,Ta)}function Ar(t){if(t!==null)for(const e of t)(e.f&Lt)===0||(e.f&Fa)===0||(e.f^=Fa,Ar(e.deps))}function Pr(t,e,s){(t.f&Gt)!==0?e.add(t):(t.f&Ta)!==0&&s.add(t),Ar(t.deps),zt(t,Ft)}const Cs=new Set;let Ze=null,Is=null,oa=null,Kt=[],Xs=null,ln=!1,hs=!1;class Ca{committed=!1;current=new Map;previous=new Map;#t=new Set;#i=new Set;#e=0;#n=0;#r=null;#s=new Set;#a=new Set;skipped_effects=new Set;is_fork=!1;#l=!1;is_deferred(){return this.is_fork||this.#n>0}process(e){Kt=[],this.apply();var s=[],r=[];for(const n of e)this.#o(n,s,r);if(this.is_deferred())this.#c(r),this.#c(s);else{for(const n of this.#t)n();this.#t.clear(),this.#e===0&&this.#v(),Is=this,Ze=null,Qn(r),Qn(s),Is=null,this.#r?.resolve()}oa=null}#o(e,s,r){e.f^=Ft;for(var n=e.first,i=null;n!==null;){var c=n.f,d=(c&(Sa|Ga))!==0,v=d&&(c&Ft)!==0,f=v||(c&ea)!==0||this.skipped_effects.has(n);if(!f&&n.fn!==null){d?n.f^=Ft:i!==null&&(c&(Os|xs|yr))!==0?i.b.defer_effect(n):(c&Os)!==0?s.push(n):js(n)&&((c&xa)!==0&&this.#s.add(n),bs(n));var p=n.first;if(p!==null){n=p;continue}}var _=n.parent;for(n=n.next;n===null&&_!==null;)_===i&&(i=null),n=_.next,_=_.parent}}#c(e){for(var s=0;s<e.length;s+=1)Pr(e[s],this.#s,this.#a)}capture(e,s){s!==It&&!this.previous.has(e)&&this.previous.set(e,s),(e.f&Pa)===0&&(this.current.set(e,e.v),oa?.set(e,e.v))}activate(){Ze=this,this.apply()}deactivate(){Ze===this&&(Ze=null,oa=null)}flush(){if(this.activate(),Kt.length>0){if(Cr(),Ze!==null&&Ze!==this)return}else this.#e===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#i)e(this);this.#i.clear()}#v(){if(Cs.size>1){this.previous.clear();var e=oa,s=!0;for(const n of Cs){if(n===this){s=!1;continue}const i=[];for(const[d,v]of this.current){if(n.current.has(d))if(s&&v!==n.current.get(d))n.current.set(d,v);else continue;i.push(d)}if(i.length===0)continue;const c=[...n.current.keys()].filter(d=>!this.current.has(d));if(c.length>0){var r=Kt;Kt=[];const d=new Set,v=new Map;for(const f of i)Dr(f,c,d,v);if(Kt.length>0){Ze=n,n.apply();for(const f of Kt)n.#o(f,[],[]);n.deactivate()}Kt=r}}Ze=null,oa=e}this.committed=!0,Cs.delete(this)}increment(e){this.#e+=1,e&&(this.#n+=1)}decrement(e){this.#e-=1,e&&(this.#n-=1),!this.#l&&(this.#l=!0,ua(()=>{this.#l=!1,this.is_deferred()?Kt.length>0&&this.flush():this.revive()}))}revive(){for(const e of this.#s)this.#a.delete(e),zt(e,Gt),wa(e);for(const e of this.#a)zt(e,Ta),wa(e);this.flush()}oncommit(e){this.#t.add(e)}ondiscard(e){this.#i.add(e)}settled(){return(this.#r??=br()).promise}static ensure(){if(Ze===null){const e=Ze=new Ca;Cs.add(Ze),hs||ua(()=>{Ze===e&&e.flush()})}return Ze}apply(){}}function fl(t){var e=hs;hs=!0;try{for(var s;;){if(ul(),Kt.length===0&&(Ze?.flush(),Kt.length===0))return Xs=null,s;Cr()}}finally{hs=e}}function Cr(){ln=!0;var t=null;try{for(var e=0;Kt.length>0;){var s=Ca.ensure();if(e++>1e3){var r,n;pl()}s.process(Kt),Da.clear()}}finally{ln=!1,Xs=null}}function pl(){try{Bi()}catch(t){Ka(t,Xs)}}let ha=null;function Qn(t){var e=t.length;if(e!==0){for(var s=0;s<e;){var r=t[s++];if((r.f&(ga|ea))===0&&js(r)&&(ha=new Set,bs(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?Wr(r):r.fn=null),ha?.size>0)){Da.clear();for(const n of ha){if((n.f&(ga|ea))!==0)continue;const i=[n];let c=n.parent;for(;c!==null;)ha.has(c)&&(ha.delete(c),i.push(c)),c=c.parent;for(let d=i.length-1;d>=0;d--){const v=i[d];(v.f&(ga|ea))===0&&bs(v)}}ha.clear()}}ha=null}}function Dr(t,e,s,r){if(!s.has(t)&&(s.add(t),t.reactions!==null))for(const n of t.reactions){const i=n.f;(i&Lt)!==0?Dr(n,e,s,r):(i&(kn|xa))!==0&&(i&Gt)===0&&Rr(n,e,r)&&(zt(n,Gt),wa(n))}}function Rr(t,e,s){const r=s.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const n of t.deps){if(e.includes(n))return!0;if((n.f&Lt)!==0&&Rr(n,e,s))return s.set(n,!0),!0}return s.set(t,!1),!1}function wa(t){for(var e=Xs=t;e.parent!==null;){e=e.parent;var s=e.f;if(ln&&e===Qe&&(s&xa)!==0&&(s&wr)===0)return;if((s&(Ga|Sa))!==0){if((s&Ft)===0)return;e.f^=Ft}}Kt.push(e)}function hl(t){let e=0,s=Ba(0),r;return()=>{En()&&(a(s),An(()=>(e===0&&(r=ns(()=>t(()=>_s(s)))),e+=1,()=>{ua(()=>{e-=1,e===0&&(r?.(),r=void 0,_s(s))})})))}}var _l=Ra|as|yn;function gl(t,e,s){new ml(t,e,s)}class ml{parent;is_pending=!1;#t;#i=null;#e;#n;#r;#s=null;#a=null;#l=null;#o=null;#c=null;#v=0;#d=0;#p=!1;#f=!1;#h=new Set;#_=new Set;#u=null;#w=hl(()=>(this.#u=Ba(this.#v),()=>{this.#u=null}));constructor(e,s,r){this.#t=e,this.#e=s,this.#n=r,this.parent=Qe.b,this.is_pending=!!this.#e.pending,this.#r=Es(()=>{Qe.b=this;{var n=this.#b();try{this.#s=aa(()=>r(n))}catch(i){this.error(i)}this.#d>0?this.#m():this.is_pending=!1}return()=>{this.#c?.remove()}},_l)}#k(){try{this.#s=aa(()=>this.#n(this.#t))}catch(e){this.error(e)}}#x(){const e=this.#e.pending;e&&(this.#a=aa(()=>e(this.#t)),ua(()=>{var s=this.#b();this.#s=this.#g(()=>(Ca.ensure(),aa(()=>this.#n(s)))),this.#d>0?this.#m():(La(this.#a,()=>{this.#a=null}),this.is_pending=!1)}))}#b(){var e=this.#t;return this.is_pending&&(this.#c=ba(),this.#t.before(this.#c),e=this.#c),e}defer_effect(e){Pr(e,this.#h,this.#_)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#e.pending}#g(e){var s=Qe,r=Xe,n=jt;da(this.#r),Ht(this.#r),Qa(this.#r.ctx);try{return e()}catch(i){return jr(i),null}finally{da(s),Ht(r),Qa(n)}}#m(){const e=this.#e.pending;this.#s!==null&&(this.#o=document.createDocumentFragment(),this.#o.append(this.#c),Qr(this.#s,this.#o)),this.#a===null&&(this.#a=aa(()=>e(this.#t)))}#y(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(e);return}if(this.#d+=e,this.#d===0){this.is_pending=!1;for(const s of this.#h)zt(s,Gt),wa(s);for(const s of this.#_)zt(s,Ta),wa(s);this.#h.clear(),this.#_.clear(),this.#a&&La(this.#a,()=>{this.#a=null}),this.#o&&(this.#t.before(this.#o),this.#o=null)}}update_pending_count(e){this.#y(e),this.#v+=e,!(!this.#u||this.#p)&&(this.#p=!0,ua(()=>{this.#p=!1,this.#u&&es(this.#u,this.#v)}))}get_effect_pending(){return this.#w(),a(this.#u)}error(e){var s=this.#e.onerror;let r=this.#e.failed;if(this.#f||!s&&!r)throw e;this.#s&&(Wt(this.#s),this.#s=null),this.#a&&(Wt(this.#a),this.#a=null),this.#l&&(Wt(this.#l),this.#l=null);var n=!1,i=!1;const c=()=>{if(n){ll();return}n=!0,i&&Ji(),Ca.ensure(),this.#v=0,this.#l!==null&&La(this.#l,()=>{this.#l=null}),this.is_pending=this.has_pending_snippet(),this.#s=this.#g(()=>(this.#f=!1,aa(()=>this.#n(this.#t)))),this.#d>0?this.#m():this.is_pending=!1};var d=Xe;try{Ht(null),i=!0,s?.(e,c),i=!1}catch(v){Ka(v,this.#r&&this.#r.parent)}finally{Ht(d)}r&&ua(()=>{this.#l=this.#g(()=>{Ca.ensure(),this.#f=!0;try{return aa(()=>{r(this.#t,()=>e,()=>c)})}catch(v){return Ka(v,this.#r.parent),null}finally{this.#f=!1}})})}}function bl(t,e,s,r){const n=Ss()?Ts:Sn;var i=t.filter(h=>!h.settled);if(s.length===0&&i.length===0){r(e.map(n));return}var c=Ze,d=Qe,v=yl(),f=i.length===1?i[0].promise:i.length>1?Promise.all(i.map(h=>h.promise)):null;function p(h){v();try{r(h)}catch(m){(d.f&ga)===0&&Ka(m,d)}c?.deactivate(),on()}if(s.length===0){f.then(()=>p(e.map(n)));return}function _(){v(),Promise.all(s.map(h=>wl(h))).then(h=>p([...e.map(n),...h])).catch(h=>Ka(h,d))}f?f.then(_):_()}function yl(){var t=Qe,e=Xe,s=jt,r=Ze;return function(i=!0){da(t),Ht(e),Qa(s),i&&r?.activate()}}function on(){da(null),Ht(null),Qa(null)}function Ts(t){var e=Lt|Gt,s=Xe!==null&&(Xe.f&Lt)!==0?Xe:null;return Qe!==null&&(Qe.f|=as),{ctx:jt,deps:null,effects:null,equals:Tr,f:e,fn:t,reactions:null,rv:0,v:It,wv:0,parent:s??Qe,ac:null}}function wl(t,e,s){let r=Qe;r===null&&Ii();var n=r.b,i=void 0,c=Ba(It),d=!Xe,v=new Map;return Dl(()=>{var f=br();i=f.promise;try{Promise.resolve(t()).then(f.resolve,f.reject).then(()=>{p===Ze&&p.committed&&p.deactivate(),on()})}catch(m){f.reject(m),on()}var p=Ze;if(d){var _=n.is_rendered();n.update_pending_count(1),p.increment(_),v.get(p)?.reject(Va),v.delete(p),v.set(p,f)}const h=(m,T=void 0)=>{if(p.activate(),T)T!==Va&&(c.f|=Pa,es(c,T));else{(c.f&Pa)!==0&&(c.f^=Pa),es(c,m);for(const[x,y]of v){if(v.delete(x),x===p)break;y.reject(Va)}}d&&(n.update_pending_count(-1),p.decrement(_))};f.promise.then(h,m=>h(null,m||"unknown"))}),jn(()=>{for(const f of v.values())f.reject(Va)}),new Promise(f=>{function p(_){function h(){_===i?f(c):p(i)}_.then(h,h)}p(i)})}function nt(t){const e=Ts(t);return Kr(e),e}function Sn(t){const e=Ts(t);return e.equals=qr,e}function zr(t){var e=t.effects;if(e!==null){t.effects=null;for(var s=0;s<e.length;s+=1)Wt(e[s])}}function kl(t){for(var e=t.parent;e!==null;){if((e.f&Lt)===0)return(e.f&ga)===0?e:null;e=e.parent}return null}function Tn(t){var e,s=Qe;da(kl(t));try{t.f&=~Fa,zr(t),e=si(t)}finally{da(s)}return e}function Mr(t){var e=Tn(t);if(!t.equals(e)&&(t.wv=ti(),(!Ze?.is_fork||t.deps===null)&&(t.v=e,t.deps===null))){zt(t,Ft);return}za||(oa!==null?(En()||Ze?.is_fork)&&oa.set(t,e):xn(t))}let cn=new Set;const Da=new Map;let Nr=!1;function Ba(t,e){var s={f:0,v:t,reactions:null,equals:Tr,rv:0,wv:0};return s}function k(t,e){const s=Ba(t);return Kr(s),s}function xl(t,e=!1,s=!0){const r=Ba(t);return e||(r.equals=qr),ss&&s&&jt!==null&&jt.l!==null&&(jt.l.s??=[]).push(r),r}function u(t,e,s=!1){Xe!==null&&(!ca||(Xe.f&Zn)!==0)&&Ss()&&(Xe.f&(Lt|xa|kn|Zn))!==0&&!ya?.includes(t)&&Xi();let r=s?ye(e):e;return es(t,r)}function es(t,e){if(!t.equals(e)){var s=t.v;za?Da.set(t,e):Da.set(t,s),t.v=e;var r=Ca.ensure();if(r.capture(t,s),(t.f&Lt)!==0){const n=t;(t.f&Gt)!==0&&Tn(n),xn(n)}t.wv=ti(),Or(t,Gt),Ss()&&Qe!==null&&(Qe.f&Ft)!==0&&(Qe.f&(Sa|Ga))===0&&(ta===null?zl([t]):ta.push(t)),!r.is_fork&&cn.size>0&&!Nr&&Sl()}return e}function Sl(){Nr=!1;for(const t of cn)(t.f&Ft)!==0&&zt(t,Ta),js(t)&&bs(t);cn.clear()}function Ds(t,e=1){var s=a(t),r=e===1?s++:s--;return u(t,s),r}function _s(t){u(t,t.v+1)}function Or(t,e){var s=t.reactions;if(s!==null)for(var r=Ss(),n=s.length,i=0;i<n;i++){var c=s[i],d=c.f;if(!(!r&&c===Qe)){var v=(d&Gt)===0;if(v&&zt(c,e),(d&Lt)!==0){var f=c;oa?.delete(f),(d&Fa)===0&&(d&sa&&(c.f|=Fa),Or(f,Ta))}else v&&((d&xa)!==0&&ha!==null&&ha.add(c),wa(c))}}}function ye(t){if(typeof t!="object"||t===null||ma in t)return t;const e=mn(t);if(e!==Ri&&e!==zi)return t;var s=new Map,r=Gs(t),n=k(0),i=$a,c=d=>{if($a===i)return d();var v=Xe,f=$a;Ht(null),ar(i);var p=d();return Ht(v),ar(f),p};return r&&s.set("length",k(t.length)),new Proxy(t,{defineProperty(d,v,f){(!("value"in f)||f.configurable===!1||f.enumerable===!1||f.writable===!1)&&Gi();var p=s.get(v);return p===void 0?p=c(()=>{var _=k(f.value);return s.set(v,_),_}):u(p,f.value,!0),!0},deleteProperty(d,v){var f=s.get(v);if(f===void 0){if(v in d){const p=c(()=>k(It));s.set(v,p),_s(n)}}else u(f,It),_s(n);return!0},get(d,v,f){if(v===ma)return t;var p=s.get(v),_=v in d;if(p===void 0&&(!_||Za(d,v)?.writable)&&(p=c(()=>{var m=ye(_?d[v]:It),T=k(m);return T}),s.set(v,p)),p!==void 0){var h=a(p);return h===It?void 0:h}return Reflect.get(d,v,f)},getOwnPropertyDescriptor(d,v){var f=Reflect.getOwnPropertyDescriptor(d,v);if(f&&"value"in f){var p=s.get(v);p&&(f.value=a(p))}else if(f===void 0){var _=s.get(v),h=_?.v;if(_!==void 0&&h!==It)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return f},has(d,v){if(v===ma)return!0;var f=s.get(v),p=f!==void 0&&f.v!==It||Reflect.has(d,v);if(f!==void 0||Qe!==null&&(!p||Za(d,v)?.writable)){f===void 0&&(f=c(()=>{var h=p?ye(d[v]):It,m=k(h);return m}),s.set(v,f));var _=a(f);if(_===It)return!1}return p},set(d,v,f,p){var _=s.get(v),h=v in d;if(r&&v==="length")for(var m=f;m<_.v;m+=1){var T=s.get(m+"");T!==void 0?u(T,It):m in d&&(T=c(()=>k(It)),s.set(m+"",T))}if(_===void 0)(!h||Za(d,v)?.writable)&&(_=c(()=>k(void 0)),u(_,ye(f)),s.set(v,_));else{h=_.v!==It;var x=c(()=>ye(f));u(_,x)}var y=Reflect.getOwnPropertyDescriptor(d,v);if(y?.set&&y.set.call(p,f),!h){if(r&&typeof v=="string"){var S=s.get("length"),N=Number(v);Number.isInteger(N)&&N>=S.v&&u(S,N+1)}_s(n)}return!0},ownKeys(d){a(n);var v=Reflect.ownKeys(d).filter(_=>{var h=s.get(_);return h===void 0||h.v!==It});for(var[f,p]of s)p.v!==It&&!(f in d)&&v.push(f);return v},setPrototypeOf(){Yi()}})}function Kn(t){try{if(t!==null&&typeof t=="object"&&ma in t)return t[ma]}catch{}return t}function Tl(t,e){return Object.is(Kn(t),Kn(e))}var vn,Ir,Lr,$r;function ql(){if(vn===void 0){vn=window,Ir=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,s=Text.prototype;Lr=Za(e,"firstChild").get,$r=Za(e,"nextSibling").get,Vn(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Vn(s)&&(s.__t=void 0)}}function ba(t=""){return document.createTextNode(t)}function Aa(t){return Lr.call(t)}function qs(t){return $r.call(t)}function o(t,e){return Aa(t)}function qe(t,e=!1){{var s=Aa(t);return s instanceof Comment&&s.data===""?qs(s):s}}function l(t,e=1,s=!1){let r=t;for(;e--;)r=qs(r);return r}function El(t){t.textContent=""}function Fr(){return!1}function qn(t,e){{const s=document.body;t.autofocus=!0,ua(()=>{document.activeElement===s&&t.focus()})}}let er=!1;function jl(){er||(er=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function Js(t){var e=Xe,s=Qe;Ht(null),da(null);try{return t()}finally{Ht(e),da(s)}}function Br(t,e,s,r=s){t.addEventListener(e,()=>Js(s));const n=t.__on_r;n?t.__on_r=()=>{n(),r(!0)}:t.__on_r=()=>r(!0),jl()}function Ur(t){Qe===null&&(Xe===null&&Fi(),$i()),za&&Li()}function Al(t,e){var s=e.last;s===null?e.last=e.first=t:(s.next=t,t.prev=s,e.last=t)}function fa(t,e,s){var r=Qe;r!==null&&(r.f&ea)!==0&&(t|=ea);var n={ctx:jt,deps:null,nodes:null,f:t|Gt|sa,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(s)try{bs(n),n.f|=wn}catch(d){throw Wt(n),d}else e!==null&&wa(n);var i=n;if(s&&i.deps===null&&i.teardown===null&&i.nodes===null&&i.first===i.last&&(i.f&as)===0&&(i=i.first,(t&xa)!==0&&(t&Ra)!==0&&i!==null&&(i.f|=Ra)),i!==null&&(i.parent=r,r!==null&&Al(i,r),Xe!==null&&(Xe.f&Lt)!==0&&(t&Ga)===0)){var c=Xe;(c.effects??=[]).push(i)}return n}function En(){return Xe!==null&&!ca}function jn(t){const e=fa(xs,null,!1);return zt(e,Ft),e.teardown=t,e}function Bt(t){Ur();var e=Qe.f,s=!Xe&&(e&Sa)!==0&&(e&wn)===0;if(s){var r=jt;(r.e??=[]).push(t)}else return Gr(t)}function Gr(t){return fa(Os|kr,t,!1)}function Pl(t){return Ur(),fa(xs|kr,t,!0)}function Cl(t){Ca.ensure();const e=fa(Ga|as,t,!0);return(s={})=>new Promise(r=>{s.outro?La(e,()=>{Wt(e),r(void 0)}):(Wt(e),r(void 0))})}function Yr(t){return fa(Os,t,!1)}function Dl(t){return fa(kn|as,t,!0)}function An(t,e=0){return fa(xs|e,t,!0)}function U(t,e=[],s=[],r=[]){bl(r,e,s,n=>{fa(xs,()=>t(...n.map(a)),!0)})}function Es(t,e=0){var s=fa(xa|e,t,!0);return s}function aa(t){return fa(Sa|as,t,!0)}function Xr(t){var e=t.teardown;if(e!==null){const s=za,r=Xe;tr(!0),Ht(null);try{e.call(null)}finally{tr(s),Ht(r)}}}function Jr(t,e=!1){var s=t.first;for(t.first=t.last=null;s!==null;){const n=s.ac;n!==null&&Js(()=>{n.abort(Va)});var r=s.next;(s.f&Ga)!==0?s.parent=null:Wt(s,e),s=r}}function Rl(t){for(var e=t.first;e!==null;){var s=e.next;(e.f&Sa)===0&&Wt(e),e=s}}function Wt(t,e=!0){var s=!1;(e||(t.f&wr)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Hr(t.nodes.start,t.nodes.end),s=!0),Jr(t,e&&!s),Ls(t,0),zt(t,ga);var r=t.nodes&&t.nodes.t;if(r!==null)for(const i of r)i.stop();Xr(t);var n=t.parent;n!==null&&n.first!==null&&Wr(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Hr(t,e){for(;t!==null;){var s=t===e?null:qs(t);t.remove(),t=s}}function Wr(t){var e=t.parent,s=t.prev,r=t.next;s!==null&&(s.next=r),r!==null&&(r.prev=s),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=s))}function La(t,e,s=!0){var r=[];Vr(t,r,!0);var n=()=>{s&&Wt(t),e&&e()},i=r.length;if(i>0){var c=()=>--i||n();for(var d of r)d.out(c)}else n()}function Vr(t,e,s){if((t.f&ea)===0){t.f^=ea;var r=t.nodes&&t.nodes.t;if(r!==null)for(const d of r)(d.is_global||s)&&e.push(d);for(var n=t.first;n!==null;){var i=n.next,c=(n.f&Ra)!==0||(n.f&Sa)!==0&&(t.f&xa)!==0;Vr(n,e,c?s:!1),n=i}}}function Pn(t){Zr(t,!0)}function Zr(t,e){if((t.f&ea)!==0){t.f^=ea,(t.f&Ft)===0&&(zt(t,Gt),wa(t));for(var s=t.first;s!==null;){var r=s.next,n=(s.f&Ra)!==0||(s.f&Sa)!==0;Zr(s,n?e:!1),s=r}var i=t.nodes&&t.nodes.t;if(i!==null)for(const c of i)(c.is_global||e)&&c.in()}}function Qr(t,e){if(t.nodes)for(var s=t.nodes.start,r=t.nodes.end;s!==null;){var n=s===r?null:qs(s);e.append(s),s=n}}let Ms=!1,za=!1;function tr(t){za=t}let Xe=null,ca=!1;function Ht(t){Xe=t}let Qe=null;function da(t){Qe=t}let ya=null;function Kr(t){Xe!==null&&(ya===null?ya=[t]:ya.push(t))}let Jt=null,Qt=0,ta=null;function zl(t){ta=t}let ei=1,Ia=0,$a=Ia;function ar(t){$a=t}function ti(){return++ei}function js(t){var e=t.f;if((e&Gt)!==0)return!0;if(e&Lt&&(t.f&=~Fa),(e&Ta)!==0){for(var s=t.deps,r=s.length,n=0;n<r;n++){var i=s[n];if(js(i)&&Mr(i),i.wv>t.wv)return!0}(e&sa)!==0&&oa===null&&zt(t,Ft)}return!1}function ai(t,e,s=!0){var r=t.reactions;if(r!==null&&!ya?.includes(t))for(var n=0;n<r.length;n++){var i=r[n];(i.f&Lt)!==0?ai(i,e,!1):e===i&&(s?zt(i,Gt):(i.f&Ft)!==0&&zt(i,Ta),wa(i))}}function si(t){var e=Jt,s=Qt,r=ta,n=Xe,i=ya,c=jt,d=ca,v=$a,f=t.f;Jt=null,Qt=0,ta=null,Xe=(f&(Sa|Ga))===0?t:null,ya=null,Qa(t.ctx),ca=!1,$a=++Ia,t.ac!==null&&(Js(()=>{t.ac.abort(Va)}),t.ac=null);try{t.f|=rn;var p=t.fn,_=p(),h=t.deps;if(Jt!==null){var m;if(Ls(t,Qt),h!==null&&Qt>0)for(h.length=Qt+Jt.length,m=0;m<Jt.length;m++)h[Qt+m]=Jt[m];else t.deps=h=Jt;if(En()&&(t.f&sa)!==0)for(m=Qt;m<h.length;m++)(h[m].reactions??=[]).push(t)}else h!==null&&Qt<h.length&&(Ls(t,Qt),h.length=Qt);if(Ss()&&ta!==null&&!ca&&h!==null&&(t.f&(Lt|Ta|Gt))===0)for(m=0;m<ta.length;m++)ai(ta[m],t);if(n!==null&&n!==t){if(Ia++,n.deps!==null)for(let T=0;T<s;T+=1)n.deps[T].rv=Ia;if(e!==null)for(const T of e)T.rv=Ia;ta!==null&&(r===null?r=ta:r.push(...ta))}return(t.f&Pa)!==0&&(t.f^=Pa),_}catch(T){return jr(T)}finally{t.f^=rn,Jt=e,Qt=s,ta=r,Xe=n,ya=i,Qa(c),ca=d,$a=v}}function Ml(t,e){let s=e.reactions;if(s!==null){var r=Ci.call(s,t);if(r!==-1){var n=s.length-1;n===0?s=e.reactions=null:(s[r]=s[n],s.pop())}}if(s===null&&(e.f&Lt)!==0&&(Jt===null||!Jt.includes(e))){var i=e;(i.f&sa)!==0&&(i.f^=sa,i.f&=~Fa),xn(i),zr(i),Ls(i,0)}}function Ls(t,e){var s=t.deps;if(s!==null)for(var r=e;r<s.length;r++)Ml(t,s[r])}function bs(t){var e=t.f;if((e&ga)===0){zt(t,Ft);var s=Qe,r=Ms;Qe=t,Ms=!0;try{(e&(xa|yr))!==0?Rl(t):Jr(t),Xr(t);var n=si(t);t.teardown=typeof n=="function"?n:null,t.wv=ei;var i;sn&&cl&&(t.f&Gt)!==0&&t.deps}finally{Ms=r,Qe=s}}}async function Nl(){await Promise.resolve(),fl()}function a(t){var e=t.f,s=(e&Lt)!==0;if(Xe!==null&&!ca){var r=Qe!==null&&(Qe.f&ga)!==0;if(!r&&!ya?.includes(t)){var n=Xe.deps;if((Xe.f&rn)!==0)t.rv<Ia&&(t.rv=Ia,Jt===null&&n!==null&&n[Qt]===t?Qt++:Jt===null?Jt=[t]:Jt.push(t));else{(Xe.deps??=[]).push(t);var i=t.reactions;i===null?t.reactions=[Xe]:i.includes(Xe)||i.push(Xe)}}}if(za&&Da.has(t))return Da.get(t);if(s){var c=t;if(za){var d=c.v;return((c.f&Ft)===0&&c.reactions!==null||ri(c))&&(d=Tn(c)),Da.set(c,d),d}var v=(c.f&sa)===0&&!ca&&Xe!==null&&(Ms||(Xe.f&sa)!==0),f=c.deps===null;js(c)&&(v&&(c.f|=sa),Mr(c)),v&&!f&&ni(c)}if(oa?.has(t))return oa.get(t);if((t.f&Pa)!==0)throw t.v;return t.v}function ni(t){if(t.deps!==null){t.f|=sa;for(const e of t.deps)(e.reactions??=[]).push(t),(e.f&Lt)!==0&&(e.f&sa)===0&&ni(e)}}function ri(t){if(t.v===It)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Da.has(e)||(e.f&Lt)!==0&&ri(e))return!0;return!1}function ns(t){var e=ca;try{return ca=!0,t()}finally{ca=e}}function Ol(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(ma in t)un(t);else if(!Array.isArray(t))for(let e in t){const s=t[e];typeof s=="object"&&s&&ma in s&&un(s)}}}function un(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{un(t[r],e)}catch{}const s=mn(t);if(s!==Object.prototype&&s!==Array.prototype&&s!==Map.prototype&&s!==Set.prototype&&s!==Date.prototype){const r=mr(s);for(let n in r){const i=r[n].get;if(i)try{i.call(t)}catch{}}}}}const Il=["touchstart","touchmove"];function Ll(t){return Il.includes(t)}const ii=new Set,dn=new Set;function $l(t,e,s,r={}){function n(i){if(r.capture||ds.call(e,i),!i.cancelBubble)return Js(()=>s?.call(this,i))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?ua(()=>{e.addEventListener(t,n,r)}):e.addEventListener(t,n,r),n}function ka(t,e,s,r,n){var i={capture:r,passive:n},c=$l(t,e,s,i);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&jn(()=>{e.removeEventListener(t,c,i)})}function _t(t){for(var e=0;e<t.length;e++)ii.add(t[e]);for(var s of dn)s(t)}let sr=null;function ds(t){var e=this,s=e.ownerDocument,r=t.type,n=t.composedPath?.()||[],i=n[0]||t.target;sr=t;var c=0,d=sr===t&&t.__root;if(d){var v=n.indexOf(d);if(v!==-1&&(e===document||e===window)){t.__root=e;return}var f=n.indexOf(e);if(f===-1)return;v<=f&&(c=v)}if(i=n[c]||t.target,i!==e){Di(t,"currentTarget",{configurable:!0,get(){return i||s}});var p=Xe,_=Qe;Ht(null),da(null);try{for(var h,m=[];i!==null;){var T=i.assignedSlot||i.parentNode||i.host||null;try{var x=i["__"+r];x!=null&&(!i.disabled||t.target===i)&&x.call(i,t)}catch(y){h?m.push(y):h=y}if(t.cancelBubble||T===e||T===null)break;i=T}if(h){for(let y of m)queueMicrotask(()=>{throw y});throw h}}finally{t.__root=e,delete t.currentTarget,Ht(p),da(_)}}}function li(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function ys(t,e){var s=Qe;s.nodes===null&&(s.nodes={start:t,end:e,a:null,t:null})}function w(t,e){var s=(e&sl)!==0,r=(e&nl)!==0,n,i=!t.startsWith("<!>");return()=>{n===void 0&&(n=li(i?t:"<!>"+t),s||(n=Aa(n)));var c=r||Ir?document.importNode(n,!0):n.cloneNode(!0);if(s){var d=Aa(c),v=c.lastChild;ys(d,v)}else ys(c,c);return c}}function oi(t=""){{var e=ba(t+"");return ys(e,e),e}}function dt(){var t=document.createDocumentFragment(),e=document.createComment(""),s=ba();return t.append(e,s),ys(e,s),t}function g(t,e){t!==null&&t.before(e)}function q(t,e){var s=e==null?"":typeof e=="object"?e+"":e;s!==(t.__t??=t.nodeValue)&&(t.__t=s,t.nodeValue=s+"")}function Fl(t,e){return Bl(t,e)}const Wa=new Map;function Bl(t,{target:e,anchor:s,props:r={},events:n,context:i,intro:c=!0}){ql();var d=new Set,v=_=>{for(var h=0;h<_.length;h++){var m=_[h];if(!d.has(m)){d.add(m);var T=Ll(m);e.addEventListener(m,ds,{passive:T});var x=Wa.get(m);x===void 0?(document.addEventListener(m,ds,{passive:T}),Wa.set(m,1)):Wa.set(m,x+1)}}};v(Ys(ii)),dn.add(v);var f=void 0,p=Cl(()=>{var _=s??e.appendChild(ba());return gl(_,{pending:()=>{}},h=>{if(i){it({});var m=jt;m.c=i}n&&(r.$$events=n),f=t(h,r)||{},i&&lt()}),()=>{for(var h of d){e.removeEventListener(h,ds);var m=Wa.get(h);--m===0?(document.removeEventListener(h,ds),Wa.delete(h)):Wa.set(h,m)}dn.delete(v),_!==s&&_.parentNode?.removeChild(_)}});return Ul.set(f,p),f}let Ul=new WeakMap;class Cn{anchor;#t=new Map;#i=new Map;#e=new Map;#n=new Set;#r=!0;constructor(e,s=!0){this.anchor=e,this.#r=s}#s=()=>{var e=Ze;if(this.#t.has(e)){var s=this.#t.get(e),r=this.#i.get(s);if(r)Pn(r),this.#n.delete(s);else{var n=this.#e.get(s);n&&(this.#i.set(s,n.effect),this.#e.delete(s),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),r=n.effect)}for(const[i,c]of this.#t){if(this.#t.delete(i),i===e)break;const d=this.#e.get(c);d&&(Wt(d.effect),this.#e.delete(c))}for(const[i,c]of this.#i){if(i===s||this.#n.has(i))continue;const d=()=>{if(Array.from(this.#t.values()).includes(i)){var f=document.createDocumentFragment();Qr(c,f),f.append(ba()),this.#e.set(i,{effect:c,fragment:f})}else Wt(c);this.#n.delete(i),this.#i.delete(i)};this.#r||!r?(this.#n.add(i),La(c,d,!1)):d()}}};#a=e=>{this.#t.delete(e);const s=Array.from(this.#t.values());for(const[r,n]of this.#e)s.includes(r)||(Wt(n.effect),this.#e.delete(r))};ensure(e,s){var r=Ze,n=Fr();if(s&&!this.#i.has(e)&&!this.#e.has(e))if(n){var i=document.createDocumentFragment(),c=ba();i.append(c),this.#e.set(e,{effect:aa(()=>s(c)),fragment:i})}else this.#i.set(e,aa(()=>s(this.anchor)));if(this.#t.set(r,e),n){for(const[d,v]of this.#i)d===e?r.skipped_effects.delete(v):r.skipped_effects.add(v);for(const[d,v]of this.#e)d===e?r.skipped_effects.delete(v.effect):r.skipped_effects.add(v.effect);r.oncommit(this.#s),r.ondiscard(this.#a)}else this.#s()}}function $(t,e,s=!1){var r=new Cn(t),n=s?Ra:0;function i(c,d){r.ensure(c,d)}Es(()=>{var c=!1;e((d,v=!0)=>{c=!0,i(v,d)}),c||i(!1,null)},n)}function Ge(t,e){return e}function Gl(t,e,s){for(var r=[],n=e.length,i,c=e.length,d=0;d<n;d++){let _=e[d];La(_,()=>{if(i){if(i.pending.delete(_),i.done.add(_),i.pending.size===0){var h=t.outrogroups;fn(Ys(i.done)),h.delete(i),h.size===0&&(t.outrogroups=null)}}else c-=1},!1)}if(c===0){var v=r.length===0&&s!==null;if(v){var f=s,p=f.parentNode;El(p),p.append(f),t.items.clear()}fn(e,!v)}else i={pending:new Set(e),done:new Set},(t.outrogroups??=new Set).add(i)}function fn(t,e=!0){for(var s=0;s<t.length;s++)Wt(t[s],e)}var nr;function Ae(t,e,s,r,n,i=null){var c=t,d=new Map,v=(e&Sr)!==0;if(v){var f=t;c=f.appendChild(ba())}var p=null,_=Sn(()=>{var S=s();return Gs(S)?S:S==null?[]:Ys(S)}),h,m=!0;function T(){y.fallback=p,Yl(y,h,c,e,r),p!==null&&(h.length===0?(p.f&_a)===0?Pn(p):(p.f^=_a,fs(p,null,c)):La(p,()=>{p=null}))}var x=Es(()=>{h=a(_);for(var S=h.length,N=new Set,b=Ze,j=Fr(),C=0;C<S;C+=1){var R=h[C],J=r(R,C),Y=m?null:d.get(J);Y?(Y.v&&es(Y.v,R),Y.i&&es(Y.i,C),j&&b.skipped_effects.delete(Y.e)):(Y=Xl(d,m?c:nr??=ba(),R,J,C,n,e,s),m||(Y.e.f|=_a),d.set(J,Y)),N.add(J)}if(S===0&&i&&!p&&(m?p=aa(()=>i(c)):(p=aa(()=>i(nr??=ba())),p.f|=_a)),!m)if(j){for(const[D,H]of d)N.has(D)||b.skipped_effects.add(H.e);b.oncommit(T),b.ondiscard(()=>{})}else T();a(_)}),y={effect:x,items:d,outrogroups:null,fallback:p};m=!1}function Yl(t,e,s,r,n){var i=(r&Vi)!==0,c=e.length,d=t.items,v=t.effect.first,f,p=null,_,h=[],m=[],T,x,y,S;if(i)for(S=0;S<c;S+=1)T=e[S],x=n(T,S),y=d.get(x).e,(y.f&_a)===0&&(y.nodes?.a?.measure(),(_??=new Set).add(y));for(S=0;S<c;S+=1){if(T=e[S],x=n(T,S),y=d.get(x).e,t.outrogroups!==null)for(const H of t.outrogroups)H.pending.delete(y),H.done.delete(y);if((y.f&_a)!==0)if(y.f^=_a,y===v)fs(y,null,s);else{var N=p?p.next:v;y===t.effect.last&&(t.effect.last=y.prev),y.prev&&(y.prev.next=y.next),y.next&&(y.next.prev=y.prev),Ea(t,p,y),Ea(t,y,N),fs(y,N,s),p=y,h=[],m=[],v=p.next;continue}if((y.f&ea)!==0&&(Pn(y),i&&(y.nodes?.a?.unfix(),(_??=new Set).delete(y))),y!==v){if(f!==void 0&&f.has(y)){if(h.length<m.length){var b=m[0],j;p=b.prev;var C=h[0],R=h[h.length-1];for(j=0;j<h.length;j+=1)fs(h[j],b,s);for(j=0;j<m.length;j+=1)f.delete(m[j]);Ea(t,C.prev,R.next),Ea(t,p,C),Ea(t,R,b),v=b,p=R,S-=1,h=[],m=[]}else f.delete(y),fs(y,v,s),Ea(t,y.prev,y.next),Ea(t,y,p===null?t.effect.first:p.next),Ea(t,p,y),p=y;continue}for(h=[],m=[];v!==null&&v!==y;)(f??=new Set).add(v),m.push(v),v=v.next;if(v===null)continue}(y.f&_a)===0&&h.push(y),p=y,v=y.next}if(t.outrogroups!==null){for(const H of t.outrogroups)H.pending.size===0&&(fn(Ys(H.done)),t.outrogroups?.delete(H));t.outrogroups.size===0&&(t.outrogroups=null)}if(v!==null||f!==void 0){var J=[];if(f!==void 0)for(y of f)(y.f&ea)===0&&J.push(y);for(;v!==null;)(v.f&ea)===0&&v!==t.fallback&&J.push(v),v=v.next;var Y=J.length;if(Y>0){var D=(r&Sr)!==0&&c===0?s:null;if(i){for(S=0;S<Y;S+=1)J[S].nodes?.a?.measure();for(S=0;S<Y;S+=1)J[S].nodes?.a?.fix()}Gl(t,J,D)}}i&&ua(()=>{if(_!==void 0)for(y of _)y.nodes?.a?.apply()})}function Xl(t,e,s,r,n,i,c,d){var v=(c&Hi)!==0?(c&Zi)===0?xl(s,!1,!1):Ba(s):null,f=(c&Wi)!==0?Ba(n):null;return{v,i:f,e:aa(()=>(i(e,v??s,f??n,d),()=>{t.delete(r)}))}}function fs(t,e,s){if(t.nodes)for(var r=t.nodes.start,n=t.nodes.end,i=e&&(e.f&_a)===0?e.nodes.start:s;r!==null;){var c=qs(r);if(i.before(r),r===n)return;r=c}}function Ea(t,e,s){e===null?t.effect.first=s:e.next=s,s===null?t.effect.last=e:s.prev=e}function Jl(t,e,s=!1,r=!1,n=!1){var i=t,c="";U(()=>{var d=Qe;if(c!==(c=e()??"")&&(d.nodes!==null&&(Hr(d.nodes.start,d.nodes.end),d.nodes=null),c!=="")){var v=c+"";s?v=`<svg>${v}</svg>`:r&&(v=`<math>${v}</math>`);var f=li(v);if((s||r)&&(f=Aa(f)),ys(Aa(f),f.lastChild),s||r)for(;Aa(f);)i.before(Aa(f));else i.before(f)}})}function Hl(t,e,...s){var r=new Cn(t);Es(()=>{const n=e()??null;r.ensure(n,n&&(i=>n(i,...s)))},Ra)}function Wl(t,e,s){var r=new Cn(t);Es(()=>{var n=e()??null;r.ensure(n,n&&(i=>s(i,n)))},Ra)}const rr=[...` 	
\r\fÂ \v\uFEFF`];function Vl(t,e,s){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),s){for(var n in s)if(s[n])r=r?r+" "+n:n;else if(r.length)for(var i=n.length,c=0;(c=r.indexOf(n,c))>=0;){var d=c+i;(c===0||rr.includes(r[c-1]))&&(d===r.length||rr.includes(r[d]))?r=(c===0?"":r.substring(0,c))+r.substring(d+1):c=d}}return r===""?null:r}function Zl(t,e){return t==null?null:String(t)}function Le(t,e,s,r,n,i){var c=t.__className;if(c!==s||c===void 0){var d=Vl(s,r,i);d==null?t.removeAttribute("class"):t.className=d,t.__className=s}else if(i&&n!==i)for(var v in i){var f=!!i[v];(n==null||f!==!!n[v])&&t.classList.toggle(v,f)}return i}function ts(t,e,s,r){var n=t.__style;if(n!==e){var i=Zl(e);i==null?t.removeAttribute("style"):t.style.cssText=i,t.__style=e}return r}function ws(t,e,s=!1){if(t.multiple){if(e==null)return;if(!Gs(e))return il();for(var r of t.options)r.selected=e.includes(gs(r));return}for(r of t.options){var n=gs(r);if(Tl(n,e)){r.selected=!0;return}}(!s||e!==void 0)&&(t.selectedIndex=-1)}function $s(t){var e=new MutationObserver(()=>{ws(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),jn(()=>{e.disconnect()})}function At(t,e,s=e){var r=new WeakSet,n=!0;Br(t,"change",i=>{var c=i?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(c),gs);else{var v=t.querySelector(c)??t.querySelector("option:not([disabled])");d=v&&gs(v)}s(d),Ze!==null&&r.add(Ze)}),Yr(()=>{var i=e();if(t===document.activeElement){var c=Is??Ze;if(r.has(c))return}if(ws(t,i,n),n&&i===void 0){var d=t.querySelector(":checked");d!==null&&(i=gs(d),s(i))}t.__value=i,n=!1}),$s(t)}function gs(t){return"__value"in t?t.__value:t.value}const Ql=Symbol("is custom element"),Kl=Symbol("is html");function os(t,e){var s=Dn(t);s.value===(s.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function Ks(t,e){var s=Dn(t);s.checked!==(s.checked=e??void 0)&&(t.checked=e)}function We(t,e,s,r){var n=Dn(t);n[e]!==(n[e]=s)&&(e==="loading"&&(t[Oi]=s),s==null?t.removeAttribute(e):typeof s!="string"&&eo(t).includes(e)?t[e]=s:t.setAttribute(e,s))}function Dn(t){return t.__attributes??={[Ql]:t.nodeName.includes("-"),[Kl]:t.namespaceURI===rl}}var ir=new Map;function eo(t){var e=t.getAttribute("is")||t.nodeName,s=ir.get(e);if(s)return s;ir.set(e,s=[]);for(var r,n=t,i=Element.prototype;i!==n;){r=mr(n);for(var c in r)r[c].set&&s.push(c);n=mn(n)}return s}function Ce(t,e,s=e){var r=new WeakSet;Br(t,"input",async n=>{var i=n?t.defaultValue:t.value;if(i=en(t)?tn(i):i,s(i),Ze!==null&&r.add(Ze),await Nl(),i!==(i=e())){var c=t.selectionStart,d=t.selectionEnd,v=t.value.length;if(t.value=i??"",d!==null){var f=t.value.length;c===d&&d===v&&f>v?(t.selectionStart=f,t.selectionEnd=f):(t.selectionStart=c,t.selectionEnd=Math.min(d,f))}}}),ns(e)==null&&t.value&&(s(en(t)?tn(t.value):t.value),Ze!==null&&r.add(Ze)),An(()=>{var n=e();if(t===document.activeElement){var i=Is??Ze;if(r.has(i))return}en(t)&&n===tn(t.value)||t.type==="date"&&!n&&!t.value||n!==t.value&&(t.value=n??"")})}function en(t){var e=t.type;return e==="number"||e==="range"}function tn(t){return t===""?null:+t}function lr(t,e){return t===e||t?.[ma]===e}function Rn(t={},e,s,r){return Yr(()=>{var n,i;return An(()=>{n=i,i=[],ns(()=>{t!==s(...i)&&(e(t,...i),n&&lr(s(...n),t)&&e(null,...n))})}),()=>{ua(()=>{i&&lr(s(...i),t)&&e(null,...i)})}}),t}function to(t=!1){const e=jt,s=e.l.u;if(!s)return;let r=()=>Ol(e.s);if(t){let n=0,i={};const c=Ts(()=>{let d=!1;const v=e.s;for(const f in v)v[f]!==i[f]&&(i[f]=v[f],d=!0);return d&&n++,n});r=()=>a(c)}s.b.length&&Pl(()=>{or(e,r),nn(s.b)}),Bt(()=>{const n=ns(()=>s.m.map(Mi));return()=>{for(const i of n)typeof i=="function"&&i()}}),s.a.length&&Bt(()=>{or(e,r),nn(s.a)})}function or(t,e){if(t.l.s)for(const s of t.l.s)a(s);e()}let Rs=!1;function ao(t){var e=Rs;try{return Rs=!1,[t(),Rs]}finally{Rs=e}}function xt(t,e,s,r){var n=!ss||(s&Ki)!==0,i=(s&tl)!==0,c=(s&al)!==0,d=r,v=!0,f=()=>(v&&(v=!1,d=c?ns(r):r),d),p;if(i){var _=ma in t||Ni in t;p=Za(t,e)?.set??(_&&e in t?b=>t[e]=b:void 0)}var h,m=!1;i?[h,m]=ao(()=>t[e]):h=t[e],h===void 0&&r!==void 0&&(h=f(),p&&(n&&Ui(),p(h)));var T;if(n?T=()=>{var b=t[e];return b===void 0?f():(v=!0,b)}:T=()=>{var b=t[e];return b!==void 0&&(d=void 0),b===void 0?d:b},n&&(s&el)===0)return T;if(p){var x=t.$$legacy;return(function(b,j){return arguments.length>0?((!n||!j||x||m)&&p(j?T():b),b):T()})}var y=!1,S=((s&Qi)!==0?Ts:Sn)(()=>(y=!1,T()));i&&a(S);var N=Qe;return(function(b,j){if(arguments.length>0){const C=j?a(S):n&&i?ye(b):b;return u(S,C),y=!0,d!==void 0&&(d=C),b}return za&&y||(N.f&ga)!==0?S.v:a(S)})}function Vt(t){jt===null&&xr(),ss&&jt.l!==null?ro(jt).m.push(t):Bt(()=>{const e=ns(t);if(typeof e=="function")return e})}function so(t,e,{bubbles:s=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:s,cancelable:r})}function no(){const t=jt;return t===null&&xr(),(e,s,r)=>{const n=t.s.$$events?.[e];if(n){const i=Gs(n)?n.slice():[n],c=so(e,s,r);for(const d of i)d.call(t.x,c);return!c.defaultPrevented}return!0}}function ro(t){var e=t.l;return e.u??={a:[],b:[],m:[]}}const io="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(io);function ra(t){window.history.pushState({},"",t),window.dispatchEvent(new Event("popstate"))}let pn=ye({path:window.location.pathname});if(typeof window<"u"){const t=history.pushState;history.pushState=function(...e){t.apply(this,e),pn.path=window.location.pathname,window.dispatchEvent(new Event("popstate"))},window.addEventListener("popstate",()=>{pn.path=window.location.pathname})}const ja={get path(){return pn.path}};var lo=w("<p>404 Not Found</p>");function oo(t,e){it(e,!0);let s=k(ye(window.location.pathname)),r=k(null);function n(){u(s,window.location.pathname,!0)}Bt(()=>{let f=a(s),p=null;if(!e.routes)return;const _=Object.keys(e.routes).sort((h,m)=>m.length-h.length);for(const h of _){if(h===f){p=e.routes[h];break}if(f.startsWith(h)&&h!=="/"){p=e.routes[h];break}}p||(p=e.routes["/"]||null),u(r,p,!0)}),Vt(()=>(window.addEventListener("popstate",n),()=>{window.removeEventListener("popstate",n)}));var i=dt(),c=qe(i);{var d=f=>{var p=dt(),_=qe(p);Wl(_,()=>a(r),(h,m)=>{m(h,{})}),g(f,p)},v=f=>{var p=lo();g(f,p)};$(c,f=>{a(r)?f(d):f(v,!1)})}g(t,i),lt()}const De="";function Re(t={}){return{"X-User-Role":localStorage.getItem("user_role")||"admin",...t}}async function zn(t){const e=new FormData;e.append("file",t);const s=await fetch(`${De}/upload`,{method:"POST",headers:Re(),body:e});if(!s.ok)throw new Error("Upload failed");return await s.json()}async function Mn(t="",e="",s="",r="registration_date",n="desc",i="",c="",d="",v="registration_date",f="",p=""){const _=new URLSearchParams;return t&&_.append("search",t),e&&_.append("type",e),s&&_.append("status",s),i&&_.append("tag",i),c&&_.append("start_date",c),d&&_.append("end_date",d),v&&_.append("date_field",v),r&&_.append("sort_by",r),n&&_.append("sort_order",n),f&&_.append("assignee",f),p&&_.append("part_search",p),await(await fetch(`${De}/documents/?${_.toString()}`,{headers:Re()})).json()}async function co(){return await(await fetch(`${De}/tags`,{headers:Re()})).json()}async function Na(t){const e=await fetch(`${De}/settings/${t}`,{headers:Re()});if(!e.ok)throw new Error("Failed to fetch setting");return await e.json()}async function cs(t,e){const s=await fetch(`${De}/settings/`,{method:"PUT",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify({key:t,value:e})});if(!s.ok){const r=await s.json().catch(()=>({}));throw new Error(r.detail||`Failed to update setting (${s.status})`)}return await s.json()}async function vo(t){return await(await fetch(`${De}/settings/test-path`,{method:"POST",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify({path:t})})).json()}async function uo(t){const e=await fetch(`${De}/documents/`,{method:"POST",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify(t)});if(!e.ok){const s=await e.json().catch(()=>({}));throw new Error(s.detail||`Failed to create document (${e.status})`)}return await e.json()}async function fo(t,e){return await(await fetch(`${De}/documents/${t}`,{method:"PUT",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify({status:e})})).json()}async function po(t,e){const s=await fetch(`${De}/documents/${t}`,{method:"PUT",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!s.ok){const r=await s.json().catch(()=>({}));throw new Error(r.detail||`Failed to update document (${s.status})`)}return await s.json()}async function ho(t,e){const s=await fetch(`${De}/documents/${t}/download-zip`,{headers:Re()});if(!s.ok)throw new Error("Download failed");const r=await s.blob(),n=window.URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=`${e}_source.zip`,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n)}async function _o(t){return await(await fetch(`${De}/documents/${t}`,{method:"DELETE",headers:Re()})).json()}async function go(t="",e="",s=""){const r=new URLSearchParams;return t&&r.append("type",t),e&&r.append("status",e),s&&r.append("document_id",s),await(await fetch(`${De}/journal/?${r.toString()}`,{headers:Re()})).json()}async function ci(t){return await(await fetch(`${De}/journal/`,{method:"POST",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify(t)})).json()}async function Nn(t,e){return await(await fetch(`${De}/journal/${t}`,{method:"PUT",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify(e)})).json()}async function mo(t){return await(await fetch(`${De}/journal/${t}`,{method:"DELETE",headers:Re()})).json()}async function bo(t){return await(await fetch(`${De}/documents/${t}/tasks`,{headers:Re()})).json()}async function yo(t,e){return await(await fetch(`${De}/documents/${t}/tasks`,{method:"POST",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify(e)})).json()}async function wo(t,e,s){const r=await fetch(`${De}/documents/save-as-new-order`,{method:"POST",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify({name:t,sheet:e,original_document_id:s})});if(!r.ok){const n=await r.json().catch(()=>({}));throw new Error(n.detail||`Failed to create order (${r.status})`)}return await r.json()}async function Ns(t,e){return await(await fetch(`${De}/tasks/${t}`,{method:"PUT",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify(e)})).json()}async function ko(t){return await(await fetch(`${De}/tasks/${t}`,{method:"DELETE",headers:Re()})).json()}async function xo(t){return await(await fetch(`${De}/attachments/${t}`,{method:"DELETE",headers:Re()})).json()}async function So(){return await(await fetch(`${De}/filter-presets`,{headers:Re()})).json()}async function Ya(){return await(await fetch(`${De}/materials`,{headers:Re()})).json()}async function To(t){return await(await fetch(`${De}/materials`,{method:"POST",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify(t)})).json()}async function qo(t,e){const s=await fetch(`${De}/documents/order`,{method:"POST",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify({name:e,parts:t})});if(!s.ok){const r=await s.json().catch(()=>({}));throw new Error(r.detail||`Failed to create order (${s.status})`)}return await s.json()}async function Eo(t,e){return await(await fetch(`${De}/materials/${t}?name=${encodeURIComponent(e)}`,{method:"PUT",headers:Re({"Content-Type":"application/json"})})).json()}async function jo(t){return await(await fetch(`${De}/materials/${t}`,{method:"DELETE",headers:Re()})).json()}async function Ao(t=0,e=100,s={}){const r=new URLSearchParams({skip:String(t),limit:String(e)});return s.search&&r.append("search",s.search),s.material_id&&r.append("material_id",s.material_id),s.min_width&&r.append("min_width",s.min_width),s.max_width&&r.append("max_width",s.max_width),s.min_height&&r.append("min_height",s.min_height),s.max_height&&r.append("max_height",s.max_height),await(await fetch(`${De}/parts?${r.toString()}`,{headers:Re()})).json()}async function vi(){return await(await fetch(`${De}/stock`,{headers:Re()})).json()}async function Po(t){return await(await fetch(`${De}/stock`,{method:"POST",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify(t)})).json()}async function Co(t){return await(await fetch(`${De}/stock/${t}`,{method:"DELETE",headers:Re()})).json()}async function Do(t){const e=new FormData;e.append("file",t);const s=await fetch(`${De}/gnc/parse`,{method:"POST",headers:Re(),body:e});if(!s.ok){const r=await s.json().catch(()=>({}));throw new Error(r.detail||"Failed to parse GNC file")}return await s.json()}async function Ro(t,e,s=!0){const r=await fetch(`${De}/gnc/save`,{method:"PUT",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify({sheet:t,filename:e,overwrite:s})});if(!r.ok){const n=await r.json().catch(()=>({}));throw new Error(n.detail||"Failed to save GNC file")}return await r.json()}async function zo(t){const e=await fetch(`${De}/parts/scan`,{method:"POST",headers:Re()});if(!e.ok)throw new Error("Failed to start scan");const s=e.body.getReader(),r=new TextDecoder;for(;;){const{done:n,value:i}=await s.read();if(n)break;const d=r.decode(i).split(`
`).filter(v=>v.trim());for(const v of d)try{const f=JSON.parse(v);t(f)}catch{console.error("Failed to parse progress:",v)}}}async function Mo(t,e){const s=await fetch(`${De}/parts/${t}`,{method:"PUT",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!s.ok)throw new Error("Failed to update part");return await s.json()}async function cr(t){const e=await fetch(`${De}/parts/${t}/gnc`,{headers:Re()});if(!e.ok)throw new Error("Failed to fetch part GNC");return await e.json()}async function ks(){return await(await fetch(`${De}/assignees/`,{headers:Re()})).json()}async function No(t){return await(await fetch(`${De}/assignees/`,{method:"POST",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify(t)})).json()}async function Oo(t,e){return await(await fetch(`${De}/assignees/${t}`,{method:"PUT",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify({name:e})})).json()}async function Io(t){return await(await fetch(`${De}/assignees/${t}`,{method:"DELETE",headers:Re()})).json()}async function Lo(){return await(await fetch(`${De}/api/gnc/stock-templates`,{headers:Re()})).json()}async function $o(){return await(await fetch(`${De}/api/gnc/library-parts`,{headers:Re()})).json()}async function Fo(t){return await(await fetch(`${De}/api/gnc/orders/${t}/tasks`,{headers:Re()})).json()}async function Bo(t){return await(await fetch(`${De}/api/gnc/save-order-nesting`,{method:"POST",headers:Re({"Content-Type":"application/json"}),body:JSON.stringify(t)})).json()}var Uo=w('<div class="loading svelte-plcxj0">Loading dashboard...</div>'),Go=w('<div class="recent-doc-item svelte-plcxj0"><div class="doc-info svelte-plcxj0"><span class="doc-name svelte-plcxj0"> </span> <span class="doc-date svelte-plcxj0"> </span></div> <span> </span></div>'),Yo=w('<div class="empty-state svelte-plcxj0">No documents yet</div>'),Xo=w('<div class="dashboard-section svelte-plcxj0"><h2 class="svelte-plcxj0">ðŸ“Š Overview</h2> <div class="stats-grid svelte-plcxj0"><div class="stat-card documents svelte-plcxj0"><div class="stat-icon svelte-plcxj0">ðŸ“„</div> <div class="stat-content svelte-plcxj0"><div class="stat-value svelte-plcxj0"> </div> <div class="stat-label svelte-plcxj0">Total Documents</div> <div class="stat-breakdown svelte-plcxj0"><span class="in-progress svelte-plcxj0"> </span> <span class="done svelte-plcxj0"> </span></div></div></div> <div class="stat-card tasks svelte-plcxj0"><div class="stat-icon svelte-plcxj0">âœ“</div> <div class="stat-content svelte-plcxj0"><div class="stat-value svelte-plcxj0"> </div> <div class="stat-label svelte-plcxj0">Total Tasks</div> <div class="stat-breakdown svelte-plcxj0"><span class="planned svelte-plcxj0"> </span> <span class="pending svelte-plcxj0"> </span> <span class="done svelte-plcxj0"> </span></div></div></div> <div class="stat-card materials svelte-plcxj0"><div class="stat-icon svelte-plcxj0">ðŸ“¦</div> <div class="stat-content svelte-plcxj0"><div class="stat-value svelte-plcxj0"> </div> <div class="stat-label svelte-plcxj0">Materials</div></div></div> <div class="stat-card completion svelte-plcxj0"><div class="stat-icon svelte-plcxj0">ðŸ“ˆ</div> <div class="stat-content svelte-plcxj0"><div class="stat-value svelte-plcxj0"> </div> <div class="stat-label svelte-plcxj0">Completion Rate</div></div></div></div></div> <div class="dashboard-section svelte-plcxj0"><h2 class="svelte-plcxj0">ðŸ“… Reports</h2> <div class="reports-grid svelte-plcxj0"><div class="report-card svelte-plcxj0"><h3 class="svelte-plcxj0">Today</h3> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Created:</span> <span class="report-value svelte-plcxj0"> </span></div> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Completed:</span> <span class="report-value svelte-plcxj0"> </span></div></div> <div class="report-card svelte-plcxj0"><h3 class="svelte-plcxj0">Last 7 Days</h3> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Created:</span> <span class="report-value svelte-plcxj0"> </span></div> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Completed:</span> <span class="report-value svelte-plcxj0"> </span></div></div> <div class="report-card svelte-plcxj0"><h3 class="svelte-plcxj0">Last 30 Days</h3> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Created:</span> <span class="report-value svelte-plcxj0"> </span></div> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Completed:</span> <span class="report-value svelte-plcxj0"> </span></div></div></div></div> <div class="dashboard-section svelte-plcxj0"><h2 class="svelte-plcxj0">ðŸ“ Recent Documents</h2> <div class="recent-documents svelte-plcxj0"><!> <!></div></div>',1),Jo=w('<div class="dashboard-container svelte-plcxj0"><!></div>');function Ho(t,e){it(e,!0);let s=ye({totalDocuments:0,totalTasks:0,totalMaterials:0,documentsInProgress:0,documentsDone:0,tasksPlanned:0,tasksPending:0,tasksDone:0}),r=ye({tasksCompleted:0,documentsCreated:0,documentsCompleted:0}),n=ye({tasksCompleted:0,documentsCreated:0,documentsCompleted:0}),i=ye({tasksCompleted:0,documentsCreated:0,documentsCompleted:0}),c=k(ye([])),d=k(!0);Vt(()=>{v()});async function v(){u(d,!0);try{const m=await Mn("","","","registration_date","desc"),T=await Ya();s.totalDocuments=m.length,s.totalMaterials=T.length,s.documentsInProgress=m.filter(b=>b.status==="in_progress").length,s.documentsDone=m.filter(b=>b.status==="done").length;let x=[];m.forEach(b=>{b.tasks&&(x=x.concat(b.tasks))}),s.totalTasks=x.length,s.tasksPlanned=x.filter(b=>b.status==="planned").length,s.tasksPending=x.filter(b=>b.status==="pending").length,s.tasksDone=x.filter(b=>b.status==="done").length;const y=new Date;y.setHours(0,0,0,0),r.documentsCreated=m.filter(b=>{const j=new Date(b.registration_date);return j.setHours(0,0,0,0),j.getTime()===y.getTime()}).length,r.documentsCompleted=m.filter(b=>{if(!b.done_date)return!1;const j=new Date(b.done_date);return j.setHours(0,0,0,0),j.getTime()===y.getTime()}).length;const S=new Date;S.setDate(S.getDate()-7),S.setHours(0,0,0,0),n.documentsCreated=m.filter(b=>new Date(b.registration_date)>=S).length,n.documentsCompleted=m.filter(b=>b.done_date?new Date(b.done_date)>=S:!1).length;const N=new Date;N.setDate(N.getDate()-30),N.setHours(0,0,0,0),i.documentsCreated=m.filter(b=>new Date(b.registration_date)>=N).length,i.documentsCompleted=m.filter(b=>b.done_date?new Date(b.done_date)>=N:!1).length,u(c,m.slice(0,5),!0)}catch(m){console.error("Failed to load dashboard data",m)}finally{u(d,!1)}}var f=Jo(),p=o(f);{var _=m=>{var T=Uo();g(m,T)},h=m=>{var T=Xo(),x=qe(T),y=l(o(x),2),S=o(y),N=l(o(S),2),b=o(N),j=o(b),C=l(b,4),R=o(C),J=o(R),Y=l(R,2),D=o(Y),H=l(S,2),Z=l(o(H),2),L=o(Z),M=o(L),K=l(L,4),re=o(K),be=o(re),_e=l(re,2),ke=o(_e),me=l(_e,2),le=o(me),Te=l(H,2),xe=l(o(Te),2),oe=o(xe),E=o(oe),I=l(Te,2),ee=l(o(I),2),Q=o(ee),ae=o(Q),Se=l(x,2),Pe=l(o(Se),2),$e=o(Pe),Me=l(o($e),2),z=l(o(Me),2),G=o(z),ce=l(Me,2),ue=l(o(ce),2),X=o(ue),W=l($e,2),se=l(o(W),2),ne=l(o(se),2),ie=o(ne),ve=l(se,2),F=l(o(ve),2),fe=o(F),P=l(W,2),A=l(o(P),2),te=l(o(A),2),je=o(te),ze=l(A,2),Be=l(o(ze),2),we=o(Be),Ne=l(Se,2),Je=l(o(Ne),2),ot=o(Je);Ae(ot,17,()=>a(c),Ge,(O,pe)=>{var Ee=Go(),ct=o(Ee),at=o(ct),gt=o(at),He=l(at,2),Pt=o(He),St=l(ct,2),Yt=o(St);U(()=>{q(gt,a(pe).name),q(Pt,a(pe).registration_date),Le(St,1,`doc-status ${a(pe).status??""}`,"svelte-plcxj0"),q(Yt,a(pe).status)}),g(O,Ee)});var ge=l(ot,2);{var Ie=O=>{var pe=Yo();g(O,pe)};$(ge,O=>{a(c).length===0&&O(Ie)})}U(O=>{q(j,s.totalDocuments),q(J,`${s.documentsInProgress??""} in progress`),q(D,`${s.documentsDone??""} done`),q(M,s.totalTasks),q(be,`${s.tasksPlanned??""} planned`),q(ke,`${s.tasksPending??""} pending`),q(le,`${s.tasksDone??""} done`),q(E,s.totalMaterials),q(ae,`${O??""}%`),q(G,r.documentsCreated),q(X,r.documentsCompleted),q(ie,n.documentsCreated),q(fe,n.documentsCompleted),q(je,i.documentsCreated),q(we,i.documentsCompleted)},[()=>s.totalDocuments>0?Math.round(s.documentsDone/s.totalDocuments*100):0]),g(m,T)};$(p,m=>{a(d)?m(_):m(h,!1)})}g(t,f),lt()}var Wo=w('<div class="modal-backdrop svelte-5awcn0" role="button" tabindex="0"><div class="modal-content svelte-5awcn0" role="document" tabindex="0"><button class="close-btn svelte-5awcn0">&times;</button> <!></div></div>');function On(t,e){it(e,!0);let s=xt(e,"maxWidth",3,"500px");function r(d){d.key==="Escape"&&e.close()}var n=dt(),i=qe(n);{var c=d=>{var v=Wo();v.__click=function(...h){e.close?.apply(this,h)},v.__keydown=r;var f=o(v);f.__click=h=>h.stopPropagation(),f.__keydown=h=>h.stopPropagation();var p=o(f);p.__click=function(...h){e.close?.apply(this,h)};var _=l(p,2);Hl(_,()=>e.children),U(()=>ts(f,`max-width: ${s()??""}`)),g(d,v)};$(i,d=>{e.isOpen&&d(c)})}g(t,n),lt()}_t(["click","keydown"]);function In(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Xa=In();function ui(t){Xa=t}var ms={exec:()=>null};function Ve(t,e=""){let s=typeof t=="string"?t:t.source,r={replace:(n,i)=>{let c=typeof i=="string"?i:i.source;return c=c.replace(Ut.caret,"$1"),s=s.replace(n,c),r},getRegex:()=>new RegExp(s,e)};return r}var Vo=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Ut={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},Zo=/^(?:[ \t]*(?:\n|$))+/,Qo=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Ko=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,As=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,ec=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Ln=/(?:[*+-]|\d{1,9}[.)])/,di=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,fi=Ve(di).replace(/bull/g,Ln).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),tc=Ve(di).replace(/bull/g,Ln).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),$n=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ac=/^[^\n]+/,Fn=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,sc=Ve(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Fn).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),nc=Ve(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Ln).getRegex(),Hs="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Bn=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,rc=Ve("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Bn).replace("tag",Hs).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),pi=Ve($n).replace("hr",As).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Hs).getRegex(),ic=Ve(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",pi).getRegex(),Un={blockquote:ic,code:Qo,def:sc,fences:Ko,heading:ec,hr:As,html:rc,lheading:fi,list:nc,newline:Zo,paragraph:pi,table:ms,text:ac},vr=Ve("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",As).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Hs).getRegex(),lc={...Un,lheading:tc,table:vr,paragraph:Ve($n).replace("hr",As).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",vr).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Hs).getRegex()},oc={...Un,html:Ve(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Bn).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ms,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ve($n).replace("hr",As).replace("heading",` *#{1,6} *[^
]`).replace("lheading",fi).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},cc=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,vc=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,hi=/^( {2,}|\\)\n(?!\s*$)/,uc=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Ws=/[\p{P}\p{S}]/u,Gn=/[\s\p{P}\p{S}]/u,_i=/[^\s\p{P}\p{S}]/u,dc=Ve(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Gn).getRegex(),gi=/(?!~)[\p{P}\p{S}]/u,fc=/(?!~)[\s\p{P}\p{S}]/u,pc=/(?:[^\s\p{P}\p{S}]|~)/u,hc=Ve(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Vo?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),mi=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,_c=Ve(mi,"u").replace(/punct/g,Ws).getRegex(),gc=Ve(mi,"u").replace(/punct/g,gi).getRegex(),bi="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",mc=Ve(bi,"gu").replace(/notPunctSpace/g,_i).replace(/punctSpace/g,Gn).replace(/punct/g,Ws).getRegex(),bc=Ve(bi,"gu").replace(/notPunctSpace/g,pc).replace(/punctSpace/g,fc).replace(/punct/g,gi).getRegex(),yc=Ve("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,_i).replace(/punctSpace/g,Gn).replace(/punct/g,Ws).getRegex(),wc=Ve(/\\(punct)/,"gu").replace(/punct/g,Ws).getRegex(),kc=Ve(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),xc=Ve(Bn).replace("(?:-->|$)","-->").getRegex(),Sc=Ve("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",xc).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Fs=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Tc=Ve(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Fs).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),yi=Ve(/^!?\[(label)\]\[(ref)\]/).replace("label",Fs).replace("ref",Fn).getRegex(),wi=Ve(/^!?\[(ref)\](?:\[\])?/).replace("ref",Fn).getRegex(),qc=Ve("reflink|nolink(?!\\()","g").replace("reflink",yi).replace("nolink",wi).getRegex(),ur=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Yn={_backpedal:ms,anyPunctuation:wc,autolink:kc,blockSkip:hc,br:hi,code:vc,del:ms,emStrongLDelim:_c,emStrongRDelimAst:mc,emStrongRDelimUnd:yc,escape:cc,link:Tc,nolink:wi,punctuation:dc,reflink:yi,reflinkSearch:qc,tag:Sc,text:uc,url:ms},Ec={...Yn,link:Ve(/^!?\[(label)\]\((.*?)\)/).replace("label",Fs).getRegex(),reflink:Ve(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Fs).getRegex()},hn={...Yn,emStrongRDelimAst:bc,emStrongLDelim:gc,url:Ve(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",ur).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Ve(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",ur).getRegex()},jc={...hn,br:Ve(hi).replace("{2,}","*").getRegex(),text:Ve(hn.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},zs={normal:Un,gfm:lc,pedantic:oc},vs={normal:Yn,gfm:hn,breaks:jc,pedantic:Ec},Ac={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},dr=t=>Ac[t];function pa(t,e){if(e){if(Ut.escapeTest.test(t))return t.replace(Ut.escapeReplace,dr)}else if(Ut.escapeTestNoEncode.test(t))return t.replace(Ut.escapeReplaceNoEncode,dr);return t}function fr(t){try{t=encodeURI(t).replace(Ut.percentDecode,"%")}catch{return null}return t}function pr(t,e){let s=t.replace(Ut.findPipe,(i,c,d)=>{let v=!1,f=c;for(;--f>=0&&d[f]==="\\";)v=!v;return v?"|":" |"}),r=s.split(Ut.splitPipe),n=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;n<r.length;n++)r[n]=r[n].trim().replace(Ut.slashPipe,"|");return r}function us(t,e,s){let r=t.length;if(r===0)return"";let n=0;for(;n<r&&t.charAt(r-n-1)===e;)n++;return t.slice(0,r-n)}function Pc(t,e){if(t.indexOf(e[1])===-1)return-1;let s=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===e[0])s++;else if(t[r]===e[1]&&(s--,s<0))return r;return s>0?-2:-1}function hr(t,e,s,r,n){let i=e.href,c=e.title||null,d=t[1].replace(n.other.outputLinkReplace,"$1");r.state.inLink=!0;let v={type:t[0].charAt(0)==="!"?"image":"link",raw:s,href:i,title:c,text:d,tokens:r.inlineTokens(d)};return r.state.inLink=!1,v}function Cc(t,e,s){let r=t.match(s.other.indentCodeCompensation);if(r===null)return e;let n=r[1];return e.split(`
`).map(i=>{let c=i.match(s.other.beginningSpace);if(c===null)return i;let[d]=c;return d.length>=n.length?i.slice(n.length):i}).join(`
`)}var Bs=class{options;rules;lexer;constructor(t){this.options=t||Xa}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let s=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?s:us(s,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let s=e[0],r=Cc(s,e[3]||"",this.rules);return{type:"code",raw:s,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let s=e[2].trim();if(this.rules.other.endingHash.test(s)){let r=us(s,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(s=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:s,tokens:this.lexer.inline(s)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:us(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let s=us(e[0],`
`).split(`
`),r="",n="",i=[];for(;s.length>0;){let c=!1,d=[],v;for(v=0;v<s.length;v++)if(this.rules.other.blockquoteStart.test(s[v]))d.push(s[v]),c=!0;else if(!c)d.push(s[v]);else break;s=s.slice(v);let f=d.join(`
`),p=f.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${f}`:f,n=n?`${n}
${p}`:p;let _=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(p,i,!0),this.lexer.state.top=_,s.length===0)break;let h=i.at(-1);if(h?.type==="code")break;if(h?.type==="blockquote"){let m=h,T=m.raw+`
`+s.join(`
`),x=this.blockquote(T);i[i.length-1]=x,r=r.substring(0,r.length-m.raw.length)+x.raw,n=n.substring(0,n.length-m.text.length)+x.text;break}else if(h?.type==="list"){let m=h,T=m.raw+`
`+s.join(`
`),x=this.list(T);i[i.length-1]=x,r=r.substring(0,r.length-h.raw.length)+x.raw,n=n.substring(0,n.length-m.raw.length)+x.raw,s=T.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:i,text:n}}}list(t){let e=this.rules.block.list.exec(t);if(e){let s=e[1].trim(),r=s.length>1,n={type:"list",raw:"",ordered:r,start:r?+s.slice(0,-1):"",loose:!1,items:[]};s=r?`\\d{1,9}\\${s.slice(-1)}`:`\\${s}`,this.options.pedantic&&(s=r?s:"[*+-]");let i=this.rules.other.listItemRegex(s),c=!1;for(;t;){let v=!1,f="",p="";if(!(e=i.exec(t))||this.rules.block.hr.test(t))break;f=e[0],t=t.substring(f.length);let _=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,x=>" ".repeat(3*x.length)),h=t.split(`
`,1)[0],m=!_.trim(),T=0;if(this.options.pedantic?(T=2,p=_.trimStart()):m?T=e[1].length+1:(T=e[2].search(this.rules.other.nonSpaceChar),T=T>4?1:T,p=_.slice(T),T+=e[1].length),m&&this.rules.other.blankLine.test(h)&&(f+=h+`
`,t=t.substring(h.length+1),v=!0),!v){let x=this.rules.other.nextBulletRegex(T),y=this.rules.other.hrRegex(T),S=this.rules.other.fencesBeginRegex(T),N=this.rules.other.headingBeginRegex(T),b=this.rules.other.htmlBeginRegex(T);for(;t;){let j=t.split(`
`,1)[0],C;if(h=j,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),C=h):C=h.replace(this.rules.other.tabCharGlobal,"    "),S.test(h)||N.test(h)||b.test(h)||x.test(h)||y.test(h))break;if(C.search(this.rules.other.nonSpaceChar)>=T||!h.trim())p+=`
`+C.slice(T);else{if(m||_.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(_)||N.test(_)||y.test(_))break;p+=`
`+h}!m&&!h.trim()&&(m=!0),f+=j+`
`,t=t.substring(j.length+1),_=C.slice(T)}}n.loose||(c?n.loose=!0:this.rules.other.doubleBlankLine.test(f)&&(c=!0)),n.items.push({type:"list_item",raw:f,task:!!this.options.gfm&&this.rules.other.listIsTask.test(p),loose:!1,text:p,tokens:[]}),n.raw+=f}let d=n.items.at(-1);if(d)d.raw=d.raw.trimEnd(),d.text=d.text.trimEnd();else return;n.raw=n.raw.trimEnd();for(let v of n.items){if(this.lexer.state.top=!1,v.tokens=this.lexer.blockTokens(v.text,[]),v.task){if(v.text=v.text.replace(this.rules.other.listReplaceTask,""),v.tokens[0]?.type==="text"||v.tokens[0]?.type==="paragraph"){v.tokens[0].raw=v.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),v.tokens[0].text=v.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let p=this.lexer.inlineQueue.length-1;p>=0;p--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[p].src)){this.lexer.inlineQueue[p].src=this.lexer.inlineQueue[p].src.replace(this.rules.other.listReplaceTask,"");break}}let f=this.rules.other.listTaskCheckbox.exec(v.raw);if(f){let p={type:"checkbox",raw:f[0]+" ",checked:f[0]!=="[ ]"};v.checked=p.checked,n.loose?v.tokens[0]&&["paragraph","text"].includes(v.tokens[0].type)&&"tokens"in v.tokens[0]&&v.tokens[0].tokens?(v.tokens[0].raw=p.raw+v.tokens[0].raw,v.tokens[0].text=p.raw+v.tokens[0].text,v.tokens[0].tokens.unshift(p)):v.tokens.unshift({type:"paragraph",raw:p.raw,text:p.raw,tokens:[p]}):v.tokens.unshift(p)}}if(!n.loose){let f=v.tokens.filter(_=>_.type==="space"),p=f.length>0&&f.some(_=>this.rules.other.anyLine.test(_.raw));n.loose=p}}if(n.loose)for(let v of n.items){v.loose=!0;for(let f of v.tokens)f.type==="text"&&(f.type="paragraph")}return n}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let s=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",n=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:s,raw:e[0],href:r,title:n}}}table(t){let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let s=pr(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),n=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:e[0],header:[],align:[],rows:[]};if(s.length===r.length){for(let c of r)this.rules.other.tableAlignRight.test(c)?i.align.push("right"):this.rules.other.tableAlignCenter.test(c)?i.align.push("center"):this.rules.other.tableAlignLeft.test(c)?i.align.push("left"):i.align.push(null);for(let c=0;c<s.length;c++)i.header.push({text:s[c],tokens:this.lexer.inline(s[c]),header:!0,align:i.align[c]});for(let c of n)i.rows.push(pr(c,i.header.length).map((d,v)=>({text:d,tokens:this.lexer.inline(d),header:!1,align:i.align[v]})));return i}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let s=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:s,tokens:this.lexer.inline(s)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let s=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(s)){if(!this.rules.other.endAngleBracket.test(s))return;let i=us(s.slice(0,-1),"\\");if((s.length-i.length)%2===0)return}else{let i=Pc(e[2],"()");if(i===-2)return;if(i>-1){let c=(e[0].indexOf("!")===0?5:4)+e[1].length+i;e[2]=e[2].substring(0,i),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let r=e[2],n="";if(this.options.pedantic){let i=this.rules.other.pedanticHrefTitle.exec(r);i&&(r=i[1],n=i[3])}else n=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(s)?r=r.slice(1):r=r.slice(1,-1)),hr(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:n&&n.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let s;if((s=this.rules.inline.reflink.exec(t))||(s=this.rules.inline.nolink.exec(t))){let r=(s[2]||s[1]).replace(this.rules.other.multipleSpaceGlobal," "),n=e[r.toLowerCase()];if(!n){let i=s[0].charAt(0);return{type:"text",raw:i,text:i}}return hr(s,n,s[0],this.lexer,this.rules)}}emStrong(t,e,s=""){let r=this.rules.inline.emStrongLDelim.exec(t);if(!(!r||r[3]&&s.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!s||this.rules.inline.punctuation.exec(s))){let n=[...r[0]].length-1,i,c,d=n,v=0,f=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(f.lastIndex=0,e=e.slice(-1*t.length+n);(r=f.exec(e))!=null;){if(i=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!i)continue;if(c=[...i].length,r[3]||r[4]){d+=c;continue}else if((r[5]||r[6])&&n%3&&!((n+c)%3)){v+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d+v);let p=[...r[0]][0].length,_=t.slice(0,n+r.index+p+c);if(Math.min(n,c)%2){let m=_.slice(1,-1);return{type:"em",raw:_,text:m,tokens:this.lexer.inlineTokens(m)}}let h=_.slice(2,-2);return{type:"strong",raw:_,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let s=e[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(s),n=this.rules.other.startingSpaceChar.test(s)&&this.rules.other.endingSpaceChar.test(s);return r&&n&&(s=s.substring(1,s.length-1)),{type:"codespan",raw:e[0],text:s}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){let e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let s,r;return e[2]==="@"?(s=e[1],r="mailto:"+s):(s=e[1],r=s),{type:"link",raw:e[0],text:s,href:r,tokens:[{type:"text",raw:s,text:s}]}}}url(t){let e;if(e=this.rules.inline.url.exec(t)){let s,r;if(e[2]==="@")s=e[0],r="mailto:"+s;else{let n;do n=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(n!==e[0]);s=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:s,href:r,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let s=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:s}}}},ia=class _n{tokens;options;state;inlineQueue;tokenizer;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Xa,this.options.tokenizer=this.options.tokenizer||new Bs,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let s={other:Ut,block:zs.normal,inline:vs.normal};this.options.pedantic?(s.block=zs.pedantic,s.inline=vs.pedantic):this.options.gfm&&(s.block=zs.gfm,this.options.breaks?s.inline=vs.breaks:s.inline=vs.gfm),this.tokenizer.rules=s}static get rules(){return{block:zs,inline:vs}}static lex(e,s){return new _n(s).lex(e)}static lexInline(e,s){return new _n(s).inlineTokens(e)}lex(e){e=e.replace(Ut.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let s=0;s<this.inlineQueue.length;s++){let r=this.inlineQueue[s];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,s=[],r=!1){for(this.options.pedantic&&(e=e.replace(Ut.tabCharGlobal,"    ").replace(Ut.spaceLine,""));e;){let n;if(this.options.extensions?.block?.some(c=>(n=c.call({lexer:this},e,s))?(e=e.substring(n.raw.length),s.push(n),!0):!1))continue;if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length);let c=s.at(-1);n.raw.length===1&&c!==void 0?c.raw+=`
`:s.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length);let c=s.at(-1);c?.type==="paragraph"||c?.type==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+n.raw,c.text+=`
`+n.text,this.inlineQueue.at(-1).src=c.text):s.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),s.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),s.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),s.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),s.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),s.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),s.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length);let c=s.at(-1);c?.type==="paragraph"||c?.type==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+n.raw,c.text+=`
`+n.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title},s.push(n));continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),s.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),s.push(n);continue}let i=e;if(this.options.extensions?.startBlock){let c=1/0,d=e.slice(1),v;this.options.extensions.startBlock.forEach(f=>{v=f.call({lexer:this},d),typeof v=="number"&&v>=0&&(c=Math.min(c,v))}),c<1/0&&c>=0&&(i=e.substring(0,c+1))}if(this.state.top&&(n=this.tokenizer.paragraph(i))){let c=s.at(-1);r&&c?.type==="paragraph"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+n.raw,c.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):s.push(n),r=i.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length);let c=s.at(-1);c?.type==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+n.raw,c.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):s.push(n);continue}if(e){let c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,s}inline(e,s=[]){return this.inlineQueue.push({src:e,tokens:s}),s}inlineTokens(e,s=[]){let r=e,n=null;if(this.tokens.links){let v=Object.keys(this.tokens.links);if(v.length>0)for(;(n=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)v.includes(n[0].slice(n[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(n=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,n.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let i;for(;(n=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)i=n[2]?n[2].length:0,r=r.slice(0,n.index+i)+"["+"a".repeat(n[0].length-i-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=this.options.hooks?.emStrongMask?.call({lexer:this},r)??r;let c=!1,d="";for(;e;){c||(d=""),c=!1;let v;if(this.options.extensions?.inline?.some(p=>(v=p.call({lexer:this},e,s))?(e=e.substring(v.raw.length),s.push(v),!0):!1))continue;if(v=this.tokenizer.escape(e)){e=e.substring(v.raw.length),s.push(v);continue}if(v=this.tokenizer.tag(e)){e=e.substring(v.raw.length),s.push(v);continue}if(v=this.tokenizer.link(e)){e=e.substring(v.raw.length),s.push(v);continue}if(v=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(v.raw.length);let p=s.at(-1);v.type==="text"&&p?.type==="text"?(p.raw+=v.raw,p.text+=v.text):s.push(v);continue}if(v=this.tokenizer.emStrong(e,r,d)){e=e.substring(v.raw.length),s.push(v);continue}if(v=this.tokenizer.codespan(e)){e=e.substring(v.raw.length),s.push(v);continue}if(v=this.tokenizer.br(e)){e=e.substring(v.raw.length),s.push(v);continue}if(v=this.tokenizer.del(e)){e=e.substring(v.raw.length),s.push(v);continue}if(v=this.tokenizer.autolink(e)){e=e.substring(v.raw.length),s.push(v);continue}if(!this.state.inLink&&(v=this.tokenizer.url(e))){e=e.substring(v.raw.length),s.push(v);continue}let f=e;if(this.options.extensions?.startInline){let p=1/0,_=e.slice(1),h;this.options.extensions.startInline.forEach(m=>{h=m.call({lexer:this},_),typeof h=="number"&&h>=0&&(p=Math.min(p,h))}),p<1/0&&p>=0&&(f=e.substring(0,p+1))}if(v=this.tokenizer.inlineText(f)){e=e.substring(v.raw.length),v.raw.slice(-1)!=="_"&&(d=v.raw.slice(-1)),c=!0;let p=s.at(-1);p?.type==="text"?(p.raw+=v.raw,p.text+=v.text):s.push(v);continue}if(e){let p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return s}},Us=class{options;parser;constructor(t){this.options=t||Xa}space(t){return""}code({text:t,lang:e,escaped:s}){let r=(e||"").match(Ut.notSpaceStart)?.[0],n=t.replace(Ut.endingNewline,"")+`
`;return r?'<pre><code class="language-'+pa(r)+'">'+(s?n:pa(n,!0))+`</code></pre>
`:"<pre><code>"+(s?n:pa(n,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,s=t.start,r="";for(let c=0;c<t.items.length;c++){let d=t.items[c];r+=this.listitem(d)}let n=e?"ol":"ul",i=e&&s!==1?' start="'+s+'"':"";return"<"+n+i+`>
`+r+"</"+n+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",s="";for(let n=0;n<t.header.length;n++)s+=this.tablecell(t.header[n]);e+=this.tablerow({text:s});let r="";for(let n=0;n<t.rows.length;n++){let i=t.rows[n];s="";for(let c=0;c<i.length;c++)s+=this.tablecell(i[c]);r+=this.tablerow({text:s})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),s=t.header?"th":"td";return(t.align?`<${s} align="${t.align}">`:`<${s}>`)+e+`</${s}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${pa(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:s}){let r=this.parser.parseInline(s),n=fr(t);if(n===null)return r;t=n;let i='<a href="'+t+'"';return e&&(i+=' title="'+pa(e)+'"'),i+=">"+r+"</a>",i}image({href:t,title:e,text:s,tokens:r}){r&&(s=this.parser.parseInline(r,this.parser.textRenderer));let n=fr(t);if(n===null)return pa(s);t=n;let i=`<img src="${t}" alt="${s}"`;return e&&(i+=` title="${pa(e)}"`),i+=">",i}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:pa(t.text)}},Xn=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},la=class gn{options;renderer;textRenderer;constructor(e){this.options=e||Xa,this.options.renderer=this.options.renderer||new Us,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Xn}static parse(e,s){return new gn(s).parse(e)}static parseInline(e,s){return new gn(s).parseInline(e)}parse(e){let s="";for(let r=0;r<e.length;r++){let n=e[r];if(this.options.extensions?.renderers?.[n.type]){let c=n,d=this.options.extensions.renderers[c.type].call({parser:this},c);if(d!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(c.type)){s+=d||"";continue}}let i=n;switch(i.type){case"space":{s+=this.renderer.space(i);break}case"hr":{s+=this.renderer.hr(i);break}case"heading":{s+=this.renderer.heading(i);break}case"code":{s+=this.renderer.code(i);break}case"table":{s+=this.renderer.table(i);break}case"blockquote":{s+=this.renderer.blockquote(i);break}case"list":{s+=this.renderer.list(i);break}case"checkbox":{s+=this.renderer.checkbox(i);break}case"html":{s+=this.renderer.html(i);break}case"def":{s+=this.renderer.def(i);break}case"paragraph":{s+=this.renderer.paragraph(i);break}case"text":{s+=this.renderer.text(i);break}default:{let c='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return s}parseInline(e,s=this.renderer){let r="";for(let n=0;n<e.length;n++){let i=e[n];if(this.options.extensions?.renderers?.[i.type]){let d=this.options.extensions.renderers[i.type].call({parser:this},i);if(d!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){r+=d||"";continue}}let c=i;switch(c.type){case"escape":{r+=s.text(c);break}case"html":{r+=s.html(c);break}case"link":{r+=s.link(c);break}case"image":{r+=s.image(c);break}case"checkbox":{r+=s.checkbox(c);break}case"strong":{r+=s.strong(c);break}case"em":{r+=s.em(c);break}case"codespan":{r+=s.codespan(c);break}case"br":{r+=s.br(c);break}case"del":{r+=s.del(c);break}case"text":{r+=s.text(c);break}default:{let d='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(d),"";throw new Error(d)}}}return r}},ps=class{options;block;constructor(t){this.options=t||Xa}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?ia.lex:ia.lexInline}provideParser(){return this.block?la.parse:la.parseInline}},Dc=class{defaults=In();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=la;Renderer=Us;TextRenderer=Xn;Lexer=ia;Tokenizer=Bs;Hooks=ps;constructor(...t){this.use(...t)}walkTokens(t,e){let s=[];for(let r of t)switch(s=s.concat(e.call(this,r)),r.type){case"table":{let n=r;for(let i of n.header)s=s.concat(this.walkTokens(i.tokens,e));for(let i of n.rows)for(let c of i)s=s.concat(this.walkTokens(c.tokens,e));break}case"list":{let n=r;s=s.concat(this.walkTokens(n.items,e));break}default:{let n=r;this.defaults.extensions?.childTokens?.[n.type]?this.defaults.extensions.childTokens[n.type].forEach(i=>{let c=n[i].flat(1/0);s=s.concat(this.walkTokens(c,e))}):n.tokens&&(s=s.concat(this.walkTokens(n.tokens,e)))}}return s}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(s=>{let r={...s};if(r.async=this.defaults.async||r.async||!1,s.extensions&&(s.extensions.forEach(n=>{if(!n.name)throw new Error("extension name required");if("renderer"in n){let i=e.renderers[n.name];i?e.renderers[n.name]=function(...c){let d=n.renderer.apply(this,c);return d===!1&&(d=i.apply(this,c)),d}:e.renderers[n.name]=n.renderer}if("tokenizer"in n){if(!n.level||n.level!=="block"&&n.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let i=e[n.level];i?i.unshift(n.tokenizer):e[n.level]=[n.tokenizer],n.start&&(n.level==="block"?e.startBlock?e.startBlock.push(n.start):e.startBlock=[n.start]:n.level==="inline"&&(e.startInline?e.startInline.push(n.start):e.startInline=[n.start]))}"childTokens"in n&&n.childTokens&&(e.childTokens[n.name]=n.childTokens)}),r.extensions=e),s.renderer){let n=this.defaults.renderer||new Us(this.defaults);for(let i in s.renderer){if(!(i in n))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;let c=i,d=s.renderer[c],v=n[c];n[c]=(...f)=>{let p=d.apply(n,f);return p===!1&&(p=v.apply(n,f)),p||""}}r.renderer=n}if(s.tokenizer){let n=this.defaults.tokenizer||new Bs(this.defaults);for(let i in s.tokenizer){if(!(i in n))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;let c=i,d=s.tokenizer[c],v=n[c];n[c]=(...f)=>{let p=d.apply(n,f);return p===!1&&(p=v.apply(n,f)),p}}r.tokenizer=n}if(s.hooks){let n=this.defaults.hooks||new ps;for(let i in s.hooks){if(!(i in n))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;let c=i,d=s.hooks[c],v=n[c];ps.passThroughHooks.has(i)?n[c]=f=>{if(this.defaults.async&&ps.passThroughHooksRespectAsync.has(i))return(async()=>{let _=await d.call(n,f);return v.call(n,_)})();let p=d.call(n,f);return v.call(n,p)}:n[c]=(...f)=>{if(this.defaults.async)return(async()=>{let _=await d.apply(n,f);return _===!1&&(_=await v.apply(n,f)),_})();let p=d.apply(n,f);return p===!1&&(p=v.apply(n,f)),p}}r.hooks=n}if(s.walkTokens){let n=this.defaults.walkTokens,i=s.walkTokens;r.walkTokens=function(c){let d=[];return d.push(i.call(this,c)),n&&(d=d.concat(n.call(this,c))),d}}this.defaults={...this.defaults,...r}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return ia.lex(t,e??this.defaults)}parser(t,e){return la.parse(t,e??this.defaults)}parseMarkdown(t){return(e,s)=>{let r={...s},n={...this.defaults,...r},i=this.onError(!!n.silent,!!n.async);if(this.defaults.async===!0&&r.async===!1)return i(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return i(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(n.hooks&&(n.hooks.options=n,n.hooks.block=t),n.async)return(async()=>{let c=n.hooks?await n.hooks.preprocess(e):e,d=await(n.hooks?await n.hooks.provideLexer():t?ia.lex:ia.lexInline)(c,n),v=n.hooks?await n.hooks.processAllTokens(d):d;n.walkTokens&&await Promise.all(this.walkTokens(v,n.walkTokens));let f=await(n.hooks?await n.hooks.provideParser():t?la.parse:la.parseInline)(v,n);return n.hooks?await n.hooks.postprocess(f):f})().catch(i);try{n.hooks&&(e=n.hooks.preprocess(e));let c=(n.hooks?n.hooks.provideLexer():t?ia.lex:ia.lexInline)(e,n);n.hooks&&(c=n.hooks.processAllTokens(c)),n.walkTokens&&this.walkTokens(c,n.walkTokens);let d=(n.hooks?n.hooks.provideParser():t?la.parse:la.parseInline)(c,n);return n.hooks&&(d=n.hooks.postprocess(d)),d}catch(c){return i(c)}}}onError(t,e){return s=>{if(s.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let r="<p>An error occurred:</p><pre>"+pa(s.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(s);throw s}}},Ua=new Dc;function rt(t,e){return Ua.parse(t,e)}rt.options=rt.setOptions=function(t){return Ua.setOptions(t),rt.defaults=Ua.defaults,ui(rt.defaults),rt};rt.getDefaults=In;rt.defaults=Xa;rt.use=function(...t){return Ua.use(...t),rt.defaults=Ua.defaults,ui(rt.defaults),rt};rt.walkTokens=function(t,e){return Ua.walkTokens(t,e)};rt.parseInline=Ua.parseInline;rt.Parser=la;rt.parser=la.parse;rt.Renderer=Us;rt.TextRenderer=Xn;rt.Lexer=ia;rt.lexer=ia.lex;rt.Tokenizer=Bs;rt.Hooks=ps;rt.parse=rt;rt.options;rt.setOptions;rt.use;rt.walkTokens;rt.parseInline;la.parse;ia.lex;var Rc=w('<span class="author"> </span>'),zc=w('<span class="date"> </span>'),Mc=w('<span class="tag-badge svelte-187zyvb"> </span>'),Nc=w('<div class="tags-row svelte-187zyvb"></div>'),Oc=w('<img class="svelte-187zyvb"/>'),Ic=w('<div class="attachment-card svelte-187zyvb"><!> <a target="_blank" rel="noreferrer" class="svelte-187zyvb"> </a></div>'),Lc=w('<div class="attachments svelte-187zyvb"><h3 class="svelte-187zyvb">Attachments</h3> <div class="grid svelte-187zyvb"></div></div>'),$c=w('<a target="_blank" rel="noreferrer" class="note-attachment-link svelte-187zyvb"> </a>'),Fc=w('<div class="note-attachments svelte-187zyvb"><strong class="svelte-187zyvb">Attachments:</strong> <!></div>'),Bc=w('<div class="note-card svelte-187zyvb"><div class="note-header svelte-187zyvb"><span> </span> <span class="note-author svelte-187zyvb"> </span> <span class="note-date svelte-187zyvb"> </span> <span> </span></div> <p class="note-text svelte-187zyvb"> </p> <!></div>'),Uc=w('<div class="notes-section svelte-187zyvb"><h3 class="svelte-187zyvb">Notes</h3> <div class="notes-list svelte-187zyvb"></div></div>'),Gc=w('<div class="document-view"><h2 class="svelte-187zyvb"> </h2> <div class="meta svelte-187zyvb"><span> </span> <span> </span> <span class="date"> </span> <!> <!></div> <!> <div class="content markdown-body svelte-187zyvb"><!></div> <!> <!></div>');function Yc(t,e){it(e,!0);let s=nt(()=>e.document&&e.document.content?rt.parse(e.document.content):"<p>No content available.</p>");var r=Gc(),n=o(r),i=o(n),c=l(n,2),d=o(c),v=o(d),f=l(d,2),p=o(f),_=l(f,2),h=o(_),m=l(_,2);{var T=D=>{var H=Rc(),Z=o(H);U(()=>q(Z,`By ${e.document.author??""}`)),g(D,H)};$(m,D=>{e.document?.author&&D(T)})}var x=l(m,2);{var y=D=>{var H=zc(),Z=o(H);U(()=>q(Z,`Done: ${e.document.done_date??""}`)),g(D,H)};$(x,D=>{e.document?.done_date&&D(y)})}var S=l(c,2);{var N=D=>{var H=Nc();Ae(H,21,()=>e.document.tags,Ge,(Z,L)=>{var M=Mc(),K=o(M);U(()=>q(K,`#${a(L).name??""}`)),g(Z,M)}),g(D,H)};$(S,D=>{e.document?.tags?.length>0&&D(N)})}var b=l(S,2),j=o(b);Jl(j,()=>a(s));var C=l(b,2);{var R=D=>{var H=Lc(),Z=l(o(H),2);Ae(Z,21,()=>e.document.attachments,Ge,(L,M)=>{var K=Ic(),re=o(K);{var be=me=>{var le=Oc();U(()=>{We(le,"src",a(M).file_path),We(le,"alt",a(M).filename)}),g(me,le)};$(re,me=>{a(M).media_type&&a(M).media_type.startsWith("image/")&&me(be)})}var _e=l(re,2),ke=o(_e);U(()=>{We(_e,"href",a(M).file_path),q(ke,a(M).filename)}),g(L,K)}),g(D,H)};$(C,D=>{e.document?.attachments?.length>0&&D(R)})}var J=l(C,2);{var Y=D=>{var H=Uc(),Z=l(o(H),2);Ae(Z,21,()=>e.document.journal_entries,Ge,(L,M)=>{var K=Bc(),re=o(K),be=o(re),_e=o(be),ke=l(be,2),me=o(ke),le=l(ke,2),Te=o(le),xe=l(le,2),oe=o(xe),E=l(re,2),I=o(E),ee=l(E,2);{var Q=ae=>{var Se=Fc(),Pe=l(o(Se),2);Ae(Pe,17,()=>a(M).attachments,Ge,($e,Me)=>{var z=$c(),G=o(z);U(()=>{We(z,"href",a(Me).file_path),q(G,`ðŸ“Ž ${a(Me).filename??""}`)}),g($e,z)}),g(ae,Se)};$(ee,ae=>{a(M).attachments?.length>0&&ae(Q)})}U(()=>{Le(be,1,`note-badge ${a(M).type??""}`,"svelte-187zyvb"),q(_e,a(M).type),q(me,a(M).author||"Unknown"),q(Te,a(M).created_at),Le(xe,1,`note-status ${a(M).status??""}`,"svelte-187zyvb"),q(oe,a(M).status),q(I,a(M).text)}),g(L,K)}),g(D,H)};$(J,D=>{e.document?.journal_entries?.length>0&&D(Y)})}U(D=>{q(i,e.document?.name),Le(d,1,`badge ${e.document?.type??""}`,"svelte-187zyvb"),q(v,e.document?.type),Le(f,1,`badge status-${e.document?.status??""}`,"svelte-187zyvb"),q(p,D),q(h,e.document?.registration_date)},[()=>e.document?.status.replace("_"," ")]),g(t,r),lt()}var Xc=w('<input type="text" class="edit-input svelte-1b0y5ne"/>'),Jc=w('<button class="btn-icon svelte-1b0y5ne" title="Save">âœ“</button> <button class="btn-icon svelte-1b0y5ne" title="Cancel">âœ•</button>',1),Hc=w('<button class="btn-icon svelte-1b0y5ne" title="Edit">âœï¸</button> <button class="btn-icon delete svelte-1b0y5ne" title="Delete">ðŸ—‘ï¸</button>',1),Wc=w('<tr class="svelte-1b0y5ne"><td class="svelte-1b0y5ne"><!></td><td class="svelte-1b0y5ne"><!></td></tr>'),Vc=w('<div class="empty-state svelte-1b0y5ne">No materials yet. Add one above.</div>'),Zc=w('<div class="modal-overlay svelte-1b0y5ne"><div class="modal-content svelte-1b0y5ne"><div class="modal-header svelte-1b0y5ne"><h3 class="svelte-1b0y5ne">Material Library</h3> <button class="close-btn svelte-1b0y5ne">&times;</button></div> <div class="modal-body svelte-1b0y5ne"><div class="add-section svelte-1b0y5ne"><input type="text" placeholder="New material name..." class="svelte-1b0y5ne"/> <button class="btn-add svelte-1b0y5ne">Add</button></div> <table class="materials-table svelte-1b0y5ne"><thead><tr><th class="svelte-1b0y5ne">Name</th><th class="svelte-1b0y5ne">Actions</th></tr></thead><tbody></tbody></table> <!></div></div></div>');function Qc(t,e){it(e,!0);let s=k(ye([])),r=k(""),n=k(null),i=k("");async function c(){e.isOpen&&u(s,await Ya(),!0)}Bt(()=>{c()});async function d(){if(a(r).trim())try{await To({name:a(r).trim()}),u(r,""),await c()}catch(x){console.error(x),alert("Failed to add material")}}function v(x){u(n,x.id,!0),u(i,x.name,!0)}async function f(){if(!(!a(i).trim()||a(n)===null))try{await Eo(a(n),a(i).trim()),u(n,null),u(i,""),await c()}catch(x){console.error(x),alert("Failed to update material")}}function p(){u(n,null),u(i,"")}async function _(x){if(confirm("Delete this material?"))try{await jo(x),await c()}catch(y){console.error(y),alert("Failed to delete material")}}var h=dt(),m=qe(h);{var T=x=>{var y=Zc();y.__click=function(...L){e.close?.apply(this,L)};var S=o(y);S.__click=L=>L.stopPropagation();var N=o(S),b=l(o(N),2);b.__click=function(...L){e.close?.apply(this,L)};var j=l(N,2),C=o(j),R=o(C);R.__keydown=L=>L.key==="Enter"&&d();var J=l(R,2);J.__click=d;var Y=l(C,2),D=l(o(Y));Ae(D,21,()=>a(s),L=>L.id,(L,M)=>{var K=Wc(),re=o(K),be=o(re);{var _e=oe=>{var E=Xc();qn(E),E.__keydown=I=>{I.key==="Enter"&&f(),I.key==="Escape"&&p()},Ce(E,()=>a(i),I=>u(i,I)),g(oe,E)},ke=oe=>{var E=oi();U(()=>q(E,a(M).name)),g(oe,E)};$(be,oe=>{a(n)===a(M).id?oe(_e):oe(ke,!1)})}var me=l(re),le=o(me);{var Te=oe=>{var E=Jc(),I=qe(E);I.__click=f;var ee=l(I,2);ee.__click=p,g(oe,E)},xe=oe=>{var E=Hc(),I=qe(E);I.__click=()=>v(a(M));var ee=l(I,2);ee.__click=()=>_(a(M).id),g(oe,E)};$(le,oe=>{a(n)===a(M).id?oe(Te):oe(xe,!1)})}g(L,K)});var H=l(Y,2);{var Z=L=>{var M=Vc();g(L,M)};$(H,L=>{a(s).length===0&&L(Z)})}Ce(R,()=>a(r),L=>u(r,L)),g(x,y)};$(m,x=>{e.isOpen&&x(T)})}g(t,h),lt()}_t(["click","keydown"]);var Kc=w('<input type="text" class="edit-input svelte-1w6q42o"/>'),ev=w('<button class="btn-icon svelte-1w6q42o" title="Save">âœ“</button> <button class="btn-icon svelte-1w6q42o" title="Cancel">âœ•</button>',1),tv=w('<button class="btn-icon svelte-1w6q42o" title="Edit">âœï¸</button> <button class="btn-icon delete svelte-1w6q42o" title="Delete">ðŸ—‘ï¸</button>',1),av=w('<tr class="svelte-1w6q42o"><td class="svelte-1w6q42o"><!></td><td class="svelte-1w6q42o"><!></td></tr>'),sv=w('<div class="empty-state svelte-1w6q42o">No assignees yet. Add one above.</div>'),nv=w('<div class="modal-overlay svelte-1w6q42o"><div class="modal-content svelte-1w6q42o"><div class="modal-header svelte-1w6q42o"><h3 class="svelte-1w6q42o">Assignee Library</h3> <button class="close-btn svelte-1w6q42o">&times;</button></div> <div class="modal-body svelte-1w6q42o"><div class="add-section svelte-1w6q42o"><input type="text" placeholder="New assignee name..." class="svelte-1w6q42o"/> <button class="btn-add svelte-1w6q42o">Add</button></div> <table class="assignees-table svelte-1w6q42o"><thead><tr><th class="svelte-1w6q42o">Name</th><th class="svelte-1w6q42o">Actions</th></tr></thead><tbody></tbody></table> <!></div></div></div>');function ki(t,e){it(e,!0);let s=k(ye([])),r=k(""),n=k(null),i=k("");async function c(){e.isOpen&&u(s,await ks(),!0)}Bt(()=>{c()});async function d(){if(a(r).trim())try{await No({name:a(r).trim()}),u(r,""),await c()}catch(x){console.error(x),alert("Failed to add assignee")}}function v(x){u(n,x.id,!0),u(i,x.name,!0)}async function f(){if(!(!a(i).trim()||a(n)===null))try{await Oo(a(n),a(i).trim()),u(n,null),u(i,""),await c()}catch(x){console.error(x),alert("Failed to update assignee")}}function p(){u(n,null),u(i,"")}async function _(x){if(confirm("Delete this assignee?"))try{await Io(x),await c()}catch(y){console.error(y),alert("Failed to delete assignee")}}var h=dt(),m=qe(h);{var T=x=>{var y=nv();y.__click=function(...L){e.close?.apply(this,L)};var S=o(y);S.__click=L=>L.stopPropagation();var N=o(S),b=l(o(N),2);b.__click=function(...L){e.close?.apply(this,L)};var j=l(N,2),C=o(j),R=o(C);R.__keydown=L=>L.key==="Enter"&&d();var J=l(R,2);J.__click=d;var Y=l(C,2),D=l(o(Y));Ae(D,21,()=>a(s),L=>L.id,(L,M)=>{var K=av(),re=o(K),be=o(re);{var _e=oe=>{var E=Kc();qn(E),E.__keydown=I=>{I.key==="Enter"&&f(),I.key==="Escape"&&p()},Ce(E,()=>a(i),I=>u(i,I)),g(oe,E)},ke=oe=>{var E=oi();U(()=>q(E,a(M).name)),g(oe,E)};$(be,oe=>{a(n)===a(M).id?oe(_e):oe(ke,!1)})}var me=l(re),le=o(me);{var Te=oe=>{var E=ev(),I=qe(E);I.__click=f;var ee=l(I,2);ee.__click=p,g(oe,E)},xe=oe=>{var E=tv(),I=qe(E);I.__click=()=>v(a(M));var ee=l(I,2);ee.__click=()=>_(a(M).id),g(oe,E)};$(le,oe=>{a(n)===a(M).id?oe(Te):oe(xe,!1)})}g(L,K)});var H=l(Y,2);{var Z=L=>{var M=sv();g(L,M)};$(H,L=>{a(s).length===0&&L(Z)})}Ce(R,()=>a(r),L=>u(r,L)),g(x,y)};$(m,x=>{e.isOpen&&x(T)})}g(t,h),lt()}_t(["click","keydown"]);var rv=w("<option> </option>"),iv=w('<div class="part-item svelte-1iwbfq1"><span class="part-name svelte-1iwbfq1"> </span> <span class="part-qty svelte-1iwbfq1"> </span></div>'),lv=w('<div class="form-group svelte-1iwbfq1"><label class="svelte-1iwbfq1">Associated Parts</label> <div class="parts-list svelte-1iwbfq1"></div></div>'),ov=w("<option> </option>"),cv=w('<div class="modal-overlay svelte-1iwbfq1"><div class="modal-content svelte-1iwbfq1"><div class="modal-header svelte-1iwbfq1"><h3 class="svelte-1iwbfq1"> </h3> <button class="close-btn svelte-1iwbfq1">&times;</button></div> <form class="modal-body svelte-1iwbfq1"><div class="form-group svelte-1iwbfq1"><label for="name" class="svelte-1iwbfq1">Task Name</label> <input id="name" type="text" placeholder="Enter task name..." required class="svelte-1iwbfq1"/></div> <div class="form-group svelte-1iwbfq1"><label for="material" class="svelte-1iwbfq1">Material</label> <div class="material-row svelte-1iwbfq1"><select id="material" class="material-select svelte-1iwbfq1"><option>-- No Material --</option><!></select> <button type="button" class="btn-library svelte-1iwbfq1" title="Edit Material Library">ðŸ“š</button></div></div> <div class="form-group svelte-1iwbfq1"><label for="gnc_path" class="svelte-1iwbfq1">GNC File Path</label> <input id="gnc_path" type="text" placeholder="e.g. Z:\\Sidra\\Part1.gnc" class="svelte-1iwbfq1"/></div> <!> <div class="form-group svelte-1iwbfq1"><label for="assignee" class="svelte-1iwbfq1">Assignee</label> <div class="material-row svelte-1iwbfq1"><select id="assignee" class="material-select svelte-1iwbfq1"><option>-- No Assignee --</option><!></select> <button type="button" class="btn-library svelte-1iwbfq1" title="Edit Assignee Library">ðŸ‘¥</button></div></div> <div class="actions svelte-1iwbfq1"><button type="button" class="btn-secondary svelte-1iwbfq1">Cancel</button> <button type="submit" class="btn-primary svelte-1iwbfq1"> </button></div></form></div></div>'),vv=w("<!> <!> <!>",1);function uv(t,e){it(e,!0);let s=xt(e,"task",3,null),r=k(""),n=k(""),i=k(null),c=k(""),d=k(!1),v=k(ye([])),f=k(ye([])),p=k(!1),_=k(!1);async function h(){u(v,await Ya(),!0)}async function m(){u(f,await ks(),!0)}Bt(()=>{e.isOpen&&(console.log("TaskModal Opened. Task:",s()),s()?(u(r,s().name,!0),u(n,s().assignee||"",!0),u(i,s().material_id||(s().material?s().material.id:null),!0),u(c,s().gnc_file_path||"",!0)):(u(n,localStorage.getItem("task_assignee")||"",!0),u(r,""),u(i,null),u(c,"")),h(),m())});async function T(Y){if(Y.preventDefault(),!!a(r)){u(d,!0);try{a(n)&&!s()&&localStorage.setItem("task_assignee",a(n)),await e.onSubmit({id:s()?s().id:void 0,name:a(r),assignee:a(n),material_id:a(i),gnc_file_path:a(c)}),e.close()}catch(D){console.error(D),alert("Failed to add task")}finally{u(d,!1)}}}function x(){u(p,!0)}function y(){u(p,!1),h()}function S(){u(_,!0)}function N(){u(_,!1),m()}var b=vv(),j=qe(b);{var C=Y=>{var D=cv();D.__click=function(...W){e.close?.apply(this,W)};var H=o(D);H.__click=W=>W.stopPropagation();var Z=o(H),L=o(Z),M=o(L),K=l(L,2);K.__click=function(...W){e.close?.apply(this,W)};var re=l(Z,2),be=o(re),_e=l(o(be),2);qn(_e);var ke=l(be,2),me=l(o(ke),2),le=o(me),Te=o(le);Te.value=(Te.__value=null)??"";var xe=l(Te);Ae(xe,17,()=>a(v),Ge,(W,se)=>{var ne=rv(),ie=o(ne),ve={};U(()=>{q(ie,a(se).name),ve!==(ve=a(se).id)&&(ne.value=(ne.__value=a(se).id)??"")}),g(W,ne)});var oe=l(le,2);oe.__click=x;var E=l(ke,2),I=l(o(E),2),ee=l(E,2);{var Q=W=>{var se=lv(),ne=l(o(se),2);Ae(ne,21,()=>s().part_associations,Ge,(ie,ve)=>{var F=iv(),fe=o(F),P=o(fe),A=l(fe,2),te=o(A);U(()=>{We(fe,"title",a(ve).part.name),q(P,a(ve).part.name),q(te,`x${a(ve).quantity??""}`)}),g(ie,F)}),g(W,se)};$(ee,W=>{s()&&s().part_associations&&s().part_associations.length>0&&W(Q)})}var ae=l(ee,2),Se=l(o(ae),2),Pe=o(Se),$e=o(Pe);$e.value=$e.__value="";var Me=l($e);Ae(Me,17,()=>a(f),Ge,(W,se)=>{var ne=ov(),ie=o(ne),ve={};U(()=>{q(ie,a(se).name),ve!==(ve=a(se).name)&&(ne.value=(ne.__value=a(se).name)??"")}),g(W,ne)});var z=l(Pe,2);z.__click=S;var G=l(ae,2),ce=o(G);ce.__click=function(...W){e.close?.apply(this,W)};var ue=l(ce,2),X=o(ue);U(()=>{q(M,s()?"Edit Task":"Add Task"),ue.disabled=a(d),q(X,a(d)?s()?"Saving...":"Adding...":s()?"Save Changes":"Add Task")}),ka("submit",re,T),Ce(_e,()=>a(r),W=>u(r,W)),At(le,()=>a(i),W=>u(i,W)),Ce(I,()=>a(c),W=>u(c,W)),At(Pe,()=>a(n),W=>u(n,W)),g(Y,D)};$(j,Y=>{e.isOpen&&Y(C)})}var R=l(j,2);Qc(R,{get isOpen(){return a(p)},close:y});var J=l(R,2);ki(J,{get isOpen(){return a(_)},close:N}),g(t,b),lt()}_t(["click"]);var dv=w('<div class="material-group-header svelte-ty272s"><span class="material-group-name svelte-ty272s"> </span> <span class="material-group-count svelte-ty272s"> </span></div>'),fv=w("<option> </option>"),pv=w('<span class="material-badge svelte-ty272s"> </span>'),hv=w('<div class="task-item svelte-ty272s"><div class="task-line-1 svelte-ty272s"><span> </span> <div class="task-right-group svelte-ty272s"><select><option>Planned</option><option>Pending</option><option>Done</option></select> <div class="task-actions svelte-ty272s"><button class="edit-btn svelte-ty272s" title="Edit">âœŽ</button> <button class="delete-btn svelte-ty272s" title="Delete">Ã—</button></div></div></div> <div class="task-line-2 svelte-ty272s"><div class="assignee-container svelte-ty272s"><select class="assignee-select svelte-ty272s"><option>Assignee</option><!></select> <button class="assignee-add-btn svelte-ty272s" title="Manage Assignees">+</button></div> <!></div></div>'),_v=w("<!> <!>",1),gv=w('<div class="empty-tasks svelte-ty272s"> </div>'),mv=w('<div class="embedded-tasks svelte-ty272s"><div class="tasks-header svelte-ty272s"><h4 class="svelte-ty272s">Tasks</h4> <div class="header-actions svelte-ty272s"><button class="group-toggle-btn svelte-ty272s"> </button> <select class="filter-select svelte-ty272s"><option>Hide Done</option><option>Show All</option><option>Pending</option></select> <button class="add-task-btn svelte-ty272s">+ Add</button></div></div> <div class="tasks-list svelte-ty272s"><!> <!></div></div> <!> <!>',1);function bv(t,e){it(e,!0);let s=xt(e,"filterAssignee",3,""),r=xt(e,"partSearch",3,""),n=k(ye(e.document.tasks||[]));Bt(()=>{u(n,e.document.tasks||[],!0)});let i=k("hide_done"),c=k(!1),d=k(null),v=k(!0),f=k(ye([])),p=k(!1);Vt(async()=>{u(f,await ks(),!0)});async function _(){u(f,await ks(),!0)}let h=nt(()=>[...a(n)].sort((E,I)=>E.status==="done"&&I.status!=="done"?1:E.status!=="done"&&I.status==="done"?-1:0)),m=nt(()=>a(h).filter(E=>{if(a(i)==="hide_done"&&E.status==="done"||a(i)==="pending"&&E.status!=="pending")return!1;if(a(i)==="all"){if(s()&&s().trim()){const I=(E.assignee||"").toLowerCase(),ee=s().toLowerCase();return I.includes(ee)}return!0}if(s()&&s().trim()){const I=(E.assignee||"").toLowerCase(),ee=s().toLowerCase();if(!I.includes(ee))return!1}if(r()&&r().trim()){if(!E.part_associations||E.part_associations.length===0)return!1;const I=r().toLowerCase();if(!E.part_associations.some(Q=>{const ae=Q.part;return ae?ae.name&&ae.name.toLowerCase().includes(I)||ae.registration_number&&ae.registration_number.toLowerCase().includes(I):!1}))return!1}return!0})),T=nt(()=>()=>{if(!a(v))return{"All Tasks":a(m)};const E={};a(m).forEach(Q=>{const ae=Q.material?Q.material.name:"(No Material)";E[ae]||(E[ae]=[]),E[ae].push(Q)});const I={};return Object.keys(E).sort((Q,ae)=>Q==="(No Material)"?1:ae==="(No Material)"?-1:Q.localeCompare(ae)).forEach(Q=>{I[Q]=E[Q]}),I});async function x(E,I){try{E.status=I,await Ns(E.id,{status:I}),e.refresh()}catch(ee){console.error(ee)}}async function y(E,I){try{await Ns(E.id,{assignee:I})}catch(ee){console.error(ee)}}async function S(E){if(confirm("Delete task?"))try{await ko(E),u(n,a(n).filter(I=>I.id!==E),!0),e.refresh()}catch(I){console.error(I)}}async function N(E){try{if(E.id){const I=await Ns(E.id,{name:E.name,assignee:E.assignee,material_id:E.material_id,gnc_file_path:E.gnc_file_path});u(n,a(n).map(ee=>ee.id===E.id?{...ee,...I}:ee),!0),e.refresh()}else{const I=await yo(e.document.id,{name:E.name,assignee:E.assignee,status:"planned",material_id:E.material_id,gnc_file_path:E.gnc_file_path});u(n,[...a(n),I],!0),e.refresh()}}catch(I){throw console.error(I),I}}function b(){u(p,!0)}function j(){u(p,!1),_()}function C(){console.log("Opening Add Modal"),u(d,null),u(c,!0)}function R(E){console.log("Opening Edit Modal for:",E),u(d,E,!0),u(c,!0)}var J=mv(),Y=qe(J),D=o(Y),H=l(o(D),2),Z=o(H);Z.__click=()=>u(v,!a(v));var L=o(Z),M=l(Z,2),K=o(M);K.value=K.__value="hide_done";var re=l(K);re.value=re.__value="all";var be=l(re);be.value=be.__value="pending";var _e=l(M,2);_e.__click=C;var ke=l(D,2),me=o(ke);Ae(me,17,()=>Object.entries(a(T)()),([E,I])=>E,(E,I)=>{var ee=nt(()=>bn(a(I),2));let Q=()=>a(ee)[0],ae=()=>a(ee)[1];var Se=_v(),Pe=qe(Se);{var $e=z=>{var G=dv(),ce=o(G),ue=o(ce),X=l(ce,2),W=o(X);U(()=>{q(ue,Q()),q(W,`(${ae().length??""})`)}),g(z,G)};$(Pe,z=>{a(v)&&Object.keys(a(T)()).length>1&&z($e)})}var Me=l(Pe,2);Ae(Me,17,ae,z=>z.id,(z,G)=>{var ce=hv(),ue=o(ce),X=o(ue),W=o(X),se=l(X,2),ne=o(se);ne.__change=O=>x(a(G),O.currentTarget.value);var ie=o(ne);ie.value=ie.__value="planned";var ve=l(ie);ve.value=ve.__value="pending";var F=l(ve);F.value=F.__value="done";var fe;$s(ne);var P=l(ne,2),A=o(P);A.__click=()=>R(a(G));var te=l(A,2);te.__click=()=>S(a(G).id);var je=l(ue,2),ze=o(je),Be=o(ze);Be.__change=O=>y(a(G),O.currentTarget.value);var we=o(Be);we.value=we.__value="";var Ne=l(we);Ae(Ne,17,()=>a(f),Ge,(O,pe)=>{var Ee=fv(),ct=o(Ee),at={};U(()=>{q(ct,a(pe).name),at!==(at=a(pe).name)&&(Ee.value=(Ee.__value=a(pe).name)??"")}),g(O,Ee)});var Je;$s(Be);var ot=l(Be,2);ot.__click=b;var ge=l(ze,2);{var Ie=O=>{var pe=pv(),Ee=o(pe);U(()=>{We(pe,"title",`Material: ${a(G).material.name??""}`),q(Ee,`ðŸ“¦ ${a(G).material.name??""}`)}),g(O,pe)};$(ge,O=>{a(G).material&&O(Ie)})}U(()=>{Le(X,1,`task-name ${a(G).status==="done"?"done-text":""}`,"svelte-ty272s"),We(X,"title",a(G).name),q(W,a(G).name),Le(ne,1,`status-select ${a(G).status??""}`,"svelte-ty272s"),fe!==(fe=a(G).status)&&(ne.value=(ne.__value=a(G).status)??"",ws(ne,a(G).status)),Je!==(Je=a(G).assignee||"")&&(Be.value=(Be.__value=a(G).assignee||"")??"",ws(Be,a(G).assignee||""))}),g(z,ce)}),g(E,Se)});var le=l(me,2);{var Te=E=>{var I=gv(),ee=o(I);U(()=>q(ee,a(n).length>0?"No tasks match filter.":"No tasks yet.")),g(E,I)};$(le,E=>{a(m).length===0&&E(Te)})}var xe=l(Y,2);uv(xe,{get isOpen(){return a(c)},close:()=>u(c,!1),onSubmit:N,get task(){return a(d)}});var oe=l(xe,2);ki(oe,{get isOpen(){return a(p)},close:j}),U(()=>{We(Z,"title",a(v)?"Show flat list":"Group by material"),q(L,a(v)?"ðŸ“¦":"ðŸ“‹")}),At(M,()=>a(i),E=>u(i,E)),g(t,J),lt()}_t(["click","change"]);var yv=w('<p class="upload-status svelte-1yijx0t">Uploading...</p>'),wv=w('<div class="attachment-item svelte-1yijx0t"><span class="attachment-name svelte-1yijx0t"> </span> <button type="button" class="remove-btn svelte-1yijx0t">Ã—</button></div>'),kv=w('<div class="attachments-list svelte-1yijx0t"></div>'),xv=w('<div class="modal-overlay svelte-1yijx0t"><div class="modal-content svelte-1yijx0t"><div class="modal-header svelte-1yijx0t"><h3 class="svelte-1yijx0t"> </h3> <button class="close-btn svelte-1yijx0t">&times;</button></div> <form class="modal-body svelte-1yijx0t"><div class="form-group svelte-1yijx0t"><label for="author" class="svelte-1yijx0t">Author</label> <input id="author" type="text" placeholder="Your Name" class="svelte-1yijx0t"/></div> <div class="form-group svelte-1yijx0t"><label for="type" class="svelte-1yijx0t">Type</label> <select id="type" class="svelte-1yijx0t"><option>Info</option><option>Warning</option><option>Error</option></select></div> <div class="form-group svelte-1yijx0t"><label for="text" class="svelte-1yijx0t">Message</label> <textarea id="text" required rows="4" class="svelte-1yijx0t"></textarea></div> <div class="form-group svelte-1yijx0t"><label for="attachments" class="svelte-1yijx0t">Attachments</label> <div class="file-upload-wrapper svelte-1yijx0t"><input id="attachments" type="file" multiple class="svelte-1yijx0t"/> <!></div> <!></div> <div class="actions svelte-1yijx0t"><button type="button" class="btn-secondary svelte-1yijx0t">Cancel</button> <button type="submit" class="btn-primary svelte-1yijx0t"> </button></div></form></div></div>');function xi(t,e){it(e,!0);let s=xt(e,"entry",3,null),r=k(""),n=k("info"),i=k(""),c=k(!1),d=k(ye([])),v=k(!1);Bt(()=>{e.isOpen&&(s()?(u(r,s().text||"",!0),u(n,s().type||"info",!0),u(i,s().author||"",!0),u(d,s().attachments||[],!0)):(u(i,localStorage.getItem("journal_author")||"",!0),u(r,""),u(n,"info"),u(d,[],!0)))});async function f(x){const y=Array.from(x.target.files);if(y.length!==0){u(v,!0);try{for(const S of y){const N=await zn(S);a(d).push({file_path:N.file_path,filename:N.filename,media_type:N.media_type})}}catch(S){console.error("Upload failed",S),alert("Failed to upload attachment")}finally{u(v,!1),x.target.value=""}}}function p(x){a(d).splice(x,1)}async function _(x){x.preventDefault(),u(c,!0),a(i)&&localStorage.setItem("journal_author",a(i));try{const y={text:a(r),type:a(n),status:s()?.status||"pending",author:a(i),document_id:e.documentId,attachments:a(d)};s()?await Nn(s().id,y):await ci(y),window.dispatchEvent(new CustomEvent("journal-entries-updated")),e.close()}catch(y){console.error(y),alert(s()?"Failed to update note":"Failed to create note")}finally{u(c,!1)}}var h=dt(),m=qe(h);{var T=x=>{var y=xv();y.__click=function(...Q){e.close?.apply(this,Q)};var S=o(y);S.__click=Q=>Q.stopPropagation();var N=o(S),b=o(N),j=o(b),C=l(b,2);C.__click=function(...Q){e.close?.apply(this,Q)};var R=l(N,2),J=o(R),Y=l(o(J),2),D=l(J,2),H=l(o(D),2),Z=o(H);Z.value=Z.__value="info";var L=l(Z);L.value=L.__value="warning";var M=l(L);M.value=M.__value="error";var K=l(D,2),re=l(o(K),2),be=l(K,2),_e=l(o(be),2),ke=o(_e);ke.__change=f;var me=l(ke,2);{var le=Q=>{var ae=yv();g(Q,ae)};$(me,Q=>{a(v)&&Q(le)})}var Te=l(_e,2);{var xe=Q=>{var ae=kv();Ae(ae,21,()=>a(d),Ge,(Se,Pe,$e)=>{var Me=wv(),z=o(Me),G=o(z),ce=l(z,2);ce.__click=()=>p($e),U(()=>q(G,a(Pe).filename)),g(Se,Me)}),g(Q,ae)};$(Te,Q=>{a(d).length>0&&Q(xe)})}var oe=l(be,2),E=o(oe);E.__click=function(...Q){e.close?.apply(this,Q)};var I=l(E,2),ee=o(I);U(()=>{q(j,s()?"Edit Note":`Add Note to ${e.documentName}`),ke.disabled=a(v),I.disabled=a(c),q(ee,a(c)?"Saving...":s()?"Update Note":"Add Note")}),ka("submit",R,_),Ce(Y,()=>a(i),Q=>u(i,Q)),At(H,()=>a(n),Q=>u(n,Q)),Ce(re,()=>a(r),Q=>u(r,Q)),g(x,y)};$(m,x=>{e.isOpen&&x(T)})}g(t,h),lt()}_t(["click","change"]);var Sv=w('<img class="svelte-jm2ier"/>'),Tv=w('<div class="file-placeholder svelte-jm2ier"><span> </span> <a target="_blank" rel="noreferrer">Download</a></div>'),qv=w('<div class="image-wrapper svelte-jm2ier"><!></div>'),Ev=w('<div class="modal-overlay svelte-jm2ier"><div class="modal-content svelte-jm2ier"><button class="close-btn svelte-jm2ier">&times;</button> <div class="gallery svelte-jm2ier"></div></div></div>');function Si(t,e){var s=dt(),r=qe(s);{var n=i=>{var c=Ev();c.__click=function(...p){e.close?.apply(this,p)};var d=o(c);d.__click=p=>p.stopPropagation();var v=o(d);v.__click=function(...p){e.close?.apply(this,p)};var f=l(v,2);Ae(f,21,()=>e.attachments,Ge,(p,_)=>{var h=qv(),m=o(h);{var T=y=>{var S=Sv();U(()=>{We(S,"src",a(_).file_path),We(S,"alt",a(_).filename)}),g(y,S)},x=y=>{var S=Tv(),N=o(S),b=o(N),j=l(N,2);U(()=>{q(b,`ðŸ“„ ${a(_).filename??""}`),We(j,"href",a(_).file_path)}),g(y,S)};$(m,y=>{a(_).media_type&&a(_).media_type.startsWith("image/")?y(T):y(x,!1)})}g(p,h)}),g(i,c)};$(r,i=>{e.isOpen&&i(n)})}g(t,s)}_t(["click"]);var jv=w("<option> </option>"),Av=w("<option> </option>"),Pv=w('<div class="modal-overlay svelte-12q38jy"><div class="modal-content svelte-12q38jy"><div class="modal-header svelte-12q38jy"><h3 class="svelte-12q38jy">ðŸ” Filter Documents</h3> <button class="close-btn svelte-12q38jy">&times;</button></div> <div class="modal-body svelte-12q38jy"><div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Document Type</h4> <select class="filter-input svelte-12q38jy"><option>All Types</option><option>Plan</option><option>Mail</option><option>Other</option></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Status</h4> <select class="filter-input svelte-12q38jy"><option>All Statuses</option><option>In Progress</option><option>Done</option></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Tag</h4> <input type="text" placeholder="Filter by tag..." class="filter-input svelte-12q38jy"/></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Part Number / Name</h4> <input type="text" placeholder="Search for parts..." class="filter-input svelte-12q38jy"/></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Assignee</h4> <select class="filter-input svelte-12q38jy"><option>All Assignees</option><!></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Material</h4> <select class="filter-input svelte-12q38jy"><option>All Materials</option><!></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Task Types (Show documents with these task types)</h4> <div class="checkbox-group svelte-12q38jy"><label class="checkbox-label svelte-12q38jy"><input type="checkbox" class="svelte-12q38jy"/> <span class="checkbox-text svelte-12q38jy">Planned</span></label> <label class="checkbox-label svelte-12q38jy"><input type="checkbox" class="svelte-12q38jy"/> <span class="checkbox-text svelte-12q38jy">Pending</span></label> <label class="checkbox-label svelte-12q38jy"><input type="checkbox" class="svelte-12q38jy"/> <span class="checkbox-text svelte-12q38jy">Done</span></label></div></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Date Range</h4> <select class="filter-input svelte-12q38jy"><option>Registration Date</option><option>Done Date</option></select> <div class="date-range svelte-12q38jy"><input type="date" class="filter-input svelte-12q38jy" placeholder="Start Date"/> <span class="date-separator svelte-12q38jy">to</span> <input type="date" class="filter-input svelte-12q38jy" placeholder="End Date"/></div></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Sort By</h4> <div class="sort-controls svelte-12q38jy"><select class="filter-input svelte-12q38jy"><option>Date</option><option>Name</option><option>Author</option><option>Status</option><option>Done Date</option></select> <button class="sort-order-btn svelte-12q38jy" title="Toggle sort order"> </button></div></div></div> <div class="modal-footer svelte-12q38jy"><button class="btn-secondary svelte-12q38jy">Reset All</button> <button class="btn-primary svelte-12q38jy">Apply Filters</button></div></div></div>');function Cv(t,e){it(e,!0);let s=k(ye({filterType:"",filterStatus:"",filterTag:"",filterAssignee:"",partSearch:"",filterMaterial:"",filterTaskTypes:[],startDate:"",endDate:"",dateField:"registration_date",sortBy:"registration_date",sortOrder:"desc"})),r=k(ye([])),n=k(ye([])),i=!1;Bt(()=>{e.isOpen&&!i&&(e.filters&&(u(s,{...e.filters},!0),Array.isArray(a(s).filterTaskTypes)||(a(s).filterTaskTypes=[])),c(),d()),i=e.isOpen});async function c(){try{u(r,await Ya(),!0)}catch(T){console.error("Failed to load materials",T)}}async function d(){try{u(n,await ks(),!0)}catch(T){console.error("Failed to load assignees",T)}}function v(){e.onApply(a(s)),e.close()}function f(){u(s,{filterType:"",filterStatus:"",filterTag:"",filterAssignee:"",partSearch:"",filterMaterial:"",filterTaskTypes:[],startDate:"",endDate:"",dateField:"registration_date",sortBy:"registration_date",sortOrder:"desc"},!0)}function p(T){a(s).filterTaskTypes.includes(T)?a(s).filterTaskTypes=a(s).filterTaskTypes.filter(x=>x!==T):a(s).filterTaskTypes=[...a(s).filterTaskTypes,T]}var _=dt(),h=qe(_);{var m=T=>{var x=Pv();x.__click=function(...ge){e.close?.apply(this,ge)};var y=o(x);y.__click=ge=>ge.stopPropagation();var S=o(y),N=l(o(S),2);N.__click=function(...ge){e.close?.apply(this,ge)};var b=l(S,2),j=o(b),C=l(o(j),2),R=o(C);R.value=R.__value="";var J=l(R);J.value=J.__value="plan";var Y=l(J);Y.value=Y.__value="mail";var D=l(Y);D.value=D.__value="other";var H=l(j,2),Z=l(o(H),2),L=o(Z);L.value=L.__value="";var M=l(L);M.value=M.__value="in_progress";var K=l(M);K.value=K.__value="done";var re=l(H,2),be=l(o(re),2),_e=l(re,2),ke=l(o(_e),2),me=l(_e,2),le=l(o(me),2),Te=o(le);Te.value=Te.__value="";var xe=l(Te);Ae(xe,17,()=>a(n),Ge,(ge,Ie)=>{var O=jv(),pe=o(O),Ee={};U(()=>{q(pe,a(Ie).name),Ee!==(Ee=a(Ie).name)&&(O.value=(O.__value=a(Ie).name)??"")}),g(ge,O)});var oe=l(me,2),E=l(o(oe),2),I=o(E);I.value=I.__value="";var ee=l(I);Ae(ee,17,()=>a(r),Ge,(ge,Ie)=>{var O=Av(),pe=o(O),Ee={};U(()=>{q(pe,a(Ie).name),Ee!==(Ee=a(Ie).id)&&(O.value=(O.__value=a(Ie).id)??"")}),g(ge,O)});var Q=l(oe,2),ae=l(o(Q),2),Se=o(ae),Pe=o(Se);Pe.__change=()=>p("planned");var $e=l(Se,2),Me=o($e);Me.__change=()=>p("pending");var z=l($e,2),G=o(z);G.__change=()=>p("done");var ce=l(Q,2),ue=l(o(ce),2),X=o(ue);X.value=X.__value="registration_date";var W=l(X);W.value=W.__value="done_date";var se=l(ue,2),ne=o(se),ie=l(ne,4),ve=l(ce,2),F=l(o(ve),2),fe=o(F),P=o(fe);P.value=P.__value="registration_date";var A=l(P);A.value=A.__value="name";var te=l(A);te.value=te.__value="author";var je=l(te);je.value=je.__value="status";var ze=l(je);ze.value=ze.__value="done_date";var Be=l(fe,2);Be.__click=()=>a(s).sortOrder=a(s).sortOrder==="desc"?"asc":"desc";var we=o(Be),Ne=l(b,2),Je=o(Ne);Je.__click=f;var ot=l(Je,2);ot.__click=v,U((ge,Ie,O)=>{Ks(Pe,ge),Ks(Me,Ie),Ks(G,O),q(we,a(s).sortOrder==="desc"?"â†“ Desc":"â†‘ Asc")},[()=>a(s).filterTaskTypes.includes("planned"),()=>a(s).filterTaskTypes.includes("pending"),()=>a(s).filterTaskTypes.includes("done")]),At(C,()=>a(s).filterType,ge=>a(s).filterType=ge),At(Z,()=>a(s).filterStatus,ge=>a(s).filterStatus=ge),Ce(be,()=>a(s).filterTag,ge=>a(s).filterTag=ge),Ce(ke,()=>a(s).partSearch,ge=>a(s).partSearch=ge),At(le,()=>a(s).filterAssignee,ge=>a(s).filterAssignee=ge),At(E,()=>a(s).filterMaterial,ge=>a(s).filterMaterial=ge),At(ue,()=>a(s).dateField,ge=>a(s).dateField=ge),Ce(ne,()=>a(s).startDate,ge=>a(s).startDate=ge),Ce(ie,()=>a(s).endDate,ge=>a(s).endDate=ge),At(fe,()=>a(s).sortBy,ge=>a(s).sortBy=ge),g(T,x)};$(h,T=>{e.isOpen&&T(m)})}g(t,_),lt()}_t(["click","change"]);var Dv=w('<span class="tag-chip svelte-1qsxu3n"> <button type="button" class="svelte-1qsxu3n">&times;</button></span>'),Rv=w('<li class="svelte-1qsxu3n"> </li>'),zv=w('<ul class="suggestions svelte-1qsxu3n"></ul>'),Mv=w('<div class="tag-input-container svelte-1qsxu3n"><!> <div class="input-wrapper svelte-1qsxu3n"><input type="text" class="svelte-1qsxu3n"/> <!></div></div>');function Nv(t,e){it(e,!0);let s=xt(e,"selectedTags",31,()=>ye([])),r=xt(e,"placeholder",3,"Add tag..."),n=k(""),i=k(ye([])),c=k(ye([])),d=k(!1),v;Vt(async()=>{try{u(i,await co(),!0)}catch(b){console.error("Failed to fetch tags",b)}});function f(b){if(u(n,b.target.value,!0),a(n).includes(",")){const j=a(n).split(",");for(let C of j)C=C.trim(),C&&(s().includes(C)||s([...s(),C]));u(n,""),u(d,!1);return}a(n)?(u(c,a(i).filter(j=>j.name.toLowerCase().includes(a(n).toLowerCase())&&!s().includes(j.name)),!0),u(d,!0)):u(d,!1)}function p(b){b&&!s().includes(b)&&s([...s(),b]),u(n,""),u(d,!1),v.focus()}function _(b){s(s().filter(j=>j!==b))}function h(b){b.key==="Enter"?(b.preventDefault(),a(n).trim()&&p(a(n).trim())):b.key==="Backspace"&&!a(n)&&s().length>0&&_(s()[s().length-1])}var m=Mv(),T=o(m);Ae(T,17,s,Ge,(b,j)=>{var C=Dv(),R=o(C),J=l(R);J.__click=()=>_(a(j)),U(()=>q(R,`${a(j)??""} `)),g(b,C)});var x=l(T,2),y=o(x);y.__input=f,y.__keydown=h,Rn(y,b=>v=b,()=>v);var S=l(y,2);{var N=b=>{var j=zv();Ae(j,21,()=>a(c),Ge,(C,R)=>{var J=Rv();J.__click=()=>p(a(R).name);var Y=o(J);U(()=>q(Y,a(R).name)),g(C,J)}),g(b,j)};$(S,b=>{a(d)&&a(c).length>0&&b(N)})}U(()=>We(y,"placeholder",r())),ka("blur",y,()=>setTimeout(()=>u(d,!1),200)),ka("focus",y,()=>a(n)&&u(d,!0)),Ce(y,()=>a(n),b=>u(n,b)),g(t,m),lt()}_t(["click","input","keydown"]);var Ov=w('<span class="filter-badge svelte-s90sg6">â—</span>'),Iv=w('<div class="card-desc svelte-s90sg6"> </div>'),Lv=w('<span class="tag-badge svelte-s90sg6"> </span>'),$v=w('<button class="icon-badge attachment-badge svelte-s90sg6" title="View Attachments"> </button>'),Fv=w('<span class="icon-badge task-planned svelte-s90sg6" title="Planned Tasks"> </span>'),Bv=w('<span class="icon-badge task-pending svelte-s90sg6" title="Pending Tasks"> </span>'),Uv=w('<span class="icon-badge task-done svelte-s90sg6" title="Completed Tasks"> </span>'),Gv=w("<!> <!> <!>",1),Yv=w('<span class="icon-badge journal-info svelte-s90sg6" title="Info Notes"> </span>'),Xv=w('<span class="icon-badge journal-warning svelte-s90sg6" title="Warnings"> </span>'),Jv=w('<span class="icon-badge journal-error svelte-s90sg6" title="Errors"> </span>'),Hv=w("<!> <!> <!>",1),Wv=w('<div class="badges-tags-row svelte-s90sg6"><!> <!> <!> <!></div>'),Vv=w('<div class="meta-item svelte-s90sg6"><span class="label svelte-s90sg6">Done:</span> <span class="value"> </span></div>'),Zv=w('<button class="note-attachment-btn svelte-s90sg6"> </button>'),Qv=w('<div><div class="note-header svelte-s90sg6"><span> </span> <span class="note-author svelte-s90sg6"> </span> <span class="note-date svelte-s90sg6"> </span> <!> <button class="note-edit-btn svelte-s90sg6" title="Edit note">âœï¸</button> <button> </button></div> <p class="note-text svelte-s90sg6"> </p></div>'),Kv=w('<div class="embedded-notes svelte-s90sg6"><h4 class="svelte-s90sg6">Notes</h4> <div class="notes-list svelte-s90sg6"></div></div>'),eu=w('<button class="action-btn primary-btn svelte-s90sg6" title="Register Document"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg> Register</button>'),tu=w('<button class="action-btn primary-btn svelte-s90sg6" title="View Content"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg> View</button>'),au=w('<button class="dropdown-item svelte-s90sg6">ðŸ“¦ Download Zip</button>'),su=w('<div class="dropdown-menu svelte-s90sg6"><button class="dropdown-item svelte-s90sg6">ðŸ“ Add Note</button> <button class="dropdown-item svelte-s90sg6"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg> Edit</button> <!> <button class="dropdown-item delete-item svelte-s90sg6"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg> Delete</button></div>'),nu=w('<div class="card svelte-s90sg6"><div class="card-header svelte-s90sg6"><div class="title-group svelte-s90sg6"><h3 class="svelte-s90sg6"> </h3> <span class="badge badge-type svelte-s90sg6"> </span></div> <select><option>Unregistered</option><option>In Progress</option><option>Done</option></select></div> <!> <!> <div class="card-meta svelte-s90sg6"><div class="meta-item svelte-s90sg6"><span class="label svelte-s90sg6">Author:</span> <span class="value"> </span></div> <div class="meta-item svelte-s90sg6"><span class="label svelte-s90sg6">Date:</span> <span class="value"> </span></div> <!></div> <!> <!> <div class="card-actions svelte-s90sg6"><!> <div class="dropdown-container svelte-s90sg6"><button class="action-btn dropdown-btn svelte-s90sg6" title="More actions"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle></svg></button> <!></div></div></div>'),ru=w('<div class="empty-state svelte-s90sg6"><p>No documents found.</p></div>'),iu=w('<div class="list-container svelte-s90sg6"><div class="filters-bar svelte-s90sg6"><div class="main-filters svelte-s90sg6"><div class="search-box svelte-s90sg6"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon svelte-s90sg6"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> <input type="text" placeholder="Search documents..." class="svelte-s90sg6"/></div> <button class="filter-btn svelte-s90sg6" title="Filter &amp; Sort"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon></svg> Filters <!></button></div></div> <div class="cards-wrapper svelte-s90sg6"><!> <!></div> <!> <!> <!> <!></div>');function lu(t,e){it(e,!0);let s=k(ye([])),r=k(""),n=k(""),i=k(""),c=k(""),d=k(""),v=k(""),f=k(""),p=k(ye([])),_=k(""),h=k(""),m=k("registration_date"),T=k(ye([])),x=k(null),y=k(null),S=k(null),N=k(null),b=k(!1),j=k("registration_date"),C=k("desc"),R=k(null);async function J(){let P=await Mn(a(r),a(i),a(c),a(j),a(C),a(d),a(_),a(h),a(m),a(v),a(n));a(p)&&a(p).length>0&&(P=P.filter(A=>!A.tasks||A.tasks.length===0?!1:A.tasks.some(te=>a(p).includes(te.status)))),a(f)&&(P=P.filter(A=>!A.tasks||A.tasks.length===0?!1:A.tasks.some(te=>te.material_id&&te.material_id.toString()===a(f).toString()))),u(s,P,!0)}async function Y(){u(T,await So(),!0)}Vt(()=>{const P=new URLSearchParams(window.location.search);P.has("part_search")&&u(n,P.get("part_search"),!0),J(),Y()});async function D(P,A){await fo(P.id,A),J()}async function H(P){confirm("Are you sure you want to delete this document?")&&(await _o(P),J())}function Z(){J()}function L(P){u(x,P,!0)}function M(){u(x,null)}function K(P){u(y,P,!0),u(S,null)}function re(P,A){u(y,P,!0),u(S,A,!0)}function be(){u(y,null),u(S,null),J()}async function _e(P,A){const te=A==="pending"?"done":"pending";try{await Nn(P,{status:te}),J(),window.dispatchEvent(new CustomEvent("journal-entries-updated"))}catch(je){console.error("Failed to update note status",je)}}function ke(P){u(N,P,!0)}function me(){u(N,null)}function le(P){if(!P)return null;const A={planned:0,pending:0,done:0};return P.forEach(te=>{A[te.status]!==void 0&&A[te.status]++}),A}function Te(P){if(!P)return null;const A={info:0,warning:0,error:0};return P.forEach(te=>{A[te.type]!==void 0&&A[te.type]++}),A}function xe(){u(b,!0)}function oe(){u(b,!1)}function E(P){u(i,P.filterType,!0),u(c,P.filterStatus,!0),u(d,P.filterTag,!0),u(v,P.filterAssignee,!0),u(n,P.partSearch||"",!0),u(f,P.filterMaterial||"",!0),u(p,P.filterTaskTypes||[],!0),u(_,P.startDate,!0),u(h,P.endDate,!0),u(m,P.dateField,!0),u(j,P.sortBy,!0),u(C,P.sortOrder,!0),J()}function I(P){u(R,a(R)===P?null:P,!0)}function ee(){u(R,null)}async function Q(P){try{await ho(P.id,P.name)}catch(A){console.error(A),alert("Failed to download zip. Ensure the source folder exists on the server.")}}var ae={refresh:J},Se=iu(),Pe=o(Se),$e=o(Pe),Me=o($e),z=l(o(Me),2);z.__input=Z;var G=l(Me,2);G.__click=xe;var ce=l(o(G),2);{var ue=P=>{var A=Ov();g(P,A)};$(ce,P=>{(a(i)||a(c)||a(d)||a(v)||a(_)||a(h)||a(p)&&a(p).length>0)&&P(ue)})}var X=l(Pe,2),W=o(X);Ae(W,17,()=>a(s),P=>P.id,(P,A)=>{const te=nt(()=>le(a(A).tasks)),je=nt(()=>Te(a(A).journal_entries));var ze=nu(),Be=o(ze),we=o(Be),Ne=o(we),Je=o(Ne),ot=l(Ne,2),ge=o(ot),Ie=l(we,2);Ie.__change=Fe=>D(a(A),Fe.target.value);var O=o(Ie);O.value=O.__value="unregistered";var pe=l(O);pe.value=pe.__value="in_progress";var Ee=l(pe);Ee.value=Ee.__value="done";var ct;$s(Ie);var at=l(Be,2);{var gt=Fe=>{var Ke=Iv(),et=o(Ke);U(()=>q(et,a(A).description)),g(Fe,Ke)};$(at,Fe=>{a(A).description&&Fe(gt)})}var He=l(at,2);{var Pt=Fe=>{var Ke=Wv(),et=o(Ke);{var kt=pt=>{var bt=dt(),Dt=qe(bt);Ae(Dt,17,()=>a(A).tags,Ge,($t,ut)=>{var ht=Lv(),qt=o(ht);U(()=>q(qt,`#${a(ut).name??""}`)),g($t,ht)}),g(pt,bt)};$(et,pt=>{a(A).tags&&a(A).tags.length>0&&pt(kt)})}var Oe=l(et,2);{var vt=pt=>{var bt=$v();bt.__click=()=>ke(a(A).attachments);var Dt=o(bt);U(()=>q(Dt,`ðŸ“· ${a(A).attachments.length??""}`)),g(pt,bt)};$(Oe,pt=>{a(A).attachments&&a(A).attachments.length>0&&pt(vt)})}var ft=l(Oe,2);{var yt=pt=>{var bt=Gv(),Dt=qe(bt);{var $t=tt=>{var st=Fv(),Et=o(st);U(()=>q(Et,`ðŸ“… ${a(te).planned??""}`)),g(tt,st)};$(Dt,tt=>{a(te).planned>0&&tt($t)})}var ut=l(Dt,2);{var ht=tt=>{var st=Bv(),Et=o(st);U(()=>q(Et,`â³ ${a(te).pending??""}`)),g(tt,st)};$(ut,tt=>{a(te).pending>0&&tt(ht)})}var qt=l(ut,2);{var Xt=tt=>{var st=Uv(),Et=o(st);U(()=>q(Et,`âœ… ${a(te).done??""}`)),g(tt,st)};$(qt,tt=>{a(te).done>0&&tt(Xt)})}g(pt,bt)};$(ft,pt=>{a(te)&&pt(yt)})}var mt=l(ft,2);{var Zt=pt=>{var bt=Hv(),Dt=qe(bt);{var $t=tt=>{var st=Yv(),Et=o(st);U(()=>q(Et,`â„¹ï¸ ${a(je).info??""}`)),g(tt,st)};$(Dt,tt=>{a(je).info>0&&tt($t)})}var ut=l(Dt,2);{var ht=tt=>{var st=Xv(),Et=o(st);U(()=>q(Et,`âš ï¸ ${a(je).warning??""}`)),g(tt,st)};$(ut,tt=>{a(je).warning>0&&tt(ht)})}var qt=l(ut,2);{var Xt=tt=>{var st=Jv(),Et=o(st);U(()=>q(Et,`âŒ ${a(je).error??""}`)),g(tt,st)};$(qt,tt=>{a(je).error>0&&tt(Xt)})}g(pt,bt)};$(mt,pt=>{a(je)&&pt(Zt)})}g(Fe,Ke)};$(He,Fe=>{(a(A).tags&&a(A).tags.length>0||a(A).attachments&&a(A).attachments.length>0||a(te)||a(je))&&Fe(Pt)})}var St=l(He,2),Yt=o(St),va=l(o(Yt),2),Ma=o(va),Ja=l(Yt,2),rs=l(o(Ja),2),Ha=o(rs),B=l(Ja,2);{var V=Fe=>{var Ke=Vv(),et=l(o(Ke),2),kt=o(et);U(()=>q(kt,a(A).done_date)),g(Fe,Ke)};$(B,Fe=>{a(A).done_date&&Fe(V)})}var de=l(St,2);bv(de,{get document(){return a(A)},refresh:J,get filterAssignee(){return a(v)},get partSearch(){return a(n)}});var Ue=l(de,2);{var Ct=Fe=>{var Ke=Kv(),et=l(o(Ke),2);Ae(et,21,()=>a(A).journal_entries,Ge,(kt,Oe)=>{var vt=Qv(),ft=o(vt),yt=o(ft),mt=o(yt),Zt=l(yt,2),pt=o(Zt),bt=l(Zt,2),Dt=o(bt),$t=l(bt,2);{var ut=Et=>{var qa=Zv();qa.__click=()=>ke(a(Oe).attachments);var is=o(qa);U(()=>{We(qa,"title",`View attachments (${a(Oe).attachments.length??""})`),q(is,`ðŸ“Ž ${a(Oe).attachments.length??""}`)}),g(Et,qa)};$($t,Et=>{a(Oe).attachments&&a(Oe).attachments.length>0&&Et(ut)})}var ht=l($t,2);ht.__click=()=>re(a(A),a(Oe));var qt=l(ht,2);qt.__click=()=>_e(a(Oe).id,a(Oe).status);var Xt=o(qt),tt=l(ft,2),st=o(tt);U(()=>{Le(vt,1,`note-item ${a(Oe).type??""}`,"svelte-s90sg6"),Le(yt,1,`note-badge ${a(Oe).type??""}`,"svelte-s90sg6"),q(mt,a(Oe).type),q(pt,a(Oe).author||"Unknown"),q(Dt,a(Oe).created_at),Le(qt,1,`note-status-btn ${a(Oe).status??""}`,"svelte-s90sg6"),We(qt,"title",a(Oe).status==="pending"?"Click to mark as done":"Click to mark as pending"),q(Xt,a(Oe).status),q(st,a(Oe).text)}),g(kt,vt)}),g(Fe,Ke)};$(Ue,Fe=>{a(A).journal_entries&&a(A).journal_entries.length>0&&Fe(Ct)})}var he=l(Ue,2),Ye=o(he);{var Tt=Fe=>{var Ke=eu();Ke.__click=()=>e.onEdit(a(A)),g(Fe,Ke)},Mt=Fe=>{var Ke=tu();Ke.__click=()=>L(a(A)),g(Fe,Ke)};$(Ye,Fe=>{a(A).status==="unregistered"?Fe(Tt):Fe(Mt,!1)})}var Nt=l(Ye,2),Ot=o(Nt);Ot.__click=()=>I(a(A).id);var wt=l(Ot,2);{var na=Fe=>{var Ke=su(),et=o(Ke);et.__click=()=>{K(a(A)),ee()};var kt=l(et,2);kt.__click=()=>{e.onEdit(a(A)),ee()};var Oe=l(kt,2);{var vt=yt=>{var mt=au();mt.__click=()=>{Q(a(A)),ee()},g(yt,mt)};$(Oe,yt=>{a(A).type==="order"&&yt(vt)})}var ft=l(Oe,2);ft.__click=()=>{H(a(A).id),ee()},g(Fe,Ke)};$(wt,Fe=>{a(R)===a(A).id&&Fe(na)})}U(()=>{q(Je,a(A).name),q(ge,a(A).type),Le(Ie,1,`status-select ${a(A).status??""}`,"svelte-s90sg6"),O.disabled=a(A).status!=="unregistered",ct!==(ct=a(A).status)&&(Ie.value=(Ie.__value=a(A).status)??"",ws(Ie,a(A).status)),q(Ma,a(A).author||"-"),q(Ha,a(A).registration_date)}),g(P,ze)});var se=l(W,2);{var ne=P=>{var A=ru();g(P,A)};$(se,P=>{a(s).length===0&&P(ne)})}var ie=l(X,2);{let P=nt(()=>!!a(x));On(ie,{get isOpen(){return a(P)},close:M,maxWidth:"800px",children:(A,te)=>{Yc(A,{get document(){return a(x)}})},$$slots:{default:!0}})}var ve=l(ie,2);{let P=nt(()=>!!a(y)),A=nt(()=>a(y)?.id),te=nt(()=>a(y)?.name);xi(ve,{get isOpen(){return a(P)},close:be,get documentId(){return a(A)},get documentName(){return a(te)},get entry(){return a(S)}})}var F=l(ve,2);{let P=nt(()=>!!a(N)),A=nt(()=>a(N)||[]);Si(F,{get isOpen(){return a(P)},close:me,get attachments(){return a(A)}})}var fe=l(F,2);{let P=nt(()=>({filterType:a(i),filterStatus:a(c),filterTag:a(d),filterAssignee:a(v),filterMaterial:a(f),filterTaskTypes:a(p),startDate:a(_),endDate:a(h),dateField:a(m),sortBy:a(j),sortOrder:a(C)}));Cv(fe,{get isOpen(){return a(b)},close:oe,get filters(){return a(P)},onApply:E})}return Ce(z,()=>a(r),P=>u(r,P)),g(t,Se),lt(ae)}_t(["input","click","change"]);var ou=w('<button type="button" class="btn-outline svelte-f0yvr0">ðŸ“· View Gallery</button>'),cu=w('<p class="info-text svelte-f0yvr0">Uploading...</p>'),vu=w('<p class="error-text svelte-f0yvr0"> </p>'),uu=w('<div class="attachment-item svelte-f0yvr0"><span class="file-name svelte-f0yvr0"> </span> <button type="button" class="remove-btn svelte-f0yvr0">âŒ</button></div>'),du=w('<div class="attachment-item new svelte-f0yvr0"><span class="file-name svelte-f0yvr0"> </span> <button type="button" class="remove-btn svelte-f0yvr0">âŒ</button></div>'),fu=w('<div class="attachments-list svelte-f0yvr0"><!> <!></div>'),pu=w('<span class="part-dims svelte-f0yvr0"> </span>'),hu=w('<li class="part-item-li svelte-f0yvr0"><span class="part-name svelte-f0yvr0"> </span> <span class="part-reg svelte-f0yvr0"> </span> <!></li>'),_u=w('<ul class="parts-list svelte-f0yvr0"></ul>'),gu=w('<p class="no-parts svelte-f0yvr0">No linked parts found in GNC.</p>'),mu=w('<details class="task-item svelte-f0yvr0"><summary class="svelte-f0yvr0"><span class="task-icon">âš™ï¸</span> <span class="task-name svelte-f0yvr0"> </span> <span> </span></summary> <div class="task-details svelte-f0yvr0"><div class="task-meta svelte-f0yvr0"><div class="meta-item svelte-f0yvr0"><span class="label svelte-f0yvr0">Assignee:</span> <span> </span></div> <div class="meta-item svelte-f0yvr0"><span class="label svelte-f0yvr0">Material:</span> <span> </span></div> <div class="meta-item svelte-f0yvr0"><span class="label svelte-f0yvr0">GNC Path:</span> <span class="path svelte-f0yvr0"> </span></div></div> <div class="linked-parts-section svelte-f0yvr0"><h5 class="svelte-f0yvr0"> </h5> <!></div></div></details>'),bu=w('<div class="form-section svelte-f0yvr0"><h4 class="svelte-f0yvr0"> </h4> <div class="task-list svelte-f0yvr0"></div></div>'),yu=w('<div class="form-group svelte-f0yvr0"><button type="button" class="btn-gnc svelte-f0yvr0">âœ‚ï¸ Edit in GNC</button></div>'),wu=w('<div class="form-container svelte-f0yvr0"><h3 class="svelte-f0yvr0"> </h3> <form><div class="form-section upload-section svelte-f0yvr0"><h4 class="svelte-f0yvr0">Files & Scanning</h4> <div class="upload-buttons"><div class="upload-btn-wrapper svelte-f0yvr0"><button type="button" class="btn-outline svelte-f0yvr0">ðŸ“„ Add Attachments</button> <input type="file" multiple title="Add Attachments (No Scan)" class="svelte-f0yvr0"/></div> <!></div> <!> <!> <!></div> <div class="form-group svelte-f0yvr0"><label for="name" class="svelte-f0yvr0">Name</label> <input id="name" type="text" required placeholder="e.g. Project Alpha Specs" class="svelte-f0yvr0"/></div> <div class="form-group svelte-f0yvr0"><label for="description" class="svelte-f0yvr0">Description</label> <textarea id="description" rows="3" placeholder="Brief description of the document..." class="svelte-f0yvr0"></textarea></div> <!> <div class="form-group svelte-f0yvr0"><label for="tags" class="svelte-f0yvr0">Tags</label> <!></div> <div class="form-group svelte-f0yvr0"><label for="content" class="svelte-f0yvr0">Recognized Content (Markdown)</label> <textarea id="content" rows="10" placeholder="Recognized document content will appear here..." class="svelte-f0yvr0"></textarea></div> <div class="row svelte-f0yvr0"><div class="form-group half svelte-f0yvr0"><label for="type" class="svelte-f0yvr0">Type</label> <select id="type" class="svelte-f0yvr0"><option>Plan</option><option>Mail</option><option>Order</option><option>Other</option></select></div> <div class="form-group half svelte-f0yvr0"><label for="status" class="svelte-f0yvr0">Status</label> <select id="status" class="svelte-f0yvr0"><option>In Progress</option><option>Done</option></select></div></div> <!> <div class="row svelte-f0yvr0"><div class="form-group half svelte-f0yvr0"><label for="date" class="svelte-f0yvr0">Registration Date</label> <input id="date" type="date" class="svelte-f0yvr0"/></div> <div class="form-group half svelte-f0yvr0"><label for="done_date" class="svelte-f0yvr0">Done Date</label> <input id="done_date" type="date" class="svelte-f0yvr0"/></div></div> <div class="form-group svelte-f0yvr0"><label for="author" class="svelte-f0yvr0">Author</label> <input id="author" type="text" placeholder="Your Name" class="svelte-f0yvr0"/></div> <div class="actions svelte-f0yvr0"><button type="button" class="btn-secondary svelte-f0yvr0">Cancel</button> <button type="submit" class="btn-primary svelte-f0yvr0"> </button></div></form> <!></div>');function ku(t,e){it(e,!0);let s=xt(e,"document",3,null),r=k(""),n=k(""),i=k("plan"),c=k("in_progress"),d=k(""),v=k(""),f=k(""),p=k(""),_=k(ye([])),h=k(ye([])),m=k(ye([]));Bt(()=>{if(s())u(r,s().name||"",!0),u(n,s().description||"",!0),u(i,s().type||"plan",!0),u(c,s().status||"in_progress",!0),u(d,s().registration_date||"",!0),u(v,s().content||"",!0),u(f,s().author||"",!0),u(p,s().done_date||"",!0),u(_,s().attachments||[],!0),s().tags?u(m,s().tags.map(O=>typeof O=="string"?O:O.name),!0):u(m,[],!0);else{const O=typeof localStorage<"u"?localStorage.getItem("doc_author"):"";O&&u(f,O,!0)}});let T=k(!1),x=k(!1),y=k(""),S=k(null);Vt(()=>{if(a(c)==="unregistered"&&u(c,"in_progress"),!s()){const O=localStorage.getItem("doc_author");O&&u(f,O,!0)}}),Bt(()=>{a(c)==="done"&&!a(p)&&u(p,new Date().toISOString().split("T")[0],!0)});async function N(O){const pe=Array.from(O.target.files);if(pe.length!==0){u(T,!0);try{for(const Ee of pe){const ct=await zn(Ee);a(h).push({file_path:ct.file_path,filename:ct.filename,media_type:ct.media_type})}}catch(Ee){console.error("Upload failed",Ee),alert("Failed to upload attachment")}finally{u(T,!1),O.target.value=""}}}function b(){u(S,[...a(_),...a(h)],!0)}async function j(O,pe){if(pe)a(h).splice(O,1);else{if(!confirm("Permanently delete this attachment?"))return;const Ee=a(_)[O];try{await xo(Ee.id),a(_).splice(O,1)}catch(ct){console.error("Failed to delete attachment",ct),alert("Failed to delete attachment")}}}async function C(O){O.preventDefault(),u(x,!0),u(y,"");try{a(f)&&localStorage.setItem("doc_author",a(f));const pe={name:a(r),description:a(n),type:a(i),status:a(c),registration_date:a(d)||void 0,content:a(v),author:a(f),done_date:a(p)||void 0,attachments:a(h),tags:a(m)};s()?await po(s().id,pe):await uo(pe),s()||(u(r,""),u(n,""),u(i,"plan"),u(c,"in_progress"),u(d,""),u(v,""),u(f,localStorage.getItem("doc_author")||"",!0),u(p,""),u(h,[],!0),u(m,[],!0)),e.onDocumentCreated()}catch(pe){console.error("Failed to save document:",pe),u(y,"Failed to save document. Please try again.")}finally{u(x,!1)}}var R=wu(),J=o(R),Y=o(J),D=l(J,2),H=o(D),Z=l(o(H),2),L=o(Z),M=l(o(L),2);M.__change=N;var K=l(L,2);{var re=O=>{var pe=ou();pe.__click=b,g(O,pe)};$(K,O=>{(a(_).length>0||a(h).length>0)&&O(re)})}var be=l(Z,2);{var _e=O=>{var pe=cu();g(O,pe)};$(be,O=>{a(T)&&O(_e)})}var ke=l(be,2);{var me=O=>{var pe=vu(),Ee=o(pe);U(()=>q(Ee,a(y))),g(O,pe)};$(ke,O=>{a(y)&&O(me)})}var le=l(ke,2);{var Te=O=>{var pe=fu(),Ee=o(pe);Ae(Ee,17,()=>a(_),Ge,(at,gt,He)=>{var Pt=uu(),St=o(Pt),Yt=o(St),va=l(St,2);va.__click=()=>j(He,!1),U(()=>{We(St,"title",a(gt).filename),q(Yt,a(gt).filename)}),g(at,Pt)});var ct=l(Ee,2);Ae(ct,17,()=>a(h),Ge,(at,gt,He)=>{var Pt=du(),St=o(Pt),Yt=o(St),va=l(St,2);va.__click=()=>j(He,!0),U(()=>{We(St,"title",a(gt).filename),q(Yt,`(New) ${a(gt).filename??""}`)}),g(at,Pt)}),g(O,pe)};$(le,O=>{(a(_).length>0||a(h).length>0)&&O(Te)})}var xe=l(H,2),oe=l(o(xe),2),E=l(xe,2),I=l(o(E),2),ee=l(E,2);{var Q=O=>{var pe=bu(),Ee=o(pe),ct=o(Ee),at=l(Ee,2);Ae(at,21,()=>s().tasks,Ge,(gt,He)=>{var Pt=mu(),St=o(Pt),Yt=l(o(St),2),va=o(Yt),Ma=l(Yt,2),Ja=o(Ma),rs=l(St,2),Ha=o(rs),B=o(Ha),V=l(o(B),2),de=o(V),Ue=l(B,2),Ct=l(o(Ue),2),he=o(Ct),Ye=l(Ue,2),Tt=l(o(Ye),2),Mt=o(Tt),Nt=l(Ha,2),Ot=o(Nt),wt=o(Ot),na=l(Ot,2);{var Fe=et=>{var kt=_u();Ae(kt,21,()=>a(He).parts,Ge,(Oe,vt)=>{var ft=hu(),yt=o(ft),mt=o(yt),Zt=l(yt,2),pt=o(Zt),bt=l(Zt,2);{var Dt=$t=>{var ut=pu(),ht=o(ut);U((qt,Xt)=>q(ht,`${qt??""} x ${Xt??""}`),[()=>Math.round(a(vt).width),()=>Math.round(a(vt).height)]),g($t,ut)};$(bt,$t=>{(a(vt).width||a(vt).height)&&$t(Dt)})}U(()=>{q(mt,a(vt).name),q(pt,`[${a(vt).registration_number??""}]`)}),g(Oe,ft)}),g(et,kt)},Ke=et=>{var kt=gu();g(et,kt)};$(na,et=>{a(He).parts?.length>0?et(Fe):et(Ke,!1)})}U(()=>{q(va,a(He).name),Le(Ma,1,`task-status-badge ${a(He).status??""}`,"svelte-f0yvr0"),q(Ja,a(He).status),q(de,a(He).assignee||"Unassigned"),q(he,a(He).material?.name||"Unknown"),We(Tt,"title",a(He).gnc_file_path),q(Mt,a(He).gnc_file_path||"N/A"),q(wt,`Linked Parts (${(a(He).parts?.length||0)??""})`)}),g(gt,Pt)}),U(()=>q(ct,`Tasks (${s().tasks.length??""})`)),g(O,pe)};$(ee,O=>{s()?.tasks?.length>0&&O(Q)})}var ae=l(ee,2),Se=l(o(ae),2);Nv(Se,{get selectedTags(){return a(m)},set selectedTags(O){u(m,O,!0)}});var Pe=l(ae,2),$e=l(o(Pe),2),Me=l(Pe,2),z=o(Me),G=l(o(z),2),ce=o(G);ce.value=ce.__value="plan";var ue=l(ce);ue.value=ue.__value="mail";var X=l(ue);X.value=X.__value="order";var W=l(X);W.value=W.__value="other";var se=l(z,2),ne=l(o(se),2),ie=o(ne);ie.value=ie.__value="in_progress";var ve=l(ie);ve.value=ve.__value="done";var F=l(Me,2);{var fe=O=>{var pe=yu(),Ee=o(pe);Ee.__click=()=>window.location.hash=`#/gnc?orderId=${s().id}`,g(O,pe)};$(F,O=>{s()&&a(i)==="order"&&O(fe)})}var P=l(F,2),A=o(P),te=l(o(A),2),je=l(A,2),ze=l(o(je),2),Be=l(P,2),we=l(o(Be),2),Ne=l(Be,2),Je=o(Ne);Je.__click=function(...O){e.onCancel?.apply(this,O)};var ot=l(Je,2),ge=o(ot),Ie=l(D,2);{let O=nt(()=>!!a(S)),pe=nt(()=>a(S)||[]);Si(Ie,{get isOpen(){return a(O)},close:()=>u(S,null),get attachments(){return a(pe)}})}U(()=>{q(Y,s()?"Edit Document":"New Document"),ze.disabled=a(c)!=="done",ot.disabled=a(x)||a(T),q(ge,a(x)?"Saving...":s()?"Save Changes":"Register Document")}),ka("submit",D,C),Ce(oe,()=>a(r),O=>u(r,O)),Ce(I,()=>a(n),O=>u(n,O)),Ce($e,()=>a(v),O=>u(v,O)),At(G,()=>a(i),O=>u(i,O)),At(ne,()=>a(c),O=>u(c,O)),Ce(te,()=>a(d),O=>u(d,O)),Ce(ze,()=>a(p),O=>u(p,O)),Ce(we,()=>a(f),O=>u(f,O)),g(t,R),lt()}_t(["change","click"]);var xu=w('<div class="page-container svelte-14q2aho"><div class="actions-bar svelte-14q2aho"><button class="add-btn svelte-14q2aho"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg> New Document</button></div> <!> <!></div>');function Su(t){let e=k(!1),s=k(null),r=k(null);function n(){u(s,null),u(e,!0)}function i(m){u(s,m,!0),u(e,!0)}function c(){u(e,!1),u(s,null)}function d(){c(),a(r)&&a(r).refresh&&a(r).refresh()}var v=xu(),f=o(v),p=o(f);p.__click=n;var _=l(f,2);Rn(lu(_,{onEdit:i}),m=>u(r,m,!0),()=>a(r));var h=l(_,2);On(h,{get isOpen(){return a(e)},close:c,children:(m,T)=>{ku(m,{onDocumentCreated:d,onCancel:c,get document(){return a(s)}})},$$slots:{default:!0}}),g(t,v)}_t(["click"]);var Tu=w('<span class="att-badge svelte-v5qqzx"> </span>'),qu=w('<div class="attachments-preview svelte-v5qqzx"></div>'),Eu=w('<div class="entry-form svelte-v5qqzx"><input type="text" placeholder="Author" class="author-input svelte-v5qqzx"/> <select class="svelte-v5qqzx"><option>Info</option><option>Warning</option><option>Error</option></select> <textarea placeholder="Message..." class="svelte-v5qqzx"></textarea> <div class="file-input-group svelte-v5qqzx"><input type="file" multiple class="svelte-v5qqzx"/> <!></div> <button>Save</button></div>'),ju=w("<p>Loading...</p>"),Au=w('<p class="empty">No entries found.</p>'),Pu=w('<span class="doc-ref svelte-v5qqzx"> </span>'),Cu=w('<a target="_blank" class="svelte-v5qqzx"><img class="svelte-v5qqzx"/></a>'),Du=w('<a target="_blank" class="svelte-v5qqzx"> </a>'),Ru=w('<div class="attachment-thumb svelte-v5qqzx"><!></div>'),zu=w('<div class="entry-attachments svelte-v5qqzx"></div>'),Mu=w('<div><div class="entry-header svelte-v5qqzx"><span> </span> <span class="author svelte-v5qqzx"> </span> <span class="date"> </span> <!> <div class="actions svelte-v5qqzx"><button class="edit-btn svelte-v5qqzx">âœï¸ Edit</button> <button class="status-btn svelte-v5qqzx"> </button> <button class="delete-btn svelte-v5qqzx">ðŸ—‘</button></div></div> <p class="text svelte-v5qqzx"> </p> <!></div>'),Nu=w('<div class="journal-container svelte-v5qqzx"><div class="toolbar svelte-v5qqzx"><div class="filters svelte-v5qqzx"><select class="svelte-v5qqzx"><option>All Types</option><option>Info</option><option>Warning</option><option>Error</option></select> <select class="svelte-v5qqzx"><option>All Statuses</option><option>Pending</option><option>Done</option></select></div> <button class="add-btn svelte-v5qqzx"> </button></div> <!> <div class="entries-list svelte-v5qqzx"><!></div> <!></div>');function Ou(t,e){it(e,!0);let s=k(ye([])),r=k(!1),n=k(null),i=k(""),c=k(""),d=k(!1),v=k(""),f=k("info"),p=k(""),_=k(ye([]));async function h(){u(r,!0);try{u(s,await go(a(i),a(c)),!0)}catch(E){console.error(E)}finally{u(r,!1)}}Vt(()=>{u(p,localStorage.getItem("journal_author")||"",!0),h();const E=()=>{h()};return window.addEventListener("journal-entries-updated",E),()=>{window.removeEventListener("journal-entries-updated",E)}});async function m(E){const I=Array.from(E.target.files);if(I.length!==0){for(const ee of I)try{const Q=await zn(ee);a(_).push(Q)}catch(Q){console.error("Upload failed",Q),alert("Upload failed for "+ee.name)}E.target.value=""}}async function T(){if(!(!a(v)&&a(_).length===0)){a(p)&&localStorage.setItem("journal_author",a(p));try{await ci({text:a(v),type:a(f),status:"pending",author:a(p),attachments:a(_)}),u(v,""),u(_,[],!0),u(d,!1),h()}catch(E){console.error("Failed to add entry",E)}}}async function x(E){const I=E.status==="pending"?"done":"pending";try{await Nn(E.id,{status:I}),h()}catch(ee){console.error(ee)}}async function y(E){if(confirm("Are you sure?"))try{await mo(E),h()}catch(I){console.error(I)}}function S(E){u(n,E,!0)}function N(){u(n,null),h()}Bt(()=>{h()});var b=Nu(),j=o(b),C=o(j),R=o(C);R.__change=h;var J=o(R);J.value=J.__value="";var Y=l(J);Y.value=Y.__value="info";var D=l(Y);D.value=D.__value="warning";var H=l(D);H.value=H.__value="error";var Z=l(R,2);Z.__change=h;var L=o(Z);L.value=L.__value="";var M=l(L);M.value=M.__value="pending";var K=l(M);K.value=K.__value="done";var re=l(C,2);re.__click=()=>u(d,!a(d));var be=o(re),_e=l(j,2);{var ke=E=>{var I=Eu(),ee=o(I),Q=l(ee,2),ae=o(Q);ae.value=ae.__value="info";var Se=l(ae);Se.value=Se.__value="warning";var Pe=l(Se);Pe.value=Pe.__value="error";var $e=l(Q,2),Me=l($e,2),z=o(Me);z.__change=m;var G=l(z,2);{var ce=X=>{var W=qu();Ae(W,21,()=>a(_),Ge,(se,ne)=>{var ie=Tu(),ve=o(ie);U(()=>q(ve,a(ne).filename)),g(se,ie)}),g(X,W)};$(G,X=>{a(_).length>0&&X(ce)})}var ue=l(Me,2);ue.__click=T,Ce(ee,()=>a(p),X=>u(p,X)),At(Q,()=>a(f),X=>u(f,X)),Ce($e,()=>a(v),X=>u(v,X)),g(E,I)};$(_e,E=>{a(d)&&E(ke)})}var me=l(_e,2),le=o(me);{var Te=E=>{var I=ju();g(E,I)},xe=E=>{var I=dt(),ee=qe(I);{var Q=Se=>{var Pe=Au();g(Se,Pe)},ae=Se=>{var Pe=dt(),$e=qe(Pe);Ae($e,17,()=>a(s),Ge,(Me,z)=>{var G=Mu(),ce=o(G),ue=o(ce),X=o(ue),W=l(ue,2),se=o(W),ne=l(W,2),ie=o(ne),ve=l(ne,2);{var F=Je=>{var ot=Pu(),ge=o(ot);U(()=>q(ge,`Ref: Doc #${a(z).document_id??""}`)),g(Je,ot)};$(ve,Je=>{a(z).document_id&&Je(F)})}var fe=l(ve,2),P=o(fe);P.__click=()=>S(a(z));var A=l(P,2);A.__click=()=>x(a(z));var te=o(A),je=l(A,2);je.__click=()=>y(a(z).id);var ze=l(ce,2),Be=o(ze),we=l(ze,2);{var Ne=Je=>{var ot=zu();Ae(ot,21,()=>a(z).attachments,Ge,(ge,Ie)=>{var O=Ru(),pe=o(O);{var Ee=at=>{var gt=Cu(),He=o(gt);U(()=>{We(gt,"href",a(Ie).file_path),We(He,"src",a(Ie).file_path),We(He,"alt",a(Ie).filename)}),g(at,gt)},ct=at=>{var gt=Du(),He=o(gt);U(()=>{We(gt,"href",a(Ie).file_path),q(He,`ðŸ“„ ${a(Ie).filename??""}`)}),g(at,gt)};$(pe,at=>{a(Ie).media_type&&a(Ie).media_type.startsWith("image/")?at(Ee):at(ct,!1)})}g(ge,O)}),g(Je,ot)};$(we,Je=>{a(z).attachments&&a(z).attachments.length>0&&Je(Ne)})}U(()=>{Le(G,1,`entry-card ${a(z).type??""} ${a(z).status??""}`,"svelte-v5qqzx"),Le(ue,1,`badge ${a(z).type??""}`,"svelte-v5qqzx"),q(X,a(z).type),q(se,a(z).author||"Unknown"),q(ie,a(z).created_at),q(te,a(z).status==="pending"?"â˜‘ Mark Done":"â†© Reopen"),q(Be,a(z).text)}),g(Me,G)}),g(Se,Pe)};$(ee,Se=>{a(s).length===0?Se(Q):Se(ae,!1)},!0)}g(E,I)};$(le,E=>{a(r)?E(Te):E(xe,!1)})}var oe=l(me,2);{let E=nt(()=>!!a(n)),I=nt(()=>a(n)?.document_id);xi(oe,{get isOpen(){return a(E)},close:N,get documentId(){return a(I)},documentName:"Journal Entry",get entry(){return a(n)}})}U(()=>q(be,a(d)?"Cancel":"+ New Entry")),At(R,()=>a(i),E=>u(i,E)),At(Z,()=>a(c),E=>u(c,E)),g(t,b),lt()}_t(["change","click"]);var Iu=w('<div class="loading-state svelte-g0byll">Loading tasks...</div>'),Lu=w('<div class="empty-state svelte-g0byll">Enter an assignee name above to view their tasks.</div>'),$u=w('<div class="empty-state svelte-g0byll">No pending or planned tasks found for this assignee.</div>'),Fu=w('<div><div class="task-info svelte-g0byll"><span> </span> <button class="btn-done svelte-g0byll" title="Mark as done">âœ“</button> <span class="task-name svelte-g0byll"> </span></div></div>'),Bu=w('<div class="material-group svelte-g0byll"><div class="material-header svelte-g0byll"><span class="material-name svelte-g0byll"> </span> <span class="task-count svelte-g0byll"> </span></div> <div class="tasks-list svelte-g0byll"></div></div>'),Uu=w('<div class="doc-group svelte-g0byll"><div class="doc-header svelte-g0byll"><h3 class="svelte-g0byll"> </h3> <span> </span></div> <!></div>'),Gu=w('<div class="documents-list svelte-g0byll"></div>'),Yu=w('<div class="job-view svelte-g0byll"><div class="assignee-filter svelte-g0byll"><label for="assignee" class="svelte-g0byll">Assignee:</label> <input id="assignee" type="text" placeholder="Enter assignee name..." class="svelte-g0byll"/> <button class="btn-load svelte-g0byll"> </button></div> <!></div>');function Xu(t,e){it(e,!0);let s=k(ye([])),r=k(""),n=k(!1);Vt(()=>{u(r,localStorage.getItem("job_assignee")||"",!0),a(r)&&i()});async function i(){if(!a(r).trim()){u(s,[],!0);return}u(n,!0);try{const S=await Mn();u(s,S.map(N=>({...N,tasks:(N.tasks||[]).filter(b=>b.assignee&&b.assignee.toLowerCase().includes(a(r).toLowerCase())&&(b.status==="pending"||b.status==="planned"))})).filter(N=>N.tasks.length>0),!0)}catch(S){console.error(S)}finally{u(n,!1)}}function c(){localStorage.setItem("job_assignee",a(r)),i()}async function d(S){try{await Ns(S,{status:"done"}),await i()}catch(N){console.error(N),alert("Failed to update task status")}}function v(S){const b=[...S.tasks||[]].sort((C,R)=>C.status==="pending"&&R.status!=="pending"?-1:C.status!=="pending"&&R.status==="pending"?1:0),j={};return b.forEach(C=>{const R=C.material?C.material.name:"(No Material)";j[R]||(j[R]=[]),j[R].push(C)}),j}var f=Yu(),p=o(f),_=l(o(p),2);_.__change=c;var h=l(_,2);h.__click=i;var m=o(h),T=l(p,2);{var x=S=>{var N=Iu();g(S,N)},y=S=>{var N=dt(),b=qe(N);{var j=R=>{var J=Lu();g(R,J)},C=R=>{var J=dt(),Y=qe(J);{var D=Z=>{var L=$u();g(Z,L)},H=Z=>{var L=Gu();Ae(L,21,()=>a(s),M=>M.id,(M,K)=>{const re=nt(()=>v(a(K)));var be=Uu(),_e=o(be),ke=o(_e),me=o(ke),le=l(ke,2),Te=o(le),xe=l(_e,2);Ae(xe,17,()=>Object.entries(a(re)),Ge,(oe,E)=>{var I=nt(()=>bn(a(E),2));let ee=()=>a(I)[0],Q=()=>a(I)[1];var ae=Bu(),Se=o(ae),Pe=o(Se),$e=o(Pe),Me=l(Pe,2),z=o(Me),G=l(Se,2);Ae(G,21,Q,ce=>ce.id,(ce,ue)=>{var X=Fu(),W=o(X),se=o(W),ne=o(se),ie=l(se,2);ie.__click=()=>d(a(ue).id);var ve=l(ie,2),F=o(ve);U(()=>{Le(X,1,`task-row ${a(ue).status??""}`,"svelte-g0byll"),Le(se,1,`task-status-badge ${a(ue).status??""}`,"svelte-g0byll"),q(ne,a(ue).status),q(F,a(ue).name)}),g(ce,X)}),U(()=>{q($e,`ðŸ“¦ ${ee()??""}`),q(z,`${Q().length??""} task${Q().length!==1?"s":""}`)}),g(oe,ae)}),U(()=>{q(me,a(K).name),Le(le,1,`doc-badge ${a(K).type??""}`,"svelte-g0byll"),q(Te,a(K).type)}),g(M,be)}),g(Z,L)};$(Y,Z=>{a(s).length===0?Z(D):Z(H,!1)},!0)}g(R,J)};$(b,R=>{a(r).trim()?R(C,!1):R(j)},!0)}g(S,N)};$(T,S=>{a(n)?S(x):S(y,!1)})}U(S=>{h.disabled=S,q(m,a(n)?"Loading...":"Load")},[()=>a(n)||!a(r).trim()]),Ce(_,()=>a(r),S=>u(r,S)),g(t,f),lt()}_t(["change","click"]);const Rt=ye({userRole:(typeof window<"u"?localStorage.getItem("user_role"):"admin")||"admin",configStatus:"unknown",currentDocument:null,settings:{ocrUrl:"",docNameRegex:"",syncMihtavPath:"",syncSidraPath:""},partTray:[],trayVisible:!1});function Ju(t){Rt.configStatus=t}function Hu(t){const e=Rt.partTray.find(s=>s.part.id===t.id);e?e.quantity+=1:Rt.partTray.push({part:t,quantity:1}),Rt.trayVisible=!0}function Ti(t){Rt.partTray=Rt.partTray.filter(e=>e.part.id!==t)}function _r(t,e){const s=Rt.partTray.find(r=>r.part.id===t);s&&(s.quantity+=e,s.quantity<=0&&Ti(t))}function gr(){Rt.partTray=[]}function an(){Rt.trayVisible=!Rt.trayVisible}var Wu=w('<img class="thumbnail-img svelte-10wfxqz"/>'),Vu=w('<div class="thumbnail card svelte-10wfxqz" role="button" tabindex="0"><div class="preview svelte-10wfxqz"><!> <div class="placeholder-geo svelte-10wfxqz"><span>âš™ï¸</span></div> <div class="overlay-actions svelte-10wfxqz"><button class="action-btn svelte-10wfxqz" title="Edit Part">âœï¸</button> <button class="action-btn svelte-10wfxqz" title="Preview">ðŸ‘ï¸</button> <button class="action-btn svelte-10wfxqz" title="Add to Order">+</button> <button class="action-btn svelte-10wfxqz" title="Filter in Docs">ðŸ”</button></div></div> <div class="info svelte-10wfxqz"><h4 class="name svelte-10wfxqz"> </h4> <div class="card-meta svelte-10wfxqz"><div class="meta-item svelte-10wfxqz"><span class="label svelte-10wfxqz">Registration:</span> <span class="value svelte-10wfxqz"> </span></div> <div class="meta-item svelte-10wfxqz"><span class="label svelte-10wfxqz">Dimensions:</span> <span class="value svelte-10wfxqz"> </span></div> <div class="meta-item svelte-10wfxqz"><span class="label svelte-10wfxqz">Material:</span> <span class="value svelte-10wfxqz"> </span></div></div></div></div>');function Zu(t,e){it(e,!0);let s=nt(()=>e.part.material?e.part.material.name:"Unknown Material"),r=nt(()=>`${e.part.width||"?"} x ${e.part.height||"?"}`);function n(M){M.stopPropagation(),e.onedit&&e.onedit(e.part)}function i(M){M.stopPropagation(),e.onpreview&&e.onpreview(e.part)}var c=Vu();c.__click=function(...M){e.onclick?.apply(this,M)},c.__keydown=M=>M.key==="Enter"&&e.onclick&&e.onclick();var d=o(c),v=o(d);{var f=M=>{var K=Wu();U(()=>{We(K,"src",`/uploads/thumbnails/${(e.part.registration_number||e.part.id)??""}.svg`),We(K,"alt",e.part.name)}),ka("error",K,re=>{re.currentTarget.style.display="none"}),g(M,K)};$(v,M=>{e.part.gnc_file_path&&M(f)})}var p=l(v,2),_=l(p,2),h=o(_);h.__click=n;var m=l(h,2);m.__click=i;var T=l(m,2);T.__click=M=>{M.stopPropagation(),e.onclick&&e.onclick()};var x=l(T,2);x.__click=M=>{M.stopPropagation(),e.onfilter&&e.onfilter(e.part)};var y=l(d,2),S=o(y),N=o(S),b=l(S,2),j=o(b),C=l(o(j),2),R=o(C),J=l(j,2),Y=l(o(J),2),D=o(Y),H=l(J,2),Z=l(o(H),2),L=o(Z);U(()=>{ts(p,e.part.gnc_file_path?"display: none;":""),We(S,"title",e.part.name),q(N,e.part.name),q(R,e.part.registration_number||"-"),q(D,`${a(r)??""} mm`),q(L,a(s))}),g(t,c),lt()}_t(["click","keydown"]);var Qu=w('<div class="tray-item svelte-15dteus"><img class="thumb svelte-15dteus"/> <div class="details svelte-15dteus"><span class="name svelte-15dteus"> </span> <div class="qty-controls svelte-15dteus"><button class="svelte-15dteus">-</button> <span class="qty svelte-15dteus"> </span> <button class="svelte-15dteus">+</button></div></div> <button class="remove-btn svelte-15dteus" title="Remove">ðŸ—‘ï¸</button></div>'),Ku=w('<div class="empty svelte-15dteus">Tray is empty. Add parts from the library.</div>'),ed=w('<div class="tray-backdrop svelte-15dteus"></div> <aside class="tray-panel svelte-15dteus"><header class="svelte-15dteus"><h3 class="svelte-15dteus">Order Tray</h3> <button class="close-btn svelte-15dteus">&times;</button></header> <div class="items svelte-15dteus"><!> <!></div> <footer class="svelte-15dteus"><div class="input-group svelte-15dteus"><label for="order-name" class="svelte-15dteus">Order Name</label> <input id="order-name" type="text" placeholder="e.g. ORDER-2024-001" class="svelte-15dteus"/></div> <div class="actions svelte-15dteus"><button class="clear-btn svelte-15dteus">Clear</button> <button class="create-btn svelte-15dteus"> </button></div></footer></aside>',1);function td(t,e){it(e,!0);let s=k(!1),r=k("");async function n(){if(Rt.partTray.length!==0){if(!a(r))return alert("Please enter an Order Name");u(s,!0);try{const v=Rt.partTray.map(f=>({id:f.part.id,qty:f.quantity}));await qo(v,a(r)),gr(),an(),alert("Order created successfully!")}catch(v){console.error(v),alert("Failed to create order: "+v.message)}finally{u(s,!1)}}}var i=dt(),c=qe(i);{var d=v=>{var f=ed(),p=qe(f);p.__click=function(...D){an?.apply(this,D)};var _=l(p,2),h=o(_),m=l(o(h),2);m.__click=function(...D){an?.apply(this,D)};var T=l(h,2),x=o(T);Ae(x,17,()=>Rt.partTray,D=>D.part.id,(D,H)=>{var Z=Qu(),L=o(Z),M=l(L,2),K=o(M),re=o(K),be=l(K,2),_e=o(be);_e.__click=()=>_r(a(H).part.id,-1);var ke=l(_e,2),me=o(ke),le=l(ke,2);le.__click=()=>_r(a(H).part.id,1);var Te=l(M,2);Te.__click=()=>Ti(a(H).part.id),U(()=>{We(L,"src",a(H).part.thumbnail_url||"/placeholder.png"),We(L,"alt",a(H).part.name),q(re,a(H).part.name),_e.disabled=a(H).quantity<=1,q(me,a(H).quantity)}),g(D,Z)});var y=l(x,2);{var S=D=>{var H=Ku();g(D,H)};$(y,D=>{Rt.partTray.length===0&&D(S)})}var N=l(T,2),b=o(N),j=l(o(b),2),C=l(b,2),R=o(C);R.__click=function(...D){gr?.apply(this,D)};var J=l(R,2);J.__click=n;var Y=o(J);U(()=>{R.disabled=Rt.partTray.length===0,J.disabled=Rt.partTray.length===0||a(s)||!a(r),q(Y,a(s)?"Creating...":"Create Order")}),Ce(j,()=>a(r),D=>u(r,D)),g(v,f)};$(c,v=>{Rt.trayVisible&&v(d)})}g(t,i),lt()}_t(["click"]);var ad=w('<div class="message svelte-1y39gna"> </div>'),sd=w('<div class="modal-overlay svelte-1y39gna"><div class="modal svelte-1y39gna"><h2 class="svelte-1y39gna">Scanning Library</h2> <div class="progress-container svelte-1y39gna"><div class="progress-bar svelte-1y39gna"><div class="progress-fill svelte-1y39gna"></div></div> <span class="progress-text svelte-1y39gna"> </span></div> <div class="status svelte-1y39gna"><strong>Status:</strong> </div> <!> <div class="actions svelte-1y39gna"><button class="svelte-1y39gna"> </button></div></div></div>');function nd(t,e){it(e,!0);const s=no();let r=xt(e,"show",15,!1),n=xt(e,"progress",3,0),i=xt(e,"status",3,""),c=xt(e,"message",3,"");function d(){i()!=="scanning"&&(r(!1),s("close"))}var v=dt(),f=qe(v);{var p=_=>{var h=sd();h.__click=d;var m=o(h);m.__click=H=>H.stopPropagation();var T=l(o(m),2),x=o(T),y=o(x),S=l(x,2),N=o(S),b=l(T,2),j=l(o(b)),C=l(b,2);{var R=H=>{var Z=ad(),L=o(Z);U(()=>q(L,c())),g(H,Z)};$(C,H=>{c()&&H(R)})}var J=l(C,2),Y=o(J);Y.__click=d;var D=o(Y);U(()=>{ts(y,`width: ${n()??""}%`),q(N,`${n()??""}%`),q(j,` ${i()??""}`),Y.disabled=i()==="scanning",q(D,i()==="scanning"?"Scanning...":"Close")}),g(_,h)};$(f,_=>{r()&&_(p)})}g(t,v),lt()}_t(["click"]);var rd=w("<option> </option>"),id=w('<div class="modal-overlay svelte-1fna2hh"><div class="modal svelte-1fna2hh"><h2 class="svelte-1fna2hh">Edit Part</h2> <div class="form svelte-1fna2hh"><div class="field svelte-1fna2hh"><label for="name" class="svelte-1fna2hh">Name</label> <input id="name" type="text" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="reg" class="svelte-1fna2hh">Registration Number</label> <input id="reg" type="text" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="width" class="svelte-1fna2hh">Width (mm)</label> <input id="width" type="number" step="0.01" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="height" class="svelte-1fna2hh">Height (mm)</label> <input id="height" type="number" step="0.01" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="material" class="svelte-1fna2hh">Material</label> <select id="material" class="svelte-1fna2hh"><option>No Material</option><!></select></div></div> <div class="actions svelte-1fna2hh"><button class="secondary svelte-1fna2hh">Cancel</button> <button class="primary svelte-1fna2hh">Save</button></div></div></div>');function ld(t,e){it(e,!0);let s=xt(e,"show",15,!1),r=xt(e,"part",3,null),n=k(ye([])),i=k(ye({name:"",registration_number:"",width:0,height:0,material_id:null}));Bt(()=>{s()&&r()&&(u(i,{name:r().name||"",registration_number:r().registration_number||"",width:r().width||0,height:r().height||0,material_id:r().material_id||null},!0),c())});async function c(){try{u(n,await Ya(),!0)}catch(h){console.error("Failed to load materials:",h)}}function d(){s(!1)}function v(){e.onsave&&e.onsave(a(i)),d()}var f=dt(),p=qe(f);{var _=h=>{var m=id();m.__click=d;var T=o(m);T.__click=re=>re.stopPropagation();var x=l(o(T),2),y=o(x),S=l(o(y),2),N=l(y,2),b=l(o(N),2),j=l(N,2),C=l(o(j),2),R=l(j,2),J=l(o(R),2),Y=l(R,2),D=l(o(Y),2),H=o(D);H.value=(H.__value=null)??"";var Z=l(H);Ae(Z,17,()=>a(n),Ge,(re,be)=>{var _e=rd(),ke=o(_e),me={};U(()=>{q(ke,a(be).name),me!==(me=a(be).id)&&(_e.value=(_e.__value=a(be).id)??"")}),g(re,_e)});var L=l(x,2),M=o(L);M.__click=d;var K=l(M,2);K.__click=v,Ce(S,()=>a(i).name,re=>a(i).name=re),Ce(b,()=>a(i).registration_number,re=>a(i).registration_number=re),Ce(C,()=>a(i).width,re=>a(i).width=re),Ce(J,()=>a(i).height,re=>a(i).height=re),At(D,()=>a(i).material_id,re=>a(i).material_id=re),g(h,m)};$(p,h=>{s()&&h(_)})}g(t,f),lt()}_t(["click"]);var od=w('<img class="preview-img svelte-17z6zdn"/>'),cd=w('<div class="no-preview svelte-17z6zdn">No preview available</div>'),vd=w('<div class="modal-backdrop svelte-17z6zdn"><div class="modal svelte-17z6zdn"><header class="svelte-17z6zdn"><h3 class="svelte-17z6zdn"> </h3> <button class="close-btn svelte-17z6zdn">&times;</button></header> <div class="content svelte-17z6zdn"><!> <div class="details svelte-17z6zdn"><p><strong>Registration:</strong> </p> <p><strong>Dimensions:</strong> </p></div></div></div></div>');function ud(t,e){it(e,!0);let s=xt(e,"show",15,!1);function r(){s(!1)}function n(v){v.key==="Escape"&&r()}var i=dt();ka("keydown",vn,n);var c=qe(i);{var d=v=>{var f=vd();f.__click=r;var p=o(f);p.__click=Y=>Y.stopPropagation();var _=o(p),h=o(_),m=o(h),T=l(h,2);T.__click=r;var x=l(_,2),y=o(x);{var S=Y=>{var D=od();U(()=>{We(D,"src",`/uploads/thumbnails/${(e.part.registration_number||e.part.id)??""}.svg`),We(D,"alt",e.part.name)}),g(Y,D)},N=Y=>{var D=cd();g(Y,D)};$(y,Y=>{e.part.gnc_file_path?Y(S):Y(N,!1)})}var b=l(y,2),j=o(b),C=l(o(j)),R=l(j,2),J=l(o(R));U(()=>{q(m,e.part.name),q(C,` ${(e.part.registration_number||"-")??""}`),q(J,` ${(e.part.width||"?")??""} x ${(e.part.height||"?")??""} mm`)}),g(v,f)};$(c,v=>{s()&&e.part&&v(d)})}g(t,i),lt()}_t(["click"]);var dd=w("<option> </option>"),fd=w('<div class="loading svelte-xfu7xu">Loading parts...</div>'),pd=w('<div class="empty svelte-xfu7xu">No parts found matching filters.</div>'),hd=w("<div></div>"),_d=w('<div class="parts-layout svelte-xfu7xu"><aside class="sidebar svelte-xfu7xu"><h3 class="svelte-xfu7xu">Filters</h3> <div class="filter-group svelte-xfu7xu"><label for="search" class="svelte-xfu7xu">Search</label> <input id="search" type="text" placeholder="Name or Reg #" class="svelte-xfu7xu"/></div> <div class="filter-group svelte-xfu7xu"><label for="material" class="svelte-xfu7xu">Material</label> <select id="material" class="svelte-xfu7xu"><option>All Materials</option><!></select></div> <div class="filter-group svelte-xfu7xu"><span class="filter-label svelte-xfu7xu">Width (mm)</span> <div class="range svelte-xfu7xu"><input type="number" placeholder="Min" class="svelte-xfu7xu"/> <span>-</span> <input type="number" placeholder="Max" class="svelte-xfu7xu"/></div></div> <div class="filter-group svelte-xfu7xu"><span class="filter-label svelte-xfu7xu">Height (mm)</span> <div class="range svelte-xfu7xu"><input type="number" placeholder="Min" class="svelte-xfu7xu"/> <span>-</span> <input type="number" placeholder="Max" class="svelte-xfu7xu"/></div></div> <button class="reset-btn svelte-xfu7xu">Reset Filters</button></aside> <main class="content svelte-xfu7xu"><header class="svelte-xfu7xu"><div class="title-row svelte-xfu7xu"><h2 class="svelte-xfu7xu">Parts Library</h2></div> <div class="actions svelte-xfu7xu"><button>ðŸ”„ Rescan Library</button> <button>â†» Refresh</button></div></header> <!></main> <!> <!> <!> <!></div>');function gd(t,e){it(e,!0);let s=k(ye([])),r=k(ye([])),n=k(""),i=k(""),c=k(""),d=k(""),v=k(""),f=k(""),p=k(!1),_=k(0);const h=50;let m=k(!1),T=k(0),x=k(""),y=k(""),S=k(!1),N=k(null),b=k(!1),j=k(null);async function C(){u(p,!0);try{const F={};a(n)&&(F.search=a(n)),a(i)&&(F.material_id=a(i)),a(c)&&(F.min_width=a(c)),a(d)&&(F.max_width=a(d)),a(v)&&(F.min_height=a(v)),a(f)&&(F.max_height=a(f));const[fe,P]=await Promise.all([Ao(a(_)*h,h,F),a(r).length===0?Ya():Promise.resolve(a(r))]);u(s,fe,!0),a(r).length===0&&u(r,P,!0)}catch(F){console.error(F),alert("Failed to load parts")}finally{u(p,!1)}}function R(){u(_,0),C()}let J;function Y(){clearTimeout(J),J=setTimeout(()=>{R()},500)}async function D(){u(m,!0),u(T,0),u(x,"starting"),u(y,"Initializing scan...");try{await zo(F=>{u(T,F.percent||0,!0),u(x,F.status||"",!0),u(y,F.message||"",!0)}),a(x)==="complete"&&await C()}catch(F){console.error("Scan error:",F),u(x,"error"),u(y,`Scan failed: ${F.message}`)}}function H(F){u(N,F,!0),u(S,!0)}function Z(F){u(j,F,!0),u(b,!0)}function L(F){ra(`/documents?part_search=${encodeURIComponent(F.name)}`)}async function M(F){try{await Mo(a(N).id,F),await C(),alert("Part updated successfully"),u(S,!1)}catch(fe){console.error("Update error:",fe),alert("Failed to update part")}}Vt(()=>{C()});var K=_d(),re=o(K),be=l(o(re),2),_e=l(o(be),2);_e.__input=Y;var ke=l(be,2),me=l(o(ke),2);me.__change=R;var le=o(me);le.value=le.__value="";var Te=l(le);Ae(Te,17,()=>a(r),Ge,(F,fe)=>{var P=dd(),A=o(P),te={};U(()=>{q(A,a(fe).name),te!==(te=a(fe).id)&&(P.value=(P.__value=a(fe).id)??"")}),g(F,P)});var xe=l(ke,2),oe=l(o(xe),2),E=o(oe);E.__change=R;var I=l(E,4);I.__change=R;var ee=l(xe,2),Q=l(o(ee),2),ae=o(Q);ae.__change=R;var Se=l(ae,4);Se.__change=R;var Pe=l(ee,2);Pe.__click=()=>{u(n,""),u(i,""),u(c,""),u(d,""),u(v,""),u(f,""),R()};var $e=l(re,2),Me=o($e),z=l(o(Me),2),G=o(z);G.__click=D;var ce=l(G,2);ce.__click=()=>C();var ue=l(Me,2);{var X=F=>{var fe=fd();g(F,fe)},W=F=>{var fe=dt(),P=qe(fe);{var A=je=>{var ze=pd();g(je,ze)},te=je=>{var ze=hd();Le(ze,1,"grid grid svelte-xfu7xu"),Ae(ze,21,()=>a(s),Be=>Be.id,(Be,we)=>{Zu(Be,{get part(){return a(we)},onclick:()=>Hu(a(we)),onedit:H,onpreview:Z,onfilter:L})}),g(je,ze)};$(P,je=>{a(s).length===0?je(A):je(te,!1)},!0)}g(F,fe)};$(ue,F=>{a(p)?F(X):F(W,!1)})}var se=l($e,2);nd(se,{get status(){return a(x)},get message(){return a(y)},get progress(){return a(T)},get show(){return a(m)},set show(F){u(m,F,!0)}});var ne=l(se,2);ld(ne,{get part(){return a(N)},onsave:M,get show(){return a(S)},set show(F){u(S,F,!0)}});var ie=l(ne,2);ud(ie,{get part(){return a(j)},get show(){return a(b)},set show(F){u(b,F,!0)}});var ve=l(ie,2);td(ve,{}),Ce(_e,()=>a(n),F=>u(n,F)),At(me,()=>a(i),F=>u(i,F)),Ce(E,()=>a(c),F=>u(c,F)),Ce(I,()=>a(d),F=>u(d,F)),Ce(ae,()=>a(v),F=>u(v,F)),Ce(Se,()=>a(f),F=>u(f,F)),g(t,K),lt()}_t(["input","change","click"]);var md=w('<div class="canvas-container svelte-1eph566"><div class="toolbar svelte-1eph566"><button title="Navigate (Pan)">âœ‹</button> <button title="Select">â†–</button> <button title="Define Nesting Area">ðŸŽ¯</button></div>  <canvas class="svelte-1eph566"></canvas> <div class="zoom-controls svelte-1eph566"><button title="Reset Zoom" class="svelte-1eph566">âŸ²</button> <span class="zoom-level svelte-1eph566"> </span></div></div>');function bd(t,e){it(e,!0);let s=xt(e,"sheet",3,null),r=xt(e,"width",3,800),n=xt(e,"height",3,600),i=xt(e,"onselect",3,null),c=xt(e,"onAreaChange",3,null),d=k(void 0),v=k(null),f=k(1),p=k(0),_=k(0),h=k(!1),m=k(0),T=k(0),x=k("navigate"),y=k(!1),S=k(null),N=k(null),b=k(null),j=k(null);const C=nt(()=>s()?J(s()):{minX:0,minY:0,maxX:100,maxY:100}),R=nt(()=>{const z=a(C).maxX-a(C).minX,G=a(C).maxY-a(C).minY;if(z===0&&G===0)return{scale:1,startX:0,startY:0,bounds:a(C)};const ce=20,ue=r()-ce*2,X=n()-ce*2,W=ue/z,se=X/G,ie=Math.min(W,se)*.95*a(f),ve=z*ie,F=G*ie;return{scale:ie,startX:(r()-ve)/2+a(p),startY:(n()-F)/2+a(_),bounds:a(C)}});Bt(()=>{a(d)&&a(R)&&D()}),Vt(()=>{a(d)&&(u(v,a(d).getContext("2d"),!0),D())});function J(z){let G=1/0,ce=1/0,ue=-1/0,X=-1/0,W=!1;z.program_width&&z.program_height&&(G=0,ce=0,ue=z.program_width,X=z.program_height,W=!0);for(const se of z.parts){const ne=se.x||0,ie=se.y||0;let ve=0,F=0;for(const fe of se.contours)for(const P of fe.commands)if(P.x!==void 0&&(ve=P.x),P.y!==void 0&&(F=P.y),P.x!==void 0||P.y!==void 0){W=!0;const A=ne+ve,te=ie+F;A<G&&(G=A),A>ue&&(ue=A),te<ce&&(ce=te),te>X&&(X=te)}}return W?{minX:G,minY:ce,maxX:ue,maxY:X}:{minX:0,minY:0,maxX:100,maxY:100}}function Y(z,G){return{x:(z-a(R).startX)/a(R).scale+a(R).bounds.minX,y:(n()-G-a(R).startY)/a(R).scale+a(R).bounds.minY}}function D(){if(!a(v)||!s()||!a(R))return;a(v).fillStyle="#1e1e1e",a(v).fillRect(0,0,r(),n());const{scale:z,startX:G,startY:ce,bounds:ue}=a(R),X=(se,ne=0)=>G+(se+ne-ue.minX)*z,W=(se,ne=0)=>n()-(ce+(se+ne-ue.minY)*z);if(s().program_width&&s().program_height&&(a(v).strokeStyle="#444",a(v).lineWidth=2,a(v).setLineDash([5,5]),a(v).strokeRect(X(0),W(s().program_height),s().program_width*z,s().program_height*z),a(v).setLineDash([])),s().nestingArea&&(a(v).strokeStyle="rgba(0, 255, 0, 0.5)",a(v).lineWidth=2,a(v).setLineDash([10,5]),a(v).strokeRect(X(s().nestingArea.x),W(s().nestingArea.y+s().nestingArea.height),s().nestingArea.width*z,s().nestingArea.height*z),a(v).fillStyle="rgba(0, 255, 0, 0.05)",a(v).fillRect(X(s().nestingArea.x),W(s().nestingArea.y+s().nestingArea.height),s().nestingArea.width*z,s().nestingArea.height*z),a(v).setLineDash([])),a(y)&&a(S)&&a(N)){const se=Math.min(a(S).x,a(N).x),ne=Math.min(a(S).y,a(N).y),ie=Math.max(a(S).x,a(N).x),ve=Math.max(a(S).y,a(N).y);a(v).strokeStyle="rgba(0, 255, 0, 0.8)",a(v).lineWidth=2,a(v).strokeRect(X(se),W(ve),(ie-se)*z,(ve-ne)*z)}s().parts.forEach((se,ne)=>{const ie=ne*137%360,ve=se.x||0,F=se.y||0;se.contours.forEach(fe=>{const P=`${se.id}-${fe.id}`,A=a(b)===P,te=a(j)===P;a(v).beginPath(),a(v).strokeStyle=A?"#ffffff":te?"#fbbf24":`hsl(${ie}, 70%, 60%)`,a(v).lineWidth=A||te?3:1.5,a(v).shadowBlur=A?10:te?5:0,a(v).shadowColor=A?"#ffffff":te?"#fbbf24":"transparent";let je=null,ze=null,Be=!1;fe.commands.forEach(we=>{const Ne=je,Je=ze;if(we.x!==void 0&&(je=we.x),we.y!==void 0&&(ze=we.y),!(je===null||ze===null)){if(we.type==="G00"||we.command==="G"&&we.value===0)a(v).moveTo(X(je,ve),W(ze,F)),Be=!0;else if(we.type==="G01"||we.command==="G"&&we.value===1||we.type==="MODAL"||we.type==="G41"||we.type==="G40")Be?a(v).lineTo(X(je,ve),W(ze,F)):(a(v).moveTo(X(je,ve),W(ze,F)),Be=!0);else if((we.type==="G02"||we.type==="G03"||we.command==="G"&&(we.value===2||we.value===3))&&we.i!==void 0&&we.j!==void 0&&Ne!==null&&Je!==null){const ot=we.i,ge=we.j,Ie=Ne+ot,O=Je+ge,pe=Math.sqrt(ot*ot+ge*ge),Ee=X(Ie,ve),ct=W(O,F),at=pe*z,gt=Math.atan2(W(Je,F)-ct,X(Ne,ve)-Ee),He=Math.atan2(W(ze,F)-ct,X(je,ve)-Ee),Pt=we.type==="G02"||we.command==="G"&&we.value===2;a(v).arc(Ee,ct,at,gt,He,Pt)}}}),a(v).stroke(),a(v).shadowBlur=0})})}function H(z,G){if(!s())return null;const ce=a(d).getBoundingClientRect(),ue=z-ce.left,X=G-ce.top,W=Y(ue,X),se=W.x,ne=W.y,ie=5/a(R).scale;let ve=null,F=null,fe=1/0;for(const P of s().parts){const A=P.x||0,te=P.y||0;for(const je of P.contours){let ze=null,Be=null,we=1/0;for(const Ne of je.commands){const Je=Ne.x!==void 0?Ne.x:ze,ot=Ne.y!==void 0?Ne.y:Be;let ge=1/0;if(ze!==null&&Be!==null&&Je!==null&&ot!==null){if(Ne.type==="G01"||Ne.command==="G"&&Ne.value===1||Ne.type==="MODAL"||Ne.type==="G41"||Ne.type==="G40")ge=L(se,ne,ze+A,Be+te,Je+A,ot+te);else if(Ne.type==="G02"||Ne.type==="G03"||Ne.command==="G"&&(Ne.value===2||Ne.value===3)){const Ie=Ne.i||0,O=Ne.j||0,pe=ze+Ie+A,Ee=Be+O+te,ct=Math.sqrt(Ie*Ie+O*O),at=Math.sqrt((se-pe)**2+(ne-Ee)**2);ge=Math.abs(at-ct);const gt=Math.atan2(Be+te-Ee,ze+A-pe),He=Math.atan2(ot+te-Ee,Je+A-pe),Pt=Math.atan2(ne-Ee,se-pe),St=Ne.type==="G02"||Ne.command==="G"&&Ne.value===2;ke(Pt,gt,He,St)||(ge=1/0)}}ge<we&&(we=ge),ze=Je,Be=ot}we<ie&&we<fe&&(fe=we,ve=je,F=P)}}return ve?{contour:ve,part:F}:null}function Z(z){const G=H(z.clientX,z.clientY);G?(u(b,`${G.part.id}-${G.contour.id}`),i()&&i()(G)):(u(b,null),i()&&i()(null)),D()}function L(z,G,ce,ue,X,W){const se=z-ce,ne=G-ue,ie=X-ce,ve=W-ue,F=se*ie+ne*ve,fe=ie*ie+ve*ve;let P=-1;fe!=0&&(P=F/fe);let A,te;P<0?(A=ce,te=ue):P>1?(A=X,te=W):(A=ce+P*ie,te=ue+P*ve);const je=z-A,ze=G-te;return Math.sqrt(je*je+ze*ze)}function M(z){z.preventDefault();const G=a(d).getBoundingClientRect(),ce=z.clientX-G.left,ue=z.clientY-G.top,X=Y(ce,ue),W=z.deltaY>0?.9:1.1,se=Math.max(.1,Math.min(10,a(f)*W));if(a(R).scale===0||a(f)===0)return;const ie=a(R).scale/a(f)*se,ve=a(R).bounds.maxX-a(R).bounds.minX,F=a(R).bounds.maxY-a(R).bounds.minY,fe=ve*ie,P=F*ie,A=ce-(X.x-a(R).bounds.minX)*ie,te=n()-ue-(X.y-a(R).bounds.minY)*ie;u(p,A-(r()-fe)/2),u(_,te-(n()-P)/2),u(f,se,!0),D()}function K(z){u(m,z.clientX,!0),u(T,z.clientY,!0);const G=a(d).getBoundingClientRect();a(x)==="navigate"?u(h,!0):a(x)==="nestArea"&&(u(y,!0),u(S,Y(z.clientX-G.left,z.clientY-G.top),!0),u(N,a(S),!0))}function re(z){if(a(x)==="navigate"&&a(h)){const G=z.clientX-a(m),ce=z.clientY-a(T);u(p,a(p)+G),u(_,a(_)-ce),u(m,z.clientX,!0),u(T,z.clientY,!0),D()}else if(a(x)==="select"){const G=H(z.clientX,z.clientY),ce=G?`${G.part.id}-${G.contour.id}`:null;ce!==a(j)&&(u(j,ce,!0),D())}else if(a(x)==="nestArea"&&a(y)){const G=a(d).getBoundingClientRect();u(N,Y(z.clientX-G.left,z.clientY-G.top),!0),D()}}function be(){a(j)!==null&&(u(j,null),D()),a(h)&&u(h,!1)}function _e(z){const G=Math.abs(z.clientX-a(m)),ce=Math.abs(z.clientY-a(T)),ue=G<5&&ce<5;if(a(x)==="navigate")u(h,!1);else if(a(x)==="select")ue&&Z(z);else if(a(x)==="nestArea"&&a(y)){u(y,!1);const X=Math.min(a(S).x,a(N).x),W=Math.min(a(S).y,a(N).y),se=Math.max(a(S).x,a(N).x),ne=Math.max(a(S).y,a(N).y),ie={x:X,y:W,width:se-X,height:ne-W};ie.width>5&&ie.height>5&&c()&&c()(ie),D()}}function ke(z,G,ce,ue){const X=Math.PI*2,W=(z%X+X)%X,se=(G%X+X)%X,ne=(ce%X+X)%X;if(ue){const ie=(se-ne+X)%X;return(se-W+X)%X<=ie}else{const ie=(ne-se+X)%X;return(W-se+X)%X<=ie}}function me(){u(f,1),u(p,0),u(_,0),D()}var le=md(),Te=o(le),xe=o(Te);xe.__click=()=>u(x,"navigate");let oe;var E=l(xe,2);E.__click=()=>u(x,"select");let I;var ee=l(E,2);ee.__click=()=>u(x,"nestArea");let Q;var ae=l(Te,2);ae.__mousedown=K,ae.__mousemove=re,ae.__mouseup=_e,Rn(ae,z=>u(d,z),()=>a(d));var Se=l(ae,2),Pe=o(Se);Pe.__click=me;var $e=l(Pe,2),Me=o($e);U(z=>{ts(le,`width: ${r()??""}px; height: ${n()??""}px;`),oe=Le(xe,1,"svelte-1eph566",null,oe,{active:a(x)==="navigate"}),I=Le(E,1,"svelte-1eph566",null,I,{active:a(x)==="select"}),Q=Le(ee,1,"svelte-1eph566",null,Q,{active:a(x)==="nestArea"}),We(ae,"width",r()),We(ae,"height",n()),ts(ae,`cursor: ${a(x)==="navigate"?a(h)?"grabbing":"grab":"default"}`),q(Me,`${z??""}%`)},[()=>Math.round(a(f)*100)]),ka("wheel",ae,M),ka("mouseleave",ae,be),g(t,le),lt()}_t(["click","mousedown","mousemove","mouseup"]);var yd=w('<span class="filename"> </span>'),wd=w('<div><button class="sheet-tab svelte-57krl6"></button> <button class="close-tab svelte-57krl6">Ã—</button></div>'),kd=w('<div class="stock-item svelte-57krl6"><span class="name"> </span> <div class="dims svelte-57krl6"> </div> <button class="apply-btn svelte-57krl6">Apply</button></div>'),xd=w('<button class="template-btn svelte-57krl6"> </button>'),Sd=w('<div class="loading svelte-57krl6">Processing...</div>'),Td=w('<div class="placeholder svelte-57krl6"><p>No sheet active.</p> <button class="btn-primary svelte-57krl6">Create Blank Sheet</button></div>'),qd=w('<p class="hint-text">Select or create a sheet.</p>'),Ed=w('<h3>Sheet Properties</h3> <div class="prop-group svelte-57krl6"><span class="label">Program Size (mm):</span> <div class="inline-inputs svelte-57krl6"><input type="number" step="0.1" class="svelte-57krl6"/> <span>Ã—</span> <input type="number" step="0.1" class="svelte-57krl6"/></div></div> <div class="prop-group svelte-57krl6"><span class="label">Thickness (mm):</span> <input type="number" step="0.1" class="svelte-57krl6"/></div> <div class="prop-group svelte-57krl6"><span class="label">Cut Count:</span> <input type="number" min="1" class="svelte-57krl6"/></div> <div class="prop-group svelte-57krl6"><span class="label">Material:</span> <span class="value"> </span></div> <div class="prop-group svelte-57krl6"><span class="label">Total Parts:</span> <span class="value"> </span></div>',1),jd=w("<option> </option>"),Ad=w('<div class="prop-group svelte-57krl6"><span class="label">Part Name:</span> <span class="value"> </span></div> <div class="prop-group svelte-57krl6"><span class="label">Contours:</span> <span class="value"> </span></div>',1),Pd=w('<h3>Part Properties</h3> <div class="prop-group svelte-57krl6"><span class="label">Select Part:</span> <select class="svelte-57krl6"></select></div> <!> <button class="delete-btn svelte-57krl6">Remove Part</button>',1),Cd=w('<div><div class="info svelte-57krl6"><span class="name svelte-57krl6"> </span> <span class="stats svelte-57krl6"> </span></div> <button class="add-btn svelte-57krl6">+</button></div>'),Dd=w('<p class="empty-text svelte-57krl6">No matching tasks.</p>'),Rd=w('<button class="lib-item svelte-57krl6"> </button>'),zd=w('<p class="empty-text svelte-57krl6">No matching library parts.</p>'),Md=w('<h3>Inventory</h3> <div class="search-bar svelte-57krl6"><input type="text" placeholder="Search parts..." class="svelte-57krl6"/></div> <div class="inventory-list"><!> <!></div> <h4 class="section-title svelte-57krl6">Library Parts</h4> <div class="library-grid svelte-57krl6"><!> <!></div>',1),Nd=w('<div class="prop-field"><label> </label> <input type="text" class="svelte-57krl6"/></div>'),Od=w('<p class="empty-props">No parameters found.</p>'),Id=w('<div class="prop-group svelte-57krl6"><span class="label">Contour ID:</span> <span class="value"> </span></div> <h4 class="section-title svelte-57krl6">P-Codes</h4> <div class="p-codes-list"><!></div>',1),Ld=w("<h3>Contour Properties</h3> <!>",1),$d=w('<div class="view-container"><div class="header"><h2>GNC Editor</h2> <div class="actions"><input type="file" id="gnc-upload" accept=".gnc,.nc" class="file-input svelte-57krl6"/> <label for="gnc-upload" class="upload-btn">Open File</label> <!> <button class="icon-btn" title="Undo">â†©</button> <button class="icon-btn" title="Redo">â†ª</button> <button class="save-btn">Save Changes</button> <div class="nest-controls svelte-57krl6"><select class="nest-mode-select svelte-57krl6"><option>Precise Hull</option><option>Bounding Box</option></select> <button class="save-btn"> </button></div> <button class="save-btn" style="background-color: #6d28d9;" title="Unplace all and nest from scratch">Re-nest All</button> <button class="save-btn" style="background-color: #475569;" title="Clear all parts from sheet">Unplace All</button> <button class="save-btn" style="background-color: #10b981;">Save as New Order</button></div></div> <div class="sheet-tabs svelte-57krl6"><!> <button class="add-sheet-btn svelte-57krl6">+ Add Sheet</button></div> <div class="workspace svelte-57krl6"><div class="stock-sidebar svelte-57krl6"><h3 class="svelte-57krl6">Local Stock</h3> <div class="stock-list"></div> <h4 class="section-title svelte-57krl6">Templates</h4> <div class="template-grid svelte-57krl6"></div></div> <div class="canvas-area svelte-57krl6"><!></div> <div class="properties-panel svelte-57krl6"><div class="mode-selector svelte-57krl6"><button>Sheet</button> <button>Part</button> <button>Contour</button> <button>Inventory</button></div> <!></div></div></div>');function Fd(t,e){it(e,!0);let s=xt(e,"documentId",3,null),r=xt(e,"orderId",3,null),n=k(ye([])),i=k(0),c=nt(()=>a(n)[a(i)]||null),d=k(null),v=k(""),f=k(!1),p=k(ye([])),_=k(ye([])),h=k(ye([])),m=k(ye([])),T=k(ye([])),x=k("sheet"),y=k(null),S=k(""),N=k("hull");const b=nt(()=>a(_).filter(B=>B.name.toLowerCase().includes(a(S).toLowerCase()))),j=nt(()=>a(m).filter(B=>B.name.toLowerCase().includes(a(S).toLowerCase())));async function C(){if(r()||s())try{r()?u(p,await Fo(r()),!0):u(p,await bo(s()),!0),D()}catch(V){console.error("Failed to load tasks",V)}}async function R(){try{const[B,V,de]=await Promise.all([vi(),Lo(),$o()]);u(T,V,!0),u(m,de,!0),u(h,[...V],!0)}catch(B){console.error("Failed to load stock data",B)}}function J(B){if(!a(c)){alert("No active sheet to update."),B.target.value="";return}const V=parseInt(B.target.value);if(!V)return;const de=a(h).find(Ct=>Ct.id===V);if(!de)return;const Ue=`Update sheet dimensions to ${de.width}x${de.height} (${de.material||"N/A"})?`;confirm(Ue)?(K(),a(c).program_width=de.width,a(c).program_height=de.height,a(c).material=de.material):B.target.value=""}async function Y(B){const V=B.target.files[0];if(V){u(v,V.name,!0),u(f,!0),u(n,[],!0),u(i,0),u(d,null);try{const de=await Do(V);u(n,[de],!0),D(),de?.parts?.length>0&&u(y,de.parts[0].id,!0)}catch(de){alert("Error parsing GNC file"),console.error(de)}finally{u(f,!1)}}}function D(){if(!a(p)||a(p).length===0){u(_,[],!0);return}const B={};a(n).forEach(V=>{V.parts.forEach(de=>{const Ue=de.taskId;Ue&&(B[Ue]=(B[Ue]||0)+1)})}),u(_,a(p).map(V=>{const de=V.quantity||1,Ue=B[V.id]||0;return{...V,placed:Ue,total:de,remaining:Math.max(0,de-Ue)}}),!0)}function H(B=null){const V={parts:[],metadata:{},total_parts:0,total_contours:0,program_width:B?.width||3e3,program_height:B?.height||1500,thickness:0,cut_count:1,material:B?.material||"Steel"};u(n,[...a(n),V],!0),u(i,a(n).length-1),K()}function Z(B){a(n).length<=1||(u(n,a(n).filter((V,de)=>de!==B),!0),a(i)>=a(n).length&&u(i,a(n).length-1),K(),D())}let L=k(ye([])),M=k(-1);function K(){if(a(n).length===0)return;const B=JSON.parse(JSON.stringify(a(n)));a(M)<a(L).length-1&&u(L,a(L).slice(0,a(M)+1),!0),a(L).push(B),Ds(M),a(L).length>50&&(a(L).shift(),Ds(M,-1))}function re(){a(M)>0&&(Ds(M,-1),u(n,JSON.parse(JSON.stringify(a(L)[a(M)])),!0),D())}function be(){a(M)<a(L).length-1&&(Ds(M),u(n,JSON.parse(JSON.stringify(a(L)[a(M)])),!0),D())}async function _e(B){if(!a(c)){alert("Please create or load a sheet first.");return}if(!(B.remaining<=0&&!a(_).find(V=>V.id===B.id))){if(B.remaining<=0){alert("All instances of this task are already placed.");return}}try{K();let V=null;if(B.part_associations&&B.part_associations.length>0)V=B.part_associations[0].part_id;else if(B.id&&!B.document_id)V=B.id;else{alert("This task is not linked to a part geometry.");return}const de=await cr(V);if(!de||!de.parts||de.parts.length===0){alert("No geometry found for this part.");return}console.log("Placed Part GNC Data:",{partId:V,totalPartsInGnc:de.parts.length,firstPartContours:de.parts[0].contours.length,allParts:de.parts.map(wt=>({name:wt.name,contours:wt.contours.length}))});let Ue=de.parts.find(wt=>wt.name&&(wt.name.includes(B.name)||B.name.includes(wt.name)));Ue||(console.warn(`Could not find geometry matching name "${B.name}", defaulting to first part.`),Ue=de.parts[0]);const Ct=Math.max(...a(n).flatMap(wt=>wt.parts).map(wt=>wt.id),0)+1,he=50,Ye=a(c).program_width||2e3,Tt=a(c).program_height||1e3,Mt=he+Math.random()*Math.max(0,Ye-he*2-200),Nt=he+Math.random()*Math.max(0,Tt-he*2-200),Ot={...Ue,id:Ct,name:B.name,taskId:B.id,metadata:{...Ue.metadata||{},source_part_id:V},x:Mt,y:Nt};a(c).parts=[...a(c).parts,Ot],a(c).total_parts=a(c).parts.length,D()}catch(V){console.error(V),alert("Failed to place part.")}}function ke(B){a(c)&&(K(),a(c).parts=a(c).parts.filter(V=>V.id!==B),a(c).total_parts=a(c).parts.length,a(y)===B&&(u(y,null),u(x,"sheet")),D())}let me=null,le=k(!1),Te=k(0);Vt(()=>{R(),s()&&C(),window.Worker&&(me=new Worker(new URL("/assets/NestingWorker-C0hIlIX6.js",import.meta.url),{type:"module"}),me.onmessage=B=>{const{type:V,payload:de}=B.data;if(V==="PROGRESS")u(Te,de,!0);else if(V==="COMPLETE"){u(le,!1),console.log("COMPLETE payload",de);const{sheets:Ue}=de;u(n,Ue,!0),D(),K(),alert("Nesting complete!")}else V==="STOPPED"&&u(le,!1)})});function xe(){a(c)&&(K(),a(c).parts=[],D())}async function oe(B=!1){if(!me||a(n).length===0)return;if(a(le)){me.postMessage({type:"STOP_NESTING"});return}let V=[];B?(V=JSON.parse(JSON.stringify(a(_))).map(he=>(he.remaining=he.total,he)),a(n).forEach(he=>{he.parts.forEach(Ye=>{if(!a(_).some(Mt=>Mt.id===Ye.taskId)){let Mt=V.find(Nt=>Nt.id===(Ye.taskId||Ye.id));Mt?(Mt.remaining++,Mt.total++):V.push({...Ye,id:Ye.taskId||Ye.id,total:1,remaining:1,isLibraryPart:!0})}})}),K(),a(n).forEach(he=>{he.parts=[]}),D()):V=JSON.parse(JSON.stringify(a(_).filter(he=>he.remaining>0))),u(le,!0),u(Te,0),console.log(`GncView: Preparing geometries for ${V.length} items (isReNest: ${B})`);for(let he of V){if(he.contours&&he.contours.length>0)continue;let Ye=null;if(he.part_associations&&he.part_associations.length>0?Ye=he.part_associations[0].part_id:he.id&&!he.document_id&&(Ye=he.id),Ye)try{const Tt=await cr(Ye);if(Tt?.parts?.length>0){let Mt=Tt.parts.find(Nt=>Nt.name&&(Nt.name.includes(he.name)||he.name.includes(Nt.name)))||Tt.parts[0];he.contours=Mt.contours,he.taskId=he.id}}catch(Tt){console.error(`GncView: Failed to fetch geometry for ${he.name}`,Tt)}}let de=4,Ue=10;try{const[he,Ye]=await Promise.all([Na("nesting_rotations").catch(()=>({value:"4"})),Na("nesting_population").catch(()=>({value:"10"}))]);de=parseInt(he.value)||4,Ue=parseInt(Ye.value)||10}catch(he){console.warn("Using default nesting settings",he)}const Ct={rotations:de,population:Ue,multiSheet:!0,nestingMode:a(N)};me.postMessage({type:"START_NESTING",payload:{sheets:JSON.parse(JSON.stringify(a(n))),inventory:JSON.parse(JSON.stringify(V)),stock:JSON.parse(JSON.stringify(a(h))),config:Ct}})}function E(B){if(!B){u(d,null);return}B.contour&&(u(d,B.contour,!0),B.part?(u(y,B.part.id,!0),a(x)==="sheet"&&u(x,"contour")):u(x,"contour"))}async function I(){if(a(n).length!==0)try{u(f,!0);const B={order_id:r(),name:a(v)||"Nesting Project",sheets:a(n).map((V,de)=>({id:de,name:`Sheet ${de+1}`,data:V})),inventory:a(p),stock:a(h)};r()?await Bo(B):await Ro(a(c),a(v),!0),alert("Project saved successfully!")}catch(B){alert("Failed to save project: "+B.message)}finally{u(f,!1)}}async function ee(){if(a(n).length===0)return;const B=prompt("Enter name for the new Order:");if(B)try{const V=await wo(B,a(c),s());alert(`New Order "${V.name}" created successfully!`)}catch(V){console.error(V),alert("Failed to save as new order: "+V.message)}}function Q(B,V){a(d)&&a(d).metadata&&(a(d).metadata[B]=V)}function ae(B,V){a(c)&&(a(c)[B]=V)}let Se=nt(()=>a(c)?.parts?.find(B=>B.id===a(y)));var Pe=$d(),$e=o(Pe),Me=l(o($e),2),z=o(Me);z.__change=Y;var G=l(z,4);{var ce=B=>{var V=yd(),de=o(V);U(()=>q(de,a(v))),g(B,V)};$(G,B=>{a(v)&&B(ce)})}var ue=l(G,2);ue.__click=re;var X=l(ue,2);X.__click=be;var W=l(X,2);W.__click=I;var se=l(W,2),ne=o(se),ie=o(ne);ie.value=ie.__value="hull";var ve=l(ie);ve.value=ve.__value="bbox";var F=l(ne,2);F.__click=()=>oe(!1);var fe=o(F),P=l(se,2);P.__click=()=>oe(!0);var A=l(P,2);A.__click=xe;var te=l(A,2);te.__click=ee;var je=l($e,2),ze=o(je);Ae(ze,17,()=>a(n),Ge,(B,V,de)=>{var Ue=wd();let Ct;var he=o(Ue);he.__click=()=>u(i,de,!0),he.textContent=`Sheet ${de+1}`;var Ye=l(he,2);Ye.__click=()=>Z(de),U(()=>Ct=Le(Ue,1,"tab-wrapper svelte-57krl6",null,Ct,{active:a(i)===de})),g(B,Ue)});var Be=l(ze,2);Be.__click=()=>H();var we=l(je,2),Ne=o(we),Je=l(o(Ne),2);Ae(Je,21,()=>a(h),Ge,(B,V)=>{var de=kd(),Ue=o(de),Ct=o(Ue),he=l(Ue,2),Ye=o(he),Tt=l(he,2);Tt.__click=()=>J({target:{value:a(V).id}}),U(()=>{q(Ct,a(V).name),q(Ye,`${a(V).width??""}x${a(V).height??""}`)}),g(B,de)});var ot=l(Je,4);Ae(ot,21,()=>a(T),Ge,(B,V)=>{var de=xd();de.__click=()=>H(a(V));var Ue=o(de);U(()=>q(Ue,a(V).name)),g(B,de)});var ge=l(Ne,2),Ie=o(ge);{var O=B=>{var V=Sd();g(B,V)},pe=B=>{var V=dt(),de=qe(V);{var Ue=he=>{bd(he,{get sheet(){return a(c)},width:800,height:600,onselect:E,onAreaChange:Ye=>{a(c).nestingArea=Ye,K()}})},Ct=he=>{var Ye=Td(),Tt=l(o(Ye),2);Tt.__click=()=>H(),g(he,Ye)};$(de,he=>{a(c)?he(Ue):he(Ct,!1)},!0)}g(B,V)};$(Ie,B=>{a(f)?B(O):B(pe,!1)})}var Ee=l(ge,2),ct=o(Ee),at=o(ct);at.__click=()=>u(x,"sheet");let gt;var He=l(at,2);He.__click=()=>u(x,"part");let Pt;var St=l(He,2);St.__click=()=>u(x,"contour");let Yt;var va=l(St,2);va.__click=()=>u(x,"inventory");let Ma;var Ja=l(ct,2);{var rs=B=>{var V=qd();g(B,V)},Ha=B=>{var V=dt(),de=qe(V);{var Ue=he=>{var Ye=Ed(),Tt=l(qe(Ye),2),Mt=l(o(Tt),2),Nt=o(Mt);Nt.__input=mt=>ae("program_width",parseFloat(mt.currentTarget.value));var Ot=l(Nt,4);Ot.__input=mt=>ae("program_height",parseFloat(mt.currentTarget.value));var wt=l(Tt,2),na=l(o(wt),2);na.__input=mt=>ae("thickness",parseFloat(mt.currentTarget.value));var Fe=l(wt,2),Ke=l(o(Fe),2);Ke.__input=mt=>ae("cut_count",parseInt(mt.currentTarget.value));var et=l(Fe,2),kt=l(o(et),2),Oe=o(kt),vt=l(et,2),ft=l(o(vt),2),yt=o(ft);U(()=>{os(Nt,a(c).program_width||0),os(Ot,a(c).program_height||0),os(na,a(c).thickness||0),os(Ke,a(c).cut_count||1),q(Oe,a(c).material||"N/A"),q(yt,a(c).total_parts)}),g(he,Ye)},Ct=he=>{var Ye=dt(),Tt=qe(Ye);{var Mt=Ot=>{var wt=Pd(),na=l(qe(wt),2),Fe=l(o(na),2);Ae(Fe,21,()=>a(c).parts,Ge,(Oe,vt)=>{var ft=jd(),yt=o(ft),mt={};U(()=>{q(yt,a(vt).name||`Part ${a(vt).id}`),mt!==(mt=a(vt).id)&&(ft.value=(ft.__value=a(vt).id)??"")}),g(Oe,ft)});var Ke=l(na,2);{var et=Oe=>{var vt=Ad(),ft=qe(vt),yt=l(o(ft),2),mt=o(yt),Zt=l(ft,2),pt=l(o(Zt),2),bt=o(pt);U(()=>{q(mt,a(Se).name||"N/A"),q(bt,a(Se).contours.length)}),g(Oe,vt)};$(Ke,Oe=>{a(Se)&&Oe(et)})}var kt=l(Ke,2);kt.__click=()=>ke(a(y)),At(Fe,()=>a(y),Oe=>u(y,Oe)),g(Ot,wt)},Nt=Ot=>{var wt=dt(),na=qe(wt);{var Fe=et=>{var kt=Md(),Oe=l(qe(kt),2),vt=o(Oe),ft=l(Oe,2),yt=o(ft);Ae(yt,17,()=>a(b),Ge,(ut,ht)=>{var qt=Cd();let Xt;var tt=o(qt),st=o(tt),Et=o(st),qa=l(st,2),is=o(qa),Ps=l(tt,2);Ps.__click=()=>_e(a(ht)),U(()=>{Xt=Le(qt,1,"inventory-item svelte-57krl6",null,Xt,{complete:a(ht).remaining===0}),q(Et,a(ht).name),q(is,`${a(ht).placed??""} / ${a(ht).total??""}`),Ps.disabled=a(ht).remaining<=0}),g(ut,qt)});var mt=l(yt,2);{var Zt=ut=>{var ht=Dd();g(ut,ht)};$(mt,ut=>{a(b).length===0&&ut(Zt)})}var pt=l(ft,4),bt=o(pt);Ae(bt,17,()=>a(j),Ge,(ut,ht)=>{var qt=Rd();qt.__click=()=>_e(a(ht));var Xt=o(qt);U(()=>q(Xt,a(ht).name)),g(ut,qt)});var Dt=l(bt,2);{var $t=ut=>{var ht=zd();g(ut,ht)};$(Dt,ut=>{a(j).length===0&&ut($t)})}Ce(vt,()=>a(S),ut=>u(S,ut)),g(et,kt)},Ke=et=>{var kt=dt(),Oe=qe(kt);{var vt=ft=>{var yt=Ld(),mt=l(qe(yt),2);{var Zt=pt=>{var bt=Id(),Dt=qe(bt),$t=l(o(Dt),2),ut=o($t),ht=l(Dt,4),qt=o(ht);{var Xt=st=>{var Et=dt(),qa=qe(Et);Ae(qa,17,()=>Object.entries(a(d).metadata),Ge,(is,Ps)=>{var Jn=nt(()=>bn(a(Ps),2));let ls=()=>a(Jn)[0],qi=()=>a(Jn)[1];var Hn=dt(),Ei=qe(Hn);{var ji=Vs=>{var Wn=Nd(),Zs=o(Wn),Ai=o(Zs),Qs=l(Zs,2);Qs.__input=Pi=>Q(ls(),Pi.currentTarget.value),U(()=>{We(Zs,"for",ls()),q(Ai,ls()),We(Qs,"id",ls()),os(Qs,qi())}),g(Vs,Wn)};$(Ei,Vs=>{ls().startsWith("P")&&Vs(ji)})}g(is,Hn)}),g(st,Et)},tt=st=>{var Et=Od();g(st,Et)};$(qt,st=>{a(d).metadata?st(Xt):st(tt,!1)})}U(()=>q(ut,`#${a(d).id??""}`)),g(pt,bt)};$(mt,pt=>{a(d)&&pt(Zt)})}g(ft,yt)};$(Oe,ft=>{a(x)==="contour"&&ft(vt)},!0)}g(et,kt)};$(na,et=>{a(x)==="inventory"?et(Fe):et(Ke,!1)},!0)}g(Ot,wt)};$(Tt,Ot=>{a(x)==="part"?Ot(Mt):Ot(Nt,!1)},!0)}g(he,Ye)};$(de,he=>{a(x)==="sheet"?he(Ue):he(Ct,!1)},!0)}g(B,V)};$(Ja,B=>{a(c)?B(Ha,!1):B(rs)})}U(()=>{ue.disabled=a(M)<=0,X.disabled=a(M)>=a(L).length-1,W.disabled=!a(c),F.disabled=!a(c),ts(F,`background-color: ${a(le)?"#ef4444":"#8b5cf6"};`),q(fe,a(le)?`Stop Nesting (${a(Te)}%)`:"Auto Nest"),P.disabled=!a(c)||a(le),A.disabled=!a(c)||a(le),te.disabled=!a(c),gt=Le(at,1,"svelte-57krl6",null,gt,{active:a(x)==="sheet"}),Pt=Le(He,1,"svelte-57krl6",null,Pt,{active:a(x)==="part"}),Yt=Le(St,1,"svelte-57krl6",null,Yt,{active:a(x)==="contour"}),Ma=Le(va,1,"svelte-57krl6",null,Ma,{active:a(x)==="inventory"})}),At(ne,()=>a(N),B=>u(N,B)),g(t,Pe),lt()}_t(["change","click","input"]);var Bd=w("<option> </option>"),Ud=w('<div class="form-panel svelte-gim6qq"><h3>New Stock Item</h3> <div class="form-grid svelte-gim6qq"><div class="field svelte-gim6qq"><label class="svelte-gim6qq">Material</label> <select class="svelte-gim6qq"><option>Select Material...</option><!></select></div> <div class="field svelte-gim6qq"><label class="svelte-gim6qq">Width (mm)</label> <input type="number" min="0" class="svelte-gim6qq"/></div> <div class="field svelte-gim6qq"><label class="svelte-gim6qq">Height (mm)</label> <input type="number" min="0" class="svelte-gim6qq"/></div> <div class="field svelte-gim6qq"><label class="svelte-gim6qq">Quantity</label> <input type="number" min="0" class="svelte-gim6qq"/></div> <div class="field svelte-gim6qq"><label class="svelte-gim6qq">Location</label> <input type="text" placeholder="e.g. A-01" class="svelte-gim6qq"/></div> <div class="actions"><button class="save-btn svelte-gim6qq">Save Item</button></div></div></div>'),Gd=w('<p class="loading svelte-gim6qq">Loading stock...</p>'),Yd=w('<div class="empty-state svelte-gim6qq"><p>No stock items found.</p></div>'),Xd=w('<tr><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"><button class="delete-btn svelte-gim6qq">Delete</button></td></tr>'),Jd=w('<div class="table-container svelte-gim6qq"><table class="svelte-gim6qq"><thead><tr><th class="svelte-gim6qq">Material</th><th class="svelte-gim6qq">Dimensions</th><th class="svelte-gim6qq">Qty</th><th class="svelte-gim6qq">Reserved</th><th class="svelte-gim6qq">Location</th><th class="svelte-gim6qq">Actions</th></tr></thead><tbody></tbody></table></div>'),Hd=w('<div class="view-container svelte-gim6qq"><div class="header svelte-gim6qq"><h2 class="svelte-gim6qq">Stock Management</h2> <button class="primary-btn svelte-gim6qq"> </button></div> <!> <!></div>');function Wd(t,e){it(e,!0);let s=k(ye([])),r=k(ye([])),n=k(!0),i=k(!1),c=k(ye({material_id:"",width:0,height:0,quantity:0,location:""}));async function d(){u(n,!0);try{const[b,j]=await Promise.all([vi(),Ya()]);u(s,b,!0),u(r,j,!0)}catch(b){console.error(b)}finally{u(n,!1)}}async function v(){if(a(c).material_id)try{const b=await Po(a(c));u(s,[...a(s),b],!0),u(i,!1),u(c,{material_id:"",width:0,height:0,quantity:0,location:""},!0)}catch(b){alert("Failed to add stock item"),console.error(b)}}async function f(b){if(confirm("Are you sure you want to delete this item?"))try{await Co(b),u(s,a(s).filter(j=>j.id!==b),!0)}catch{alert("Failed to delete item")}}Vt(d);var p=Hd(),_=o(p),h=l(o(_),2);h.__click=()=>u(i,!a(i));var m=o(h),T=l(_,2);{var x=b=>{var j=Ud(),C=l(o(j),2),R=o(C),J=l(o(R),2),Y=o(J);Y.value=Y.__value="";var D=l(Y);Ae(D,17,()=>a(r),Ge,(le,Te)=>{var xe=Bd(),oe=o(xe),E={};U(()=>{q(oe,a(Te).name),E!==(E=a(Te).id)&&(xe.value=(xe.__value=a(Te).id)??"")}),g(le,xe)});var H=l(R,2),Z=l(o(H),2),L=l(H,2),M=l(o(L),2),K=l(L,2),re=l(o(K),2),be=l(K,2),_e=l(o(be),2),ke=l(be,2),me=o(ke);me.__click=v,At(J,()=>a(c).material_id,le=>a(c).material_id=le),Ce(Z,()=>a(c).width,le=>a(c).width=le),Ce(M,()=>a(c).height,le=>a(c).height=le),Ce(re,()=>a(c).quantity,le=>a(c).quantity=le),Ce(_e,()=>a(c).location,le=>a(c).location=le),g(b,j)};$(T,b=>{a(i)&&b(x)})}var y=l(T,2);{var S=b=>{var j=Gd();g(b,j)},N=b=>{var j=dt(),C=qe(j);{var R=Y=>{var D=Yd();g(Y,D)},J=Y=>{var D=Jd(),H=o(D),Z=l(o(H));Ae(Z,21,()=>a(s),Ge,(L,M)=>{var K=Xd(),re=o(K),be=o(re),_e=l(re),ke=o(_e),me=l(_e),le=o(me),Te=l(me),xe=o(Te),oe=l(Te),E=o(oe),I=l(oe),ee=o(I);ee.__click=()=>f(a(M).id),U(()=>{q(be,a(M).material?a(M).material.name:"Unknown"),q(ke,`${a(M).width??""} x ${a(M).height??""}`),q(le,a(M).quantity),q(xe,a(M).reserved),q(E,a(M).location||"-")}),g(L,K)}),g(Y,D)};$(C,Y=>{a(s).length===0?Y(R):Y(J,!1)},!0)}g(b,j)};$(y,b=>{a(n)?b(S):b(N,!1)})}U(()=>q(m,a(i)?"Cancel":"Add Stock")),g(t,p),lt()}_t(["click"]);var Vd=w("<p> </p>"),Zd=w(`<div class="setup-container svelte-1125czv"><div class="card svelte-1125czv"><h1 class="svelte-1125czv">Welcome to DocuFlow</h1> <p class="subtitle svelte-1125czv">Please configure the database connection.</p> <div class="field svelte-1125czv"><label for="db-path" class="svelte-1125czv">Database File Path</label> <p class="help-text svelte-1125czv">Enter the full path to the SQLite database file. For network
                sharing, use a path on the shared drive (e.g., <code>Z:\\DocuFlow\\data.db</code>).</p> <div class="input-group svelte-1125czv"><input id="db-path" type="text" placeholder="C:\\DocuFlow\\data.db" class="svelte-1125czv"/> <button class="svelte-1125czv"> </button></div> <!></div> <div class="actions"><button class="primary svelte-1125czv"> </button></div></div></div>`);function Qd(t,e){it(e,!0);let s=k(""),r=k(!1),n=k(null),i=k(!1);Vt(async()=>{try{const C=await(await fetch("/api/config")).json();C.database_path&&u(s,C.database_path,!0)}catch(j){console.error(j)}});async function c(){if(a(s)){u(r,!0),u(n,null);try{const C=await(await fetch("/api/test-path",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:a(s)})})).json();u(n,{ok:C.accessible||!C.exists,message:C.accessible?"Path exists and is readable.":C.exists?"Path exists but not readable.":"File does not exist (will be created)."},!0)}catch(j){u(n,{ok:!1,message:j.message},!0)}finally{u(r,!1)}}}async function d(){u(i,!0);try{(await(await fetch("/api/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({database_path:a(s)})})).json()).ok?(alert("Configuration saved. Please restart the application (Server) to apply changes."),Rt.configStatus="configured",ra("/")):alert("Failed to save config.")}catch(j){alert("Error saving config: "+j.message)}finally{u(i,!1)}}var v=Zd(),f=o(v),p=l(o(f),4),_=l(o(p),4),h=o(_),m=l(h,2);m.__click=c;var T=o(m),x=l(_,2);{var y=j=>{var C=Vd(),R=o(C);U(()=>{Le(C,1,`result ${a(n).ok?"success":"warn"}`,"svelte-1125czv"),q(R,a(n).message)}),g(j,C)};$(x,j=>{a(n)&&j(y)})}var S=l(p,2),N=o(S);N.__click=d;var b=o(N);U(()=>{m.disabled=a(r),q(T,a(r)?"Testing...":"Test Path"),N.disabled=a(i)||!a(s),q(b,a(i)?"Saving...":"Save Configuration")}),Ce(h,()=>a(s),j=>u(s,j)),g(t,v),lt()}_t(["click"]);const Kd={"/":Ho,"/documents":Su,"/journal":Ou,"/job":Xu,"/parts":gd,"/gnc":Fd,"/stock":Wd,"/setup":Qd};vl();var ef=w('<aside class="sidebar svelte-1nhzsi7"><div class="sidebar-header svelte-1nhzsi7"><span class="logo-icon svelte-1nhzsi7">DF</span></div> <nav class="svelte-1nhzsi7"><button><span class="icon svelte-1nhzsi7">ðŸ“Š</span> <span class="label svelte-1nhzsi7">Dashboard</span></button> <button><span class="icon svelte-1nhzsi7">ðŸ“„</span> <span class="label svelte-1nhzsi7">Documents</span></button> <button><span class="icon svelte-1nhzsi7">âš™ï¸</span> <span class="label svelte-1nhzsi7">Parts Library</span></button> <button><span class="icon svelte-1nhzsi7">ðŸ“</span> <span class="label svelte-1nhzsi7">GNC Editor</span></button> <button><span class="icon svelte-1nhzsi7">ðŸ‘·</span> <span class="label svelte-1nhzsi7">Job Processing</span></button> <button><span class="icon svelte-1nhzsi7">ðŸ“¦</span> <span class="label svelte-1nhzsi7">Stock</span></button> <button><span class="icon svelte-1nhzsi7">ðŸ““</span> <span class="label svelte-1nhzsi7">Journal</span></button></nav></aside>');function tf(t,e){it(e,!1),to();var s=ef(),r=l(o(s),2),n=o(r);n.__click=()=>ra("/");let i;var c=l(n,2);c.__click=()=>ra("/documents");let d;var v=l(c,2);v.__click=()=>ra("/parts");let f;var p=l(v,2);p.__click=()=>ra("/gnc");let _;var h=l(p,2);h.__click=()=>ra("/job");let m;var T=l(h,2);T.__click=()=>ra("/stock");let x;var y=l(T,2);y.__click=()=>ra("/journal");let S;U((N,b,j,C,R,J)=>{i=Le(n,1,"svelte-1nhzsi7",null,i,{active:ja.path==="/"}),d=Le(c,1,"svelte-1nhzsi7",null,d,N),f=Le(v,1,"svelte-1nhzsi7",null,f,b),_=Le(p,1,"svelte-1nhzsi7",null,_,j),m=Le(h,1,"svelte-1nhzsi7",null,m,C),x=Le(T,1,"svelte-1nhzsi7",null,x,R),S=Le(y,1,"svelte-1nhzsi7",null,S,J)},[()=>({active:ja.path.includes("/documents")}),()=>({active:ja.path.includes("/parts")}),()=>({active:ja.path.includes("/gnc")}),()=>({active:ja.path.includes("/job")}),()=>({active:ja.path.includes("/stock")}),()=>({active:ja.path.includes("/journal")})]),g(t,s),lt()}_t(["click"]);var af=w("<p>Loading...</p>"),sf=w("<span> </span>"),nf=w("<span> </span>"),rf=w(`<div class="field svelte-w0yg29"><label for="regex" class="svelte-w0yg29">Document Name Regex</label> <input id="regex" type="text" placeholder="Regex Pattern" class="svelte-w0yg29"/></div> <hr class="divider svelte-w0yg29"/> <h3 class="section-title svelte-w0yg29">Sync Folder Paths</h3> <p class="section-hint svelte-w0yg29">Configure paths to network folders for automatic file
                        import.</p> <div class="field path-field svelte-w0yg29"><label for="mihtav-path" class="svelte-w0yg29">Mihtav (Orders) Path</label> <div class="path-input-group svelte-w0yg29"><input id="mihtav-path" type="text" placeholder="Z:\\Mihtavim or \\\\server\\share\\orders" class="svelte-w0yg29"/> <button class="test-btn svelte-w0yg29"> </button></div> <!></div> <div class="field path-field svelte-w0yg29"><label for="sidra-path" class="svelte-w0yg29">Sidra (Parts Library) Path</label> <div class="path-input-group svelte-w0yg29"><input id="sidra-path" type="text" placeholder="Z:\\Sidra or \\\\server\\share\\parts" class="svelte-w0yg29"/> <button class="test-btn svelte-w0yg29"> </button></div> <!></div> <div class="field svelte-w0yg29"><label for="role" class="svelte-w0yg29">User Mode (Simulated)</label> <select id="role" class="svelte-w0yg29"><option>Operator (Read-Only)</option><option>Admin (Full Access)</option></select> <p class="hint svelte-w0yg29">Switching mode will reload the application.</p></div>`,1),lf=w(`<h3 class="section-title svelte-w0yg29">Auto-Nesting Configuration</h3> <p class="section-hint svelte-w0yg29">Adjust parameters for the nesting algorithm (SVGnest).</p> <div class="field svelte-w0yg29"><label for="rotations" class="svelte-w0yg29">Rotations</label> <input id="rotations" type="number" min="1" max="360" class="svelte-w0yg29"/> <p class="hint svelte-w0yg29">Number of rotation steps (e.g., 4 = 0, 90, 180,
                            270).</p></div> <div class="field svelte-w0yg29"><label for="population" class="svelte-w0yg29">Population Size</label> <input id="population" type="number" min="5" max="100" class="svelte-w0yg29"/> <p class="hint svelte-w0yg29">Higher values check more combinations but run
                            slower.</p></div>`,1),of=w('<div class="tabs svelte-w0yg29"><button>General</button> <button>Nesting</button></div> <div class="tab-content"><!></div>',1),cf=w('<div class="modal-content svelte-w0yg29"><h2 class="svelte-w0yg29">Settings</h2> <!> <div class="actions svelte-w0yg29"><button class="cancel-btn svelte-w0yg29">Cancel</button> <button class="save-btn svelte-w0yg29">Save</button></div></div>');function vf(t,e){it(e,!0);let s=xt(e,"isOpen",3,!1),r=k("general"),n=k(""),i=k("admin"),c=k(""),d=k(""),v=k(4),f=k(10),p=k(!0),_=ye({mihtav:!1,sidra:!1}),h=k(ye({mihtav:null,sidra:null}));async function m(){u(p,!0);try{const[b,j,C,R,J]=await Promise.all([Na("doc_name_regex").catch(()=>({value:""})),Na("sync_mihtav_path").catch(()=>({value:""})),Na("sync_sidra_path").catch(()=>({value:""})),Na("nesting_rotations").catch(()=>({value:"4"})),Na("nesting_population").catch(()=>({value:"10"}))]);u(n,b.value||"",!0),u(c,j.value||"",!0),u(d,C.value||"",!0),u(v,parseInt(R.value)||4,!0),u(f,parseInt(J.value)||10,!0);const Y=localStorage.getItem("user_role");Y&&u(i,Y,!0)}catch(b){console.error(b)}finally{u(p,!1)}}async function T(b){const j=a(b==="mihtav"?c:d);if(!j){a(h)[b]={accessible:!1,error:"Path is empty"};return}_[b]=!0;try{const C=await vo(j);a(h)[b]={accessible:C.ok,error:C.error}}catch(C){a(h)[b]={accessible:!1,error:C.message}}finally{_[b]=!1}}async function x(){try{await Promise.all([cs("doc_name_regex",a(n)),cs("sync_mihtav_path",a(c)),cs("sync_sidra_path",a(d)),cs("nesting_rotations",a(v).toString()),cs("nesting_population",a(f).toString())]),localStorage.setItem("user_role",a(i)),window.location.reload(),e.close()}catch(b){alert("Failed to save settings. Ensure you have Admin privileges."),console.error(b)}}Bt(()=>{s()&&(m(),u(h,{mihtav:null,sidra:null},!0))});var y=dt(),S=qe(y);{var N=b=>{var j=cf(),C=l(o(j),2);{var R=Z=>{var L=af();g(Z,L)},J=Z=>{var L=of(),M=qe(L),K=o(M);K.__click=()=>u(r,"general");let re;var be=l(K,2);be.__click=()=>u(r,"nesting");let _e;var ke=l(M,2),me=o(ke);{var le=xe=>{var oe=rf(),E=qe(oe),I=l(o(E),2),ee=l(E,8),Q=l(o(ee),2),ae=o(Q),Se=l(ae,2);Se.__click=()=>T("mihtav");var Pe=o(Se),$e=l(Q,2);{var Me=fe=>{var P=sf();let A;var te=o(P);U(()=>{A=Le(P,1,"test-result svelte-w0yg29",null,A,{success:a(h).mihtav.accessible,error:!a(h).mihtav.accessible}),q(te,a(h).mihtav.accessible?"âœ“ Path accessible":`âœ— ${a(h).mihtav.error||"Path not accessible"}`)}),g(fe,P)};$($e,fe=>{a(h).mihtav&&fe(Me)})}var z=l(ee,2),G=l(o(z),2),ce=o(G),ue=l(ce,2);ue.__click=()=>T("sidra");var X=o(ue),W=l(G,2);{var se=fe=>{var P=nf();let A;var te=o(P);U(()=>{A=Le(P,1,"test-result svelte-w0yg29",null,A,{success:a(h).sidra.accessible,error:!a(h).sidra.accessible}),q(te,a(h).sidra.accessible?"âœ“ Path accessible":`âœ— ${a(h).sidra.error||"Path not accessible"}`)}),g(fe,P)};$(W,fe=>{a(h).sidra&&fe(se)})}var ne=l(z,2),ie=l(o(ne),2),ve=o(ie);ve.value=ve.__value="operator";var F=l(ve);F.value=F.__value="admin",U(()=>{Se.disabled=_.mihtav,q(Pe,_.mihtav?"Testing...":"Test"),ue.disabled=_.sidra,q(X,_.sidra?"Testing...":"Test")}),Ce(I,()=>a(n),fe=>u(n,fe)),Ce(ae,()=>a(c),fe=>u(c,fe)),Ce(ce,()=>a(d),fe=>u(d,fe)),At(ie,()=>a(i),fe=>u(i,fe)),g(xe,oe)},Te=xe=>{var oe=dt(),E=qe(oe);{var I=ee=>{var Q=lf(),ae=l(qe(Q),4),Se=l(o(ae),2),Pe=l(ae,2),$e=l(o(Pe),2);Ce(Se,()=>a(v),Me=>u(v,Me)),Ce($e,()=>a(f),Me=>u(f,Me)),g(ee,Q)};$(E,ee=>{a(r)==="nesting"&&ee(I)},!0)}g(xe,oe)};$(me,xe=>{a(r)==="general"?xe(le):xe(Te,!1)})}U(()=>{re=Le(K,1,"svelte-w0yg29",null,re,{active:a(r)==="general"}),_e=Le(be,1,"svelte-w0yg29",null,_e,{active:a(r)==="nesting"})}),g(Z,L)};$(C,Z=>{a(p)?Z(R):Z(J,!1)})}var Y=l(C,2),D=o(Y);D.__click=function(...Z){e.close?.apply(this,Z)};var H=l(D,2);H.__click=x,g(b,j)};$(S,b=>{s()&&b(N)})}g(t,y),lt()}_t(["click"]);var uf=w('<div class="app-container svelte-1n46o8q"><!> <main class="main-content svelte-1n46o8q"><div class="top-bar svelte-1n46o8q"><div class="spacer svelte-1n46o8q"></div> <button class="settings-btn svelte-1n46o8q" title="Settings">âš™ï¸</button></div> <div class="route-content svelte-1n46o8q"><!></div></main> <!></div>');function df(t,e){it(e,!0);let s=k(!1);Vt(async()=>{try{const T=await(await fetch("/api/config-check")).json();Ju(T.status),T.needs_setup&&ra("/setup")}catch(m){console.error("Config check failed",m),ra("/setup")}});function r(){u(s,!0)}var n=uf(),i=o(n);{var c=m=>{tf(m,{})};$(i,m=>{ja.path!=="/setup"&&m(c)})}var d=l(i,2),v=o(d),f=l(o(v),2);f.__click=r;var p=l(v,2),_=o(p);oo(_,{get routes(){return Kd}});var h=l(d,2);On(h,{get isOpen(){return a(s)},close:()=>u(s,!1),children:(m,T)=>{vf(m,{get isOpen(){return a(s)},close:()=>u(s,!1)})},$$slots:{default:!0}}),g(t,n),lt()}_t(["click"]);window.onerror=function(t,e,s,r,n){const i=document.createElement("div");i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.background="#fee2e2",i.style.color="#991b1b",i.style.padding="20px",i.style.zIndex="999999",i.style.borderBottom="2px solid #7f1d1d",i.innerHTML=`<strong>Error:</strong> ${t}<br><small>${e}:${s}:${r}</small><pre>${n?.stack||""}</pre>`,document.body.appendChild(i)};window.onunhandledrejection=function(t){const e=document.createElement("div");e.innerHTML+=`<br><strong>Unhandled Rejection:</strong> ${t.reason}`,document.body.prepend(e)};Fl(df,{target:document.getElementById("app")});
