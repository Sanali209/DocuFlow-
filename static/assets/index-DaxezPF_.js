(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=a(n);fetch(n.href,l)}})();const zs=!1;var ks=Array.isArray,ol=Array.prototype.indexOf,xs=Array.from,cl=Object.defineProperty,Da=Object.getOwnPropertyDescriptor,Hn=Object.getOwnPropertyDescriptors,vl=Object.prototype,ul=Array.prototype,Vs=Object.getPrototypeOf,qn=Object.isExtensible;function dl(t){return t()}function Rs(t){for(var e=0;e<t.length;e++)t[e]()}function Yn(){var t,e,a=new Promise((r,n)=>{t=r,e=n});return{promise:a,resolve:t,reject:e}}function Ws(t,e){if(Array.isArray(t))return t;if(!(Symbol.iterator in t))return Array.from(t);const a=[];for(const r of t)if(a.push(r),a.length===e)break;return a}const pt=2,_s=4,as=8,Xn=1<<24,sa=16,na=32,Ta=64,Zs=128,Ct=512,ft=1024,yt=2048,Bt=4096,jt=8192,Jt=16384,Js=32768,ka=65536,Tn=1<<17,Vn=1<<18,La=1<<19,Wn=1<<20,Zt=1<<25,xa=32768,Ms=1<<21,Qs=1<<22,va=1<<23,Qt=Symbol("$state"),fl=Symbol("legacy props"),pl=Symbol(""),Aa=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Zn(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function hl(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function _l(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function gl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function ml(t){throw new Error("https://svelte.dev/e/effect_orphan")}function bl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function yl(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function wl(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function kl(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function xl(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Sl(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const ql=1,Tl=2,Jn=4,jl=8,El=16,Pl=1,Cl=2,Al=4,Dl=8,zl=16,Rl=1,Ml=2,dt=Symbol(),Il="http://www.w3.org/1999/xhtml";function Ll(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Ol(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Qn(t){return t===this.v}function Nl(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Kn(t){return!Nl(t,this.v)}let Oa=!1,$l=!1;function Fl(){Oa=!0}let Je=null;function za(t){Je=t}function Ye(t,e=!1,a){Je={p:Je,i:!1,c:null,e:null,s:t,x:null,l:Oa&&!e?{s:null,u:null,$:[]}:null}}function Xe(t){var e=Je,a=e.e;if(a!==null){e.e=null;for(var r of a)mr(r)}return t!==void 0&&(e.x=t),e.i=!0,Je=e.p,t??{}}function ss(){return!Oa||Je!==null&&Je.l===null}let ma=[];function er(){var t=ma;ma=[],Rs(t)}function $t(t){if(ma.length===0&&!Za){var e=ma;queueMicrotask(()=>{e===ma&&er()})}ma.push(t)}function Bl(){for(;ma.length>0;)er()}function tr(t){var e=Ie;if(e===null)return Pe.f|=va,t;if((e.f&Js)===0){if((e.f&Zs)===0)throw t;e.b.error(t)}else Ra(t,e)}function Ra(t,e){for(;e!==null;){if((e.f&Zs)!==0)try{e.b.error(t);return}catch(a){t=a}e=e.parent}throw t}const Gl=-7169;function it(t,e){t.f=t.f&Gl|e}function Ks(t){(t.f&Ct)!==0||t.deps===null?it(t,ft):it(t,Bt)}function ar(t){if(t!==null)for(const e of t)(e.f&pt)===0||(e.f&xa)===0||(e.f^=xa,ar(e.deps))}function sr(t,e,a){(t.f&yt)!==0?e.add(t):(t.f&Bt)!==0&&a.add(t),ar(t.deps),it(t,ft)}const vs=new Set;let Me=null,gs=null,Mt=null,Tt=[],Ss=null,Is=!1,Za=!1;class ua{committed=!1;current=new Map;previous=new Map;#t=new Set;#l=new Set;#e=0;#n=0;#r=null;#s=new Set;#a=new Set;skipped_effects=new Set;is_fork=!1;#i=!1;is_deferred(){return this.is_fork||this.#n>0}process(e){Tt=[],this.apply();var a=[],r=[];for(const n of e)this.#o(n,a,r);if(this.is_deferred())this.#c(r),this.#c(a);else{for(const n of this.#t)n();this.#t.clear(),this.#e===0&&this.#v(),gs=this,Me=null,jn(r),jn(a),gs=null,this.#r?.resolve()}Mt=null}#o(e,a,r){e.f^=ft;for(var n=e.first,l=null;n!==null;){var i=n.f,u=(i&(na|Ta))!==0,v=u&&(i&ft)!==0,d=v||(i&jt)!==0||this.skipped_effects.has(n);if(!d&&n.fn!==null){u?n.f^=ft:l!==null&&(i&(_s|as|Xn))!==0?l.b.defer_effect(n):(i&_s)!==0?a.push(n):Na(n)&&((i&sa)!==0&&this.#s.add(n),Ia(n));var p=n.first;if(p!==null){n=p;continue}}var b=n.parent;for(n=n.next;n===null&&b!==null;)b===l&&(l=null),n=b.next,b=b.parent}}#c(e){for(var a=0;a<e.length;a+=1)sr(e[a],this.#s,this.#a)}capture(e,a){a!==dt&&!this.previous.has(e)&&this.previous.set(e,a),(e.f&va)===0&&(this.current.set(e,e.v),Mt?.set(e,e.v))}activate(){Me=this,this.apply()}deactivate(){Me===this&&(Me=null,Mt=null)}flush(){if(this.activate(),Tt.length>0){if(nr(),Me!==null&&Me!==this)return}else this.#e===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#l)e(this);this.#l.clear()}#v(){if(vs.size>1){this.previous.clear();var e=Mt,a=!0;for(const n of vs){if(n===this){a=!1;continue}const l=[];for(const[u,v]of this.current){if(n.current.has(u))if(a&&v!==n.current.get(u))n.current.set(u,v);else continue;l.push(u)}if(l.length===0)continue;const i=[...n.current.keys()].filter(u=>!this.current.has(u));if(i.length>0){var r=Tt;Tt=[];const u=new Set,v=new Map;for(const d of l)rr(d,i,u,v);if(Tt.length>0){Me=n,n.apply();for(const d of Tt)n.#o(d,[],[]);n.deactivate()}Tt=r}}Me=null,Mt=e}this.committed=!0,vs.delete(this)}increment(e){this.#e+=1,e&&(this.#n+=1)}decrement(e){this.#e-=1,e&&(this.#n-=1),!this.#i&&(this.#i=!0,$t(()=>{this.#i=!1,this.is_deferred()?Tt.length>0&&this.flush():this.revive()}))}revive(){for(const e of this.#s)this.#a.delete(e),it(e,yt),ta(e);for(const e of this.#a)it(e,Bt),ta(e);this.flush()}oncommit(e){this.#t.add(e)}ondiscard(e){this.#l.add(e)}settled(){return(this.#r??=Yn()).promise}static ensure(){if(Me===null){const e=Me=new ua;vs.add(Me),Za||$t(()=>{Me===e&&e.flush()})}return Me}apply(){}}function Ul(t){var e=Za;Za=!0;try{for(var a;;){if(Bl(),Tt.length===0&&(Me?.flush(),Tt.length===0))return Ss=null,a;nr()}}finally{Za=e}}function nr(){Is=!0;var t=null;try{for(var e=0;Tt.length>0;){var a=ua.ensure();if(e++>1e3){var r,n;Hl()}a.process(Tt),da.clear()}}finally{Is=!1,Ss=null}}function Hl(){try{bl()}catch(t){Ra(t,Ss)}}let Wt=null;function jn(t){var e=t.length;if(e!==0){for(var a=0;a<e;){var r=t[a++];if((r.f&(Jt|jt))===0&&Na(r)&&(Wt=new Set,Ia(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?xr(r):r.fn=null),Wt?.size>0)){da.clear();for(const n of Wt){if((n.f&(Jt|jt))!==0)continue;const l=[n];let i=n.parent;for(;i!==null;)Wt.has(i)&&(Wt.delete(i),l.push(i)),i=i.parent;for(let u=l.length-1;u>=0;u--){const v=l[u];(v.f&(Jt|jt))===0&&Ia(v)}}Wt.clear()}}Wt=null}}function rr(t,e,a,r){if(!a.has(t)&&(a.add(t),t.reactions!==null))for(const n of t.reactions){const l=n.f;(l&pt)!==0?rr(n,e,a,r):(l&(Qs|sa))!==0&&(l&yt)===0&&lr(n,e,r)&&(it(n,yt),ta(n))}}function lr(t,e,a){const r=a.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const n of t.deps){if(e.includes(n))return!0;if((n.f&pt)!==0&&lr(n,e,a))return a.set(n,!0),!0}return a.set(t,!1),!1}function ta(t){for(var e=Ss=t;e.parent!==null;){e=e.parent;var a=e.f;if(Is&&e===Ie&&(a&sa)!==0&&(a&Vn)===0)return;if((a&(Ta|na))!==0){if((a&ft)===0)return;e.f^=ft}}Tt.push(e)}function Yl(t){let e=0,a=Sa(0),r;return()=>{an()&&(s(a),ls(()=>(e===0&&(r=pa(()=>t(()=>Ja(a)))),e+=1,()=>{$t(()=>{e-=1,e===0&&(r?.(),r=void 0,Ja(a))})})))}}var Xl=ka|La|Zs;function Vl(t,e,a){new Wl(t,e,a)}class Wl{parent;is_pending=!1;#t;#l=null;#e;#n;#r;#s=null;#a=null;#i=null;#o=null;#c=null;#v=0;#d=0;#p=!1;#f=!1;#h=new Set;#_=new Set;#u=null;#w=Yl(()=>(this.#u=Sa(this.#v),()=>{this.#u=null}));constructor(e,a,r){this.#t=e,this.#e=a,this.#n=r,this.parent=Ie.b,this.is_pending=!!this.#e.pending,this.#r=Ts(()=>{Ie.b=this;{var n=this.#b();try{this.#s=Pt(()=>r(n))}catch(l){this.error(l)}this.#d>0?this.#m():this.is_pending=!1}return()=>{this.#c?.remove()}},Xl)}#k(){try{this.#s=Pt(()=>this.#n(this.#t))}catch(e){this.error(e)}}#x(){const e=this.#e.pending;e&&(this.#a=Pt(()=>e(this.#t)),$t(()=>{var a=this.#b();this.#s=this.#g(()=>(ua.ensure(),Pt(()=>this.#n(a)))),this.#d>0?this.#m():(ya(this.#a,()=>{this.#a=null}),this.is_pending=!1)}))}#b(){var e=this.#t;return this.is_pending&&(this.#c=Kt(),this.#t.before(this.#c),e=this.#c),e}defer_effect(e){sr(e,this.#h,this.#_)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#e.pending}#g(e){var a=Ie,r=Pe,n=Je;Ft(this.#r),xt(this.#r),za(this.#r.ctx);try{return e()}catch(l){return tr(l),null}finally{Ft(a),xt(r),za(n)}}#m(){const e=this.#e.pending;this.#s!==null&&(this.#o=document.createDocumentFragment(),this.#o.append(this.#c),Tr(this.#s,this.#o)),this.#a===null&&(this.#a=Pt(()=>e(this.#t)))}#y(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(e);return}if(this.#d+=e,this.#d===0){this.is_pending=!1;for(const a of this.#h)it(a,yt),ta(a);for(const a of this.#_)it(a,Bt),ta(a);this.#h.clear(),this.#_.clear(),this.#a&&ya(this.#a,()=>{this.#a=null}),this.#o&&(this.#t.before(this.#o),this.#o=null)}}update_pending_count(e){this.#y(e),this.#v+=e,!(!this.#u||this.#p)&&(this.#p=!0,$t(()=>{this.#p=!1,this.#u&&Ma(this.#u,this.#v)}))}get_effect_pending(){return this.#w(),s(this.#u)}error(e){var a=this.#e.onerror;let r=this.#e.failed;if(this.#f||!a&&!r)throw e;this.#s&&(St(this.#s),this.#s=null),this.#a&&(St(this.#a),this.#a=null),this.#i&&(St(this.#i),this.#i=null);var n=!1,l=!1;const i=()=>{if(n){Ol();return}n=!0,l&&Sl(),ua.ensure(),this.#v=0,this.#i!==null&&ya(this.#i,()=>{this.#i=null}),this.is_pending=this.has_pending_snippet(),this.#s=this.#g(()=>(this.#f=!1,Pt(()=>this.#n(this.#t)))),this.#d>0?this.#m():this.is_pending=!1};var u=Pe;try{xt(null),l=!0,a?.(e,i),l=!1}catch(v){Ra(v,this.#r&&this.#r.parent)}finally{xt(u)}r&&$t(()=>{this.#i=this.#g(()=>{ua.ensure(),this.#f=!0;try{return Pt(()=>{r(this.#t,()=>e,()=>i)})}catch(v){return Ra(v,this.#r.parent),null}finally{this.#f=!1}})})}}function Zl(t,e,a,r){const n=ss()?ns:en;var l=t.filter(h=>!h.settled);if(a.length===0&&l.length===0){r(e.map(n));return}var i=Me,u=Ie,v=Jl(),d=l.length===1?l[0].promise:l.length>1?Promise.all(l.map(h=>h.promise)):null;function p(h){v();try{r(h)}catch(m){(u.f&Jt)===0&&Ra(m,u)}i?.deactivate(),Ls()}if(a.length===0){d.then(()=>p(e.map(n)));return}function b(){v(),Promise.all(a.map(h=>Ql(h))).then(h=>p([...e.map(n),...h])).catch(h=>Ra(h,u))}d?d.then(b):b()}function Jl(){var t=Ie,e=Pe,a=Je,r=Me;return function(l=!0){Ft(t),xt(e),za(a),l&&r?.activate()}}function Ls(){Ft(null),xt(null),za(null)}function ns(t){var e=pt|yt,a=Pe!==null&&(Pe.f&pt)!==0?Pe:null;return Ie!==null&&(Ie.f|=La),{ctx:Je,deps:null,effects:null,equals:Qn,f:e,fn:t,reactions:null,rv:0,v:dt,wv:0,parent:a??Ie,ac:null}}function Ql(t,e,a){let r=Ie;r===null&&hl();var n=r.b,l=void 0,i=Sa(dt),u=!Pe,v=new Map;return vi(()=>{var d=Yn();l=d.promise;try{Promise.resolve(t()).then(d.resolve,d.reject).then(()=>{p===Me&&p.committed&&p.deactivate(),Ls()})}catch(m){d.reject(m),Ls()}var p=Me;if(u){var b=n.is_rendered();n.update_pending_count(1),p.increment(b),v.get(p)?.reject(Aa),v.delete(p),v.set(p,d)}const h=(m,x=void 0)=>{if(p.activate(),x)x!==Aa&&(i.f|=va,Ma(i,x));else{(i.f&va)!==0&&(i.f^=va),Ma(i,m);for(const[S,w]of v){if(v.delete(S),S===p)break;w.reject(Aa)}}u&&(n.update_pending_count(-1),p.decrement(b))};d.promise.then(h,m=>h(null,m||"unknown"))}),sn(()=>{for(const d of v.values())d.reject(Aa)}),new Promise(d=>{function p(b){function h(){b===l?d(i):p(l)}b.then(h,h)}p(l)})}function Ze(t){const e=ns(t);return jr(e),e}function en(t){const e=ns(t);return e.equals=Kn,e}function ir(t){var e=t.effects;if(e!==null){t.effects=null;for(var a=0;a<e.length;a+=1)St(e[a])}}function Kl(t){for(var e=t.parent;e!==null;){if((e.f&pt)===0)return(e.f&Jt)===0?e:null;e=e.parent}return null}function tn(t){var e,a=Ie;Ft(Kl(t));try{t.f&=~xa,ir(t),e=Ar(t)}finally{Ft(a)}return e}function or(t){var e=tn(t);if(!t.equals(e)&&(t.wv=Pr(),(!Me?.is_fork||t.deps===null)&&(t.v=e,t.deps===null))){it(t,ft);return}fa||(Mt!==null?(an()||Me?.is_fork)&&Mt.set(t,e):Ks(t))}let Os=new Set;const da=new Map;let cr=!1;function Sa(t,e){var a={f:0,v:t,reactions:null,equals:Qn,rv:0,wv:0};return a}function q(t,e){const a=Sa(t);return jr(a),a}function Ya(t,e=!1,a=!0){const r=Sa(t);return e||(r.equals=Kn),Oa&&a&&Je!==null&&Je.l!==null&&(Je.l.s??=[]).push(r),r}function f(t,e,a=!1){Pe!==null&&(!It||(Pe.f&Tn)!==0)&&ss()&&(Pe.f&(pt|sa|Qs|Tn))!==0&&!ea?.includes(t)&&xl();let r=a?ke(e):e;return Ma(t,r)}function Ma(t,e){if(!t.equals(e)){var a=t.v;fa?da.set(t,e):da.set(t,a),t.v=e;var r=ua.ensure();if(r.capture(t,a),(t.f&pt)!==0){const n=t;(t.f&yt)!==0&&tn(n),Ks(n)}t.wv=Pr(),vr(t,yt),ss()&&Ie!==null&&(Ie.f&ft)!==0&&(Ie.f&(na|Ta))===0&&(Et===null?di([t]):Et.push(t)),!r.is_fork&&Os.size>0&&!cr&&ei()}return e}function ei(){cr=!1;for(const t of Os)(t.f&ft)!==0&&it(t,Bt),Na(t)&&Ia(t);Os.clear()}function Ja(t){f(t,t.v+1)}function vr(t,e){var a=t.reactions;if(a!==null)for(var r=ss(),n=a.length,l=0;l<n;l++){var i=a[l],u=i.f;if(!(!r&&i===Ie)){var v=(u&yt)===0;if(v&&it(i,e),(u&pt)!==0){var d=i;Mt?.delete(d),(u&xa)===0&&(u&Ct&&(i.f|=xa),vr(d,Bt))}else v&&((u&sa)!==0&&Wt!==null&&Wt.add(i),ta(i))}}}function ke(t){if(typeof t!="object"||t===null||Qt in t)return t;const e=Vs(t);if(e!==vl&&e!==ul)return t;var a=new Map,r=ks(t),n=q(0),l=wa,i=u=>{if(wa===l)return u();var v=Pe,d=wa;xt(null),An(l);var p=u();return xt(v),An(d),p};return r&&a.set("length",q(t.length)),new Proxy(t,{defineProperty(u,v,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&wl();var p=a.get(v);return p===void 0?p=i(()=>{var b=q(d.value);return a.set(v,b),b}):f(p,d.value,!0),!0},deleteProperty(u,v){var d=a.get(v);if(d===void 0){if(v in u){const p=i(()=>q(dt));a.set(v,p),Ja(n)}}else f(d,dt),Ja(n);return!0},get(u,v,d){if(v===Qt)return t;var p=a.get(v),b=v in u;if(p===void 0&&(!b||Da(u,v)?.writable)&&(p=i(()=>{var m=ke(b?u[v]:dt),x=q(m);return x}),a.set(v,p)),p!==void 0){var h=s(p);return h===dt?void 0:h}return Reflect.get(u,v,d)},getOwnPropertyDescriptor(u,v){var d=Reflect.getOwnPropertyDescriptor(u,v);if(d&&"value"in d){var p=a.get(v);p&&(d.value=s(p))}else if(d===void 0){var b=a.get(v),h=b?.v;if(b!==void 0&&h!==dt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return d},has(u,v){if(v===Qt)return!0;var d=a.get(v),p=d!==void 0&&d.v!==dt||Reflect.has(u,v);if(d!==void 0||Ie!==null&&(!p||Da(u,v)?.writable)){d===void 0&&(d=i(()=>{var h=p?ke(u[v]):dt,m=q(h);return m}),a.set(v,d));var b=s(d);if(b===dt)return!1}return p},set(u,v,d,p){var b=a.get(v),h=v in u;if(r&&v==="length")for(var m=d;m<b.v;m+=1){var x=a.get(m+"");x!==void 0?f(x,dt):m in u&&(x=i(()=>q(dt)),a.set(m+"",x))}if(b===void 0)(!h||Da(u,v)?.writable)&&(b=i(()=>q(void 0)),f(b,ke(d)),a.set(v,b));else{h=b.v!==dt;var S=i(()=>ke(d));f(b,S)}var w=Reflect.getOwnPropertyDescriptor(u,v);if(w?.set&&w.set.call(p,d),!h){if(r&&typeof v=="string"){var y=a.get("length"),P=Number(v);Number.isInteger(P)&&P>=y.v&&f(y,P+1)}Ja(n)}return!0},ownKeys(u){s(n);var v=Reflect.ownKeys(u).filter(b=>{var h=a.get(b);return h===void 0||h.v!==dt});for(var[d,p]of a)p.v!==dt&&!(d in u)&&v.push(d);return v},setPrototypeOf(){kl()}})}function En(t){try{if(t!==null&&typeof t=="object"&&Qt in t)return t[Qt]}catch{}return t}function ti(t,e){return Object.is(En(t),En(e))}var Ns,ur,dr,fr;function ai(){if(Ns===void 0){Ns=window,ur=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,a=Text.prototype;dr=Da(e,"firstChild").get,fr=Da(e,"nextSibling").get,qn(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),qn(a)&&(a.__t=void 0)}}function Kt(t=""){return document.createTextNode(t)}function ca(t){return dr.call(t)}function rs(t){return fr.call(t)}function c(t,e){return ca(t)}function qe(t,e=!1){{var a=ca(t);return a instanceof Comment&&a.data===""?rs(a):a}}function o(t,e=1,a=!1){let r=t;for(;e--;)r=rs(r);return r}function si(t){t.textContent=""}function pr(){return!1}function hr(t,e){{const a=document.body;t.autofocus=!0,$t(()=>{document.activeElement===a&&t.focus()})}}let Pn=!1;function ni(){Pn||(Pn=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function qs(t){var e=Pe,a=Ie;xt(null),Ft(null);try{return t()}finally{xt(e),Ft(a)}}function _r(t,e,a,r=a){t.addEventListener(e,()=>qs(a));const n=t.__on_r;n?t.__on_r=()=>{n(),r(!0)}:t.__on_r=()=>r(!0),ni()}function gr(t){Ie===null&&(Pe===null&&ml(),gl()),fa&&_l()}function ri(t,e){var a=e.last;a===null?e.last=e.first=t:(a.next=t,t.prev=a,e.last=t)}function Gt(t,e,a){var r=Ie;r!==null&&(r.f&jt)!==0&&(t|=jt);var n={ctx:Je,deps:null,nodes:null,f:t|yt|Ct,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(a)try{Ia(n),n.f|=Js}catch(u){throw St(n),u}else e!==null&&ta(n);var l=n;if(a&&l.deps===null&&l.teardown===null&&l.nodes===null&&l.first===l.last&&(l.f&La)===0&&(l=l.first,(t&sa)!==0&&(t&ka)!==0&&l!==null&&(l.f|=ka)),l!==null&&(l.parent=r,r!==null&&ri(l,r),Pe!==null&&(Pe.f&pt)!==0&&(t&Ta)===0)){var i=Pe;(i.effects??=[]).push(l)}return n}function an(){return Pe!==null&&!It}function sn(t){const e=Gt(as,null,!1);return it(e,ft),e.teardown=t,e}function Lt(t){gr();var e=Ie.f,a=!Pe&&(e&na)!==0&&(e&Js)===0;if(a){var r=Je;(r.e??=[]).push(t)}else return mr(t)}function mr(t){return Gt(_s|Wn,t,!1)}function li(t){return gr(),Gt(as|Wn,t,!0)}function ii(t){ua.ensure();const e=Gt(Ta|La,t,!0);return(a={})=>new Promise(r=>{a.outro?ya(e,()=>{St(e),r(void 0)}):(St(e),r(void 0))})}function br(t){return Gt(_s,t,!1)}function oi(t,e){var a=Je,r={effect:null,ran:!1,deps:t};a.l.$.push(r),r.effect=ls(()=>{t(),!r.ran&&(r.ran=!0,pa(e))})}function ci(){var t=Je;ls(()=>{for(var e of t.l.$){e.deps();var a=e.effect;(a.f&ft)!==0&&a.deps!==null&&it(a,Bt),Na(a)&&Ia(a),e.ran=!1}})}function vi(t){return Gt(Qs|La,t,!0)}function ls(t,e=0){return Gt(as|e,t,!0)}function U(t,e=[],a=[],r=[]){Zl(r,e,a,n=>{Gt(as,()=>t(...n.map(s)),!0)})}function Ts(t,e=0){var a=Gt(sa|e,t,!0);return a}function Pt(t){return Gt(na|La,t,!0)}function yr(t){var e=t.teardown;if(e!==null){const a=fa,r=Pe;Cn(!0),xt(null);try{e.call(null)}finally{Cn(a),xt(r)}}}function wr(t,e=!1){var a=t.first;for(t.first=t.last=null;a!==null;){const n=a.ac;n!==null&&qs(()=>{n.abort(Aa)});var r=a.next;(a.f&Ta)!==0?a.parent=null:St(a,e),a=r}}function ui(t){for(var e=t.first;e!==null;){var a=e.next;(e.f&na)===0&&St(e),e=a}}function St(t,e=!0){var a=!1;(e||(t.f&Vn)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(kr(t.nodes.start,t.nodes.end),a=!0),wr(t,e&&!a),ms(t,0),it(t,Jt);var r=t.nodes&&t.nodes.t;if(r!==null)for(const l of r)l.stop();yr(t);var n=t.parent;n!==null&&n.first!==null&&xr(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function kr(t,e){for(;t!==null;){var a=t===e?null:rs(t);t.remove(),t=a}}function xr(t){var e=t.parent,a=t.prev,r=t.next;a!==null&&(a.next=r),r!==null&&(r.prev=a),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=a))}function ya(t,e,a=!0){var r=[];Sr(t,r,!0);var n=()=>{a&&St(t),e&&e()},l=r.length;if(l>0){var i=()=>--l||n();for(var u of r)u.out(i)}else n()}function Sr(t,e,a){if((t.f&jt)===0){t.f^=jt;var r=t.nodes&&t.nodes.t;if(r!==null)for(const u of r)(u.is_global||a)&&e.push(u);for(var n=t.first;n!==null;){var l=n.next,i=(n.f&ka)!==0||(n.f&na)!==0&&(t.f&sa)!==0;Sr(n,e,i?a:!1),n=l}}}function nn(t){qr(t,!0)}function qr(t,e){if((t.f&jt)!==0){t.f^=jt,(t.f&ft)===0&&(it(t,yt),ta(t));for(var a=t.first;a!==null;){var r=a.next,n=(a.f&ka)!==0||(a.f&na)!==0;qr(a,n?e:!1),a=r}var l=t.nodes&&t.nodes.t;if(l!==null)for(const i of l)(i.is_global||e)&&i.in()}}function Tr(t,e){if(t.nodes)for(var a=t.nodes.start,r=t.nodes.end;a!==null;){var n=a===r?null:rs(a);e.append(a),a=n}}let hs=!1,fa=!1;function Cn(t){fa=t}let Pe=null,It=!1;function xt(t){Pe=t}let Ie=null;function Ft(t){Ie=t}let ea=null;function jr(t){Pe!==null&&(ea===null?ea=[t]:ea.push(t))}let kt=null,qt=0,Et=null;function di(t){Et=t}let Er=1,ba=0,wa=ba;function An(t){wa=t}function Pr(){return++Er}function Na(t){var e=t.f;if((e&yt)!==0)return!0;if(e&pt&&(t.f&=~xa),(e&Bt)!==0){for(var a=t.deps,r=a.length,n=0;n<r;n++){var l=a[n];if(Na(l)&&or(l),l.wv>t.wv)return!0}(e&Ct)!==0&&Mt===null&&it(t,ft)}return!1}function Cr(t,e,a=!0){var r=t.reactions;if(r!==null&&!ea?.includes(t))for(var n=0;n<r.length;n++){var l=r[n];(l.f&pt)!==0?Cr(l,e,!1):e===l&&(a?it(l,yt):(l.f&ft)!==0&&it(l,Bt),ta(l))}}function Ar(t){var e=kt,a=qt,r=Et,n=Pe,l=ea,i=Je,u=It,v=wa,d=t.f;kt=null,qt=0,Et=null,Pe=(d&(na|Ta))===0?t:null,ea=null,za(t.ctx),It=!1,wa=++ba,t.ac!==null&&(qs(()=>{t.ac.abort(Aa)}),t.ac=null);try{t.f|=Ms;var p=t.fn,b=p(),h=t.deps;if(kt!==null){var m;if(ms(t,qt),h!==null&&qt>0)for(h.length=qt+kt.length,m=0;m<kt.length;m++)h[qt+m]=kt[m];else t.deps=h=kt;if(an()&&(t.f&Ct)!==0)for(m=qt;m<h.length;m++)(h[m].reactions??=[]).push(t)}else h!==null&&qt<h.length&&(ms(t,qt),h.length=qt);if(ss()&&Et!==null&&!It&&h!==null&&(t.f&(pt|Bt|yt))===0)for(m=0;m<Et.length;m++)Cr(Et[m],t);if(n!==null&&n!==t){if(ba++,n.deps!==null)for(let x=0;x<a;x+=1)n.deps[x].rv=ba;if(e!==null)for(const x of e)x.rv=ba;Et!==null&&(r===null?r=Et:r.push(...Et))}return(t.f&va)!==0&&(t.f^=va),b}catch(x){return tr(x)}finally{t.f^=Ms,kt=e,qt=a,Et=r,Pe=n,ea=l,za(i),It=u,wa=v}}function fi(t,e){let a=e.reactions;if(a!==null){var r=ol.call(a,t);if(r!==-1){var n=a.length-1;n===0?a=e.reactions=null:(a[r]=a[n],a.pop())}}if(a===null&&(e.f&pt)!==0&&(kt===null||!kt.includes(e))){var l=e;(l.f&Ct)!==0&&(l.f^=Ct,l.f&=~xa),Ks(l),ir(l),ms(l,0)}}function ms(t,e){var a=t.deps;if(a!==null)for(var r=e;r<a.length;r++)fi(t,a[r])}function Ia(t){var e=t.f;if((e&Jt)===0){it(t,ft);var a=Ie,r=hs;Ie=t,hs=!0;try{(e&(sa|Xn))!==0?ui(t):wr(t),yr(t);var n=Ar(t);t.teardown=typeof n=="function"?n:null,t.wv=Er;var l;zs&&$l&&(t.f&yt)!==0&&t.deps}finally{hs=r,Ie=a}}}async function pi(){await Promise.resolve(),Ul()}function s(t){var e=t.f,a=(e&pt)!==0;if(Pe!==null&&!It){var r=Ie!==null&&(Ie.f&Jt)!==0;if(!r&&!ea?.includes(t)){var n=Pe.deps;if((Pe.f&Ms)!==0)t.rv<ba&&(t.rv=ba,kt===null&&n!==null&&n[qt]===t?qt++:kt===null?kt=[t]:kt.push(t));else{(Pe.deps??=[]).push(t);var l=t.reactions;l===null?t.reactions=[Pe]:l.includes(Pe)||l.push(Pe)}}}if(fa&&da.has(t))return da.get(t);if(a){var i=t;if(fa){var u=i.v;return((i.f&ft)===0&&i.reactions!==null||zr(i))&&(u=tn(i)),da.set(i,u),u}var v=(i.f&Ct)===0&&!It&&Pe!==null&&(hs||(Pe.f&Ct)!==0),d=i.deps===null;Na(i)&&(v&&(i.f|=Ct),or(i)),v&&!d&&Dr(i)}if(Mt?.has(t))return Mt.get(t);if((t.f&va)!==0)throw t.v;return t.v}function Dr(t){if(t.deps!==null){t.f|=Ct;for(const e of t.deps)(e.reactions??=[]).push(t),(e.f&pt)!==0&&(e.f&Ct)===0&&Dr(e)}}function zr(t){if(t.v===dt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(da.has(e)||(e.f&pt)!==0&&zr(e))return!0;return!1}function pa(t){var e=It;try{return It=!0,t()}finally{It=e}}function Rr(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(Qt in t)$s(t);else if(!Array.isArray(t))for(let e in t){const a=t[e];typeof a=="object"&&a&&Qt in a&&$s(a)}}}function $s(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{$s(t[r],e)}catch{}const a=Vs(t);if(a!==Object.prototype&&a!==Array.prototype&&a!==Map.prototype&&a!==Set.prototype&&a!==Date.prototype){const r=Hn(a);for(let n in r){const l=r[n].get;if(l)try{l.call(t)}catch{}}}}}const hi=["touchstart","touchmove"];function _i(t){return hi.includes(t)}const Mr=new Set,Fs=new Set;function gi(t,e,a,r={}){function n(l){if(r.capture||Xa.call(e,l),!l.cancelBubble)return qs(()=>a?.call(this,l))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?$t(()=>{e.addEventListener(t,n,r)}):e.addEventListener(t,n,r),n}function aa(t,e,a,r,n){var l={capture:r,passive:n},i=gi(t,e,a,l);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&sn(()=>{e.removeEventListener(t,i,l)})}function Qe(t){for(var e=0;e<t.length;e++)Mr.add(t[e]);for(var a of Fs)a(t)}let Dn=null;function Xa(t){var e=this,a=e.ownerDocument,r=t.type,n=t.composedPath?.()||[],l=n[0]||t.target;Dn=t;var i=0,u=Dn===t&&t.__root;if(u){var v=n.indexOf(u);if(v!==-1&&(e===document||e===window)){t.__root=e;return}var d=n.indexOf(e);if(d===-1)return;v<=d&&(i=v)}if(l=n[i]||t.target,l!==e){cl(t,"currentTarget",{configurable:!0,get(){return l||a}});var p=Pe,b=Ie;xt(null),Ft(null);try{for(var h,m=[];l!==null;){var x=l.assignedSlot||l.parentNode||l.host||null;try{var S=l["__"+r];S!=null&&(!l.disabled||t.target===l)&&S.call(l,t)}catch(w){h?m.push(w):h=w}if(t.cancelBubble||x===e||x===null)break;l=x}if(h){for(let w of m)queueMicrotask(()=>{throw w});throw h}}finally{t.__root=e,delete t.currentTarget,xt(p),Ft(b)}}}function Ir(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function es(t,e){var a=Ie;a.nodes===null&&(a.nodes={start:t,end:e,a:null,t:null})}function k(t,e){var a=(e&Rl)!==0,r=(e&Ml)!==0,n,l=!t.startsWith("<!>");return()=>{n===void 0&&(n=Ir(l?t:"<!>"+t),a||(n=ca(n)));var i=r||ur?document.importNode(n,!0):n.cloneNode(!0);if(a){var u=ca(i),v=i.lastChild;es(u,v)}else es(i,i);return i}}function mi(t=""){{var e=Kt(t+"");return es(e,e),e}}function Le(){var t=document.createDocumentFragment(),e=document.createComment(""),a=Kt();return t.append(e,a),es(e,a),t}function g(t,e){t!==null&&t.before(e)}function T(t,e){var a=e==null?"":typeof e=="object"?e+"":e;a!==(t.__t??=t.nodeValue)&&(t.__t=a,t.nodeValue=a+"")}function bi(t,e){return yi(t,e)}const Ca=new Map;function yi(t,{target:e,anchor:a,props:r={},events:n,context:l,intro:i=!0}){ai();var u=new Set,v=b=>{for(var h=0;h<b.length;h++){var m=b[h];if(!u.has(m)){u.add(m);var x=_i(m);e.addEventListener(m,Xa,{passive:x});var S=Ca.get(m);S===void 0?(document.addEventListener(m,Xa,{passive:x}),Ca.set(m,1)):Ca.set(m,S+1)}}};v(xs(Mr)),Fs.add(v);var d=void 0,p=ii(()=>{var b=a??e.appendChild(Kt());return Vl(b,{pending:()=>{}},h=>{if(l){Ye({});var m=Je;m.c=l}n&&(r.$$events=n),d=t(h,r)||{},l&&Xe()}),()=>{for(var h of u){e.removeEventListener(h,Xa);var m=Ca.get(h);--m===0?(document.removeEventListener(h,Xa),Ca.delete(h)):Ca.set(h,m)}Fs.delete(v),b!==a&&b.parentNode?.removeChild(b)}});return wi.set(d,p),d}let wi=new WeakMap;class Lr{anchor;#t=new Map;#l=new Map;#e=new Map;#n=new Set;#r=!0;constructor(e,a=!0){this.anchor=e,this.#r=a}#s=()=>{var e=Me;if(this.#t.has(e)){var a=this.#t.get(e),r=this.#l.get(a);if(r)nn(r),this.#n.delete(a);else{var n=this.#e.get(a);n&&(this.#l.set(a,n.effect),this.#e.delete(a),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),r=n.effect)}for(const[l,i]of this.#t){if(this.#t.delete(l),l===e)break;const u=this.#e.get(i);u&&(St(u.effect),this.#e.delete(i))}for(const[l,i]of this.#l){if(l===a||this.#n.has(l))continue;const u=()=>{if(Array.from(this.#t.values()).includes(l)){var d=document.createDocumentFragment();Tr(i,d),d.append(Kt()),this.#e.set(l,{effect:i,fragment:d})}else St(i);this.#n.delete(l),this.#l.delete(l)};this.#r||!r?(this.#n.add(l),ya(i,u,!1)):u()}}};#a=e=>{this.#t.delete(e);const a=Array.from(this.#t.values());for(const[r,n]of this.#e)a.includes(r)||(St(n.effect),this.#e.delete(r))};ensure(e,a){var r=Me,n=pr();if(a&&!this.#l.has(e)&&!this.#e.has(e))if(n){var l=document.createDocumentFragment(),i=Kt();l.append(i),this.#e.set(e,{effect:Pt(()=>a(i)),fragment:l})}else this.#l.set(e,Pt(()=>a(this.anchor)));if(this.#t.set(r,e),n){for(const[u,v]of this.#l)u===e?r.skipped_effects.delete(v):r.skipped_effects.add(v);for(const[u,v]of this.#e)u===e?r.skipped_effects.delete(v.effect):r.skipped_effects.add(v.effect);r.oncommit(this.#s),r.ondiscard(this.#a)}else this.#s()}}function I(t,e,a=!1){var r=new Lr(t),n=a?ka:0;function l(i,u){r.ensure(i,u)}Ts(()=>{var i=!1;e((u,v=!0)=>{i=!0,l(v,u)}),i||l(!1,null)},n)}function He(t,e){return e}function ki(t,e,a){for(var r=[],n=e.length,l,i=e.length,u=0;u<n;u++){let b=e[u];ya(b,()=>{if(l){if(l.pending.delete(b),l.done.add(b),l.pending.size===0){var h=t.outrogroups;Bs(xs(l.done)),h.delete(l),h.size===0&&(t.outrogroups=null)}}else i-=1},!1)}if(i===0){var v=r.length===0&&a!==null;if(v){var d=a,p=d.parentNode;si(p),p.append(d),t.items.clear()}Bs(e,!v)}else l={pending:new Set(e),done:new Set},(t.outrogroups??=new Set).add(l)}function Bs(t,e=!0){for(var a=0;a<t.length;a++)St(t[a],e)}var zn;function Ae(t,e,a,r,n,l=null){var i=t,u=new Map,v=(e&Jn)!==0;if(v){var d=t;i=d.appendChild(Kt())}var p=null,b=en(()=>{var y=a();return ks(y)?y:y==null?[]:xs(y)}),h,m=!0;function x(){w.fallback=p,xi(w,h,i,e,r),p!==null&&(h.length===0?(p.f&Zt)===0?nn(p):(p.f^=Zt,Va(p,null,i)):ya(p,()=>{p=null}))}var S=Ts(()=>{h=s(b);for(var y=h.length,P=new Set,_=Me,j=pr(),R=0;R<y;R+=1){var A=h[R],$=r(A,R),F=m?null:u.get($);F?(F.v&&Ma(F.v,A),F.i&&Ma(F.i,R),j&&_.skipped_effects.delete(F.e)):(F=Si(u,m?i:zn??=Kt(),A,$,R,n,e,a),m||(F.e.f|=Zt),u.set($,F)),P.add($)}if(y===0&&l&&!p&&(m?p=Pt(()=>l(i)):(p=Pt(()=>l(zn??=Kt())),p.f|=Zt)),!m)if(j){for(const[O,H]of u)P.has(O)||_.skipped_effects.add(H.e);_.oncommit(x),_.ondiscard(()=>{})}else x();s(b)}),w={effect:S,items:u,outrogroups:null,fallback:p};m=!1}function xi(t,e,a,r,n){var l=(r&jl)!==0,i=e.length,u=t.items,v=t.effect.first,d,p=null,b,h=[],m=[],x,S,w,y;if(l)for(y=0;y<i;y+=1)x=e[y],S=n(x,y),w=u.get(S).e,(w.f&Zt)===0&&(w.nodes?.a?.measure(),(b??=new Set).add(w));for(y=0;y<i;y+=1){if(x=e[y],S=n(x,y),w=u.get(S).e,t.outrogroups!==null)for(const H of t.outrogroups)H.pending.delete(w),H.done.delete(w);if((w.f&Zt)!==0)if(w.f^=Zt,w===v)Va(w,null,a);else{var P=p?p.next:v;w===t.effect.last&&(t.effect.last=w.prev),w.prev&&(w.prev.next=w.next),w.next&&(w.next.prev=w.prev),oa(t,p,w),oa(t,w,P),Va(w,P,a),p=w,h=[],m=[],v=p.next;continue}if((w.f&jt)!==0&&(nn(w),l&&(w.nodes?.a?.unfix(),(b??=new Set).delete(w))),w!==v){if(d!==void 0&&d.has(w)){if(h.length<m.length){var _=m[0],j;p=_.prev;var R=h[0],A=h[h.length-1];for(j=0;j<h.length;j+=1)Va(h[j],_,a);for(j=0;j<m.length;j+=1)d.delete(m[j]);oa(t,R.prev,A.next),oa(t,p,R),oa(t,A,_),v=_,p=A,y-=1,h=[],m=[]}else d.delete(w),Va(w,v,a),oa(t,w.prev,w.next),oa(t,w,p===null?t.effect.first:p.next),oa(t,p,w),p=w;continue}for(h=[],m=[];v!==null&&v!==w;)(d??=new Set).add(v),m.push(v),v=v.next;if(v===null)continue}(w.f&Zt)===0&&h.push(w),p=w,v=w.next}if(t.outrogroups!==null){for(const H of t.outrogroups)H.pending.size===0&&(Bs(xs(H.done)),t.outrogroups?.delete(H));t.outrogroups.size===0&&(t.outrogroups=null)}if(v!==null||d!==void 0){var $=[];if(d!==void 0)for(w of d)(w.f&jt)===0&&$.push(w);for(;v!==null;)(v.f&jt)===0&&v!==t.fallback&&$.push(v),v=v.next;var F=$.length;if(F>0){var O=(r&Jn)!==0&&i===0?a:null;if(l){for(y=0;y<F;y+=1)$[y].nodes?.a?.measure();for(y=0;y<F;y+=1)$[y].nodes?.a?.fix()}ki(t,$,O)}}l&&$t(()=>{if(b!==void 0)for(w of b)w.nodes?.a?.apply()})}function Si(t,e,a,r,n,l,i,u){var v=(i&ql)!==0?(i&El)===0?Ya(a,!1,!1):Sa(a):null,d=(i&Tl)!==0?Sa(n):null;return{v,i:d,e:Pt(()=>(l(e,v??a,d??n,u),()=>{t.delete(r)}))}}function Va(t,e,a){if(t.nodes)for(var r=t.nodes.start,n=t.nodes.end,l=e&&(e.f&Zt)===0?e.nodes.start:a;r!==null;){var i=rs(r);if(l.before(r),r===n)return;r=i}}function oa(t,e,a){e===null?t.effect.first=a:e.next=a,a===null?t.effect.last=e:a.prev=e}function qi(t,e,a=!1,r=!1,n=!1){var l=t,i="";U(()=>{var u=Ie;if(i!==(i=e()??"")&&(u.nodes!==null&&(kr(u.nodes.start,u.nodes.end),u.nodes=null),i!=="")){var v=i+"";a?v=`<svg>${v}</svg>`:r&&(v=`<math>${v}</math>`);var d=Ir(v);if((a||r)&&(d=ca(d)),es(ca(d),d.lastChild),a||r)for(;ca(d);)l.before(ca(d));else l.before(d)}})}function Ti(t,e,...a){var r=new Lr(t);Ts(()=>{const n=e()??null;r.ensure(n,n&&(l=>n(l,...a)))},ka)}const Rn=[...` 	
\r\f \v\uFEFF`];function ji(t,e,a){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),a){for(var n in a)if(a[n])r=r?r+" "+n:n;else if(r.length)for(var l=n.length,i=0;(i=r.indexOf(n,i))>=0;){var u=i+l;(i===0||Rn.includes(r[i-1]))&&(u===r.length||Rn.includes(r[u]))?r=(i===0?"":r.substring(0,i))+r.substring(u+1):i=u}}return r===""?null:r}function Ei(t,e){return t==null?null:String(t)}function ze(t,e,a,r,n,l){var i=t.__className;if(i!==a||i===void 0){var u=ji(a,r,l);u==null?t.removeAttribute("class"):t.className=u,t.__className=a}else if(l&&n!==l)for(var v in l){var d=!!l[v];(n==null||d!==!!n[v])&&t.classList.toggle(v,d)}return l}function ts(t,e,a,r){var n=t.__style;if(n!==e){var l=Ei(e);l==null?t.removeAttribute("style"):t.style.cssText=l,t.__style=e}return r}function js(t,e,a=!1){if(t.multiple){if(e==null)return;if(!ks(e))return Ll();for(var r of t.options)r.selected=e.includes(Qa(r));return}for(r of t.options){var n=Qa(r);if(ti(n,e)){r.selected=!0;return}}(!a||e!==void 0)&&(t.selectedIndex=-1)}function rn(t){var e=new MutationObserver(()=>{js(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),sn(()=>{e.disconnect()})}function ct(t,e,a=e){var r=new WeakSet,n=!0;_r(t,"change",l=>{var i=l?"[selected]":":checked",u;if(t.multiple)u=[].map.call(t.querySelectorAll(i),Qa);else{var v=t.querySelector(i)??t.querySelector("option:not([disabled])");u=v&&Qa(v)}a(u),Me!==null&&r.add(Me)}),br(()=>{var l=e();if(t===document.activeElement){var i=gs??Me;if(r.has(i))return}if(js(t,l,n),n&&l===void 0){var u=t.querySelector(":checked");u!==null&&(l=Qa(u),a(l))}t.__value=l,n=!1}),rn(t)}function Qa(t){return"__value"in t?t.__value:t.value}const Pi=Symbol("is custom element"),Ci=Symbol("is html");function Ga(t,e){var a=ln(t);a.value===(a.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function Cs(t,e){var a=ln(t);a.checked!==(a.checked=e??void 0)&&(t.checked=e)}function Ge(t,e,a,r){var n=ln(t);n[e]!==(n[e]=a)&&(e==="loading"&&(t[pl]=a),a==null?t.removeAttribute(e):typeof a!="string"&&Ai(t).includes(e)?t[e]=a:t.setAttribute(e,a))}function ln(t){return t.__attributes??={[Pi]:t.nodeName.includes("-"),[Ci]:t.namespaceURI===Il}}var Mn=new Map;function Ai(t){var e=t.getAttribute("is")||t.nodeName,a=Mn.get(e);if(a)return a;Mn.set(e,a=[]);for(var r,n=t,l=Element.prototype;l!==n;){r=Hn(n);for(var i in r)r[i].set&&a.push(i);n=Vs(n)}return a}function Te(t,e,a=e){var r=new WeakSet;_r(t,"input",async n=>{var l=n?t.defaultValue:t.value;if(l=As(t)?Ds(l):l,a(l),Me!==null&&r.add(Me),await pi(),l!==(l=e())){var i=t.selectionStart,u=t.selectionEnd,v=t.value.length;if(t.value=l??"",u!==null){var d=t.value.length;i===u&&u===v&&d>v?(t.selectionStart=d,t.selectionEnd=d):(t.selectionStart=i,t.selectionEnd=Math.min(u,d))}}}),pa(e)==null&&t.value&&(a(As(t)?Ds(t.value):t.value),Me!==null&&r.add(Me)),ls(()=>{var n=e();if(t===document.activeElement){var l=gs??Me;if(r.has(l))return}As(t)&&n===Ds(t.value)||t.type==="date"&&!n&&!t.value||n!==t.value&&(t.value=n??"")})}function As(t){var e=t.type;return e==="number"||e==="range"}function Ds(t){return t===""?null:+t}function In(t,e){return t===e||t?.[Qt]===e}function on(t={},e,a,r){return br(()=>{var n,l;return ls(()=>{n=l,l=[],pa(()=>{t!==a(...l)&&(e(t,...l),n&&In(a(...n),t)&&e(null,...n))})}),()=>{$t(()=>{l&&In(a(...l),t)&&e(null,...l)})}}),t}function Or(t=!1){const e=Je,a=e.l.u;if(!a)return;let r=()=>Rr(e.s);if(t){let n=0,l={};const i=ns(()=>{let u=!1;const v=e.s;for(const d in v)v[d]!==l[d]&&(l[d]=v[d],u=!0);return u&&n++,n});r=()=>s(i)}a.b.length&&li(()=>{Ln(e,r),Rs(a.b)}),Lt(()=>{const n=pa(()=>a.m.map(dl));return()=>{for(const l of n)typeof l=="function"&&l()}}),a.a.length&&Lt(()=>{Ln(e,r),Rs(a.a)})}function Ln(t,e){if(t.l.s)for(const a of t.l.s)s(a);e()}let us=!1;function Di(t){var e=us;try{return us=!1,[t(),us]}finally{us=e}}function lt(t,e,a,r){var n=!Oa||(a&Cl)!==0,l=(a&Dl)!==0,i=(a&zl)!==0,u=r,v=!0,d=()=>(v&&(v=!1,u=i?pa(r):r),u),p;if(l){var b=Qt in t||fl in t;p=Da(t,e)?.set??(b&&e in t?_=>t[e]=_:void 0)}var h,m=!1;l?[h,m]=Di(()=>t[e]):h=t[e],h===void 0&&r!==void 0&&(h=d(),p&&(n&&yl(),p(h)));var x;if(n?x=()=>{var _=t[e];return _===void 0?d():(v=!0,_)}:x=()=>{var _=t[e];return _!==void 0&&(u=void 0),_===void 0?u:_},n&&(a&Al)===0)return x;if(p){var S=t.$$legacy;return(function(_,j){return arguments.length>0?((!n||!j||S||m)&&p(j?x():_),_):x()})}var w=!1,y=((a&Pl)!==0?ns:en)(()=>(w=!1,x()));l&&s(y);var P=Ie;return(function(_,j){if(arguments.length>0){const R=j?s(y):n&&l?ke(_):_;return f(y,R),w=!0,u!==void 0&&(u=R),_}return fa&&w||(P.f&Jt)!==0?y.v:s(y)})}function Ot(t){Je===null&&Zn(),Oa&&Je.l!==null?Ri(Je).m.push(t):Lt(()=>{const e=pa(t);if(typeof e=="function")return e})}function zi(t,e,{bubbles:a=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:a,cancelable:r})}function Nr(){const t=Je;return t===null&&Zn(),(e,a,r)=>{const n=t.s.$$events?.[e];if(n){const l=ks(n)?n.slice():[n],i=zi(e,a,r);for(const u of l)u.call(t.x,i);return!i.defaultPrevented}return!0}}function Ri(t){var e=t.l;return e.u??={a:[],b:[],m:[]}}const Mi="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Mi);const je="";function Ee(t={}){return{"X-User-Role":localStorage.getItem("user_role")||"admin",...t}}async function cn(t){const e=new FormData;e.append("file",t);const a=await fetch(`${je}/upload`,{method:"POST",headers:Ee(),body:e});if(!a.ok)throw new Error("Upload failed");return await a.json()}async function vn(t="",e="",a="",r="registration_date",n="desc",l="",i="",u="",v="registration_date",d=""){const p=new URLSearchParams;return t&&p.append("search",t),e&&p.append("type",e),a&&p.append("status",a),l&&p.append("tag",l),i&&p.append("start_date",i),u&&p.append("end_date",u),v&&p.append("date_field",v),r&&p.append("sort_by",r),n&&p.append("sort_order",n),d&&p.append("part_search",d),await(await fetch(`${je}/documents/?${p.toString()}`,{headers:Ee()})).json()}async function Ii(){return await(await fetch(`${je}/tags`,{headers:Ee()})).json()}async function ds(t){const e=await fetch(`${je}/settings/${t}`,{headers:Ee()});if(!e.ok)throw new Error("Failed to fetch setting");return await e.json()}async function fs(t,e){const a=await fetch(`${je}/settings/`,{method:"PUT",headers:Ee({"Content-Type":"application/json"}),body:JSON.stringify({key:t,value:e})});if(!a.ok){const r=await a.json().catch(()=>({}));throw new Error(r.detail||`Failed to update setting (${a.status})`)}return await a.json()}async function Li(){return await(await fetch(`${je}/api/config-check`,{headers:Ee()})).json()}async function Oi(t){return await(await fetch(`${je}/settings/test-path`,{method:"POST",headers:Ee({"Content-Type":"application/json"}),body:JSON.stringify({path:t})})).json()}async function Ni(t){const e=await fetch(`${je}/documents/`,{method:"POST",headers:Ee({"Content-Type":"application/json"}),body:JSON.stringify(t)});if(!e.ok){const a=await e.json().catch(()=>({}));throw new Error(a.detail||`Failed to create document (${e.status})`)}return await e.json()}async function $i(t,e){return await(await fetch(`${je}/documents/${t}`,{method:"PUT",headers:Ee({"Content-Type":"application/json"}),body:JSON.stringify({status:e})})).json()}async function Fi(t,e){const a=await fetch(`${je}/documents/${t}`,{method:"PUT",headers:Ee({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!a.ok){const r=await a.json().catch(()=>({}));throw new Error(r.detail||`Failed to update document (${a.status})`)}return await a.json()}async function Bi(t){const e=new FormData;e.append("file",t);const a=await fetch(`${je}/documents/scan`,{method:"POST",headers:Ee(),body:e});if(!a.ok)throw new Error("Scan failed");return await a.json()}async function Gi(t,e){const a=await fetch(`${je}/documents/${t}/download-zip`,{headers:Ee()});if(!a.ok)throw new Error("Download failed");const r=await a.blob(),n=window.URL.createObjectURL(r),l=document.createElement("a");l.href=n,l.download=`${e}_source.zip`,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(n)}async function Ui(t){return await(await fetch(`${je}/documents/${t}`,{method:"DELETE",headers:Ee()})).json()}async function Hi(t="",e="",a=""){const r=new URLSearchParams;return t&&r.append("type",t),e&&r.append("status",e),a&&r.append("document_id",a),await(await fetch(`${je}/journal/?${r.toString()}`,{headers:Ee()})).json()}async function $r(t){return await(await fetch(`${je}/journal/`,{method:"POST",headers:Ee({"Content-Type":"application/json"}),body:JSON.stringify(t)})).json()}async function un(t,e){return await(await fetch(`${je}/journal/${t}`,{method:"PUT",headers:Ee({"Content-Type":"application/json"}),body:JSON.stringify(e)})).json()}async function Yi(t){return await(await fetch(`${je}/journal/${t}`,{method:"DELETE",headers:Ee()})).json()}async function Xi(t,e){return await(await fetch(`${je}/documents/${t}/tasks`,{method:"POST",headers:Ee({"Content-Type":"application/json"}),body:JSON.stringify(e)})).json()}async function Gs(t,e){return await(await fetch(`${je}/tasks/${t}`,{method:"PUT",headers:Ee({"Content-Type":"application/json"}),body:JSON.stringify(e)})).json()}async function Vi(t){return await(await fetch(`${je}/tasks/${t}`,{method:"DELETE",headers:Ee()})).json()}async function Wi(t){return await(await fetch(`${je}/attachments/${t}`,{method:"DELETE",headers:Ee()})).json()}async function Zi(){return await(await fetch(`${je}/filter-presets`,{headers:Ee()})).json()}async function ja(){return await(await fetch(`${je}/materials`,{headers:Ee()})).json()}async function Ji(t){return await(await fetch(`${je}/materials`,{method:"POST",headers:Ee({"Content-Type":"application/json"}),body:JSON.stringify(t)})).json()}async function Qi(t,e){return await(await fetch(`${je}/materials/${t}?name=${encodeURIComponent(e)}`,{method:"PUT",headers:Ee({"Content-Type":"application/json"})})).json()}async function Ki(t){return await(await fetch(`${je}/materials/${t}`,{method:"DELETE",headers:Ee()})).json()}async function eo(t=0,e=100,a={}){const r=new URLSearchParams({skip:String(t),limit:String(e)});return a.search&&r.append("search",a.search),a.material_id&&r.append("material_id",a.material_id),a.min_width&&r.append("min_width",a.min_width),a.max_width&&r.append("max_width",a.max_width),a.min_height&&r.append("min_height",a.min_height),a.max_height&&r.append("max_height",a.max_height),await(await fetch(`${je}/parts?${r.toString()}`,{headers:Ee()})).json()}async function to(){return await(await fetch(`${je}/stock`,{headers:Ee()})).json()}async function ao(t){return await(await fetch(`${je}/stock`,{method:"POST",headers:Ee({"Content-Type":"application/json"}),body:JSON.stringify(t)})).json()}async function so(t){return await(await fetch(`${je}/stock/${t}`,{method:"DELETE",headers:Ee()})).json()}async function no(t=0,e=100){return await(await fetch(`${je}/shift-logs?skip=${t}&limit=${e}`,{headers:Ee()})).json()}async function ro(t){return await(await fetch(`${je}/shift-logs`,{method:"POST",headers:Ee({"Content-Type":"application/json"}),body:JSON.stringify(t)})).json()}async function lo(t){const e=new FormData;e.append("file",t);const a=await fetch(`${je}/gnc/parse`,{method:"POST",headers:Ee(),body:e});if(!a.ok){const r=await a.json().catch(()=>({}));throw new Error(r.detail||"Failed to parse GNC file")}return await a.json()}async function io(t,e,a=!0){const r=await fetch(`${je}/gnc/save`,{method:"PUT",headers:Ee({"Content-Type":"application/json"}),body:JSON.stringify({sheet:t,filename:e,overwrite:a})});if(!r.ok){const n=await r.json().catch(()=>({}));throw new Error(n.detail||"Failed to save GNC file")}return await r.json()}async function oo(t){const e=await fetch(`${je}/parts/scan`,{method:"POST",headers:Ee()});if(!e.ok)throw new Error("Failed to start scan");const a=e.body.getReader(),r=new TextDecoder;for(;;){const{done:n,value:l}=await a.read();if(n)break;const u=r.decode(l).split(`
`).filter(v=>v.trim());for(const v of u)try{const d=JSON.parse(v);t(d)}catch{console.error("Failed to parse progress:",v)}}}async function co(t,e){const a=await fetch(`${je}/parts/${t}`,{method:"PUT",headers:Ee({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!a.ok)throw new Error("Failed to update part");return await a.json()}var vo=k('<div class="modal-backdrop svelte-5awcn0" role="button" tabindex="0"><div class="modal-content svelte-5awcn0" role="document" tabindex="0"><button class="close-btn svelte-5awcn0">&times;</button> <!></div></div>');function Us(t,e){Ye(e,!0);let a=lt(e,"maxWidth",3,"500px");function r(u){u.key==="Escape"&&e.close()}var n=Le(),l=qe(n);{var i=u=>{var v=vo();v.__click=function(...h){e.close?.apply(this,h)},v.__keydown=r;var d=c(v);d.__click=h=>h.stopPropagation(),d.__keydown=h=>h.stopPropagation();var p=c(d);p.__click=function(...h){e.close?.apply(this,h)};var b=o(p,2);Ti(b,()=>e.children),U(()=>ts(d,`max-width: ${a()??""}`)),g(u,v)};I(l,u=>{e.isOpen&&u(i)})}g(t,n),Xe()}Qe(["click","keydown"]);var uo=k("<p>Loading...</p>"),fo=k("<span> </span>"),po=k("<span> </span>"),ho=k('<div class="field svelte-w0yg29"><label for="ocr-url" class="svelte-w0yg29">OCR Service URL</label> <input id="ocr-url" type="text" placeholder="http://localhost:7860" class="svelte-w0yg29"/></div> <div class="field svelte-w0yg29"><label for="regex" class="svelte-w0yg29">Document Name Regex</label> <input id="regex" type="text" placeholder="Regex Pattern" class="svelte-w0yg29"/></div> <hr class="divider svelte-w0yg29"/> <h3 class="section-title svelte-w0yg29">Sync Folder Paths</h3> <p class="section-hint svelte-w0yg29">Configure paths to network folders for automatic file import.</p> <div class="field path-field svelte-w0yg29"><label for="mihtav-path" class="svelte-w0yg29">Mihtav (Orders) Path</label> <div class="path-input-group svelte-w0yg29"><input id="mihtav-path" type="text" placeholder="Z:\\Mihtavim or \\\\server\\share\\orders" class="svelte-w0yg29"/> <button class="test-btn svelte-w0yg29"> </button></div> <!></div> <div class="field path-field svelte-w0yg29"><label for="sidra-path" class="svelte-w0yg29">Sidra (Parts Library) Path</label> <div class="path-input-group svelte-w0yg29"><input id="sidra-path" type="text" placeholder="Z:\\Sidra or \\\\server\\share\\parts" class="svelte-w0yg29"/> <button class="test-btn svelte-w0yg29"> </button></div> <!></div> <hr class="divider svelte-w0yg29"/> <h3 class="section-title svelte-w0yg29">Hardware Integration</h3> <p class="section-hint svelte-w0yg29">Configure connection to cutting machines. (Coming Soon)</p> <div class="field svelte-w0yg29"><label for="com-port" class="svelte-w0yg29">COM Port</label> <input id="com-port" type="text" placeholder="e.g. COM3" disabled class="svelte-w0yg29"/></div> <hr class="divider svelte-w0yg29"/> <div class="field svelte-w0yg29"><label for="role" class="svelte-w0yg29">User Mode (Simulated)</label> <select id="role" class="svelte-w0yg29"><option>Operator (Read-Only)</option><option>Admin (Full Access)</option></select> <p class="hint svelte-w0yg29">Switching mode will reload the application.</p></div>',1),_o=k('<div class="modal-content svelte-w0yg29"><h2 class="svelte-w0yg29">Settings</h2> <!> <div class="actions svelte-w0yg29"><button class="cancel-btn svelte-w0yg29">Cancel</button> <button class="save-btn svelte-w0yg29">Save</button></div></div>');function On(t,e){Ye(e,!0);let a=lt(e,"isOpen",3,!1),r=q(""),n=q(""),l=q("admin"),i=q(""),u=q(""),v=q(!0),d=ke({mihtav:!1,sidra:!1}),p=q(ke({mihtav:null,sidra:null}));async function b(){f(v,!0);try{const[y,P,_,j]=await Promise.all([ds("ocr_url").catch(()=>({value:""})),ds("doc_name_regex").catch(()=>({value:""})),ds("sync_mihtav_path").catch(()=>({value:""})),ds("sync_sidra_path").catch(()=>({value:""}))]);f(r,y.value||"",!0),f(n,P.value||"",!0),f(i,_.value||"",!0),f(u,j.value||"",!0);const R=localStorage.getItem("user_role");R&&f(l,R,!0)}catch(y){console.error(y)}finally{f(v,!1)}}async function h(y){const P=s(y==="mihtav"?i:u);if(!P){s(p)[y]={accessible:!1,error:"Path is empty"};return}d[y]=!0;try{const _=await Oi(P);s(p)[y]={accessible:_.ok,error:_.error}}catch(_){s(p)[y]={accessible:!1,error:_.message}}finally{d[y]=!1}}async function m(){try{await Promise.all([fs("ocr_url",s(r)),fs("doc_name_regex",s(n)),fs("sync_mihtav_path",s(i)),fs("sync_sidra_path",s(u))]),localStorage.setItem("user_role",s(l)),window.location.reload(),e.close()}catch(y){alert("Failed to save settings. Ensure you have Admin privileges."),console.error(y)}}Lt(()=>{a()&&(b(),f(p,{mihtav:null,sidra:null},!0))});var x=Le(),S=qe(x);{var w=y=>{var P=_o(),_=o(c(P),2);{var j=O=>{var H=uo();g(O,H)},R=O=>{var H=ho(),Z=qe(H),W=o(c(Z),2),B=o(Z,2),N=o(c(B),2),L=o(B,8),ie=o(c(L),2),le=c(ie),de=o(le,2);de.__click=()=>h("mihtav");var be=c(de),Y=o(ie,2);{var G=D=>{var ue=fo();let re;var pe=c(ue);U(()=>{re=ze(ue,1,"test-result svelte-w0yg29",null,re,{success:s(p).mihtav.accessible,error:!s(p).mihtav.accessible}),T(pe,s(p).mihtav.accessible?"✓ Path accessible":`✗ ${s(p).mihtav.error||"Path not accessible"}`)}),g(D,ue)};I(Y,D=>{s(p).mihtav&&D(G)})}var se=o(L,2),X=o(c(se),2),C=c(X),Q=o(C,2);Q.__click=()=>h("sidra");var oe=c(Q),ae=o(X,2);{var ye=D=>{var ue=po();let re;var pe=c(ue);U(()=>{re=ze(ue,1,"test-result svelte-w0yg29",null,re,{success:s(p).sidra.accessible,error:!s(p).sidra.accessible}),T(pe,s(p).sidra.accessible?"✓ Path accessible":`✗ ${s(p).sidra.error||"Path not accessible"}`)}),g(D,ue)};I(ae,D=>{s(p).sidra&&D(ye)})}var V=o(se,12),K=o(c(V),2),te=c(K);te.value=te.__value="operator";var ne=o(te);ne.value=ne.__value="admin",U(()=>{de.disabled=d.mihtav,T(be,d.mihtav?"Testing...":"Test"),Q.disabled=d.sidra,T(oe,d.sidra?"Testing...":"Test")}),Te(W,()=>s(r),D=>f(r,D)),Te(N,()=>s(n),D=>f(n,D)),Te(le,()=>s(i),D=>f(i,D)),Te(C,()=>s(u),D=>f(u,D)),ct(K,()=>s(l),D=>f(l,D)),g(O,H)};I(_,O=>{s(v)?O(j):O(R,!1)})}var A=o(_,2),$=c(A);$.__click=function(...O){e.close?.apply(this,O)};var F=o($,2);F.__click=m,g(y,P)};I(S,y=>{a()&&y(w)})}g(t,x),Xe()}Qe(["click"]);Fl();var go=k('<aside class="sidebar svelte-1nhzsi7"><div class="sidebar-header svelte-1nhzsi7"><span class="logo-icon svelte-1nhzsi7">DF</span></div> <nav class="svelte-1nhzsi7"><button><span class="icon svelte-1nhzsi7">📊</span> <span class="label svelte-1nhzsi7">Dashboard</span></button> <button><span class="icon svelte-1nhzsi7">📄</span> <span class="label svelte-1nhzsi7">Documents</span></button> <button><span class="icon svelte-1nhzsi7">⚙️</span> <span class="label svelte-1nhzsi7">Parts Library</span></button> <button><span class="icon svelte-1nhzsi7">📐</span> <span class="label svelte-1nhzsi7">GNC Editor</span></button> <button><span class="icon svelte-1nhzsi7">👷</span> <span class="label svelte-1nhzsi7">Job Processing</span></button> <button><span class="icon svelte-1nhzsi7">📦</span> <span class="label svelte-1nhzsi7">Stock</span></button> <button><span class="icon svelte-1nhzsi7">📓</span> <span class="label svelte-1nhzsi7">Journal</span></button> <button><span class="icon svelte-1nhzsi7">📝</span> <span class="label svelte-1nhzsi7">Shift Logs</span></button></nav></aside>');function mo(t,e){Ye(e,!1);let a=lt(e,"activeView",8,"documents"),r=lt(e,"onSelect",8);function n($){r()($)}Or();var l=go(),i=o(c(l),2),u=c(i);u.__click=()=>n("dashboard");let v;var d=o(u,2);d.__click=()=>n("documents");let p;var b=o(d,2);b.__click=()=>n("parts");let h;var m=o(b,2);m.__click=()=>n("gnc");let x;var S=o(m,2);S.__click=()=>n("job");let w;var y=o(S,2);y.__click=()=>n("stock");let P;var _=o(y,2);_.__click=()=>n("journal");let j;var R=o(_,2);R.__click=()=>n("logs");let A;U(()=>{v=ze(u,1,"svelte-1nhzsi7",null,v,{active:a()==="dashboard"}),p=ze(d,1,"svelte-1nhzsi7",null,p,{active:a()==="documents"}),h=ze(b,1,"svelte-1nhzsi7",null,h,{active:a()==="parts"}),x=ze(m,1,"svelte-1nhzsi7",null,x,{active:a()==="gnc"}),w=ze(S,1,"svelte-1nhzsi7",null,w,{active:a()==="job"}),P=ze(y,1,"svelte-1nhzsi7",null,P,{active:a()==="stock"}),j=ze(_,1,"svelte-1nhzsi7",null,j,{active:a()==="journal"}),A=ze(R,1,"svelte-1nhzsi7",null,A,{active:a()==="logs"})}),g(t,l),Xe()}Qe(["click"]);var bo=k('<div class="loading svelte-plcxj0">Loading dashboard...</div>'),yo=k('<div class="recent-doc-item svelte-plcxj0"><div class="doc-info svelte-plcxj0"><span class="doc-name svelte-plcxj0"> </span> <span class="doc-date svelte-plcxj0"> </span></div> <span> </span></div>'),wo=k('<div class="empty-state svelte-plcxj0">No documents yet</div>'),ko=k('<div class="dashboard-section svelte-plcxj0"><h2 class="svelte-plcxj0">📊 Overview</h2> <div class="stats-grid svelte-plcxj0"><div class="stat-card documents svelte-plcxj0"><div class="stat-icon svelte-plcxj0">📄</div> <div class="stat-content svelte-plcxj0"><div class="stat-value svelte-plcxj0"> </div> <div class="stat-label svelte-plcxj0">Total Documents</div> <div class="stat-breakdown svelte-plcxj0"><span class="in-progress svelte-plcxj0"> </span> <span class="done svelte-plcxj0"> </span></div></div></div> <div class="stat-card tasks svelte-plcxj0"><div class="stat-icon svelte-plcxj0">✓</div> <div class="stat-content svelte-plcxj0"><div class="stat-value svelte-plcxj0"> </div> <div class="stat-label svelte-plcxj0">Total Tasks</div> <div class="stat-breakdown svelte-plcxj0"><span class="planned svelte-plcxj0"> </span> <span class="pending svelte-plcxj0"> </span> <span class="done svelte-plcxj0"> </span></div></div></div> <div class="stat-card materials svelte-plcxj0"><div class="stat-icon svelte-plcxj0">📦</div> <div class="stat-content svelte-plcxj0"><div class="stat-value svelte-plcxj0"> </div> <div class="stat-label svelte-plcxj0">Materials</div></div></div> <div class="stat-card completion svelte-plcxj0"><div class="stat-icon svelte-plcxj0">📈</div> <div class="stat-content svelte-plcxj0"><div class="stat-value svelte-plcxj0"> </div> <div class="stat-label svelte-plcxj0">Completion Rate</div></div></div></div></div> <div class="dashboard-section svelte-plcxj0"><h2 class="svelte-plcxj0">📅 Reports</h2> <div class="reports-grid svelte-plcxj0"><div class="report-card svelte-plcxj0"><h3 class="svelte-plcxj0">Today</h3> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Created:</span> <span class="report-value svelte-plcxj0"> </span></div> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Completed:</span> <span class="report-value svelte-plcxj0"> </span></div></div> <div class="report-card svelte-plcxj0"><h3 class="svelte-plcxj0">Last 7 Days</h3> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Created:</span> <span class="report-value svelte-plcxj0"> </span></div> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Completed:</span> <span class="report-value svelte-plcxj0"> </span></div></div> <div class="report-card svelte-plcxj0"><h3 class="svelte-plcxj0">Last 30 Days</h3> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Created:</span> <span class="report-value svelte-plcxj0"> </span></div> <div class="report-item svelte-plcxj0"><span class="report-label svelte-plcxj0">Documents Completed:</span> <span class="report-value svelte-plcxj0"> </span></div></div></div></div> <div class="dashboard-section svelte-plcxj0"><h2 class="svelte-plcxj0">📝 Recent Documents</h2> <div class="recent-documents svelte-plcxj0"><!> <!></div></div>',1),xo=k('<div class="dashboard-container svelte-plcxj0"><!></div>');function So(t,e){Ye(e,!0);let a=ke({totalDocuments:0,totalTasks:0,totalMaterials:0,documentsInProgress:0,documentsDone:0,tasksPlanned:0,tasksPending:0,tasksDone:0}),r=ke({tasksCompleted:0,documentsCreated:0,documentsCompleted:0}),n=ke({tasksCompleted:0,documentsCreated:0,documentsCompleted:0}),l=ke({tasksCompleted:0,documentsCreated:0,documentsCompleted:0}),i=q(ke([])),u=q(!0);Ot(()=>{v()});async function v(){f(u,!0);try{const m=await vn("","","","registration_date","desc"),x=await ja();a.totalDocuments=m.length,a.totalMaterials=x.length,a.documentsInProgress=m.filter(_=>_.status==="in_progress").length,a.documentsDone=m.filter(_=>_.status==="done").length;let S=[];m.forEach(_=>{_.tasks&&(S=S.concat(_.tasks))}),a.totalTasks=S.length,a.tasksPlanned=S.filter(_=>_.status==="planned").length,a.tasksPending=S.filter(_=>_.status==="pending").length,a.tasksDone=S.filter(_=>_.status==="done").length;const w=new Date;w.setHours(0,0,0,0),r.documentsCreated=m.filter(_=>{const j=new Date(_.registration_date);return j.setHours(0,0,0,0),j.getTime()===w.getTime()}).length,r.documentsCompleted=m.filter(_=>{if(!_.done_date)return!1;const j=new Date(_.done_date);return j.setHours(0,0,0,0),j.getTime()===w.getTime()}).length;const y=new Date;y.setDate(y.getDate()-7),y.setHours(0,0,0,0),n.documentsCreated=m.filter(_=>new Date(_.registration_date)>=y).length,n.documentsCompleted=m.filter(_=>_.done_date?new Date(_.done_date)>=y:!1).length;const P=new Date;P.setDate(P.getDate()-30),P.setHours(0,0,0,0),l.documentsCreated=m.filter(_=>new Date(_.registration_date)>=P).length,l.documentsCompleted=m.filter(_=>_.done_date?new Date(_.done_date)>=P:!1).length,f(i,m.slice(0,5),!0)}catch(m){console.error("Failed to load dashboard data",m)}finally{f(u,!1)}}var d=xo(),p=c(d);{var b=m=>{var x=bo();g(m,x)},h=m=>{var x=ko(),S=qe(x),w=o(c(S),2),y=c(w),P=o(c(y),2),_=c(P),j=c(_),R=o(_,4),A=c(R),$=c(A),F=o(A,2),O=c(F),H=o(y,2),Z=o(c(H),2),W=c(Z),B=c(W),N=o(W,4),L=c(N),ie=c(L),le=o(L,2),de=c(le),be=o(le,2),Y=c(be),G=o(H,2),se=o(c(G),2),X=c(se),C=c(X),Q=o(G,2),oe=o(c(Q),2),ae=c(oe),ye=c(ae),V=o(S,2),K=o(c(V),2),te=c(K),ne=o(c(te),2),D=o(c(ne),2),ue=c(D),re=o(ne,2),pe=o(c(re),2),ce=c(pe),he=o(te,2),fe=o(c(he),2),ve=o(c(fe),2),z=c(ve),_e=o(fe,2),xe=o(c(_e),2),M=c(xe),E=o(he,2),ee=o(c(E),2),Se=o(c(ee),2),Ce=c(Se),ge=o(ee,2),me=o(c(ge),2),Oe=c(me),Be=o(V,2),De=o(c(Be),2),Ve=c(De);Ae(Ve,17,()=>s(i),He,(Ke,Ue)=>{var ot=yo(),wt=c(ot),vt=c(wt),J=c(vt),we=o(vt,2),Ne=c(we),nt=o(wt,2),_t=c(nt);U(()=>{T(J,s(Ue).name),T(Ne,s(Ue).registration_date),ze(nt,1,`doc-status ${s(Ue).status??""}`,"svelte-plcxj0"),T(_t,s(Ue).status)}),g(Ke,ot)});var tt=o(Ve,2);{var at=Ke=>{var Ue=wo();g(Ke,Ue)};I(tt,Ke=>{s(i).length===0&&Ke(at)})}U(Ke=>{T(j,a.totalDocuments),T($,`${a.documentsInProgress??""} in progress`),T(O,`${a.documentsDone??""} done`),T(B,a.totalTasks),T(ie,`${a.tasksPlanned??""} planned`),T(de,`${a.tasksPending??""} pending`),T(Y,`${a.tasksDone??""} done`),T(C,a.totalMaterials),T(ye,`${Ke??""}%`),T(ue,r.documentsCreated),T(ce,r.documentsCompleted),T(z,n.documentsCreated),T(M,n.documentsCompleted),T(Ce,l.documentsCreated),T(Oe,l.documentsCompleted)},[()=>a.totalDocuments>0?Math.round(a.documentsDone/a.totalDocuments*100):0]),g(m,x)};I(p,m=>{s(u)?m(b):m(h,!1)})}g(t,d),Xe()}function dn(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Ea=dn();function Fr(t){Ea=t}var Ka={exec:()=>null};function Re(t,e=""){let a=typeof t=="string"?t:t.source,r={replace:(n,l)=>{let i=typeof l=="string"?l:l.source;return i=i.replace(bt.caret,"$1"),a=a.replace(n,i),r},getRegex:()=>new RegExp(a,e)};return r}var qo=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),bt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},To=/^(?:[ \t]*(?:\n|$))+/,jo=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Eo=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,is=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Po=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,fn=/(?:[*+-]|\d{1,9}[.)])/,Br=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Gr=Re(Br).replace(/bull/g,fn).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Co=Re(Br).replace(/bull/g,fn).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),pn=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Ao=/^[^\n]+/,hn=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Do=Re(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",hn).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),zo=Re(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,fn).getRegex(),Es="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",_n=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Ro=Re("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",_n).replace("tag",Es).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Ur=Re(pn).replace("hr",is).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Es).getRegex(),Mo=Re(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Ur).getRegex(),gn={blockquote:Mo,code:jo,def:Do,fences:Eo,heading:Po,hr:is,html:Ro,lheading:Gr,list:zo,newline:To,paragraph:Ur,table:Ka,text:Ao},Nn=Re("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",is).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Es).getRegex(),Io={...gn,lheading:Co,table:Nn,paragraph:Re(pn).replace("hr",is).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Nn).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Es).getRegex()},Lo={...gn,html:Re(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",_n).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ka,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Re(pn).replace("hr",is).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Gr).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Oo=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,No=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Hr=/^( {2,}|\\)\n(?!\s*$)/,$o=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Ps=/[\p{P}\p{S}]/u,mn=/[\s\p{P}\p{S}]/u,Yr=/[^\s\p{P}\p{S}]/u,Fo=Re(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,mn).getRegex(),Xr=/(?!~)[\p{P}\p{S}]/u,Bo=/(?!~)[\s\p{P}\p{S}]/u,Go=/(?:[^\s\p{P}\p{S}]|~)/u,Uo=Re(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",qo?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Vr=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Ho=Re(Vr,"u").replace(/punct/g,Ps).getRegex(),Yo=Re(Vr,"u").replace(/punct/g,Xr).getRegex(),Wr="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Xo=Re(Wr,"gu").replace(/notPunctSpace/g,Yr).replace(/punctSpace/g,mn).replace(/punct/g,Ps).getRegex(),Vo=Re(Wr,"gu").replace(/notPunctSpace/g,Go).replace(/punctSpace/g,Bo).replace(/punct/g,Xr).getRegex(),Wo=Re("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Yr).replace(/punctSpace/g,mn).replace(/punct/g,Ps).getRegex(),Zo=Re(/\\(punct)/,"gu").replace(/punct/g,Ps).getRegex(),Jo=Re(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Qo=Re(_n).replace("(?:-->|$)","-->").getRegex(),Ko=Re("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Qo).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),bs=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,ec=Re(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",bs).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Zr=Re(/^!?\[(label)\]\[(ref)\]/).replace("label",bs).replace("ref",hn).getRegex(),Jr=Re(/^!?\[(ref)\](?:\[\])?/).replace("ref",hn).getRegex(),tc=Re("reflink|nolink(?!\\()","g").replace("reflink",Zr).replace("nolink",Jr).getRegex(),$n=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,bn={_backpedal:Ka,anyPunctuation:Zo,autolink:Jo,blockSkip:Uo,br:Hr,code:No,del:Ka,emStrongLDelim:Ho,emStrongRDelimAst:Xo,emStrongRDelimUnd:Wo,escape:Oo,link:ec,nolink:Jr,punctuation:Fo,reflink:Zr,reflinkSearch:tc,tag:Ko,text:$o,url:Ka},ac={...bn,link:Re(/^!?\[(label)\]\((.*?)\)/).replace("label",bs).getRegex(),reflink:Re(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",bs).getRegex()},Hs={...bn,emStrongRDelimAst:Vo,emStrongLDelim:Yo,url:Re(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",$n).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Re(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",$n).getRegex()},sc={...Hs,br:Re(Hr).replace("{2,}","*").getRegex(),text:Re(Hs.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ps={normal:gn,gfm:Io,pedantic:Lo},Ua={normal:bn,gfm:Hs,breaks:sc,pedantic:ac},nc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Fn=t=>nc[t];function Vt(t,e){if(e){if(bt.escapeTest.test(t))return t.replace(bt.escapeReplace,Fn)}else if(bt.escapeTestNoEncode.test(t))return t.replace(bt.escapeReplaceNoEncode,Fn);return t}function Bn(t){try{t=encodeURI(t).replace(bt.percentDecode,"%")}catch{return null}return t}function Gn(t,e){let a=t.replace(bt.findPipe,(l,i,u)=>{let v=!1,d=i;for(;--d>=0&&u[d]==="\\";)v=!v;return v?"|":" |"}),r=a.split(bt.splitPipe),n=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;n<r.length;n++)r[n]=r[n].trim().replace(bt.slashPipe,"|");return r}function Ha(t,e,a){let r=t.length;if(r===0)return"";let n=0;for(;n<r&&t.charAt(r-n-1)===e;)n++;return t.slice(0,r-n)}function rc(t,e){if(t.indexOf(e[1])===-1)return-1;let a=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===e[0])a++;else if(t[r]===e[1]&&(a--,a<0))return r;return a>0?-2:-1}function Un(t,e,a,r,n){let l=e.href,i=e.title||null,u=t[1].replace(n.other.outputLinkReplace,"$1");r.state.inLink=!0;let v={type:t[0].charAt(0)==="!"?"image":"link",raw:a,href:l,title:i,text:u,tokens:r.inlineTokens(u)};return r.state.inLink=!1,v}function lc(t,e,a){let r=t.match(a.other.indentCodeCompensation);if(r===null)return e;let n=r[1];return e.split(`
`).map(l=>{let i=l.match(a.other.beginningSpace);if(i===null)return l;let[u]=i;return u.length>=n.length?l.slice(n.length):l}).join(`
`)}var ys=class{options;rules;lexer;constructor(t){this.options=t||Ea}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let a=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?a:Ha(a,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let a=e[0],r=lc(a,e[3]||"",this.rules);return{type:"code",raw:a,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let a=e[2].trim();if(this.rules.other.endingHash.test(a)){let r=Ha(a,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(a=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:a,tokens:this.lexer.inline(a)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Ha(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let a=Ha(e[0],`
`).split(`
`),r="",n="",l=[];for(;a.length>0;){let i=!1,u=[],v;for(v=0;v<a.length;v++)if(this.rules.other.blockquoteStart.test(a[v]))u.push(a[v]),i=!0;else if(!i)u.push(a[v]);else break;a=a.slice(v);let d=u.join(`
`),p=d.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${d}`:d,n=n?`${n}
${p}`:p;let b=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(p,l,!0),this.lexer.state.top=b,a.length===0)break;let h=l.at(-1);if(h?.type==="code")break;if(h?.type==="blockquote"){let m=h,x=m.raw+`
`+a.join(`
`),S=this.blockquote(x);l[l.length-1]=S,r=r.substring(0,r.length-m.raw.length)+S.raw,n=n.substring(0,n.length-m.text.length)+S.text;break}else if(h?.type==="list"){let m=h,x=m.raw+`
`+a.join(`
`),S=this.list(x);l[l.length-1]=S,r=r.substring(0,r.length-h.raw.length)+S.raw,n=n.substring(0,n.length-m.raw.length)+S.raw,a=x.substring(l.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:l,text:n}}}list(t){let e=this.rules.block.list.exec(t);if(e){let a=e[1].trim(),r=a.length>1,n={type:"list",raw:"",ordered:r,start:r?+a.slice(0,-1):"",loose:!1,items:[]};a=r?`\\d{1,9}\\${a.slice(-1)}`:`\\${a}`,this.options.pedantic&&(a=r?a:"[*+-]");let l=this.rules.other.listItemRegex(a),i=!1;for(;t;){let v=!1,d="",p="";if(!(e=l.exec(t))||this.rules.block.hr.test(t))break;d=e[0],t=t.substring(d.length);let b=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,S=>" ".repeat(3*S.length)),h=t.split(`
`,1)[0],m=!b.trim(),x=0;if(this.options.pedantic?(x=2,p=b.trimStart()):m?x=e[1].length+1:(x=e[2].search(this.rules.other.nonSpaceChar),x=x>4?1:x,p=b.slice(x),x+=e[1].length),m&&this.rules.other.blankLine.test(h)&&(d+=h+`
`,t=t.substring(h.length+1),v=!0),!v){let S=this.rules.other.nextBulletRegex(x),w=this.rules.other.hrRegex(x),y=this.rules.other.fencesBeginRegex(x),P=this.rules.other.headingBeginRegex(x),_=this.rules.other.htmlBeginRegex(x);for(;t;){let j=t.split(`
`,1)[0],R;if(h=j,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),R=h):R=h.replace(this.rules.other.tabCharGlobal,"    "),y.test(h)||P.test(h)||_.test(h)||S.test(h)||w.test(h))break;if(R.search(this.rules.other.nonSpaceChar)>=x||!h.trim())p+=`
`+R.slice(x);else{if(m||b.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||y.test(b)||P.test(b)||w.test(b))break;p+=`
`+h}!m&&!h.trim()&&(m=!0),d+=j+`
`,t=t.substring(j.length+1),b=R.slice(x)}}n.loose||(i?n.loose=!0:this.rules.other.doubleBlankLine.test(d)&&(i=!0)),n.items.push({type:"list_item",raw:d,task:!!this.options.gfm&&this.rules.other.listIsTask.test(p),loose:!1,text:p,tokens:[]}),n.raw+=d}let u=n.items.at(-1);if(u)u.raw=u.raw.trimEnd(),u.text=u.text.trimEnd();else return;n.raw=n.raw.trimEnd();for(let v of n.items){if(this.lexer.state.top=!1,v.tokens=this.lexer.blockTokens(v.text,[]),v.task){if(v.text=v.text.replace(this.rules.other.listReplaceTask,""),v.tokens[0]?.type==="text"||v.tokens[0]?.type==="paragraph"){v.tokens[0].raw=v.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),v.tokens[0].text=v.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let p=this.lexer.inlineQueue.length-1;p>=0;p--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[p].src)){this.lexer.inlineQueue[p].src=this.lexer.inlineQueue[p].src.replace(this.rules.other.listReplaceTask,"");break}}let d=this.rules.other.listTaskCheckbox.exec(v.raw);if(d){let p={type:"checkbox",raw:d[0]+" ",checked:d[0]!=="[ ]"};v.checked=p.checked,n.loose?v.tokens[0]&&["paragraph","text"].includes(v.tokens[0].type)&&"tokens"in v.tokens[0]&&v.tokens[0].tokens?(v.tokens[0].raw=p.raw+v.tokens[0].raw,v.tokens[0].text=p.raw+v.tokens[0].text,v.tokens[0].tokens.unshift(p)):v.tokens.unshift({type:"paragraph",raw:p.raw,text:p.raw,tokens:[p]}):v.tokens.unshift(p)}}if(!n.loose){let d=v.tokens.filter(b=>b.type==="space"),p=d.length>0&&d.some(b=>this.rules.other.anyLine.test(b.raw));n.loose=p}}if(n.loose)for(let v of n.items){v.loose=!0;for(let d of v.tokens)d.type==="text"&&(d.type="paragraph")}return n}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let a=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",n=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:a,raw:e[0],href:r,title:n}}}table(t){let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let a=Gn(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),n=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],l={type:"table",raw:e[0],header:[],align:[],rows:[]};if(a.length===r.length){for(let i of r)this.rules.other.tableAlignRight.test(i)?l.align.push("right"):this.rules.other.tableAlignCenter.test(i)?l.align.push("center"):this.rules.other.tableAlignLeft.test(i)?l.align.push("left"):l.align.push(null);for(let i=0;i<a.length;i++)l.header.push({text:a[i],tokens:this.lexer.inline(a[i]),header:!0,align:l.align[i]});for(let i of n)l.rows.push(Gn(i,l.header.length).map((u,v)=>({text:u,tokens:this.lexer.inline(u),header:!1,align:l.align[v]})));return l}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let a=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:a,tokens:this.lexer.inline(a)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let a=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(a)){if(!this.rules.other.endAngleBracket.test(a))return;let l=Ha(a.slice(0,-1),"\\");if((a.length-l.length)%2===0)return}else{let l=rc(e[2],"()");if(l===-2)return;if(l>-1){let i=(e[0].indexOf("!")===0?5:4)+e[1].length+l;e[2]=e[2].substring(0,l),e[0]=e[0].substring(0,i).trim(),e[3]=""}}let r=e[2],n="";if(this.options.pedantic){let l=this.rules.other.pedanticHrefTitle.exec(r);l&&(r=l[1],n=l[3])}else n=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(a)?r=r.slice(1):r=r.slice(1,-1)),Un(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:n&&n.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let a;if((a=this.rules.inline.reflink.exec(t))||(a=this.rules.inline.nolink.exec(t))){let r=(a[2]||a[1]).replace(this.rules.other.multipleSpaceGlobal," "),n=e[r.toLowerCase()];if(!n){let l=a[0].charAt(0);return{type:"text",raw:l,text:l}}return Un(a,n,a[0],this.lexer,this.rules)}}emStrong(t,e,a=""){let r=this.rules.inline.emStrongLDelim.exec(t);if(!(!r||r[3]&&a.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!a||this.rules.inline.punctuation.exec(a))){let n=[...r[0]].length-1,l,i,u=n,v=0,d=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,e=e.slice(-1*t.length+n);(r=d.exec(e))!=null;){if(l=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!l)continue;if(i=[...l].length,r[3]||r[4]){u+=i;continue}else if((r[5]||r[6])&&n%3&&!((n+i)%3)){v+=i;continue}if(u-=i,u>0)continue;i=Math.min(i,i+u+v);let p=[...r[0]][0].length,b=t.slice(0,n+r.index+p+i);if(Math.min(n,i)%2){let m=b.slice(1,-1);return{type:"em",raw:b,text:m,tokens:this.lexer.inlineTokens(m)}}let h=b.slice(2,-2);return{type:"strong",raw:b,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let a=e[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(a),n=this.rules.other.startingSpaceChar.test(a)&&this.rules.other.endingSpaceChar.test(a);return r&&n&&(a=a.substring(1,a.length-1)),{type:"codespan",raw:e[0],text:a}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){let e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let a,r;return e[2]==="@"?(a=e[1],r="mailto:"+a):(a=e[1],r=a),{type:"link",raw:e[0],text:a,href:r,tokens:[{type:"text",raw:a,text:a}]}}}url(t){let e;if(e=this.rules.inline.url.exec(t)){let a,r;if(e[2]==="@")a=e[0],r="mailto:"+a;else{let n;do n=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(n!==e[0]);a=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:a,href:r,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let a=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:a}}}},zt=class Ys{tokens;options;state;inlineQueue;tokenizer;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ea,this.options.tokenizer=this.options.tokenizer||new ys,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let a={other:bt,block:ps.normal,inline:Ua.normal};this.options.pedantic?(a.block=ps.pedantic,a.inline=Ua.pedantic):this.options.gfm&&(a.block=ps.gfm,this.options.breaks?a.inline=Ua.breaks:a.inline=Ua.gfm),this.tokenizer.rules=a}static get rules(){return{block:ps,inline:Ua}}static lex(e,a){return new Ys(a).lex(e)}static lexInline(e,a){return new Ys(a).inlineTokens(e)}lex(e){e=e.replace(bt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let a=0;a<this.inlineQueue.length;a++){let r=this.inlineQueue[a];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,a=[],r=!1){for(this.options.pedantic&&(e=e.replace(bt.tabCharGlobal,"    ").replace(bt.spaceLine,""));e;){let n;if(this.options.extensions?.block?.some(i=>(n=i.call({lexer:this},e,a))?(e=e.substring(n.raw.length),a.push(n),!0):!1))continue;if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length);let i=a.at(-1);n.raw.length===1&&i!==void 0?i.raw+=`
`:a.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length);let i=a.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+n.raw,i.text+=`
`+n.text,this.inlineQueue.at(-1).src=i.text):a.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),a.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),a.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),a.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),a.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),a.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),a.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length);let i=a.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+n.raw,i.text+=`
`+n.raw,this.inlineQueue.at(-1).src=i.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title},a.push(n));continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),a.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),a.push(n);continue}let l=e;if(this.options.extensions?.startBlock){let i=1/0,u=e.slice(1),v;this.options.extensions.startBlock.forEach(d=>{v=d.call({lexer:this},u),typeof v=="number"&&v>=0&&(i=Math.min(i,v))}),i<1/0&&i>=0&&(l=e.substring(0,i+1))}if(this.state.top&&(n=this.tokenizer.paragraph(l))){let i=a.at(-1);r&&i?.type==="paragraph"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+n.raw,i.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):a.push(n),r=l.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length);let i=a.at(-1);i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+n.raw,i.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):a.push(n);continue}if(e){let i="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(i);break}else throw new Error(i)}}return this.state.top=!0,a}inline(e,a=[]){return this.inlineQueue.push({src:e,tokens:a}),a}inlineTokens(e,a=[]){let r=e,n=null;if(this.tokens.links){let v=Object.keys(this.tokens.links);if(v.length>0)for(;(n=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)v.includes(n[0].slice(n[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(n=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,n.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let l;for(;(n=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)l=n[2]?n[2].length:0,r=r.slice(0,n.index+l)+"["+"a".repeat(n[0].length-l-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=this.options.hooks?.emStrongMask?.call({lexer:this},r)??r;let i=!1,u="";for(;e;){i||(u=""),i=!1;let v;if(this.options.extensions?.inline?.some(p=>(v=p.call({lexer:this},e,a))?(e=e.substring(v.raw.length),a.push(v),!0):!1))continue;if(v=this.tokenizer.escape(e)){e=e.substring(v.raw.length),a.push(v);continue}if(v=this.tokenizer.tag(e)){e=e.substring(v.raw.length),a.push(v);continue}if(v=this.tokenizer.link(e)){e=e.substring(v.raw.length),a.push(v);continue}if(v=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(v.raw.length);let p=a.at(-1);v.type==="text"&&p?.type==="text"?(p.raw+=v.raw,p.text+=v.text):a.push(v);continue}if(v=this.tokenizer.emStrong(e,r,u)){e=e.substring(v.raw.length),a.push(v);continue}if(v=this.tokenizer.codespan(e)){e=e.substring(v.raw.length),a.push(v);continue}if(v=this.tokenizer.br(e)){e=e.substring(v.raw.length),a.push(v);continue}if(v=this.tokenizer.del(e)){e=e.substring(v.raw.length),a.push(v);continue}if(v=this.tokenizer.autolink(e)){e=e.substring(v.raw.length),a.push(v);continue}if(!this.state.inLink&&(v=this.tokenizer.url(e))){e=e.substring(v.raw.length),a.push(v);continue}let d=e;if(this.options.extensions?.startInline){let p=1/0,b=e.slice(1),h;this.options.extensions.startInline.forEach(m=>{h=m.call({lexer:this},b),typeof h=="number"&&h>=0&&(p=Math.min(p,h))}),p<1/0&&p>=0&&(d=e.substring(0,p+1))}if(v=this.tokenizer.inlineText(d)){e=e.substring(v.raw.length),v.raw.slice(-1)!=="_"&&(u=v.raw.slice(-1)),i=!0;let p=a.at(-1);p?.type==="text"?(p.raw+=v.raw,p.text+=v.text):a.push(v);continue}if(e){let p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return a}},ws=class{options;parser;constructor(t){this.options=t||Ea}space(t){return""}code({text:t,lang:e,escaped:a}){let r=(e||"").match(bt.notSpaceStart)?.[0],n=t.replace(bt.endingNewline,"")+`
`;return r?'<pre><code class="language-'+Vt(r)+'">'+(a?n:Vt(n,!0))+`</code></pre>
`:"<pre><code>"+(a?n:Vt(n,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,a=t.start,r="";for(let i=0;i<t.items.length;i++){let u=t.items[i];r+=this.listitem(u)}let n=e?"ol":"ul",l=e&&a!==1?' start="'+a+'"':"";return"<"+n+l+`>
`+r+"</"+n+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",a="";for(let n=0;n<t.header.length;n++)a+=this.tablecell(t.header[n]);e+=this.tablerow({text:a});let r="";for(let n=0;n<t.rows.length;n++){let l=t.rows[n];a="";for(let i=0;i<l.length;i++)a+=this.tablecell(l[i]);r+=this.tablerow({text:a})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),a=t.header?"th":"td";return(t.align?`<${a} align="${t.align}">`:`<${a}>`)+e+`</${a}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${Vt(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:a}){let r=this.parser.parseInline(a),n=Bn(t);if(n===null)return r;t=n;let l='<a href="'+t+'"';return e&&(l+=' title="'+Vt(e)+'"'),l+=">"+r+"</a>",l}image({href:t,title:e,text:a,tokens:r}){r&&(a=this.parser.parseInline(r,this.parser.textRenderer));let n=Bn(t);if(n===null)return Vt(a);t=n;let l=`<img src="${t}" alt="${a}"`;return e&&(l+=` title="${Vt(e)}"`),l+=">",l}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:Vt(t.text)}},yn=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},Rt=class Xs{options;renderer;textRenderer;constructor(e){this.options=e||Ea,this.options.renderer=this.options.renderer||new ws,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new yn}static parse(e,a){return new Xs(a).parse(e)}static parseInline(e,a){return new Xs(a).parseInline(e)}parse(e){let a="";for(let r=0;r<e.length;r++){let n=e[r];if(this.options.extensions?.renderers?.[n.type]){let i=n,u=this.options.extensions.renderers[i.type].call({parser:this},i);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(i.type)){a+=u||"";continue}}let l=n;switch(l.type){case"space":{a+=this.renderer.space(l);break}case"hr":{a+=this.renderer.hr(l);break}case"heading":{a+=this.renderer.heading(l);break}case"code":{a+=this.renderer.code(l);break}case"table":{a+=this.renderer.table(l);break}case"blockquote":{a+=this.renderer.blockquote(l);break}case"list":{a+=this.renderer.list(l);break}case"checkbox":{a+=this.renderer.checkbox(l);break}case"html":{a+=this.renderer.html(l);break}case"def":{a+=this.renderer.def(l);break}case"paragraph":{a+=this.renderer.paragraph(l);break}case"text":{a+=this.renderer.text(l);break}default:{let i='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return a}parseInline(e,a=this.renderer){let r="";for(let n=0;n<e.length;n++){let l=e[n];if(this.options.extensions?.renderers?.[l.type]){let u=this.options.extensions.renderers[l.type].call({parser:this},l);if(u!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(l.type)){r+=u||"";continue}}let i=l;switch(i.type){case"escape":{r+=a.text(i);break}case"html":{r+=a.html(i);break}case"link":{r+=a.link(i);break}case"image":{r+=a.image(i);break}case"checkbox":{r+=a.checkbox(i);break}case"strong":{r+=a.strong(i);break}case"em":{r+=a.em(i);break}case"codespan":{r+=a.codespan(i);break}case"br":{r+=a.br(i);break}case"del":{r+=a.del(i);break}case"text":{r+=a.text(i);break}default:{let u='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return r}},Wa=class{options;block;constructor(t){this.options=t||Ea}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?zt.lex:zt.lexInline}provideParser(){return this.block?Rt.parse:Rt.parseInline}},ic=class{defaults=dn();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Rt;Renderer=ws;TextRenderer=yn;Lexer=zt;Tokenizer=ys;Hooks=Wa;constructor(...t){this.use(...t)}walkTokens(t,e){let a=[];for(let r of t)switch(a=a.concat(e.call(this,r)),r.type){case"table":{let n=r;for(let l of n.header)a=a.concat(this.walkTokens(l.tokens,e));for(let l of n.rows)for(let i of l)a=a.concat(this.walkTokens(i.tokens,e));break}case"list":{let n=r;a=a.concat(this.walkTokens(n.items,e));break}default:{let n=r;this.defaults.extensions?.childTokens?.[n.type]?this.defaults.extensions.childTokens[n.type].forEach(l=>{let i=n[l].flat(1/0);a=a.concat(this.walkTokens(i,e))}):n.tokens&&(a=a.concat(this.walkTokens(n.tokens,e)))}}return a}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(a=>{let r={...a};if(r.async=this.defaults.async||r.async||!1,a.extensions&&(a.extensions.forEach(n=>{if(!n.name)throw new Error("extension name required");if("renderer"in n){let l=e.renderers[n.name];l?e.renderers[n.name]=function(...i){let u=n.renderer.apply(this,i);return u===!1&&(u=l.apply(this,i)),u}:e.renderers[n.name]=n.renderer}if("tokenizer"in n){if(!n.level||n.level!=="block"&&n.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let l=e[n.level];l?l.unshift(n.tokenizer):e[n.level]=[n.tokenizer],n.start&&(n.level==="block"?e.startBlock?e.startBlock.push(n.start):e.startBlock=[n.start]:n.level==="inline"&&(e.startInline?e.startInline.push(n.start):e.startInline=[n.start]))}"childTokens"in n&&n.childTokens&&(e.childTokens[n.name]=n.childTokens)}),r.extensions=e),a.renderer){let n=this.defaults.renderer||new ws(this.defaults);for(let l in a.renderer){if(!(l in n))throw new Error(`renderer '${l}' does not exist`);if(["options","parser"].includes(l))continue;let i=l,u=a.renderer[i],v=n[i];n[i]=(...d)=>{let p=u.apply(n,d);return p===!1&&(p=v.apply(n,d)),p||""}}r.renderer=n}if(a.tokenizer){let n=this.defaults.tokenizer||new ys(this.defaults);for(let l in a.tokenizer){if(!(l in n))throw new Error(`tokenizer '${l}' does not exist`);if(["options","rules","lexer"].includes(l))continue;let i=l,u=a.tokenizer[i],v=n[i];n[i]=(...d)=>{let p=u.apply(n,d);return p===!1&&(p=v.apply(n,d)),p}}r.tokenizer=n}if(a.hooks){let n=this.defaults.hooks||new Wa;for(let l in a.hooks){if(!(l in n))throw new Error(`hook '${l}' does not exist`);if(["options","block"].includes(l))continue;let i=l,u=a.hooks[i],v=n[i];Wa.passThroughHooks.has(l)?n[i]=d=>{if(this.defaults.async&&Wa.passThroughHooksRespectAsync.has(l))return(async()=>{let b=await u.call(n,d);return v.call(n,b)})();let p=u.call(n,d);return v.call(n,p)}:n[i]=(...d)=>{if(this.defaults.async)return(async()=>{let b=await u.apply(n,d);return b===!1&&(b=await v.apply(n,d)),b})();let p=u.apply(n,d);return p===!1&&(p=v.apply(n,d)),p}}r.hooks=n}if(a.walkTokens){let n=this.defaults.walkTokens,l=a.walkTokens;r.walkTokens=function(i){let u=[];return u.push(l.call(this,i)),n&&(u=u.concat(n.call(this,i))),u}}this.defaults={...this.defaults,...r}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return zt.lex(t,e??this.defaults)}parser(t,e){return Rt.parse(t,e??this.defaults)}parseMarkdown(t){return(e,a)=>{let r={...a},n={...this.defaults,...r},l=this.onError(!!n.silent,!!n.async);if(this.defaults.async===!0&&r.async===!1)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(n.hooks&&(n.hooks.options=n,n.hooks.block=t),n.async)return(async()=>{let i=n.hooks?await n.hooks.preprocess(e):e,u=await(n.hooks?await n.hooks.provideLexer():t?zt.lex:zt.lexInline)(i,n),v=n.hooks?await n.hooks.processAllTokens(u):u;n.walkTokens&&await Promise.all(this.walkTokens(v,n.walkTokens));let d=await(n.hooks?await n.hooks.provideParser():t?Rt.parse:Rt.parseInline)(v,n);return n.hooks?await n.hooks.postprocess(d):d})().catch(l);try{n.hooks&&(e=n.hooks.preprocess(e));let i=(n.hooks?n.hooks.provideLexer():t?zt.lex:zt.lexInline)(e,n);n.hooks&&(i=n.hooks.processAllTokens(i)),n.walkTokens&&this.walkTokens(i,n.walkTokens);let u=(n.hooks?n.hooks.provideParser():t?Rt.parse:Rt.parseInline)(i,n);return n.hooks&&(u=n.hooks.postprocess(u)),u}catch(i){return l(i)}}}onError(t,e){return a=>{if(a.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let r="<p>An error occurred:</p><pre>"+Vt(a.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(a);throw a}}},qa=new ic;function $e(t,e){return qa.parse(t,e)}$e.options=$e.setOptions=function(t){return qa.setOptions(t),$e.defaults=qa.defaults,Fr($e.defaults),$e};$e.getDefaults=dn;$e.defaults=Ea;$e.use=function(...t){return qa.use(...t),$e.defaults=qa.defaults,Fr($e.defaults),$e};$e.walkTokens=function(t,e){return qa.walkTokens(t,e)};$e.parseInline=qa.parseInline;$e.Parser=Rt;$e.parser=Rt.parse;$e.Renderer=ws;$e.TextRenderer=yn;$e.Lexer=zt;$e.lexer=zt.lex;$e.Tokenizer=ys;$e.Hooks=Wa;$e.parse=$e;$e.options;$e.setOptions;$e.use;$e.walkTokens;$e.parseInline;Rt.parse;zt.lex;var oc=k('<span class="author"> </span>'),cc=k('<span class="date"> </span>'),vc=k('<span class="tag-badge svelte-187zyvb"> </span>'),uc=k('<div class="tags-row svelte-187zyvb"></div>'),dc=k('<img class="svelte-187zyvb"/>'),fc=k('<div class="attachment-card svelte-187zyvb"><!> <a target="_blank" rel="noreferrer" class="svelte-187zyvb"> </a></div>'),pc=k('<div class="attachments svelte-187zyvb"><h3 class="svelte-187zyvb">Attachments</h3> <div class="grid svelte-187zyvb"></div></div>'),hc=k('<a target="_blank" rel="noreferrer" class="note-attachment-link svelte-187zyvb"> </a>'),_c=k('<div class="note-attachments svelte-187zyvb"><strong class="svelte-187zyvb">Attachments:</strong> <!></div>'),gc=k('<div class="note-card svelte-187zyvb"><div class="note-header svelte-187zyvb"><span> </span> <span class="note-author svelte-187zyvb"> </span> <span class="note-date svelte-187zyvb"> </span> <span> </span></div> <p class="note-text svelte-187zyvb"> </p> <!></div>'),mc=k('<div class="notes-section svelte-187zyvb"><h3 class="svelte-187zyvb">Notes</h3> <div class="notes-list svelte-187zyvb"></div></div>'),bc=k('<div class="document-view"><h2 class="svelte-187zyvb"> </h2> <div class="meta svelte-187zyvb"><span> </span> <span> </span> <span class="date"> </span> <!> <!></div> <!> <div class="content markdown-body svelte-187zyvb"><!></div> <!> <!></div>');function yc(t,e){Ye(e,!0);let a=Ze(()=>e.document&&e.document.content?$e.parse(e.document.content):"<p>No content available.</p>");var r=bc(),n=c(r),l=c(n),i=o(n,2),u=c(i),v=c(u),d=o(u,2),p=c(d),b=o(d,2),h=c(b),m=o(b,2);{var x=O=>{var H=oc(),Z=c(H);U(()=>T(Z,`By ${e.document.author??""}`)),g(O,H)};I(m,O=>{e.document?.author&&O(x)})}var S=o(m,2);{var w=O=>{var H=cc(),Z=c(H);U(()=>T(Z,`Done: ${e.document.done_date??""}`)),g(O,H)};I(S,O=>{e.document?.done_date&&O(w)})}var y=o(i,2);{var P=O=>{var H=uc();Ae(H,21,()=>e.document.tags,He,(Z,W)=>{var B=vc(),N=c(B);U(()=>T(N,`#${s(W).name??""}`)),g(Z,B)}),g(O,H)};I(y,O=>{e.document?.tags?.length>0&&O(P)})}var _=o(y,2),j=c(_);qi(j,()=>s(a));var R=o(_,2);{var A=O=>{var H=pc(),Z=o(c(H),2);Ae(Z,21,()=>e.document.attachments,He,(W,B)=>{var N=fc(),L=c(N);{var ie=be=>{var Y=dc();U(()=>{Ge(Y,"src",s(B).file_path),Ge(Y,"alt",s(B).filename)}),g(be,Y)};I(L,be=>{s(B).media_type&&s(B).media_type.startsWith("image/")&&be(ie)})}var le=o(L,2),de=c(le);U(()=>{Ge(le,"href",s(B).file_path),T(de,s(B).filename)}),g(W,N)}),g(O,H)};I(R,O=>{e.document?.attachments?.length>0&&O(A)})}var $=o(R,2);{var F=O=>{var H=mc(),Z=o(c(H),2);Ae(Z,21,()=>e.document.journal_entries,He,(W,B)=>{var N=gc(),L=c(N),ie=c(L),le=c(ie),de=o(ie,2),be=c(de),Y=o(de,2),G=c(Y),se=o(Y,2),X=c(se),C=o(L,2),Q=c(C),oe=o(C,2);{var ae=ye=>{var V=_c(),K=o(c(V),2);Ae(K,17,()=>s(B).attachments,He,(te,ne)=>{var D=hc(),ue=c(D);U(()=>{Ge(D,"href",s(ne).file_path),T(ue,`📎 ${s(ne).filename??""}`)}),g(te,D)}),g(ye,V)};I(oe,ye=>{s(B).attachments?.length>0&&ye(ae)})}U(()=>{ze(ie,1,`note-badge ${s(B).type??""}`,"svelte-187zyvb"),T(le,s(B).type),T(be,s(B).author||"Unknown"),T(G,s(B).created_at),ze(se,1,`note-status ${s(B).status??""}`,"svelte-187zyvb"),T(X,s(B).status),T(Q,s(B).text)}),g(W,N)}),g(O,H)};I($,O=>{e.document?.journal_entries?.length>0&&O(F)})}U(O=>{T(l,e.document?.name),ze(u,1,`badge ${e.document?.type??""}`,"svelte-187zyvb"),T(v,e.document?.type),ze(d,1,`badge status-${e.document?.status??""}`,"svelte-187zyvb"),T(p,O),T(h,e.document?.registration_date)},[()=>e.document?.status.replace("_"," ")]),g(t,r),Xe()}var wc=k('<input type="text" class="edit-input svelte-1b0y5ne"/>'),kc=k('<button class="btn-icon svelte-1b0y5ne" title="Save">✓</button> <button class="btn-icon svelte-1b0y5ne" title="Cancel">✕</button>',1),xc=k('<button class="btn-icon svelte-1b0y5ne" title="Edit">✏️</button> <button class="btn-icon delete svelte-1b0y5ne" title="Delete">🗑️</button>',1),Sc=k('<tr class="svelte-1b0y5ne"><td class="svelte-1b0y5ne"><!></td><td class="svelte-1b0y5ne"><!></td></tr>'),qc=k('<div class="empty-state svelte-1b0y5ne">No materials yet. Add one above.</div>'),Tc=k('<div class="modal-overlay svelte-1b0y5ne"><div class="modal-content svelte-1b0y5ne"><div class="modal-header svelte-1b0y5ne"><h3 class="svelte-1b0y5ne">Material Library</h3> <button class="close-btn svelte-1b0y5ne">&times;</button></div> <div class="modal-body svelte-1b0y5ne"><div class="add-section svelte-1b0y5ne"><input type="text" placeholder="New material name..." class="svelte-1b0y5ne"/> <button class="btn-add svelte-1b0y5ne">Add</button></div> <table class="materials-table svelte-1b0y5ne"><thead><tr><th class="svelte-1b0y5ne">Name</th><th class="svelte-1b0y5ne">Actions</th></tr></thead><tbody></tbody></table> <!></div></div></div>');function jc(t,e){Ye(e,!0);let a=q(ke([])),r=q(""),n=q(null),l=q("");async function i(){e.isOpen&&f(a,await ja(),!0)}Lt(()=>{i()});async function u(){if(s(r).trim())try{await Ji({name:s(r).trim()}),f(r,""),await i()}catch(S){console.error(S),alert("Failed to add material")}}function v(S){f(n,S.id,!0),f(l,S.name,!0)}async function d(){if(!(!s(l).trim()||s(n)===null))try{await Qi(s(n),s(l).trim()),f(n,null),f(l,""),await i()}catch(S){console.error(S),alert("Failed to update material")}}function p(){f(n,null),f(l,"")}async function b(S){if(confirm("Delete this material?"))try{await Ki(S),await i()}catch(w){console.error(w),alert("Failed to delete material")}}var h=Le(),m=qe(h);{var x=S=>{var w=Tc();w.__click=function(...W){e.close?.apply(this,W)};var y=c(w);y.__click=W=>W.stopPropagation();var P=c(y),_=o(c(P),2);_.__click=function(...W){e.close?.apply(this,W)};var j=o(P,2),R=c(j),A=c(R);A.__keydown=W=>W.key==="Enter"&&u();var $=o(A,2);$.__click=u;var F=o(R,2),O=o(c(F));Ae(O,21,()=>s(a),W=>W.id,(W,B)=>{var N=Sc(),L=c(N),ie=c(L);{var le=X=>{var C=wc();hr(C),C.__keydown=Q=>{Q.key==="Enter"&&d(),Q.key==="Escape"&&p()},Te(C,()=>s(l),Q=>f(l,Q)),g(X,C)},de=X=>{var C=mi();U(()=>T(C,s(B).name)),g(X,C)};I(ie,X=>{s(n)===s(B).id?X(le):X(de,!1)})}var be=o(L),Y=c(be);{var G=X=>{var C=kc(),Q=qe(C);Q.__click=d;var oe=o(Q,2);oe.__click=p,g(X,C)},se=X=>{var C=xc(),Q=qe(C);Q.__click=()=>v(s(B));var oe=o(Q,2);oe.__click=()=>b(s(B).id),g(X,C)};I(Y,X=>{s(n)===s(B).id?X(G):X(se,!1)})}g(W,N)});var H=o(F,2);{var Z=W=>{var B=qc();g(W,B)};I(H,W=>{s(a).length===0&&W(Z)})}Te(A,()=>s(r),W=>f(r,W)),g(S,w)};I(m,S=>{e.isOpen&&S(x)})}g(t,h),Xe()}Qe(["click","keydown"]);var Ec=k("<option> </option>"),Pc=k('<div class="modal-overlay svelte-1iwbfq1"><div class="modal-content svelte-1iwbfq1"><div class="modal-header svelte-1iwbfq1"><h3 class="svelte-1iwbfq1">Add Task</h3> <button class="close-btn svelte-1iwbfq1">&times;</button></div> <form class="modal-body svelte-1iwbfq1"><div class="form-group svelte-1iwbfq1"><label for="name" class="svelte-1iwbfq1">Task Name</label> <input id="name" type="text" placeholder="Enter task name..." required class="svelte-1iwbfq1"/></div> <div class="form-group svelte-1iwbfq1"><label for="material" class="svelte-1iwbfq1">Material</label> <div class="material-row svelte-1iwbfq1"><select id="material" class="material-select svelte-1iwbfq1"><option>-- No Material --</option><!></select> <button type="button" class="btn-library svelte-1iwbfq1" title="Edit Material Library">📚</button></div></div> <div class="form-group svelte-1iwbfq1"><label for="gnc_path" class="svelte-1iwbfq1">GNC File Path</label> <input id="gnc_path" type="text" placeholder="e.g. Z:\\Sidra\\Part1.gnc" class="svelte-1iwbfq1"/></div> <div class="form-group svelte-1iwbfq1"><label for="assignee" class="svelte-1iwbfq1">Assignee</label> <input id="assignee" type="text" placeholder="Enter assignee name..." class="svelte-1iwbfq1"/></div> <div class="actions svelte-1iwbfq1"><button type="button" class="btn-secondary svelte-1iwbfq1">Cancel</button> <button type="submit" class="btn-primary svelte-1iwbfq1"> </button></div></form></div></div>'),Cc=k("<!> <!>",1);function Ac(t,e){Ye(e,!0);let a=q(""),r=q(""),n=q(null),l=q(""),i=q(!1),u=q(ke([])),v=q(!1);async function d(){f(u,await ja(),!0)}Lt(()=>{e.isOpen&&(f(r,localStorage.getItem("task_assignee")||"",!0),f(a,""),f(n,null),f(l,""),d())});async function p(y){if(y.preventDefault(),!!s(a)){f(i,!0);try{s(r)&&localStorage.setItem("task_assignee",s(r)),await e.onSubmit({name:s(a),assignee:s(r),material_id:s(n),gnc_file_path:s(l)}),e.close()}catch(P){console.error(P),alert("Failed to add task")}finally{f(i,!1)}}}function b(){f(v,!0)}function h(){f(v,!1),d()}var m=Cc(),x=qe(m);{var S=y=>{var P=Pc();P.__click=function(...X){e.close?.apply(this,X)};var _=c(P);_.__click=X=>X.stopPropagation();var j=c(_),R=o(c(j),2);R.__click=function(...X){e.close?.apply(this,X)};var A=o(j,2),$=c(A),F=o(c($),2);hr(F);var O=o($,2),H=o(c(O),2),Z=c(H),W=c(Z);W.value=(W.__value=null)??"";var B=o(W);Ae(B,17,()=>s(u),He,(X,C)=>{var Q=Ec(),oe=c(Q),ae={};U(()=>{T(oe,s(C).name),ae!==(ae=s(C).id)&&(Q.value=(Q.__value=s(C).id)??"")}),g(X,Q)});var N=o(Z,2);N.__click=b;var L=o(O,2),ie=o(c(L),2),le=o(L,2),de=o(c(le),2),be=o(le,2),Y=c(be);Y.__click=function(...X){e.close?.apply(this,X)};var G=o(Y,2),se=c(G);U(()=>{G.disabled=s(i),T(se,s(i)?"Adding...":"Add Task")}),aa("submit",A,p),Te(F,()=>s(a),X=>f(a,X)),ct(Z,()=>s(n),X=>f(n,X)),Te(ie,()=>s(l),X=>f(l,X)),Te(de,()=>s(r),X=>f(r,X)),g(y,P)};I(x,y=>{e.isOpen&&y(S)})}var w=o(x,2);jc(w,{get isOpen(){return s(v)},close:h}),g(t,m),Xe()}Qe(["click"]);var Dc=k('<div class="material-group-header svelte-ty272s"><span class="material-group-name svelte-ty272s"> </span> <span class="material-group-count svelte-ty272s"> </span></div>'),zc=k('<span class="material-badge svelte-ty272s"> </span>'),Rc=k('<div class="task-item svelte-ty272s"><div class="task-line-1 svelte-ty272s"><span> </span> <button class="delete-btn svelte-ty272s" title="Delete">×</button></div> <div class="task-line-2 svelte-ty272s"><select><option>Planned</option><option>Pending</option><option>Done</option></select> <!> <input type="text" class="assignee-input svelte-ty272s" placeholder="Assignee"/></div></div>'),Mc=k("<!> <!>",1),Ic=k('<div class="empty-tasks svelte-ty272s"> </div>'),Lc=k('<div class="embedded-tasks svelte-ty272s"><div class="tasks-header svelte-ty272s"><h4 class="svelte-ty272s">Tasks</h4> <div class="header-actions svelte-ty272s"><button class="group-toggle-btn svelte-ty272s"> </button> <select class="filter-select svelte-ty272s"><option>Hide Done</option><option>Show All</option><option>Pending</option></select> <button class="add-task-btn svelte-ty272s">+ Add</button></div></div> <div class="tasks-list svelte-ty272s"><!> <!></div></div> <!>',1);function Oc(t,e){Ye(e,!0);let a=lt(e,"filterAssignee",3,""),r=q(ke(e.document.tasks||[])),n=q("hide_done"),l=q(!1),i=q(!0),u=Ze(()=>[...s(r)].sort((N,L)=>N.status==="done"&&L.status!=="done"?1:N.status!=="done"&&L.status==="done"?-1:0)),v=Ze(()=>s(u).filter(N=>{if(s(n)==="hide_done"&&N.status==="done"||s(n)==="pending"&&N.status!=="pending")return!1;if(s(n)==="all"){if(a()&&a().trim()){const L=(N.assignee||"").toLowerCase(),ie=a().toLowerCase();return L.includes(ie)}return!0}if(a()&&a().trim()){const L=(N.assignee||"").toLowerCase(),ie=a().toLowerCase();if(!L.includes(ie))return!1}return!0})),d=Ze(()=>()=>{if(!s(i))return{"All Tasks":s(v)};const N={};s(v).forEach(le=>{const de=le.material?le.material.name:"(No Material)";N[de]||(N[de]=[]),N[de].push(le)});const L={};return Object.keys(N).sort((le,de)=>le==="(No Material)"?1:de==="(No Material)"?-1:le.localeCompare(de)).forEach(le=>{L[le]=N[le]}),L});async function p(N,L){try{N.status=L,await Gs(N.id,{status:L}),e.refresh()}catch(ie){console.error(ie)}}async function b(N,L){try{await Gs(N.id,{assignee:L})}catch(ie){console.error(ie)}}async function h(N){if(confirm("Delete task?"))try{await Vi(N),f(r,s(r).filter(L=>L.id!==N),!0),e.refresh()}catch(L){console.error(L)}}async function m(N){try{const L=await Xi(e.document.id,{name:N.name,assignee:N.assignee,status:"planned",material_id:N.material_id});f(r,[...s(r),L],!0),e.refresh()}catch(L){throw console.error(L),L}}var x=Lc(),S=qe(x),w=c(S),y=o(c(w),2),P=c(y);P.__click=()=>f(i,!s(i));var _=c(P),j=o(P,2),R=c(j);R.value=R.__value="hide_done";var A=o(R);A.value=A.__value="all";var $=o(A);$.value=$.__value="pending";var F=o(j,2);F.__click=()=>f(l,!0);var O=o(w,2),H=c(O);Ae(H,17,()=>Object.entries(s(d)()),([N,L])=>N,(N,L)=>{var ie=Ze(()=>Ws(s(L),2));let le=()=>s(ie)[0],de=()=>s(ie)[1];var be=Mc(),Y=qe(be);{var G=X=>{var C=Dc(),Q=c(C),oe=c(Q),ae=o(Q,2),ye=c(ae);U(()=>{T(oe,le()),T(ye,`(${de().length??""})`)}),g(X,C)};I(Y,X=>{s(i)&&Object.keys(s(d)()).length>1&&X(G)})}var se=o(Y,2);Ae(se,17,de,X=>X.id,(X,C,Q)=>{var oe=Rc(),ae=c(oe),ye=c(ae),V=c(ye),K=o(ye,2);K.__click=()=>h(s(C).id);var te=o(ae,2),ne=c(te);ne.__change=ve=>p(s(C),ve.target.value);var D=c(ne);D.value=D.__value="planned";var ue=o(D);ue.value=ue.__value="pending";var re=o(ue);re.value=re.__value="done";var pe;rn(ne);var ce=o(ne,2);{var he=ve=>{var z=zc(),_e=c(z);U(()=>{Ge(z,"title",`Material: ${s(C).material.name??""}`),T(_e,`📦 ${s(C).material.name??""}`)}),g(ve,z)};I(ce,ve=>{s(C).material&&ve(he)})}var fe=o(ce,2);fe.__change=()=>b(s(C),s(C).assignee),U(()=>{ze(ye,1,`task-name ${s(C).status==="done"?"done-text":""}`,"svelte-ty272s"),T(V,s(C).name),ze(ne,1,`status-select ${s(C).status??""}`,"svelte-ty272s"),pe!==(pe=s(C).status)&&(ne.value=(ne.__value=s(C).status)??"",js(ne,s(C).status))}),Te(fe,()=>s(C).assignee,ve=>s(C).assignee=ve),g(X,oe)}),g(N,be)});var Z=o(H,2);{var W=N=>{var L=Ic(),ie=c(L);U(()=>T(ie,s(r).length>0?"No tasks match filter.":"No tasks yet.")),g(N,L)};I(Z,N=>{s(v).length===0&&N(W)})}var B=o(S,2);Ac(B,{get isOpen(){return s(l)},close:()=>f(l,!1),onSubmit:m}),U(()=>{Ge(P,"title",s(i)?"Show flat list":"Group by material"),T(_,s(i)?"📦":"📋")}),ct(j,()=>s(n),N=>f(n,N)),g(t,x),Xe()}Qe(["click","change"]);var Nc=k('<p class="upload-status svelte-1yijx0t">Uploading...</p>'),$c=k('<div class="attachment-item svelte-1yijx0t"><span class="attachment-name svelte-1yijx0t"> </span> <button type="button" class="remove-btn svelte-1yijx0t">×</button></div>'),Fc=k('<div class="attachments-list svelte-1yijx0t"></div>'),Bc=k('<div class="modal-overlay svelte-1yijx0t"><div class="modal-content svelte-1yijx0t"><div class="modal-header svelte-1yijx0t"><h3 class="svelte-1yijx0t"> </h3> <button class="close-btn svelte-1yijx0t">&times;</button></div> <form class="modal-body svelte-1yijx0t"><div class="form-group svelte-1yijx0t"><label for="author" class="svelte-1yijx0t">Author</label> <input id="author" type="text" placeholder="Your Name" class="svelte-1yijx0t"/></div> <div class="form-group svelte-1yijx0t"><label for="type" class="svelte-1yijx0t">Type</label> <select id="type" class="svelte-1yijx0t"><option>Info</option><option>Warning</option><option>Error</option></select></div> <div class="form-group svelte-1yijx0t"><label for="text" class="svelte-1yijx0t">Message</label> <textarea id="text" required rows="4" class="svelte-1yijx0t"></textarea></div> <div class="form-group svelte-1yijx0t"><label for="attachments" class="svelte-1yijx0t">Attachments</label> <div class="file-upload-wrapper svelte-1yijx0t"><input id="attachments" type="file" multiple class="svelte-1yijx0t"/> <!></div> <!></div> <div class="actions svelte-1yijx0t"><button type="button" class="btn-secondary svelte-1yijx0t">Cancel</button> <button type="submit" class="btn-primary svelte-1yijx0t"> </button></div></form></div></div>');function Qr(t,e){Ye(e,!0);let a=lt(e,"entry",3,null),r=q(""),n=q("info"),l=q(""),i=q(!1),u=q(ke([])),v=q(!1);Lt(()=>{e.isOpen&&(a()?(f(r,a().text||"",!0),f(n,a().type||"info",!0),f(l,a().author||"",!0),f(u,a().attachments||[],!0)):(f(l,localStorage.getItem("journal_author")||"",!0),f(r,""),f(n,"info"),f(u,[],!0)))});async function d(S){const w=Array.from(S.target.files);if(w.length!==0){f(v,!0);try{for(const y of w){const P=await cn(y);s(u).push({file_path:P.file_path,filename:P.filename,media_type:P.media_type})}}catch(y){console.error("Upload failed",y),alert("Failed to upload attachment")}finally{f(v,!1),S.target.value=""}}}function p(S){s(u).splice(S,1)}async function b(S){S.preventDefault(),f(i,!0),s(l)&&localStorage.setItem("journal_author",s(l));try{const w={text:s(r),type:s(n),status:a()?.status||"pending",author:s(l),document_id:e.documentId,attachments:s(u)};a()?await un(a().id,w):await $r(w),window.dispatchEvent(new CustomEvent("journal-entries-updated")),e.close()}catch(w){console.error(w),alert(a()?"Failed to update note":"Failed to create note")}finally{f(i,!1)}}var h=Le(),m=qe(h);{var x=S=>{var w=Bc();w.__click=function(...ae){e.close?.apply(this,ae)};var y=c(w);y.__click=ae=>ae.stopPropagation();var P=c(y),_=c(P),j=c(_),R=o(_,2);R.__click=function(...ae){e.close?.apply(this,ae)};var A=o(P,2),$=c(A),F=o(c($),2),O=o($,2),H=o(c(O),2),Z=c(H);Z.value=Z.__value="info";var W=o(Z);W.value=W.__value="warning";var B=o(W);B.value=B.__value="error";var N=o(O,2),L=o(c(N),2),ie=o(N,2),le=o(c(ie),2),de=c(le);de.__change=d;var be=o(de,2);{var Y=ae=>{var ye=Nc();g(ae,ye)};I(be,ae=>{s(v)&&ae(Y)})}var G=o(le,2);{var se=ae=>{var ye=Fc();Ae(ye,21,()=>s(u),He,(V,K,te)=>{var ne=$c(),D=c(ne),ue=c(D),re=o(D,2);re.__click=()=>p(te),U(()=>T(ue,s(K).filename)),g(V,ne)}),g(ae,ye)};I(G,ae=>{s(u).length>0&&ae(se)})}var X=o(ie,2),C=c(X);C.__click=function(...ae){e.close?.apply(this,ae)};var Q=o(C,2),oe=c(Q);U(()=>{T(j,a()?"Edit Note":`Add Note to ${e.documentName}`),de.disabled=s(v),Q.disabled=s(i),T(oe,s(i)?"Saving...":a()?"Update Note":"Add Note")}),aa("submit",A,b),Te(F,()=>s(l),ae=>f(l,ae)),ct(H,()=>s(n),ae=>f(n,ae)),Te(L,()=>s(r),ae=>f(r,ae)),g(S,w)};I(m,S=>{e.isOpen&&S(x)})}g(t,h),Xe()}Qe(["click","change"]);var Gc=k('<img class="svelte-jm2ier"/>'),Uc=k('<div class="file-placeholder svelte-jm2ier"><span> </span> <a target="_blank" rel="noreferrer">Download</a></div>'),Hc=k('<div class="image-wrapper svelte-jm2ier"><!></div>'),Yc=k('<div class="modal-overlay svelte-jm2ier"><div class="modal-content svelte-jm2ier"><button class="close-btn svelte-jm2ier">&times;</button> <div class="gallery svelte-jm2ier"></div></div></div>');function Kr(t,e){var a=Le(),r=qe(a);{var n=l=>{var i=Yc();i.__click=function(...p){e.close?.apply(this,p)};var u=c(i);u.__click=p=>p.stopPropagation();var v=c(u);v.__click=function(...p){e.close?.apply(this,p)};var d=o(v,2);Ae(d,21,()=>e.attachments,He,(p,b)=>{var h=Hc(),m=c(h);{var x=w=>{var y=Gc();U(()=>{Ge(y,"src",s(b).file_path),Ge(y,"alt",s(b).filename)}),g(w,y)},S=w=>{var y=Uc(),P=c(y),_=c(P),j=o(P,2);U(()=>{T(_,`📄 ${s(b).filename??""}`),Ge(j,"href",s(b).file_path)}),g(w,y)};I(m,w=>{s(b).media_type&&s(b).media_type.startsWith("image/")?w(x):w(S,!1)})}g(p,h)}),g(l,i)};I(r,l=>{e.isOpen&&l(n)})}g(t,a)}Qe(["click"]);var Xc=k("<option> </option>"),Vc=k('<div class="modal-overlay svelte-12q38jy"><div class="modal-content svelte-12q38jy"><div class="modal-header svelte-12q38jy"><h3 class="svelte-12q38jy">🔍 Filter Documents</h3> <button class="close-btn svelte-12q38jy">&times;</button></div> <div class="modal-body svelte-12q38jy"><div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Document Type</h4> <select class="filter-input svelte-12q38jy"><option>All Types</option><option>Plan</option><option>Mail</option><option>Other</option></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Status</h4> <select class="filter-input svelte-12q38jy"><option>All Statuses</option><option>In Progress</option><option>Done</option></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Tag</h4> <input type="text" placeholder="Filter by tag..." class="filter-input svelte-12q38jy"/></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Assignee</h4> <input type="text" placeholder="Filter by assignee..." class="filter-input svelte-12q38jy"/></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Material</h4> <select class="filter-input svelte-12q38jy"><option>All Materials</option><!></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Task Types (Show documents with these task types)</h4> <div class="checkbox-group svelte-12q38jy"><label class="checkbox-label svelte-12q38jy"><input type="checkbox" class="svelte-12q38jy"/> <span class="checkbox-text svelte-12q38jy">Planned</span></label> <label class="checkbox-label svelte-12q38jy"><input type="checkbox" class="svelte-12q38jy"/> <span class="checkbox-text svelte-12q38jy">Pending</span></label> <label class="checkbox-label svelte-12q38jy"><input type="checkbox" class="svelte-12q38jy"/> <span class="checkbox-text svelte-12q38jy">Done</span></label></div></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Date Range</h4> <select class="filter-input svelte-12q38jy"><option>Registration Date</option><option>Done Date</option></select> <div class="date-range svelte-12q38jy"><input type="date" class="filter-input svelte-12q38jy" placeholder="Start Date"/> <span class="date-separator svelte-12q38jy">to</span> <input type="date" class="filter-input svelte-12q38jy" placeholder="End Date"/></div></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Sort By</h4> <div class="sort-controls svelte-12q38jy"><select class="filter-input svelte-12q38jy"><option>Date</option><option>Name</option><option>Author</option><option>Status</option><option>Done Date</option></select> <button class="sort-order-btn svelte-12q38jy" title="Toggle sort order"> </button></div></div></div> <div class="modal-footer svelte-12q38jy"><button class="btn-secondary svelte-12q38jy">Reset All</button> <button class="btn-primary svelte-12q38jy">Apply Filters</button></div></div></div>');function Wc(t,e){Ye(e,!0);let a=q(ke({filterType:"",filterStatus:"",filterTag:"",filterAssignee:"",filterMaterial:"",filterTaskTypes:[],startDate:"",endDate:"",dateField:"registration_date",sortBy:"registration_date",sortOrder:"desc"})),r=q(ke([])),n=!1;Lt(()=>{e.isOpen&&!n&&(e.filters&&(f(a,{...e.filters},!0),Array.isArray(s(a).filterTaskTypes)||(s(a).filterTaskTypes=[])),l()),n=e.isOpen});async function l(){try{f(r,await ja(),!0)}catch(h){console.error("Failed to load materials",h)}}function i(){e.onApply(s(a)),e.close()}function u(){f(a,{filterType:"",filterStatus:"",filterTag:"",filterAssignee:"",filterMaterial:"",filterTaskTypes:[],startDate:"",endDate:"",dateField:"registration_date",sortBy:"registration_date",sortOrder:"desc"},!0)}function v(h){s(a).filterTaskTypes.includes(h)?s(a).filterTaskTypes=s(a).filterTaskTypes.filter(m=>m!==h):s(a).filterTaskTypes=[...s(a).filterTaskTypes,h]}var d=Le(),p=qe(d);{var b=h=>{var m=Vc();m.__click=function(...ge){e.close?.apply(this,ge)};var x=c(m);x.__click=ge=>ge.stopPropagation();var S=c(x),w=o(c(S),2);w.__click=function(...ge){e.close?.apply(this,ge)};var y=o(S,2),P=c(y),_=o(c(P),2),j=c(_);j.value=j.__value="";var R=o(j);R.value=R.__value="plan";var A=o(R);A.value=A.__value="mail";var $=o(A);$.value=$.__value="other";var F=o(P,2),O=o(c(F),2),H=c(O);H.value=H.__value="";var Z=o(H);Z.value=Z.__value="in_progress";var W=o(Z);W.value=W.__value="done";var B=o(F,2),N=o(c(B),2),L=o(B,2),ie=o(c(L),2),le=o(L,2),de=o(c(le),2),be=c(de);be.value=be.__value="";var Y=o(be);Ae(Y,17,()=>s(r),He,(ge,me)=>{var Oe=Xc(),Be=c(Oe),De={};U(()=>{T(Be,s(me).name),De!==(De=s(me).id)&&(Oe.value=(Oe.__value=s(me).id)??"")}),g(ge,Oe)});var G=o(le,2),se=o(c(G),2),X=c(se),C=c(X);C.__change=()=>v("planned");var Q=o(X,2),oe=c(Q);oe.__change=()=>v("pending");var ae=o(Q,2),ye=c(ae);ye.__change=()=>v("done");var V=o(G,2),K=o(c(V),2),te=c(K);te.value=te.__value="registration_date";var ne=o(te);ne.value=ne.__value="done_date";var D=o(K,2),ue=c(D),re=o(ue,4),pe=o(V,2),ce=o(c(pe),2),he=c(ce),fe=c(he);fe.value=fe.__value="registration_date";var ve=o(fe);ve.value=ve.__value="name";var z=o(ve);z.value=z.__value="author";var _e=o(z);_e.value=_e.__value="status";var xe=o(_e);xe.value=xe.__value="done_date";var M=o(he,2);M.__click=()=>s(a).sortOrder=s(a).sortOrder==="desc"?"asc":"desc";var E=c(M),ee=o(y,2),Se=c(ee);Se.__click=u;var Ce=o(Se,2);Ce.__click=i,U((ge,me,Oe)=>{Cs(C,ge),Cs(oe,me),Cs(ye,Oe),T(E,s(a).sortOrder==="desc"?"↓ Desc":"↑ Asc")},[()=>s(a).filterTaskTypes.includes("planned"),()=>s(a).filterTaskTypes.includes("pending"),()=>s(a).filterTaskTypes.includes("done")]),ct(_,()=>s(a).filterType,ge=>s(a).filterType=ge),ct(O,()=>s(a).filterStatus,ge=>s(a).filterStatus=ge),Te(N,()=>s(a).filterTag,ge=>s(a).filterTag=ge),Te(ie,()=>s(a).filterAssignee,ge=>s(a).filterAssignee=ge),ct(de,()=>s(a).filterMaterial,ge=>s(a).filterMaterial=ge),ct(K,()=>s(a).dateField,ge=>s(a).dateField=ge),Te(ue,()=>s(a).startDate,ge=>s(a).startDate=ge),Te(re,()=>s(a).endDate,ge=>s(a).endDate=ge),ct(he,()=>s(a).sortBy,ge=>s(a).sortBy=ge),g(h,m)};I(p,h=>{e.isOpen&&h(b)})}g(t,d),Xe()}Qe(["click","change"]);var Zc=k('<span class="tag-chip svelte-1qsxu3n"> <button type="button" class="svelte-1qsxu3n">&times;</button></span>'),Jc=k('<li class="svelte-1qsxu3n"> </li>'),Qc=k('<ul class="suggestions svelte-1qsxu3n"></ul>'),Kc=k('<div class="tag-input-container svelte-1qsxu3n"><!> <div class="input-wrapper svelte-1qsxu3n"><input type="text" class="svelte-1qsxu3n"/> <!></div></div>');function ev(t,e){Ye(e,!0);let a=lt(e,"selectedTags",31,()=>ke([])),r=lt(e,"placeholder",3,"Add tag..."),n=q(""),l=q(ke([])),i=q(ke([])),u=q(!1),v;Ot(async()=>{try{f(l,await Ii(),!0)}catch(_){console.error("Failed to fetch tags",_)}});function d(_){if(f(n,_.target.value,!0),s(n).includes(",")){const j=s(n).split(",");for(let R of j)R=R.trim(),R&&(a().includes(R)||a([...a(),R]));f(n,""),f(u,!1);return}s(n)?(f(i,s(l).filter(j=>j.name.toLowerCase().includes(s(n).toLowerCase())&&!a().includes(j.name)),!0),f(u,!0)):f(u,!1)}function p(_){_&&!a().includes(_)&&a([...a(),_]),f(n,""),f(u,!1),v.focus()}function b(_){a(a().filter(j=>j!==_))}function h(_){_.key==="Enter"?(_.preventDefault(),s(n).trim()&&p(s(n).trim())):_.key==="Backspace"&&!s(n)&&a().length>0&&b(a()[a().length-1])}var m=Kc(),x=c(m);Ae(x,17,a,He,(_,j)=>{var R=Zc(),A=c(R),$=o(A);$.__click=()=>b(s(j)),U(()=>T(A,`${s(j)??""} `)),g(_,R)});var S=o(x,2),w=c(S);w.__input=d,w.__keydown=h,on(w,_=>v=_,()=>v);var y=o(w,2);{var P=_=>{var j=Qc();Ae(j,21,()=>s(i),He,(R,A)=>{var $=Jc();$.__click=()=>p(s(A).name);var F=c($);U(()=>T(F,s(A).name)),g(R,$)}),g(_,j)};I(y,_=>{s(u)&&s(i).length>0&&_(P)})}U(()=>Ge(w,"placeholder",r())),aa("blur",w,()=>setTimeout(()=>f(u,!1),200)),aa("focus",w,()=>s(n)&&f(u,!0)),Te(w,()=>s(n),_=>f(n,_)),g(t,m),Xe()}Qe(["click","input","keydown"]);var tv=k('<span class="filter-badge svelte-s90sg6">●</span>'),av=k('<div class="card-desc svelte-s90sg6"> </div>'),sv=k('<span class="tag-badge svelte-s90sg6"> </span>'),nv=k('<button class="icon-badge attachment-badge svelte-s90sg6" title="View Attachments"> </button>'),rv=k('<span class="icon-badge task-planned svelte-s90sg6" title="Planned Tasks"> </span>'),lv=k('<span class="icon-badge task-pending svelte-s90sg6" title="Pending Tasks"> </span>'),iv=k('<span class="icon-badge task-done svelte-s90sg6" title="Completed Tasks"> </span>'),ov=k("<!> <!> <!>",1),cv=k('<span class="icon-badge journal-info svelte-s90sg6" title="Info Notes"> </span>'),vv=k('<span class="icon-badge journal-warning svelte-s90sg6" title="Warnings"> </span>'),uv=k('<span class="icon-badge journal-error svelte-s90sg6" title="Errors"> </span>'),dv=k("<!> <!> <!>",1),fv=k('<div class="badges-tags-row svelte-s90sg6"><!> <!> <!> <!></div>'),pv=k('<div class="meta-item svelte-s90sg6"><span class="label svelte-s90sg6">Done:</span> <span class="value"> </span></div>'),hv=k('<button class="note-attachment-btn svelte-s90sg6"> </button>'),_v=k('<div><div class="note-header svelte-s90sg6"><span> </span> <span class="note-author svelte-s90sg6"> </span> <span class="note-date svelte-s90sg6"> </span> <!> <button class="note-edit-btn svelte-s90sg6" title="Edit note">✏️</button> <button> </button></div> <p class="note-text svelte-s90sg6"> </p></div>'),gv=k('<div class="embedded-notes svelte-s90sg6"><h4 class="svelte-s90sg6">Notes</h4> <div class="notes-list svelte-s90sg6"></div></div>'),mv=k('<button class="action-btn primary-btn svelte-s90sg6" title="Register Document"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg> Register</button>'),bv=k('<button class="action-btn primary-btn svelte-s90sg6" title="View Content"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg> View</button>'),yv=k('<button class="dropdown-item svelte-s90sg6">📦 Download Zip</button>'),wv=k('<div class="dropdown-menu svelte-s90sg6"><button class="dropdown-item svelte-s90sg6">📝 Add Note</button> <button class="dropdown-item svelte-s90sg6"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg> Edit</button> <!> <button class="dropdown-item delete-item svelte-s90sg6"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg> Delete</button></div>'),kv=k('<div class="card svelte-s90sg6"><div class="card-header svelte-s90sg6"><div class="title-group svelte-s90sg6"><h3 class="svelte-s90sg6"> </h3> <span class="badge badge-type svelte-s90sg6"> </span></div> <select><option>Unregistered</option><option>In Progress</option><option>Done</option></select></div> <!> <!> <div class="card-meta svelte-s90sg6"><div class="meta-item svelte-s90sg6"><span class="label svelte-s90sg6">Author:</span> <span class="value"> </span></div> <div class="meta-item svelte-s90sg6"><span class="label svelte-s90sg6">Date:</span> <span class="value"> </span></div> <!></div> <!> <!> <div class="card-actions svelte-s90sg6"><!> <div class="dropdown-container svelte-s90sg6"><button class="action-btn dropdown-btn svelte-s90sg6" title="More actions"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle></svg></button> <!></div></div></div>'),xv=k('<div class="empty-state svelte-s90sg6"><p>No documents found.</p></div>'),Sv=k('<div class="list-container svelte-s90sg6"><div class="filters-bar svelte-s90sg6"><div class="main-filters svelte-s90sg6"><div class="search-box svelte-s90sg6"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon svelte-s90sg6"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> <input type="text" placeholder="Search documents..." class="svelte-s90sg6"/></div> <button class="filter-btn svelte-s90sg6" title="Filter &amp; Sort"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon></svg> Filters <!></button></div></div> <div class="cards-wrapper svelte-s90sg6"><!> <!></div> <!> <!> <!> <!></div>');function qv(t,e){Ye(e,!0);let a=q(ke([])),r=q(""),n=q(""),l=q(""),i=q(""),u=q(""),v=q(""),d=q(ke([])),p=q(""),b=q(""),h=q("registration_date"),m=q(ke([])),x=q(null),S=q(null),w=q(null),y=q(null),P=q(!1),_=q("registration_date"),j=q("desc"),R=q(null);async function A(){let M=await vn(s(r),s(n),s(l),s(_),s(j),s(i),s(p),s(b),s(h),s(b),s(h),s(u));s(d)&&s(d).length>0&&(M=M.filter(E=>!E.tasks||E.tasks.length===0?!1:E.tasks.some(ee=>s(d).includes(ee.status)))),s(v)&&(M=M.filter(E=>!E.tasks||E.tasks.length===0?!1:E.tasks.some(ee=>ee.material_id&&ee.material_id.toString()===s(v).toString()))),f(a,M,!0)}async function $(){f(m,await Zi(),!0)}Ot(()=>{A(),$()});async function F(M,E){await $i(M.id,E),A()}async function O(M){confirm("Are you sure you want to delete this document?")&&(await Ui(M),A())}function H(){A()}function Z(M){f(x,M,!0)}function W(){f(x,null)}function B(M){f(S,M,!0),f(w,null)}function N(M,E){f(S,M,!0),f(w,E,!0)}function L(){f(S,null),f(w,null),A()}async function ie(M,E){const ee=E==="pending"?"done":"pending";try{await un(M,{status:ee}),A(),window.dispatchEvent(new CustomEvent("journal-entries-updated"))}catch(Se){console.error("Failed to update note status",Se)}}function le(M){f(y,M,!0)}function de(){f(y,null)}function be(M){if(!M)return null;const E={planned:0,pending:0,done:0};return M.forEach(ee=>{E[ee.status]!==void 0&&E[ee.status]++}),E}function Y(M){if(!M)return null;const E={info:0,warning:0,error:0};return M.forEach(ee=>{E[ee.type]!==void 0&&E[ee.type]++}),E}function G(){f(P,!0)}function se(){f(P,!1)}function X(M){f(n,M.filterType,!0),f(l,M.filterStatus,!0),f(i,M.filterTag,!0),f(u,M.filterAssignee,!0),f(v,M.filterMaterial||"",!0),f(d,M.filterTaskTypes||[],!0),f(p,M.startDate,!0),f(b,M.endDate,!0),f(h,M.dateField,!0),f(_,M.sortBy,!0),f(j,M.sortOrder,!0),A()}function C(M){f(R,s(R)===M?null:M,!0)}function Q(){f(R,null)}async function oe(M){try{await Gi(M.id,M.name)}catch(E){console.error(E),alert("Failed to download zip. Ensure the source folder exists on the server.")}}var ae={refresh:A},ye=Sv(),V=c(ye),K=c(V),te=c(K),ne=o(c(te),2);ne.__input=H;var D=o(te,2);D.__click=G;var ue=o(c(D),2);{var re=M=>{var E=tv();g(M,E)};I(ue,M=>{(s(n)||s(l)||s(i)||s(u)||s(p)||s(b)||s(d)&&s(d).length>0)&&M(re)})}var pe=o(V,2),ce=c(pe);Ae(ce,17,()=>s(a),M=>M.id,(M,E)=>{const ee=Ze(()=>be(s(E).tasks)),Se=Ze(()=>Y(s(E).journal_entries));var Ce=kv(),ge=c(Ce),me=c(ge),Oe=c(me),Be=c(Oe),De=o(Oe,2),Ve=c(De),tt=o(me,2);tt.__change=Fe=>F(s(E),Fe.target.value);var at=c(tt);at.value=at.__value="unregistered";var Ke=o(at);Ke.value=Ke.__value="in_progress";var Ue=o(Ke);Ue.value=Ue.__value="done";var ot;rn(tt);var wt=o(ge,2);{var vt=Fe=>{var st=av(),At=c(st);U(()=>T(At,s(E).description)),g(Fe,st)};I(wt,Fe=>{s(E).description&&Fe(vt)})}var J=o(wt,2);{var we=Fe=>{var st=fv(),At=c(st);{var la=ut=>{var gt=Le(),Dt=qe(gt);Ae(Dt,17,()=>s(E).tags,He,(ia,Yt)=>{var Xt=sv(),Nt=c(Xt);U(()=>T(Nt,`#${s(Yt).name??""}`)),g(ia,Xt)}),g(ut,gt)};I(At,ut=>{s(E).tags&&s(E).tags.length>0&&ut(la)})}var et=o(At,2);{var _a=ut=>{var gt=nv();gt.__click=()=>le(s(E).attachments);var Dt=c(gt);U(()=>T(Dt,`📷 ${s(E).attachments.length??""}`)),g(ut,gt)};I(et,ut=>{s(E).attachments&&s(E).attachments.length>0&&ut(_a)})}var ga=o(et,2);{var Ht=ut=>{var gt=ov(),Dt=qe(gt);{var ia=We=>{var rt=rv(),mt=c(rt);U(()=>T(mt,`📅 ${s(ee).planned??""}`)),g(We,rt)};I(Dt,We=>{s(ee).planned>0&&We(ia)})}var Yt=o(Dt,2);{var Xt=We=>{var rt=lv(),mt=c(rt);U(()=>T(mt,`⏳ ${s(ee).pending??""}`)),g(We,rt)};I(Yt,We=>{s(ee).pending>0&&We(Xt)})}var Nt=o(Yt,2);{var Ba=We=>{var rt=iv(),mt=c(rt);U(()=>T(mt,`✅ ${s(ee).done??""}`)),g(We,rt)};I(Nt,We=>{s(ee).done>0&&We(Ba)})}g(ut,gt)};I(ga,ut=>{s(ee)&&ut(Ht)})}var Pa=o(ga,2);{var os=ut=>{var gt=dv(),Dt=qe(gt);{var ia=We=>{var rt=cv(),mt=c(rt);U(()=>T(mt,`ℹ️ ${s(Se).info??""}`)),g(We,rt)};I(Dt,We=>{s(Se).info>0&&We(ia)})}var Yt=o(Dt,2);{var Xt=We=>{var rt=vv(),mt=c(rt);U(()=>T(mt,`⚠️ ${s(Se).warning??""}`)),g(We,rt)};I(Yt,We=>{s(Se).warning>0&&We(Xt)})}var Nt=o(Yt,2);{var Ba=We=>{var rt=uv(),mt=c(rt);U(()=>T(mt,`❌ ${s(Se).error??""}`)),g(We,rt)};I(Nt,We=>{s(Se).error>0&&We(Ba)})}g(ut,gt)};I(Pa,ut=>{s(Se)&&ut(os)})}g(Fe,st)};I(J,Fe=>{(s(E).tags&&s(E).tags.length>0||s(E).attachments&&s(E).attachments.length>0||s(ee)||s(Se))&&Fe(we)})}var Ne=o(J,2),nt=c(Ne),_t=o(c(nt),2),ht=c(_t),ra=o(nt,2),ha=o(c(ra),2),Ut=c(ha),$a=o(ra,2);{var Fa=Fe=>{var st=pv(),At=o(c(st),2),la=c(At);U(()=>T(la,s(E).done_date)),g(Fe,st)};I($a,Fe=>{s(E).done_date&&Fe(Fa)})}var wn=o(Ne,2);Oc(wn,{get document(){return s(E)},refresh:A,get filterAssignee(){return s(u)}});var kn=o(wn,2);{var el=Fe=>{var st=gv(),At=o(c(st),2);Ae(At,21,()=>s(E).journal_entries,He,(la,et)=>{var _a=_v(),ga=c(_a),Ht=c(ga),Pa=c(Ht),os=o(Ht,2),ut=c(os),gt=o(os,2),Dt=c(gt),ia=o(gt,2);{var Yt=mt=>{var cs=hv();cs.__click=()=>le(s(et).attachments);var il=c(cs);U(()=>{Ge(cs,"title",`View attachments (${s(et).attachments.length??""})`),T(il,`📎 ${s(et).attachments.length??""}`)}),g(mt,cs)};I(ia,mt=>{s(et).attachments&&s(et).attachments.length>0&&mt(Yt)})}var Xt=o(ia,2);Xt.__click=()=>N(s(E),s(et));var Nt=o(Xt,2);Nt.__click=()=>ie(s(et).id,s(et).status);var Ba=c(Nt),We=o(ga,2),rt=c(We);U(()=>{ze(_a,1,`note-item ${s(et).type??""}`,"svelte-s90sg6"),ze(Ht,1,`note-badge ${s(et).type??""}`,"svelte-s90sg6"),T(Pa,s(et).type),T(ut,s(et).author||"Unknown"),T(Dt,s(et).created_at),ze(Nt,1,`note-status-btn ${s(et).status??""}`,"svelte-s90sg6"),Ge(Nt,"title",s(et).status==="pending"?"Click to mark as done":"Click to mark as pending"),T(Ba,s(et).status),T(rt,s(et).text)}),g(la,_a)}),g(Fe,st)};I(kn,Fe=>{s(E).journal_entries&&s(E).journal_entries.length>0&&Fe(el)})}var tl=o(kn,2),xn=c(tl);{var al=Fe=>{var st=mv();st.__click=()=>e.onEdit(s(E)),g(Fe,st)},sl=Fe=>{var st=bv();st.__click=()=>Z(s(E)),g(Fe,st)};I(xn,Fe=>{s(E).status==="unregistered"?Fe(al):Fe(sl,!1)})}var nl=o(xn,2),Sn=c(nl);Sn.__click=()=>C(s(E).id);var rl=o(Sn,2);{var ll=Fe=>{var st=wv(),At=c(st);At.__click=()=>{B(s(E)),Q()};var la=o(At,2);la.__click=()=>{e.onEdit(s(E)),Q()};var et=o(la,2);{var _a=Ht=>{var Pa=yv();Pa.__click=()=>{oe(s(E)),Q()},g(Ht,Pa)};I(et,Ht=>{s(E).type==="order"&&Ht(_a)})}var ga=o(et,2);ga.__click=()=>{O(s(E).id),Q()},g(Fe,st)};I(rl,Fe=>{s(R)===s(E).id&&Fe(ll)})}U(()=>{T(Be,s(E).name),T(Ve,s(E).type),ze(tt,1,`status-select ${s(E).status??""}`,"svelte-s90sg6"),at.disabled=s(E).status!=="unregistered",ot!==(ot=s(E).status)&&(tt.value=(tt.__value=s(E).status)??"",js(tt,s(E).status)),T(ht,s(E).author||"-"),T(Ut,s(E).registration_date)}),g(M,Ce)});var he=o(ce,2);{var fe=M=>{var E=xv();g(M,E)};I(he,M=>{s(a).length===0&&M(fe)})}var ve=o(pe,2);{let M=Ze(()=>!!s(x));Us(ve,{get isOpen(){return s(M)},close:W,maxWidth:"800px",children:(E,ee)=>{yc(E,{get document(){return s(x)}})},$$slots:{default:!0}})}var z=o(ve,2);{let M=Ze(()=>!!s(S)),E=Ze(()=>s(S)?.id),ee=Ze(()=>s(S)?.name);Qr(z,{get isOpen(){return s(M)},close:L,get documentId(){return s(E)},get documentName(){return s(ee)},get entry(){return s(w)}})}var _e=o(z,2);{let M=Ze(()=>!!s(y)),E=Ze(()=>s(y)||[]);Kr(_e,{get isOpen(){return s(M)},close:de,get attachments(){return s(E)}})}var xe=o(_e,2);{let M=Ze(()=>({filterType:s(n),filterStatus:s(l),filterTag:s(i),filterAssignee:s(u),filterMaterial:s(v),filterTaskTypes:s(d),startDate:s(p),endDate:s(b),dateField:s(h),sortBy:s(_),sortOrder:s(j)}));Wc(xe,{get isOpen(){return s(P)},close:se,get filters(){return s(M)},onApply:X})}return Te(ne,()=>s(r),M=>f(r,M)),g(t,ye),Xe(ae)}Qe(["input","click","change"]);var Tv=k('<span class="att-badge svelte-v5qqzx"> </span>'),jv=k('<div class="attachments-preview svelte-v5qqzx"></div>'),Ev=k('<div class="entry-form svelte-v5qqzx"><input type="text" placeholder="Author" class="author-input svelte-v5qqzx"/> <select class="svelte-v5qqzx"><option>Info</option><option>Warning</option><option>Error</option></select> <textarea placeholder="Message..." class="svelte-v5qqzx"></textarea> <div class="file-input-group svelte-v5qqzx"><input type="file" multiple class="svelte-v5qqzx"/> <!></div> <button>Save</button></div>'),Pv=k("<p>Loading...</p>"),Cv=k('<p class="empty">No entries found.</p>'),Av=k('<span class="doc-ref svelte-v5qqzx"> </span>'),Dv=k('<a target="_blank" class="svelte-v5qqzx"><img class="svelte-v5qqzx"/></a>'),zv=k('<a target="_blank" class="svelte-v5qqzx"> </a>'),Rv=k('<div class="attachment-thumb svelte-v5qqzx"><!></div>'),Mv=k('<div class="entry-attachments svelte-v5qqzx"></div>'),Iv=k('<div><div class="entry-header svelte-v5qqzx"><span> </span> <span class="author svelte-v5qqzx"> </span> <span class="date"> </span> <!> <div class="actions svelte-v5qqzx"><button class="edit-btn svelte-v5qqzx">✏️ Edit</button> <button class="status-btn svelte-v5qqzx"> </button> <button class="delete-btn svelte-v5qqzx">🗑</button></div></div> <p class="text svelte-v5qqzx"> </p> <!></div>'),Lv=k('<div class="journal-container svelte-v5qqzx"><div class="toolbar svelte-v5qqzx"><div class="filters svelte-v5qqzx"><select class="svelte-v5qqzx"><option>All Types</option><option>Info</option><option>Warning</option><option>Error</option></select> <select class="svelte-v5qqzx"><option>All Statuses</option><option>Pending</option><option>Done</option></select></div> <button class="add-btn svelte-v5qqzx"> </button></div> <!> <div class="entries-list svelte-v5qqzx"><!></div> <!></div>');function Ov(t,e){Ye(e,!0);let a=q(ke([])),r=q(!1),n=q(null),l=q(""),i=q(""),u=q(!1),v=q(""),d=q("info"),p=q(""),b=q(ke([]));async function h(){f(r,!0);try{f(a,await Hi(s(l),s(i)),!0)}catch(C){console.error(C)}finally{f(r,!1)}}Ot(()=>{f(p,localStorage.getItem("journal_author")||"",!0),h();const C=()=>{h()};return window.addEventListener("journal-entries-updated",C),()=>{window.removeEventListener("journal-entries-updated",C)}});async function m(C){const Q=Array.from(C.target.files);if(Q.length!==0){for(const oe of Q)try{const ae=await cn(oe);s(b).push(ae)}catch(ae){console.error("Upload failed",ae),alert("Upload failed for "+oe.name)}C.target.value=""}}async function x(){if(!(!s(v)&&s(b).length===0)){s(p)&&localStorage.setItem("journal_author",s(p));try{await $r({text:s(v),type:s(d),status:"pending",author:s(p),attachments:s(b)}),f(v,""),f(b,[],!0),f(u,!1),h()}catch(C){console.error("Failed to add entry",C)}}}async function S(C){const Q=C.status==="pending"?"done":"pending";try{await un(C.id,{status:Q}),h()}catch(oe){console.error(oe)}}async function w(C){if(confirm("Are you sure?"))try{await Yi(C),h()}catch(Q){console.error(Q)}}function y(C){f(n,C,!0)}function P(){f(n,null),h()}Lt(()=>{h()});var _=Lv(),j=c(_),R=c(j),A=c(R);A.__change=h;var $=c(A);$.value=$.__value="";var F=o($);F.value=F.__value="info";var O=o(F);O.value=O.__value="warning";var H=o(O);H.value=H.__value="error";var Z=o(A,2);Z.__change=h;var W=c(Z);W.value=W.__value="";var B=o(W);B.value=B.__value="pending";var N=o(B);N.value=N.__value="done";var L=o(R,2);L.__click=()=>f(u,!s(u));var ie=c(L),le=o(j,2);{var de=C=>{var Q=Ev(),oe=c(Q),ae=o(oe,2),ye=c(ae);ye.value=ye.__value="info";var V=o(ye);V.value=V.__value="warning";var K=o(V);K.value=K.__value="error";var te=o(ae,2),ne=o(te,2),D=c(ne);D.__change=m;var ue=o(D,2);{var re=ce=>{var he=jv();Ae(he,21,()=>s(b),He,(fe,ve)=>{var z=Tv(),_e=c(z);U(()=>T(_e,s(ve).filename)),g(fe,z)}),g(ce,he)};I(ue,ce=>{s(b).length>0&&ce(re)})}var pe=o(ne,2);pe.__click=x,Te(oe,()=>s(p),ce=>f(p,ce)),ct(ae,()=>s(d),ce=>f(d,ce)),Te(te,()=>s(v),ce=>f(v,ce)),g(C,Q)};I(le,C=>{s(u)&&C(de)})}var be=o(le,2),Y=c(be);{var G=C=>{var Q=Pv();g(C,Q)},se=C=>{var Q=Le(),oe=qe(Q);{var ae=V=>{var K=Cv();g(V,K)},ye=V=>{var K=Le(),te=qe(K);Ae(te,17,()=>s(a),He,(ne,D)=>{var ue=Iv(),re=c(ue),pe=c(re),ce=c(pe),he=o(pe,2),fe=c(he),ve=o(he,2),z=c(ve),_e=o(ve,2);{var xe=De=>{var Ve=Av(),tt=c(Ve);U(()=>T(tt,`Ref: Doc #${s(D).document_id??""}`)),g(De,Ve)};I(_e,De=>{s(D).document_id&&De(xe)})}var M=o(_e,2),E=c(M);E.__click=()=>y(s(D));var ee=o(E,2);ee.__click=()=>S(s(D));var Se=c(ee),Ce=o(ee,2);Ce.__click=()=>w(s(D).id);var ge=o(re,2),me=c(ge),Oe=o(ge,2);{var Be=De=>{var Ve=Mv();Ae(Ve,21,()=>s(D).attachments,He,(tt,at)=>{var Ke=Rv(),Ue=c(Ke);{var ot=vt=>{var J=Dv(),we=c(J);U(()=>{Ge(J,"href",s(at).file_path),Ge(we,"src",s(at).file_path),Ge(we,"alt",s(at).filename)}),g(vt,J)},wt=vt=>{var J=zv(),we=c(J);U(()=>{Ge(J,"href",s(at).file_path),T(we,`📄 ${s(at).filename??""}`)}),g(vt,J)};I(Ue,vt=>{s(at).media_type&&s(at).media_type.startsWith("image/")?vt(ot):vt(wt,!1)})}g(tt,Ke)}),g(De,Ve)};I(Oe,De=>{s(D).attachments&&s(D).attachments.length>0&&De(Be)})}U(()=>{ze(ue,1,`entry-card ${s(D).type??""} ${s(D).status??""}`,"svelte-v5qqzx"),ze(pe,1,`badge ${s(D).type??""}`,"svelte-v5qqzx"),T(ce,s(D).type),T(fe,s(D).author||"Unknown"),T(z,s(D).created_at),T(Se,s(D).status==="pending"?"☑ Mark Done":"↩ Reopen"),T(me,s(D).text)}),g(ne,ue)}),g(V,K)};I(oe,V=>{s(a).length===0?V(ae):V(ye,!1)},!0)}g(C,Q)};I(Y,C=>{s(r)?C(G):C(se,!1)})}var X=o(be,2);{let C=Ze(()=>!!s(n)),Q=Ze(()=>s(n)?.document_id);Qr(X,{get isOpen(){return s(C)},close:P,get documentId(){return s(Q)},documentName:"Journal Entry",get entry(){return s(n)}})}U(()=>T(ie,s(u)?"Cancel":"+ New Entry")),ct(A,()=>s(l),C=>f(l,C)),ct(Z,()=>s(i),C=>f(i,C)),g(t,_),Xe()}Qe(["change","click"]);var Nv=k('<div class="loading-state svelte-g0byll">Loading tasks...</div>'),$v=k('<div class="empty-state svelte-g0byll">Enter an assignee name above to view their tasks.</div>'),Fv=k('<div class="empty-state svelte-g0byll">No pending or planned tasks found for this assignee.</div>'),Bv=k('<div><div class="task-info svelte-g0byll"><span> </span> <button class="btn-done svelte-g0byll" title="Mark as done">✓</button> <span class="task-name svelte-g0byll"> </span></div></div>'),Gv=k('<div class="material-group svelte-g0byll"><div class="material-header svelte-g0byll"><span class="material-name svelte-g0byll"> </span> <span class="task-count svelte-g0byll"> </span></div> <div class="tasks-list svelte-g0byll"></div></div>'),Uv=k('<div class="doc-group svelte-g0byll"><div class="doc-header svelte-g0byll"><h3 class="svelte-g0byll"> </h3> <span> </span></div> <!></div>'),Hv=k('<div class="documents-list svelte-g0byll"></div>'),Yv=k('<div class="job-view svelte-g0byll"><div class="assignee-filter svelte-g0byll"><label for="assignee" class="svelte-g0byll">Assignee:</label> <input id="assignee" type="text" placeholder="Enter assignee name..." class="svelte-g0byll"/> <button class="btn-load svelte-g0byll"> </button></div> <!></div>');function Xv(t,e){Ye(e,!0);let a=q(ke([])),r=q(""),n=q(!1);Ot(()=>{f(r,localStorage.getItem("job_assignee")||"",!0),s(r)&&l()});async function l(){if(!s(r).trim()){f(a,[],!0);return}f(n,!0);try{const y=await vn();f(a,y.map(P=>({...P,tasks:(P.tasks||[]).filter(_=>_.assignee&&_.assignee.toLowerCase().includes(s(r).toLowerCase())&&(_.status==="pending"||_.status==="planned"))})).filter(P=>P.tasks.length>0),!0)}catch(y){console.error(y)}finally{f(n,!1)}}function i(){localStorage.setItem("job_assignee",s(r)),l()}async function u(y){try{await Gs(y,{status:"done"}),await l()}catch(P){console.error(P),alert("Failed to update task status")}}function v(y){const _=[...y.tasks||[]].sort((R,A)=>R.status==="pending"&&A.status!=="pending"?-1:R.status!=="pending"&&A.status==="pending"?1:0),j={};return _.forEach(R=>{const A=R.material?R.material.name:"(No Material)";j[A]||(j[A]=[]),j[A].push(R)}),j}var d=Yv(),p=c(d),b=o(c(p),2);b.__change=i;var h=o(b,2);h.__click=l;var m=c(h),x=o(p,2);{var S=y=>{var P=Nv();g(y,P)},w=y=>{var P=Le(),_=qe(P);{var j=A=>{var $=$v();g(A,$)},R=A=>{var $=Le(),F=qe($);{var O=Z=>{var W=Fv();g(Z,W)},H=Z=>{var W=Hv();Ae(W,21,()=>s(a),B=>B.id,(B,N)=>{const L=Ze(()=>v(s(N)));var ie=Uv(),le=c(ie),de=c(le),be=c(de),Y=o(de,2),G=c(Y),se=o(le,2);Ae(se,17,()=>Object.entries(s(L)),He,(X,C)=>{var Q=Ze(()=>Ws(s(C),2));let oe=()=>s(Q)[0],ae=()=>s(Q)[1];var ye=Gv(),V=c(ye),K=c(V),te=c(K),ne=o(K,2),D=c(ne),ue=o(V,2);Ae(ue,21,ae,re=>re.id,(re,pe)=>{var ce=Bv(),he=c(ce),fe=c(he),ve=c(fe),z=o(fe,2);z.__click=()=>u(s(pe).id);var _e=o(z,2),xe=c(_e);U(()=>{ze(ce,1,`task-row ${s(pe).status??""}`,"svelte-g0byll"),ze(fe,1,`task-status-badge ${s(pe).status??""}`,"svelte-g0byll"),T(ve,s(pe).status),T(xe,s(pe).name)}),g(re,ce)}),U(()=>{T(te,`📦 ${oe()??""}`),T(D,`${ae().length??""} task${ae().length!==1?"s":""}`)}),g(X,ye)}),U(()=>{T(be,s(N).name),ze(Y,1,`doc-badge ${s(N).type??""}`,"svelte-g0byll"),T(G,s(N).type)}),g(B,ie)}),g(Z,W)};I(F,Z=>{s(a).length===0?Z(O):Z(H,!1)},!0)}g(A,$)};I(_,A=>{s(r).trim()?A(R,!1):A(j)},!0)}g(y,P)};I(x,y=>{s(n)?y(S):y(w,!1)})}U(y=>{h.disabled=y,T(m,s(n)?"Loading...":"Load")},[()=>s(n)||!s(r).trim()]),Te(b,()=>s(r),y=>f(r,y)),g(t,d),Xe()}Qe(["change","click"]);var Vv=k('<img class="thumbnail-img svelte-10wfxqz"/>'),Wv=k('<div class="thumbnail card svelte-10wfxqz" role="button" tabindex="0"><div class="preview svelte-10wfxqz"><!> <div class="placeholder-geo svelte-10wfxqz"><span>⚙️</span></div> <div class="overlay-actions svelte-10wfxqz"><button class="action-btn svelte-10wfxqz" title="Edit Part">✏️</button> <button class="action-btn svelte-10wfxqz" title="Preview">👁️</button></div></div> <div class="info svelte-10wfxqz"><h4 class="name svelte-10wfxqz"> </h4> <div class="card-meta svelte-10wfxqz"><div class="meta-item svelte-10wfxqz"><span class="label svelte-10wfxqz">Registration:</span> <span class="value svelte-10wfxqz"> </span></div> <div class="meta-item svelte-10wfxqz"><span class="label svelte-10wfxqz">Dimensions:</span> <span class="value svelte-10wfxqz"> </span></div> <div class="meta-item svelte-10wfxqz"><span class="label svelte-10wfxqz">Material:</span> <span class="value svelte-10wfxqz"> </span></div></div></div></div>');function Zv(t,e){Ye(e,!0);let a=Ze(()=>e.part.material?e.part.material.name:"Unknown Material"),r=Ze(()=>`${e.part.width||"?"} x ${e.part.height||"?"}`);function n(Z){Z.stopPropagation(),e.onedit&&e.onedit(e.part)}function l(Z){Z.stopPropagation(),e.onpreview&&e.onpreview(e.part)}var i=Wv();i.__click=function(...Z){e.onclick?.apply(this,Z)},i.__keydown=Z=>Z.key==="Enter"&&e.onclick&&e.onclick();var u=c(i),v=c(u);{var d=Z=>{var W=Vv();U(()=>{Ge(W,"src",`/uploads/thumbnails/${(e.part.registration_number||e.part.id)??""}.svg`),Ge(W,"alt",e.part.name)}),aa("error",W,B=>{B.currentTarget.style.display="none"}),g(Z,W)};I(v,Z=>{e.part.gnc_file_path&&Z(d)})}var p=o(v,2),b=o(p,2),h=c(b);h.__click=n;var m=o(h,2);m.__click=l;var x=o(u,2),S=c(x),w=c(S),y=o(S,2),P=c(y),_=o(c(P),2),j=c(_),R=o(P,2),A=o(c(R),2),$=c(A),F=o(R,2),O=o(c(F),2),H=c(O);U(()=>{ts(p,e.part.gnc_file_path?"display: none;":""),Ge(S,"title",e.part.name),T(w,e.part.name),T(j,e.part.registration_number||"-"),T($,`${s(r)??""} mm`),T(H,s(a))}),g(t,i),Xe()}Qe(["click","keydown"]);var Jv=k('<div class="message svelte-1y39gna"> </div>'),Qv=k('<div class="modal-overlay svelte-1y39gna"><div class="modal svelte-1y39gna"><h2 class="svelte-1y39gna">Scanning Library</h2> <div class="progress-container svelte-1y39gna"><div class="progress-bar svelte-1y39gna"><div class="progress-fill svelte-1y39gna"></div></div> <span class="progress-text svelte-1y39gna"> </span></div> <div class="status svelte-1y39gna"><strong>Status:</strong> </div> <!> <div class="actions svelte-1y39gna"><button class="svelte-1y39gna"> </button></div></div></div>');function Kv(t,e){Ye(e,!0);const a=Nr();let r=lt(e,"show",15,!1),n=lt(e,"progress",3,0),l=lt(e,"status",3,""),i=lt(e,"message",3,"");function u(){l()!=="scanning"&&(r(!1),a("close"))}var v=Le(),d=qe(v);{var p=b=>{var h=Qv();h.__click=u;var m=c(h);m.__click=H=>H.stopPropagation();var x=o(c(m),2),S=c(x),w=c(S),y=o(S,2),P=c(y),_=o(x,2),j=o(c(_)),R=o(_,2);{var A=H=>{var Z=Jv(),W=c(Z);U(()=>T(W,i())),g(H,Z)};I(R,H=>{i()&&H(A)})}var $=o(R,2),F=c($);F.__click=u;var O=c(F);U(()=>{ts(w,`width: ${n()??""}%`),T(P,`${n()??""}%`),T(j,` ${l()??""}`),F.disabled=l()==="scanning",T(O,l()==="scanning"?"Scanning...":"Close")}),g(b,h)};I(d,b=>{r()&&b(p)})}g(t,v),Xe()}Qe(["click"]);var eu=k("<option> </option>"),tu=k('<div class="modal-overlay svelte-1fna2hh"><div class="modal svelte-1fna2hh"><h2 class="svelte-1fna2hh">Edit Part</h2> <div class="form svelte-1fna2hh"><div class="field svelte-1fna2hh"><label for="name" class="svelte-1fna2hh">Name</label> <input id="name" type="text" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="reg" class="svelte-1fna2hh">Registration Number</label> <input id="reg" type="text" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="width" class="svelte-1fna2hh">Width (mm)</label> <input id="width" type="number" step="0.01" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="height" class="svelte-1fna2hh">Height (mm)</label> <input id="height" type="number" step="0.01" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="material" class="svelte-1fna2hh">Material</label> <select id="material" class="svelte-1fna2hh"><option>No Material</option><!></select></div></div> <div class="actions svelte-1fna2hh"><button class="secondary svelte-1fna2hh">Cancel</button> <button class="primary svelte-1fna2hh">Save</button></div></div></div>');function au(t,e){Ye(e,!0);let a=lt(e,"show",15,!1),r=lt(e,"part",3,null),n=q(ke([])),l=q(ke({name:"",registration_number:"",width:0,height:0,material_id:null}));Lt(()=>{a()&&r()&&(f(l,{name:r().name||"",registration_number:r().registration_number||"",width:r().width||0,height:r().height||0,material_id:r().material_id||null},!0),i())});async function i(){try{f(n,await ja(),!0)}catch(h){console.error("Failed to load materials:",h)}}function u(){a(!1)}function v(){e.onsave&&e.onsave(s(l)),u()}var d=Le(),p=qe(d);{var b=h=>{var m=tu();m.__click=u;var x=c(m);x.__click=L=>L.stopPropagation();var S=o(c(x),2),w=c(S),y=o(c(w),2),P=o(w,2),_=o(c(P),2),j=o(P,2),R=o(c(j),2),A=o(j,2),$=o(c(A),2),F=o(A,2),O=o(c(F),2),H=c(O);H.value=(H.__value=null)??"";var Z=o(H);Ae(Z,17,()=>s(n),He,(L,ie)=>{var le=eu(),de=c(le),be={};U(()=>{T(de,s(ie).name),be!==(be=s(ie).id)&&(le.value=(le.__value=s(ie).id)??"")}),g(L,le)});var W=o(S,2),B=c(W);B.__click=u;var N=o(B,2);N.__click=v,Te(y,()=>s(l).name,L=>s(l).name=L),Te(_,()=>s(l).registration_number,L=>s(l).registration_number=L),Te(R,()=>s(l).width,L=>s(l).width=L),Te($,()=>s(l).height,L=>s(l).height=L),ct(O,()=>s(l).material_id,L=>s(l).material_id=L),g(h,m)};I(p,h=>{a()&&h(b)})}g(t,d),Xe()}Qe(["click"]);var su=k('<img class="preview-img svelte-17z6zdn"/>'),nu=k('<div class="no-preview svelte-17z6zdn">No preview available</div>'),ru=k('<div class="modal-backdrop svelte-17z6zdn"><div class="modal svelte-17z6zdn"><header class="svelte-17z6zdn"><h3 class="svelte-17z6zdn"> </h3> <button class="close-btn svelte-17z6zdn">&times;</button></header> <div class="content svelte-17z6zdn"><!> <div class="details svelte-17z6zdn"><p><strong>Registration:</strong> </p> <p><strong>Dimensions:</strong> </p></div></div></div></div>');function lu(t,e){Ye(e,!0);let a=lt(e,"show",15,!1);function r(){a(!1)}function n(v){v.key==="Escape"&&r()}var l=Le();aa("keydown",Ns,n);var i=qe(l);{var u=v=>{var d=ru();d.__click=r;var p=c(d);p.__click=F=>F.stopPropagation();var b=c(p),h=c(b),m=c(h),x=o(h,2);x.__click=r;var S=o(b,2),w=c(S);{var y=F=>{var O=su();U(()=>{Ge(O,"src",`/uploads/thumbnails/${(e.part.registration_number||e.part.id)??""}.svg`),Ge(O,"alt",e.part.name)}),g(F,O)},P=F=>{var O=nu();g(F,O)};I(w,F=>{e.part.gnc_file_path?F(y):F(P,!1)})}var _=o(w,2),j=c(_),R=o(c(j)),A=o(j,2),$=o(c(A));U(()=>{T(m,e.part.name),T(R,` ${(e.part.registration_number||"-")??""}`),T($,` ${(e.part.width||"?")??""} x ${(e.part.height||"?")??""} mm`)}),g(v,d)};I(i,v=>{a()&&e.part&&v(u)})}g(t,l),Xe()}Qe(["click"]);var iu=k("<option> </option>"),ou=k('<div class="loading svelte-xfu7xu">Loading parts...</div>'),cu=k('<div class="empty svelte-xfu7xu">No parts found matching filters.</div>'),vu=k("<div></div>"),uu=k('<div class="parts-layout svelte-xfu7xu"><aside class="sidebar svelte-xfu7xu"><h3 class="svelte-xfu7xu">Filters</h3> <div class="filter-group svelte-xfu7xu"><label for="search" class="svelte-xfu7xu">Search</label> <input id="search" type="text" placeholder="Name or Reg #" class="svelte-xfu7xu"/></div> <div class="filter-group svelte-xfu7xu"><label for="material" class="svelte-xfu7xu">Material</label> <select id="material" class="svelte-xfu7xu"><option>All Materials</option><!></select></div> <div class="filter-group svelte-xfu7xu"><label class="svelte-xfu7xu">Width (mm)</label> <div class="range svelte-xfu7xu"><input type="number" placeholder="Min" class="svelte-xfu7xu"/> <span>-</span> <input type="number" placeholder="Max" class="svelte-xfu7xu"/></div></div> <div class="filter-group svelte-xfu7xu"><label class="svelte-xfu7xu">Height (mm)</label> <div class="range svelte-xfu7xu"><input type="number" placeholder="Min" class="svelte-xfu7xu"/> <span>-</span> <input type="number" placeholder="Max" class="svelte-xfu7xu"/></div></div> <button class="reset-btn svelte-xfu7xu">Reset Filters</button></aside> <main class="content svelte-xfu7xu"><header class="svelte-xfu7xu"><div class="title-row svelte-xfu7xu"><h2 class="svelte-xfu7xu">Parts Library</h2></div> <div class="actions svelte-xfu7xu"><button>🔄 Rescan Library</button> <button>↻ Refresh</button></div></header> <!></main> <!> <!> <!></div>');function du(t,e){Ye(e,!0);let a=q(ke([])),r=q(ke([])),n=q(""),l=q(""),i=q(""),u=q(""),v=q(""),d=q(""),p=q(!1),b=q(0);const h=50;let m=q(!1),x=q(0),S=q(""),w=q(""),y=q(!1),P=q(null),_=q(!1),j=q(null);async function R(){f(p,!0);try{const z={};s(n)&&(z.search=s(n)),s(l)&&(z.material_id=s(l)),s(i)&&(z.min_width=s(i)),s(u)&&(z.max_width=s(u)),s(v)&&(z.min_height=s(v)),s(d)&&(z.max_height=s(d));const[_e,xe]=await Promise.all([eo(s(b)*h,h,z),s(r).length===0?ja():Promise.resolve(s(r))]);f(a,_e,!0),s(r).length===0&&f(r,xe,!0)}catch(z){console.error(z),alert("Failed to load parts")}finally{f(p,!1)}}function A(){f(b,0),R()}let $;function F(){clearTimeout($),$=setTimeout(()=>{A()},500)}async function O(){f(m,!0),f(x,0),f(S,"starting"),f(w,"Initializing scan...");try{await oo(z=>{f(x,z.percent||0,!0),f(S,z.status||"",!0),f(w,z.message||"",!0)}),s(S)==="complete"&&await R()}catch(z){console.error("Scan error:",z),f(S,"error"),f(w,`Scan failed: ${z.message}`)}}function H(z){f(P,z,!0),f(y,!0)}function Z(z){f(j,z,!0),f(_,!0)}async function W(z){try{await co(s(P).id,z),await R(),alert("Part updated successfully"),f(y,!1)}catch(_e){console.error("Update error:",_e),alert("Failed to update part")}}Ot(()=>{R()});var B=uu(),N=c(B),L=o(c(N),2),ie=o(c(L),2);ie.__input=F;var le=o(L,2),de=o(c(le),2);de.__change=A;var be=c(de);be.value=be.__value="";var Y=o(be);Ae(Y,17,()=>s(r),He,(z,_e)=>{var xe=iu(),M=c(xe),E={};U(()=>{T(M,s(_e).name),E!==(E=s(_e).id)&&(xe.value=(xe.__value=s(_e).id)??"")}),g(z,xe)});var G=o(le,2),se=o(c(G),2),X=c(se);X.__change=A;var C=o(X,4);C.__change=A;var Q=o(G,2),oe=o(c(Q),2),ae=c(oe);ae.__change=A;var ye=o(ae,4);ye.__change=A;var V=o(Q,2);V.__click=()=>{f(n,""),f(l,""),f(i,""),f(u,""),f(v,""),f(d,""),A()};var K=o(N,2),te=c(K),ne=o(c(te),2),D=c(ne);D.__click=O;var ue=o(D,2);ue.__click=()=>R();var re=o(te,2);{var pe=z=>{var _e=ou();g(z,_e)},ce=z=>{var _e=Le(),xe=qe(_e);{var M=ee=>{var Se=cu();g(ee,Se)},E=ee=>{var Se=vu();ze(Se,1,"grid grid svelte-xfu7xu"),Ae(Se,21,()=>s(a),Ce=>Ce.id,(Ce,ge)=>{Zv(Ce,{get part(){return s(ge)},onclick:()=>console.log("Part clicked",s(ge).id),onedit:H,onpreview:Z})}),g(ee,Se)};I(xe,ee=>{s(a).length===0?ee(M):ee(E,!1)},!0)}g(z,_e)};I(re,z=>{s(p)?z(pe):z(ce,!1)})}var he=o(K,2);Kv(he,{get status(){return s(S)},get message(){return s(w)},get progress(){return s(x)},get show(){return s(m)},set show(z){f(m,z,!0)}});var fe=o(he,2);au(fe,{get part(){return s(P)},onsave:W,get show(){return s(y)},set show(z){f(y,z,!0)}});var ve=o(fe,2);lu(ve,{get part(){return s(j)},get show(){return s(_)},set show(z){f(_,z,!0)}}),Te(ie,()=>s(n),z=>f(n,z)),ct(de,()=>s(l),z=>f(l,z)),Te(X,()=>s(i),z=>f(i,z)),Te(C,()=>s(u),z=>f(u,z)),Te(ae,()=>s(v),z=>f(v,z)),Te(ye,()=>s(d),z=>f(d,z)),g(t,B),Xe()}Qe(["input","change","click"]);var fu=k('<div class="canvas-container svelte-1eph566"><div class="toolbar svelte-1eph566"><button title="Navigate (Pan)">✋</button> <button title="Select">↖</button></div>  <canvas class="svelte-1eph566"></canvas> <div class="zoom-controls svelte-1eph566"><button title="Reset Zoom" class="svelte-1eph566">⟲</button> <span class="zoom-level svelte-1eph566"> </span></div></div>');function pu(t,e){Ye(e,!1);let a=lt(e,"sheet",8,null),r=lt(e,"width",8,800),n=lt(e,"height",8,600);const l=Nr();let i=Ya(),u=null,v=1,d=Ya(1),p=0,b=0,h=Ya(!1),m=0,x=0,S=Ya("navigate"),w={minX:0,minY:0,maxX:100,maxY:100},y=0,P=0,_=null,j=null;Ot(()=>{s(i)&&(u=s(i).getContext("2d"),console.log("GncCanvas: mounted, ctx:",u),$())});function R(V){let K=1/0,te=1/0,ne=-1/0,D=-1/0,ue=!1,re=0,pe=0;console.log("calculateBounds: sheet.parts.length =",V.parts.length);for(const ce of V.parts){console.log("calculateBounds: part.contours.length =",ce.contours.length);for(const he of ce.contours){console.log("calculateBounds: contour.id =",he.id,"commands.length =",he.commands.length);for(const fe of he.commands)fe.x!==void 0&&(re=fe.x),fe.y!==void 0&&(pe=fe.y),(fe.x!==void 0||fe.y!==void 0)&&(ue=!0,re<K&&(K=re),re>ne&&(ne=re),pe<te&&(te=pe),pe>D&&(D=pe),console.log("calculateBounds: found point",re,pe,"from cmd.type =",fe.type))}}return console.log("calculateBounds: hasPoints =",ue,"bounds =",{minX:K,minY:te,maxX:ne,maxY:D}),ue?{minX:K,minY:te,maxX:ne,maxY:D}:{minX:0,minY:0,maxX:100,maxY:100}}function A(V,K){return{x:(V-y)/v+w.minX,y:(n()-K-P)/v+w.minY}}function $(){if(!u||!a()){console.log("GncCanvas draw: skipping - ctx:",!!u,"sheet:",!!a());return}console.log("GncCanvas draw: starting draw with sheet:",a()),u.fillStyle="#1e1e1e",u.fillRect(0,0,r(),n()),w=R(a()),console.log("GncCanvas draw: bounds:",w);const V=w.maxX-w.minX,K=w.maxY-w.minY;if(V===0&&K===0){console.log("GncCanvas draw: no data (dataW and dataH are 0)");return}const te=20,ne=r()-te*2,D=n()-te*2,ue=ne/V,re=D/K;v=Math.min(ue,re)*.95*s(d);const ce=V*v,he=K*v;y=(r()-ce)/2+p,P=(n()-he)/2+b;const fe=z=>y+(z-w.minX)*v,ve=z=>n()-(P+(z-w.minY)*v);a().parts.forEach((z,_e)=>{const xe=_e*137%360;z.contours.forEach(M=>{const E=_===M.id,ee=j===M.id;u.beginPath(),u.strokeStyle=E?"#ffffff":ee?"#fbbf24":`hsl(${xe}, 70%, 60%)`,u.lineWidth=E||ee?3:1.5,u.shadowBlur=E?10:ee?5:0,u.shadowColor=E?"#ffffff":ee?"#fbbf24":"transparent";let Se=null,Ce=null,ge=!1;M.commands.forEach(me=>{const Oe=Se,Be=Ce;if(me.x!==void 0&&(Se=me.x),me.y!==void 0&&(Ce=me.y),!(Se===null||Ce===null)){if(me.type==="G00"||me.command==="G"&&me.value===0)u.moveTo(fe(Se),ve(Ce)),ge=!0;else if(me.type==="G01"||me.command==="G"&&me.value===1||me.type==="MODAL"||me.type==="G41"||me.type==="G40")ge?u.lineTo(fe(Se),ve(Ce)):(u.moveTo(fe(Se),ve(Ce)),ge=!0);else if((me.type==="G02"||me.type==="G03"||me.command==="G"&&(me.value===2||me.value===3))&&me.i!==void 0&&me.j!==void 0&&Oe!==null&&Be!==null){const De=me.i,Ve=me.j,tt=Oe+De,at=Be+Ve,Ke=Math.sqrt(De*De+Ve*Ve),Ue=fe(tt),ot=ve(at),wt=Ke*v,vt=Math.atan2(ve(Be)-ot,fe(Oe)-Ue),J=Math.atan2(ve(Ce)-ot,fe(Se)-Ue),we=me.type==="G02"||me.command==="G"&&me.value===2;u.arc(Ue,ot,wt,vt,J,we)}}}),u.stroke(),u.shadowBlur=0})})}function F(V,K){if(!a())return null;const te=s(i).getBoundingClientRect(),ne=V-te.left,D=K-te.top,ue=A(ne,D),re=ue.x,pe=ue.y,ce=5/v;let he=null,fe=null,ve=1/0;for(const z of a().parts)for(const _e of z.contours){let xe=null,M=null,E=1/0;for(const ee of _e.commands){const Se=ee.x!==void 0?ee.x:xe,Ce=ee.y!==void 0?ee.y:M;let ge=1/0;if(xe!==null&&M!==null&&Se!==null&&Ce!==null){if(ee.type==="G01"||ee.command==="G"&&ee.value===1||ee.type==="MODAL"||ee.type==="G41"||ee.type==="G40")ge=H(re,pe,xe,M,Se,Ce);else if(ee.type==="G02"||ee.type==="G03"||ee.command==="G"&&(ee.value===2||ee.value===3)){const me=ee.i||0,Oe=ee.j||0,Be=xe+me,De=M+Oe,Ve=Math.sqrt(me*me+Oe*Oe),tt=Math.sqrt((re-Be)**2+(pe-De)**2);ge=Math.abs(tt-Ve);const at=Math.atan2(M-De,xe-Be),Ke=Math.atan2(Ce-De,Se-Be),Ue=Math.atan2(pe-De,re-Be),ot=ee.type==="G02"||ee.command==="G"&&ee.value===2;ie(Ue,at,Ke,ot)||(ge=1/0)}}ge<E&&(E=ge),xe=Se,M=Ce}E<ce&&E<ve&&(ve=E,he=_e,fe=z)}return he?{contour:he,part:fe}:null}function O(V){const K=F(V.clientX,V.clientY);K?(_=K.contour.id,l("select",K)):(_=null,l("select",null)),$()}function H(V,K,te,ne,D,ue){const re=V-te,pe=K-ne,ce=D-te,he=ue-ne,fe=re*ce+pe*he,ve=ce*ce+he*he;let z=-1;ve!=0&&(z=fe/ve);let _e,xe;z<0?(_e=te,xe=ne):z>1?(_e=D,xe=ue):(_e=te+z*ce,xe=ne+z*he);const M=V-_e,E=K-xe;return Math.sqrt(M*M+E*E)}function Z(V){V.preventDefault();const K=s(i).getBoundingClientRect(),te=V.clientX-K.left,ne=V.clientY-K.top,D=A(te,ne),ue=V.deltaY>0?.9:1.1,re=Math.max(.1,Math.min(10,s(d)*ue));if(v===0||s(d)===0)return;const ce=v/s(d)*re,he=w.maxX-w.minX,fe=w.maxY-w.minY,ve=he*ce,z=fe*ce,_e=te-(D.x-w.minX)*ce,xe=n()-ne-(D.y-w.minY)*ce;p=_e-(r()-ve)/2,b=xe-(n()-z)/2,f(d,re),$()}function W(V){m=V.clientX,x=V.clientY,s(S)==="navigate"&&f(h,!0)}function B(V){if(s(S)==="navigate"&&s(h)){const K=V.clientX-m,te=V.clientY-x;p+=K,b-=te,m=V.clientX,x=V.clientY,$()}else if(s(S)==="select"){const K=F(V.clientX,V.clientY),te=K?K.contour.id:null;te!==j&&(j=te,$())}}function N(){j!==null&&(j=null,$()),s(h)&&f(h,!1)}function L(V){const K=Math.abs(V.clientX-m),te=Math.abs(V.clientY-x),ne=K<5&&te<5;s(S)==="navigate"?f(h,!1):s(S)==="select"&&ne&&O(V)}function ie(V,K,te,ne){const D=Math.PI*2,ue=(V%D+D)%D,re=(K%D+D)%D,pe=(te%D+D)%D;if(ne){const ce=(re-pe+D)%D;return(re-ue+D)%D<=ce}else{const ce=(pe-re+D)%D;return(ue-re+D)%D<=ce}}function le(){f(d,1),p=0,b=0,$()}oi(()=>(Rr(a()),s(i)),()=>{a()&&s(i)&&(console.log("GncCanvas: sheet changed, redrawing...",a()),$())}),ci(),Or();var de=fu(),be=c(de),Y=c(be);Y.__click=()=>f(S,"navigate");let G;var se=o(Y,2);se.__click=()=>f(S,"select");let X;var C=o(be,2);C.__mousedown=W,C.__mousemove=B,C.__mouseup=L,on(C,V=>f(i,V),()=>s(i));var Q=o(C,2),oe=c(Q);oe.__click=le;var ae=o(oe,2),ye=c(ae);U(V=>{ts(de,`width: ${r()??""}px; height: ${n()??""}px;`),G=ze(Y,1,"svelte-1eph566",null,G,{active:s(S)==="navigate"}),X=ze(se,1,"svelte-1eph566",null,X,{active:s(S)==="select"}),Ge(C,"width",r()),Ge(C,"height",n()),ts(C,`cursor: ${s(S)==="navigate"?s(h)?"grabbing":"grab":"default"}`),T(ye,`${V??""}%`)},[()=>(s(d),pa(()=>Math.round(s(d)*100)))]),aa("wheel",C,Z),aa("mouseleave",C,N),g(t,de),Xe()}Qe(["click","mousedown","mousemove","mouseup"]);var hu=k('<span class="filename svelte-57krl6"> </span>'),_u=k('<div class="loading svelte-57krl6">Parsing GNC file...</div>'),gu=k('<div class="placeholder svelte-57krl6"><p>No file loaded.</p> <p class="hint svelte-57krl6">Upload a .GNC file to visualize and edit.</p></div>'),mu=k('<p class="hint-text svelte-57krl6">Load a GNC file to view properties.</p>'),bu=k('<h3 class="svelte-57krl6">Sheet Properties</h3> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Program Size (mm):</span> <div class="inline-inputs svelte-57krl6"><input type="number" step="0.1" class="svelte-57krl6"/> <span class="svelte-57krl6">×</span> <input type="number" step="0.1" class="svelte-57krl6"/></div></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Thickness (mm):</span> <input type="number" step="0.1"/></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Cut Count:</span> <input type="number" min="1"/></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Material:</span> <span class="value svelte-57krl6"> </span></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Total Parts:</span> <span class="value svelte-57krl6"> </span></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Total Contours:</span> <span class="value svelte-57krl6"> </span></div>',1),yu=k("<option> </option>"),wu=k('<div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Part Name:</span> <span class="value svelte-57krl6"> </span></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Contours:</span> <span class="value svelte-57krl6"> </span></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Corner Count:</span> <span class="value svelte-57krl6"> </span></div>',1),ku=k('<h3 class="svelte-57krl6">Part Properties</h3> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Select Part:</span> <select></select></div> <!>',1),xu=k('<div class="prop-field svelte-57krl6"><label class="svelte-57krl6"> </label> <input type="text" class="svelte-57krl6"/></div>'),Su=k('<p class="empty-props">No technological parameters found.</p>'),qu=k('<div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Contour ID:</span> <span class="value svelte-57krl6"> </span></div> <div class="prop-group svelte-57krl6"><span class="label svelte-57krl6">Corners:</span> <span class="value svelte-57krl6"> </span></div> <h4 class="section-title svelte-57krl6">Technology Parameters</h4> <div class="p-codes-list"><!></div>',1),Tu=k(`<p class="hint-text svelte-57krl6">Select a contour on the canvas to view and edit its
                        properties.</p>`),ju=k('<h3 class="svelte-57krl6">Contour Properties</h3> <!>',1),Eu=k('<div class="view-container svelte-57krl6"><div class="header svelte-57krl6"><h2 class="svelte-57krl6">GNC Editor</h2> <div class="actions svelte-57krl6"><input type="file" id="gnc-upload" accept=".gnc,.nc" class="file-input svelte-57krl6"/> <label for="gnc-upload" class="upload-btn svelte-57krl6">Open File</label> <!> <button class="save-btn svelte-57krl6">Save Changes</button></div></div> <div class="workspace svelte-57krl6"><div class="canvas-area svelte-57krl6"><!></div> <div class="properties-panel svelte-57krl6"><div class="mode-selector svelte-57krl6"><button>Sheet</button> <button>Part</button> <button>Contour</button></div> <!></div></div></div>');function Pu(t,e){Ye(e,!0);let a=q(null),r=q(null),n=q(""),l=q(!1),i=q("sheet"),u=q(null);async function v(G){const se=G.target.files[0];if(se){f(n,se.name,!0),f(l,!0),f(a,null),f(r,null);try{f(a,await lo(se),!0),console.log("Parsed GNC sheet:",s(a)),console.log("Parts:",s(a)?.parts),console.log("Total parts:",s(a)?.total_parts),s(a)?.parts?.length>0&&f(u,s(a).parts[0].id,!0)}catch(X){alert("Error parsing GNC file"),console.error(X)}finally{f(l,!1)}}}function d(G){const se=G.detail;if(!se){f(r,null);return}se.contour?(f(r,se.contour,!0),se.part?(f(u,se.part.id,!0),s(i)==="sheet"&&f(i,"contour")):f(i,"contour")):(f(r,se,!0),f(i,"contour"))}async function p(){if(!(!s(a)||!s(n)))try{const G=await io(s(a),s(n),!0);alert(`Saved successfully to ${G.path}`)}catch{alert("Failed to save file")}}function b(G,se){s(r)&&s(r).metadata&&(s(r).metadata[G]=se)}function h(G,se){s(a)&&(s(a)[G]=se)}let m=Ze(()=>s(a)?.parts?.find(G=>G.id===s(u)));var x=Eu(),S=c(x),w=o(c(S),2),y=c(w);y.__change=v;var P=o(y,4);{var _=G=>{var se=hu(),X=c(se);U(()=>T(X,s(n))),g(G,se)};I(P,G=>{s(n)&&G(_)})}var j=o(P,2);j.__click=p;var R=o(S,2),A=c(R),$=c(A);{var F=G=>{var se=_u();g(G,se)},O=G=>{var se=Le(),X=qe(se);{var C=oe=>{pu(oe,{get sheet(){return s(a)},width:800,height:600,$$events:{select:d}})},Q=oe=>{var ae=gu();g(oe,ae)};I(X,oe=>{s(a)?oe(C):oe(Q,!1)},!0)}g(G,se)};I($,G=>{s(l)?G(F):G(O,!1)})}var H=o(A,2),Z=c(H),W=c(Z);W.__click=()=>f(i,"sheet");let B;var N=o(W,2);N.__click=()=>f(i,"part");let L;var ie=o(N,2);ie.__click=()=>f(i,"contour");let le;var de=o(Z,2);{var be=G=>{var se=mu();g(G,se)},Y=G=>{var se=Le(),X=qe(se);{var C=oe=>{var ae=bu(),ye=o(qe(ae),2),V=o(c(ye),2),K=c(V);K.__input=E=>h("program_width",parseFloat(E.target.value));var te=o(K,4);te.__input=E=>h("program_height",parseFloat(E.target.value));var ne=o(ye,2),D=o(c(ne),2);D.__input=E=>h("thickness",parseFloat(E.target.value));var ue=o(ne,2),re=o(c(ue),2);re.__input=E=>h("cut_count",parseInt(E.target.value));var pe=o(ue,2),ce=o(c(pe),2),he=c(ce),fe=o(pe,2),ve=o(c(fe),2),z=c(ve),_e=o(fe,2),xe=o(c(_e),2),M=c(xe);U(()=>{Ga(K,s(a).program_width||0),Ga(te,s(a).program_height||0),Ga(D,s(a).thickness||0),Ga(re,s(a).cut_count||1),T(he,s(a).material||"N/A"),T(z,s(a).total_parts),T(M,s(a).total_contours)}),g(oe,ae)},Q=oe=>{var ae=Le(),ye=qe(ae);{var V=te=>{var ne=ku(),D=o(qe(ne),2),ue=o(c(D),2);Ae(ue,21,()=>s(a).parts,He,(ce,he)=>{var fe=yu(),ve=c(fe),z={};U(()=>{T(ve,s(he).name||`Part ${s(he).id}`),z!==(z=s(he).id)&&(fe.value=(fe.__value=s(he).id)??"")}),g(ce,fe)});var re=o(D,2);{var pe=ce=>{var he=wu(),fe=qe(he),ve=o(c(fe),2),z=c(ve),_e=o(fe,2),xe=o(c(_e),2),M=c(xe),E=o(_e,2),ee=o(c(E),2),Se=c(ee);U(()=>{T(z,s(m).name||"N/A"),T(M,s(m).contours.length),T(Se,s(m).corner_count)}),g(ce,he)};I(re,ce=>{s(m)&&ce(pe)})}ct(ue,()=>s(u),ce=>f(u,ce)),g(te,ne)},K=te=>{var ne=Le(),D=qe(ne);{var ue=re=>{var pe=ju(),ce=o(qe(pe),2);{var he=ve=>{var z=qu(),_e=qe(z),xe=o(c(_e),2),M=c(xe),E=o(_e,2),ee=o(c(E),2),Se=c(ee),Ce=o(E,4),ge=c(Ce);{var me=Be=>{var De=Le(),Ve=qe(De);Ae(Ve,17,()=>Object.entries(s(r).metadata),He,(tt,at)=>{var Ke=Ze(()=>Ws(s(at),2));let Ue=()=>s(Ke)[0],ot=()=>s(Ke)[1];var wt=Le(),vt=qe(wt);{var J=we=>{var Ne=xu(),nt=c(Ne),_t=c(nt),ht=o(nt,2);ht.__input=ra=>b(Ue(),ra.target.value),U(()=>{Ge(nt,"for",Ue()),T(_t,Ue()),Ge(ht,"id",Ue()),Ga(ht,ot())}),g(we,Ne)};I(vt,we=>{Ue().startsWith("P")&&we(J)})}g(tt,wt)}),g(Be,De)},Oe=Be=>{var De=Su();g(Be,De)};I(ge,Be=>{s(r).metadata?Be(me):Be(Oe,!1)})}U(()=>{T(M,`#${s(r).id??""}`),T(Se,s(r).corner_count)}),g(ve,z)},fe=ve=>{var z=Tu();g(ve,z)};I(ce,ve=>{s(r)?ve(he):ve(fe,!1)})}g(re,pe)};I(D,re=>{s(i)==="contour"&&re(ue)},!0)}g(te,ne)};I(ye,te=>{s(i)==="part"?te(V):te(K,!1)},!0)}g(oe,ae)};I(X,oe=>{s(i)==="sheet"?oe(C):oe(Q,!1)},!0)}g(G,se)};I(de,G=>{s(a)?G(Y,!1):G(be)})}U(()=>{j.disabled=!s(a),B=ze(W,1,"svelte-57krl6",null,B,{active:s(i)==="sheet"}),L=ze(N,1,"svelte-57krl6",null,L,{active:s(i)==="part"}),le=ze(ie,1,"svelte-57krl6",null,le,{active:s(i)==="contour"})}),g(t,x),Xe()}Qe(["change","click","input"]);var Cu=k("<option> </option>"),Au=k('<div class="form-panel svelte-gim6qq"><h3>New Stock Item</h3> <div class="form-grid svelte-gim6qq"><div class="field svelte-gim6qq"><label class="svelte-gim6qq">Material</label> <select class="svelte-gim6qq"><option>Select Material...</option><!></select></div> <div class="field svelte-gim6qq"><label class="svelte-gim6qq">Width (mm)</label> <input type="number" min="0" class="svelte-gim6qq"/></div> <div class="field svelte-gim6qq"><label class="svelte-gim6qq">Height (mm)</label> <input type="number" min="0" class="svelte-gim6qq"/></div> <div class="field svelte-gim6qq"><label class="svelte-gim6qq">Quantity</label> <input type="number" min="0" class="svelte-gim6qq"/></div> <div class="field svelte-gim6qq"><label class="svelte-gim6qq">Location</label> <input type="text" placeholder="e.g. A-01" class="svelte-gim6qq"/></div> <div class="actions"><button class="save-btn svelte-gim6qq">Save Item</button></div></div></div>'),Du=k('<p class="loading svelte-gim6qq">Loading stock...</p>'),zu=k('<div class="empty-state svelte-gim6qq"><p>No stock items found.</p></div>'),Ru=k('<tr><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"><button class="delete-btn svelte-gim6qq">Delete</button></td></tr>'),Mu=k('<div class="table-container svelte-gim6qq"><table class="svelte-gim6qq"><thead><tr><th class="svelte-gim6qq">Material</th><th class="svelte-gim6qq">Dimensions</th><th class="svelte-gim6qq">Qty</th><th class="svelte-gim6qq">Reserved</th><th class="svelte-gim6qq">Location</th><th class="svelte-gim6qq">Actions</th></tr></thead><tbody></tbody></table></div>'),Iu=k('<div class="view-container svelte-gim6qq"><div class="header svelte-gim6qq"><h2 class="svelte-gim6qq">Stock Management</h2> <button class="primary-btn svelte-gim6qq"> </button></div> <!> <!></div>');function Lu(t,e){Ye(e,!0);let a=q(ke([])),r=q(ke([])),n=q(!0),l=q(!1),i=q(ke({material_id:"",width:0,height:0,quantity:0,location:""}));async function u(){f(n,!0);try{const[_,j]=await Promise.all([to(),ja()]);f(a,_,!0),f(r,j,!0)}catch(_){console.error(_)}finally{f(n,!1)}}async function v(){if(s(i).material_id)try{const _=await ao(s(i));f(a,[...s(a),_],!0),f(l,!1),f(i,{material_id:"",width:0,height:0,quantity:0,location:""},!0)}catch(_){alert("Failed to add stock item"),console.error(_)}}async function d(_){if(confirm("Are you sure you want to delete this item?"))try{await so(_),f(a,s(a).filter(j=>j.id!==_),!0)}catch{alert("Failed to delete item")}}Ot(u);var p=Iu(),b=c(p),h=o(c(b),2);h.__click=()=>f(l,!s(l));var m=c(h),x=o(b,2);{var S=_=>{var j=Au(),R=o(c(j),2),A=c(R),$=o(c(A),2),F=c($);F.value=F.__value="";var O=o(F);Ae(O,17,()=>s(r),He,(Y,G)=>{var se=Cu(),X=c(se),C={};U(()=>{T(X,s(G).name),C!==(C=s(G).id)&&(se.value=(se.__value=s(G).id)??"")}),g(Y,se)});var H=o(A,2),Z=o(c(H),2),W=o(H,2),B=o(c(W),2),N=o(W,2),L=o(c(N),2),ie=o(N,2),le=o(c(ie),2),de=o(ie,2),be=c(de);be.__click=v,ct($,()=>s(i).material_id,Y=>s(i).material_id=Y),Te(Z,()=>s(i).width,Y=>s(i).width=Y),Te(B,()=>s(i).height,Y=>s(i).height=Y),Te(L,()=>s(i).quantity,Y=>s(i).quantity=Y),Te(le,()=>s(i).location,Y=>s(i).location=Y),g(_,j)};I(x,_=>{s(l)&&_(S)})}var w=o(x,2);{var y=_=>{var j=Du();g(_,j)},P=_=>{var j=Le(),R=qe(j);{var A=F=>{var O=zu();g(F,O)},$=F=>{var O=Mu(),H=c(O),Z=o(c(H));Ae(Z,21,()=>s(a),He,(W,B)=>{var N=Ru(),L=c(N),ie=c(L),le=o(L),de=c(le),be=o(le),Y=c(be),G=o(be),se=c(G),X=o(G),C=c(X),Q=o(X),oe=c(Q);oe.__click=()=>d(s(B).id),U(()=>{T(ie,s(B).material?s(B).material.name:"Unknown"),T(de,`${s(B).width??""} x ${s(B).height??""}`),T(Y,s(B).quantity),T(se,s(B).reserved),T(C,s(B).location||"-")}),g(W,N)}),g(F,O)};I(R,F=>{s(a).length===0?F(A):F($,!1)},!0)}g(_,j)};I(w,_=>{s(n)?_(y):_(P,!1)})}U(()=>T(m,s(l)?"Cancel":"Add Stock")),g(t,p),Xe()}Qe(["click"]);var Ou=k('<p class="loading svelte-18qgo6s">Loading logs...</p>'),Nu=k('<div class="empty-state svelte-18qgo6s">No logs yet. Start the conversation!</div>'),$u=k('<div class="log-card svelte-18qgo6s"><div class="log-header svelte-18qgo6s"><span class="author svelte-18qgo6s"> </span> <span class="time svelte-18qgo6s"> </span></div> <div class="log-content svelte-18qgo6s"> </div></div>'),Fu=k('<div class="logs-feed svelte-18qgo6s"></div>'),Bu=k('<div class="view-container svelte-18qgo6s"><div class="header svelte-18qgo6s"><h2 class="svelte-18qgo6s">Shift Logs</h2></div> <div class="input-area svelte-18qgo6s"><div class="input-row svelte-18qgo6s"><input type="text" placeholder="Author Name" class="author-input svelte-18qgo6s"/> <button class="post-btn svelte-18qgo6s">Post Log</button></div> <textarea placeholder="What happened during this shift?" rows="3" class="svelte-18qgo6s"></textarea></div> <!></div>');function Gu(t,e){Ye(e,!0);let a=q(ke([])),r=q(!0),n=q(""),l=q(ke(localStorage.getItem("shift_author")||""));async function i(){f(r,!0);try{f(a,await no(),!0)}catch(y){console.error(y)}finally{f(r,!1)}}async function u(){if(!(!s(n).trim()||!s(l).trim())){localStorage.setItem("shift_author",s(l));try{const y=await ro({author:s(l),content:s(n),type:"info"});f(a,[y,...s(a)],!0),f(n,"")}catch{alert("Failed to add log")}}}Ot(i);var v=Bu(),d=o(c(v),2),p=c(d),b=c(p),h=o(b,2);h.__click=u;var m=o(p,2),x=o(d,2);{var S=y=>{var P=Ou();g(y,P)},w=y=>{var P=Le(),_=qe(P);{var j=A=>{var $=Nu();g(A,$)},R=A=>{var $=Fu();Ae($,21,()=>s(a),He,(F,O)=>{var H=$u(),Z=c(H),W=c(Z),B=c(W),N=o(W,2),L=c(N),ie=o(Z,2),le=c(ie);U(de=>{T(B,s(O).author),T(L,de),T(le,s(O).content)},[()=>new Date(s(O).timestamp).toLocaleString()]),g(F,H)}),g(A,$)};I(_,A=>{s(a).length===0?A(j):A(R,!1)},!0)}g(y,P)};I(x,y=>{s(r)?y(S):y(w,!1)})}U(y=>h.disabled=y,[()=>!s(n).trim()||!s(l).trim()]),Te(b,()=>s(l),y=>f(l,y)),Te(m,()=>s(n),y=>f(n,y)),g(t,v),Xe()}Qe(["click"]);var Uu=k('<button type="button" class="btn-outline svelte-f0yvr0">📷 View Gallery</button>'),Hu=k('<p class="info-text svelte-f0yvr0"> </p>'),Yu=k('<p class="info-text svelte-f0yvr0">Uploading...</p>'),Xu=k('<p class="error-text svelte-f0yvr0"> </p>'),Vu=k('<p class="error-text svelte-f0yvr0"> </p>'),Wu=k('<div class="attachment-item svelte-f0yvr0"><span class="file-name svelte-f0yvr0"> </span> <button type="button" class="remove-btn svelte-f0yvr0">❌</button></div>'),Zu=k('<div class="attachment-item new svelte-f0yvr0"><span class="file-name svelte-f0yvr0"> </span> <button type="button" class="remove-btn svelte-f0yvr0">❌</button></div>'),Ju=k('<div class="attachments-list svelte-f0yvr0"><!> <!></div>'),Qu=k('<div class="form-container svelte-f0yvr0"><h3 class="svelte-f0yvr0"> </h3> <form><div class="form-section upload-section svelte-f0yvr0"><h4 class="svelte-f0yvr0">Files & Scanning</h4> <div class="upload-buttons svelte-f0yvr0"><div class="upload-btn-wrapper svelte-f0yvr0"><button type="button" class="btn-outline svelte-f0yvr0">📄 Add Attachments</button> <input type="file" multiple title="Add Attachments (No Scan)" class="svelte-f0yvr0"/></div> <div class="upload-btn-wrapper svelte-f0yvr0"><button type="button" class="btn-outline svelte-f0yvr0">🔍 Scan Documents (OCR)</button> <input type="file" multiple accept="image/*,application/pdf" title="Scan (OCR)" class="svelte-f0yvr0"/></div> <!></div> <!> <!> <!> <!> <!></div> <div class="form-group svelte-f0yvr0"><label for="name" class="svelte-f0yvr0">Name</label> <input id="name" type="text" required placeholder="e.g. Project Alpha Specs" class="svelte-f0yvr0"/></div> <div class="form-group svelte-f0yvr0"><label for="description" class="svelte-f0yvr0">Description</label> <textarea id="description" rows="3" placeholder="Brief description of the document..." class="svelte-f0yvr0"></textarea></div> <div class="form-group svelte-f0yvr0"><label for="tags" class="svelte-f0yvr0">Tags</label> <!></div> <div class="form-group svelte-f0yvr0"><label for="content" class="svelte-f0yvr0">Recognized Content (Markdown)</label> <textarea id="content" rows="10" placeholder="Recognized document content will appear here..." class="svelte-f0yvr0"></textarea></div> <div class="row svelte-f0yvr0"><div class="form-group half svelte-f0yvr0"><label for="type" class="svelte-f0yvr0">Type</label> <select id="type" class="svelte-f0yvr0"><option>Plan</option><option>Mail</option><option>Other</option></select></div> <div class="form-group half svelte-f0yvr0"><label for="status" class="svelte-f0yvr0">Status</label> <select id="status" class="svelte-f0yvr0"><option>In Progress</option><option>Done</option></select></div></div> <div class="row svelte-f0yvr0"><div class="form-group half svelte-f0yvr0"><label for="date" class="svelte-f0yvr0">Registration Date</label> <input id="date" type="date" class="svelte-f0yvr0"/></div> <div class="form-group half svelte-f0yvr0"><label for="done_date" class="svelte-f0yvr0">Done Date</label> <input id="done_date" type="date" class="svelte-f0yvr0"/></div></div> <div class="form-group svelte-f0yvr0"><label for="author" class="svelte-f0yvr0">Author</label> <input id="author" type="text" placeholder="Your Name" class="svelte-f0yvr0"/></div> <div class="actions svelte-f0yvr0"><button type="button" class="btn-secondary svelte-f0yvr0">Cancel</button> <button type="submit" class="btn-primary svelte-f0yvr0"> </button></div></form> <!></div>');function Ku(t,e){Ye(e,!0);let a=lt(e,"document",3,null),r=q(ke(a()?.name||"")),n=q(ke(a()?.description||"")),l=q(ke(a()?.type||"plan")),i=q(ke(a()?.status||"in_progress")),u=q(ke(a()?.registration_date||"")),v=q(ke(a()?.content||"")),d=q(ke(a()?.author||"")),p=q(ke(a()?.done_date||"")),b=ke(a()?.attachments||[]),h=q(ke([])),m=q(ke(a()?.tags?.map(J=>J.name)||[])),x=q(!1),S=q(!1),w=q(!1),y=q(""),P=q(""),_=q(""),j=q(null);Ot(()=>{if(s(i)==="unregistered"&&f(i,"in_progress"),!a()){const J=localStorage.getItem("doc_author");J&&f(d,J,!0)}}),Lt(()=>{s(i)==="done"&&!s(p)&&f(p,new Date().toISOString().split("T")[0],!0)});async function R(J){const we=Array.from(J.target.files);if(we.length!==0){f(x,!0),f(y,"");try{for(let Ne=0;Ne<we.length;Ne++){const nt=we[Ne];f(P,`Scanning file ${Ne+1} of ${we.length}...`);const _t=await Bi(nt);_t.name&&!s(r)&&f(r,_t.name,!0);const ht=_t.content||"";s(v)&&ht?f(v,s(v)+(`

---

`+ht)):ht&&f(v,ht,!0),_t.attachment&&s(h).push(_t.attachment)}}catch(Ne){f(y,"Failed to scan one or more documents. Please try again or enter details manually."),console.error(Ne)}finally{f(x,!1),f(P,""),J.target.value=""}}}async function A(J){const we=Array.from(J.target.files);if(we.length!==0){f(S,!0);try{for(const Ne of we){const nt=await cn(Ne);s(h).push({file_path:nt.file_path,filename:nt.filename,media_type:nt.media_type})}}catch(Ne){console.error("Upload failed",Ne),alert("Failed to upload attachment")}finally{f(S,!1),J.target.value=""}}}function $(){f(j,[...b,...s(h)],!0)}async function F(J,we){if(we)s(h).splice(J,1);else{if(!confirm("Permanently delete this attachment?"))return;const Ne=b[J];try{await Wi(Ne.id),b.splice(J,1)}catch(nt){console.error("Failed to delete attachment",nt),alert("Failed to delete attachment")}}}async function O(J){J.preventDefault(),f(w,!0),f(_,"");try{s(d)&&localStorage.setItem("doc_author",s(d));const we={name:s(r),description:s(n),type:s(l),status:s(i),registration_date:s(u)||void 0,content:s(v),author:s(d),done_date:s(p)||void 0,attachments:s(h),tags:s(m)};a()?await Fi(a().id,we):await Ni(we),a()||(f(r,""),f(n,""),f(l,"plan"),f(i,"in_progress"),f(u,""),f(v,""),f(d,localStorage.getItem("doc_author")||"",!0),f(p,""),f(h,[],!0),f(m,[],!0)),e.onDocumentCreated()}catch(we){console.error("Failed to save document:",we),f(_,"Failed to save document. Please try again.")}finally{f(w,!1)}}var H=Qu(),Z=c(H),W=c(Z),B=o(Z,2),N=c(B),L=o(c(N),2),ie=c(L),le=o(c(ie),2);le.__change=A;var de=o(ie,2),be=o(c(de),2);be.__change=R;var Y=o(de,2);{var G=J=>{var we=Uu();we.__click=$,g(J,we)};I(Y,J=>{(b.length>0||s(h).length>0)&&J(G)})}var se=o(L,2);{var X=J=>{var we=Hu(),Ne=c(we);U(()=>T(Ne,s(P)||"Scanning... Please wait.")),g(J,we)};I(se,J=>{s(x)&&J(X)})}var C=o(se,2);{var Q=J=>{var we=Yu();g(J,we)};I(C,J=>{s(S)&&J(Q)})}var oe=o(C,2);{var ae=J=>{var we=Xu(),Ne=c(we);U(()=>T(Ne,s(y))),g(J,we)};I(oe,J=>{s(y)&&J(ae)})}var ye=o(oe,2);{var V=J=>{var we=Vu(),Ne=c(we);U(()=>T(Ne,s(_))),g(J,we)};I(ye,J=>{s(_)&&J(V)})}var K=o(ye,2);{var te=J=>{var we=Ju(),Ne=c(we);Ae(Ne,17,()=>b,He,(_t,ht,ra)=>{var ha=Wu(),Ut=c(ha),$a=c(Ut),Fa=o(Ut,2);Fa.__click=()=>F(ra,!1),U(()=>{Ge(Ut,"title",s(ht).filename),T($a,s(ht).filename)}),g(_t,ha)});var nt=o(Ne,2);Ae(nt,17,()=>s(h),He,(_t,ht,ra)=>{var ha=Zu(),Ut=c(ha),$a=c(Ut),Fa=o(Ut,2);Fa.__click=()=>F(ra,!0),U(()=>{Ge(Ut,"title",s(ht).filename),T($a,`(New) ${s(ht).filename??""}`)}),g(_t,ha)}),g(J,we)};I(K,J=>{(b.length>0||s(h).length>0)&&J(te)})}var ne=o(N,2),D=o(c(ne),2),ue=o(ne,2),re=o(c(ue),2),pe=o(ue,2),ce=o(c(pe),2);ev(ce,{get selectedTags(){return s(m)},set selectedTags(J){f(m,J,!0)}});var he=o(pe,2),fe=o(c(he),2),ve=o(he,2),z=c(ve),_e=o(c(z),2),xe=c(_e);xe.value=xe.__value="plan";var M=o(xe);M.value=M.__value="mail";var E=o(M);E.value=E.__value="other";var ee=o(z,2),Se=o(c(ee),2),Ce=c(Se);Ce.value=Ce.__value="in_progress";var ge=o(Ce);ge.value=ge.__value="done";var me=o(ve,2),Oe=c(me),Be=o(c(Oe),2),De=o(Oe,2),Ve=o(c(De),2),tt=o(me,2),at=o(c(tt),2),Ke=o(tt,2),Ue=c(Ke);Ue.__click=function(...J){e.onCancel?.apply(this,J)};var ot=o(Ue,2),wt=c(ot),vt=o(B,2);{let J=Ze(()=>!!s(j)),we=Ze(()=>s(j)||[]);Kr(vt,{get isOpen(){return s(J)},close:()=>f(j,null),get attachments(){return s(we)}})}U(()=>{T(W,a()?"Edit Document":"New Document"),Ve.disabled=s(i)!=="done",ot.disabled=s(w)||s(S)||s(x),T(wt,s(w)?"Saving...":a()?"Save Changes":"Register Document")}),aa("submit",B,O),Te(D,()=>s(r),J=>f(r,J)),Te(re,()=>s(n),J=>f(n,J)),Te(fe,()=>s(v),J=>f(v,J)),ct(_e,()=>s(l),J=>f(l,J)),ct(Se,()=>s(i),J=>f(i,J)),Te(Be,()=>s(u),J=>f(u,J)),Te(Ve,()=>s(p),J=>f(p,J)),Te(at,()=>s(d),J=>f(d,J)),g(t,H),Xe()}Qe(["change","click"]);var ed=k('<button class="add-btn svelte-1n46o8q"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg> New Document</button>'),td=k('<div class="startup-overlay svelte-1n46o8q"><div class="startup-modal svelte-1n46o8q"><div class="startup-header svelte-1n46o8q"><h2 class="svelte-1n46o8q">Welcome to DocuFlow</h2> <p class="svelte-1n46o8q">Please configure the database connection to continue.</p></div> <!></div></div>'),ad=k('<div class="app-container svelte-1n46o8q"><!> <div class="main-content-wrapper svelte-1n46o8q"><header class="svelte-1n46o8q"><div class="header-content svelte-1n46o8q"><h1 class="svelte-1n46o8q"> </h1> <div class="header-actions svelte-1n46o8q"><button class="icon-btn svelte-1n46o8q" title="Settings"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg></button> <!></div></div></header> <main class="svelte-1n46o8q"><!></main></div> <!> <!> <!></div>');function sd(t,e){Ye(e,!0);let a=q(!1),r=q("dashboard"),n=q(!1),l=q(!1),i=q(null),u=q(null);function v(Y){f(r,Y,!0)}function d(Y){switch(Y){case"dashboard":return"Dashboard";case"documents":return"Documents";case"journal":return"Journal";case"job":return"Job Processing";case"parts":return"Parts Library";case"gnc":return"GNC Editor";case"stock":return"Stock Management";case"logs":return"Shift Logs";default:return"DocuFlow"}}function p(){f(i,null),f(n,!0)}function b(Y){f(i,Y,!0),f(n,!0)}function h(){f(n,!1),f(i,null)}function m(){f(l,!0)}function x(){f(l,!1)}function S(){h(),s(u)&&s(u).refresh&&s(u).refresh()}Ot(async()=>{const Y=localStorage.getItem("user_role");(!Y||Y==="operator")&&localStorage.setItem("user_role","admin");try{(await Li()).status!=="configured"&&f(a,!0)}catch(G){console.error("Config check failed",G)}});function w(){f(a,!1)}var y=ad(),P=c(y);mo(P,{get activeView(){return s(r)},onSelect:v});var _=o(P,2),j=c(_),R=c(j),A=c(R),$=c(A),F=o(A,2),O=c(F);O.__click=m;var H=o(O,2);{var Z=Y=>{var G=ed();G.__click=p,g(Y,G)};I(H,Y=>{s(r)==="documents"&&Y(Z)})}var W=o(j,2),B=c(W);{var N=Y=>{So(Y,{})},L=Y=>{var G=Le(),se=qe(G);{var X=Q=>{on(qv(Q,{onEdit:b}),oe=>f(u,oe,!0),()=>s(u))},C=Q=>{var oe=Le(),ae=qe(oe);{var ye=K=>{Ov(K,{})},V=K=>{var te=Le(),ne=qe(te);{var D=re=>{Xv(re,{})},ue=re=>{var pe=Le(),ce=qe(pe);{var he=ve=>{du(ve,{})},fe=ve=>{var z=Le(),_e=qe(z);{var xe=E=>{Pu(E,{})},M=E=>{var ee=Le(),Se=qe(ee);{var Ce=me=>{Lu(me,{})},ge=me=>{var Oe=Le(),Be=qe(Oe);{var De=Ve=>{Gu(Ve,{})};I(Be,Ve=>{s(r)==="logs"&&Ve(De)},!0)}g(me,Oe)};I(Se,me=>{s(r)==="stock"?me(Ce):me(ge,!1)},!0)}g(E,ee)};I(_e,E=>{s(r)==="gnc"?E(xe):E(M,!1)},!0)}g(ve,z)};I(ce,ve=>{s(r)==="parts"?ve(he):ve(fe,!1)},!0)}g(re,pe)};I(ne,re=>{s(r)==="job"?re(D):re(ue,!1)},!0)}g(K,te)};I(ae,K=>{s(r)==="journal"?K(ye):K(V,!1)},!0)}g(Q,oe)};I(se,Q=>{s(r)==="documents"?Q(X):Q(C,!1)},!0)}g(Y,G)};I(B,Y=>{s(r)==="dashboard"?Y(N):Y(L,!1)})}var ie=o(_,2);Us(ie,{get isOpen(){return s(n)},close:h,children:(Y,G)=>{Ku(Y,{onDocumentCreated:S,onCancel:h,get document(){return s(i)}})},$$slots:{default:!0}});var le=o(ie,2);Us(le,{get isOpen(){return s(l)},close:x,children:(Y,G)=>{On(Y,{get isOpen(){return s(l)},close:x})},$$slots:{default:!0}});var de=o(le,2);{var be=Y=>{var G=td(),se=c(G),X=o(c(se),2);On(X,{isOpen:!0,close:w}),g(Y,G)};I(de,Y=>{s(a)&&Y(be)})}U(Y=>T($,Y),[()=>d(s(r))]),g(t,y),Xe()}Qe(["click"]);window.onerror=function(t,e,a,r,n){const l=document.createElement("div");l.style.position="fixed",l.style.top="0",l.style.left="0",l.style.width="100%",l.style.background="#fee2e2",l.style.color="#991b1b",l.style.padding="20px",l.style.zIndex="999999",l.style.borderBottom="2px solid #7f1d1d",l.innerHTML=`<strong>Error:</strong> ${t}<br><small>${e}:${a}:${r}</small><pre>${n?.stack||""}</pre>`,document.body.appendChild(l)};window.onunhandledrejection=function(t){const e=document.createElement("div");e.innerHTML+=`<br><strong>Unhandled Rejection:</strong> ${t.reason}`,document.body.prepend(e)};bi(sd,{target:document.getElementById("app")});
