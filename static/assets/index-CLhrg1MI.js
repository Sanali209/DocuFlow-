(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();const gn=!1;var Qs=Array.isArray,$i=Array.prototype.indexOf,Ks=Array.from,Oi=Object.defineProperty,Ia=Object.getOwnPropertyDescriptor,Er=Object.getOwnPropertyDescriptors,Ii=Object.prototype,Fi=Array.prototype,Nn=Object.getPrototypeOf,ar=Object.isExtensible;function gs(a){return typeof a=="function"}function Li(a){return a()}function bn(a){for(var e=0;e<a.length;e++)a[e]()}function qr(){var a,e,t=new Promise((r,n)=>{a=r,e=n});return{promise:t,resolve:a,reject:e}}function qs(a,e){if(Array.isArray(a))return a;if(!(Symbol.iterator in a))return Array.from(a);const t=[];for(const r of a)if(t.push(r),t.length===e)break;return t}const Lt=2,Js=4,Ns=8,jr=1<<24,Ma=16,za=32,as=64,Rn=128,ua=512,Xt=1024,Vt=2048,Da=4096,ia=8192,Pa=16384,Cn=32768,Ba=65536,sr=1<<17,Ar=1<<18,ps=1<<19,Pr=1<<20,Aa=1<<25,Qa=32768,mn=1<<21,Mn=1<<22,Fa=1<<23,ka=Symbol("$state"),Nr=Symbol("legacy props"),Ui=Symbol(""),cs=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Rr(a){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Bi(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Gi(a){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Ji(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Yi(a){throw new Error("https://svelte.dev/e/effect_orphan")}function Xi(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Hi(a){throw new Error("https://svelte.dev/e/props_invalid_value")}function Wi(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Zi(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Vi(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Qi(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Ki=1,el=2,Cr=4,tl=8,al=16,sl=1,nl=2,rl=4,il=8,ll=16,ol=1,cl=2,Ft=Symbol(),vl="http://www.w3.org/1999/xhtml";function ul(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function dl(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Mr(a){return a===this.v}function fl(a,e){return a!=a?e==e:a!==e||a!==null&&typeof a=="object"||typeof a=="function"}function zr(a){return!fl(a,this.v)}let hs=!1,pl=!1;function hl(){hs=!0}let Tt=null;function vs(a){Tt=a}function lt(a,e=!1,t){Tt={p:Tt,i:!1,c:null,e:null,s:a,x:null,l:hs&&!e?{s:null,u:null,$:[]}:null}}function ot(a){var e=Tt,t=e.e;if(t!==null){e.e=null;for(var r of t)Kr(r)}return a!==void 0&&(e.x=a),e.i=!0,Tt=e.p,a??{}}function Rs(){return!hs||Tt!==null&&Tt.l===null}let Xa=[];function Dr(){var a=Xa;Xa=[],bn(a)}function xa(a){if(Xa.length===0&&!xs){var e=Xa;queueMicrotask(()=>{e===Xa&&Dr()})}Xa.push(a)}function _l(){for(;Xa.length>0;)Dr()}function $r(a){var e=at;if(e===null)return He.f|=Fa,a;if((e.f&Cn)===0){if((e.f&Rn)===0)throw a;e.b.error(a)}else us(a,e)}function us(a,e){for(;e!==null;){if((e.f&Rn)!==0)try{e.b.error(a);return}catch(t){a=t}e=e.parent}throw a}const gl=-7169;function $t(a,e){a.f=a.f&gl|e}function zn(a){(a.f&ua)!==0||a.deps===null?$t(a,Xt):$t(a,Da)}function Or(a){if(a!==null)for(const e of a)(e.f&Lt)===0||(e.f&Qa)===0||(e.f^=Qa,Or(e.deps))}function Ir(a,e,t){(a.f&Vt)!==0?e.add(a):(a.f&Da)!==0&&t.add(a),Or(a.deps),$t(a,Xt)}const Is=new Set;let tt=null,Ys=null,_a=null,ra=[],en=null,yn=!1,xs=!1;class La{committed=!1;current=new Map;previous=new Map;#e=new Set;#s=new Set;#t=0;#r=0;#i=null;#n=new Set;#a=new Set;skipped_effects=new Set;is_fork=!1;#l=!1;is_deferred(){return this.is_fork||this.#r>0}process(e){ra=[],this.apply();var t=[],r=[];for(const n of e)this.#o(n,t,r);if(this.is_deferred())this.#c(r),this.#c(t);else{for(const n of this.#e)n();this.#e.clear(),this.#t===0&&this.#v(),Ys=this,tt=null,nr(r),nr(t),Ys=null,this.#i?.resolve()}_a=null}#o(e,t,r){e.f^=Xt;for(var n=e.first,i=null;n!==null;){var c=n.f,d=(c&(za|as))!==0,v=d&&(c&Xt)!==0,f=v||(c&ia)!==0||this.skipped_effects.has(n);if(!f&&n.fn!==null){d?n.f^=Xt:i!==null&&(c&(Js|Ns|jr))!==0?i.b.defer_effect(n):(c&Js)!==0?t.push(n):Ds(n)&&((c&Ma)!==0&&this.#n.add(n),js(n));var p=n.first;if(p!==null){n=p;continue}}var h=n.parent;for(n=n.next;n===null&&h!==null;)h===i&&(i=null),n=h.next,h=h.parent}}#c(e){for(var t=0;t<e.length;t+=1)Ir(e[t],this.#n,this.#a)}capture(e,t){t!==Ft&&!this.previous.has(e)&&this.previous.set(e,t),(e.f&Fa)===0&&(this.current.set(e,e.v),_a?.set(e,e.v))}activate(){tt=this,this.apply()}deactivate(){tt===this&&(tt=null,_a=null)}flush(){if(this.activate(),ra.length>0){if(Fr(),tt!==null&&tt!==this)return}else this.#t===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#s)e(this);this.#s.clear()}#v(){if(Is.size>1){this.previous.clear();var e=_a,t=!0;for(const n of Is){if(n===this){t=!1;continue}const i=[];for(const[d,v]of this.current){if(n.current.has(d))if(t&&v!==n.current.get(d))n.current.set(d,v);else continue;i.push(d)}if(i.length===0)continue;const c=[...n.current.keys()].filter(d=>!this.current.has(d));if(c.length>0){var r=ra;ra=[];const d=new Set,v=new Map;for(const f of i)Lr(f,c,d,v);if(ra.length>0){tt=n,n.apply();for(const f of ra)n.#o(f,[],[]);n.deactivate()}ra=r}}tt=null,_a=e}this.committed=!0,Is.delete(this)}increment(e){this.#t+=1,e&&(this.#r+=1)}decrement(e){this.#t-=1,e&&(this.#r-=1),!this.#l&&(this.#l=!0,xa(()=>{this.#l=!1,this.is_deferred()?ra.length>0&&this.flush():this.revive()}))}revive(){for(const e of this.#n)this.#a.delete(e),$t(e,Vt),Ca(e);for(const e of this.#a)$t(e,Da),Ca(e);this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#s.add(e)}settled(){return(this.#i??=qr()).promise}static ensure(){if(tt===null){const e=tt=new La;Is.add(tt),xs||xa(()=>{tt===e&&e.flush()})}return tt}apply(){}}function bl(a){var e=xs;xs=!0;try{for(var t;;){if(_l(),ra.length===0&&(tt?.flush(),ra.length===0))return en=null,t;Fr()}}finally{xs=e}}function Fr(){yn=!0;var a=null;try{for(var e=0;ra.length>0;){var t=La.ensure();if(e++>1e3){var r,n;ml()}t.process(ra),Ua.clear()}}finally{yn=!1,en=null}}function ml(){try{Xi()}catch(a){us(a,en)}}let ja=null;function nr(a){var e=a.length;if(e!==0){for(var t=0;t<e;){var r=a[t++];if((r.f&(Pa|ia))===0&&Ds(r)&&(ja=new Set,js(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?si(r):r.fn=null),ja?.size>0)){Ua.clear();for(const n of ja){if((n.f&(Pa|ia))!==0)continue;const i=[n];let c=n.parent;for(;c!==null;)ja.has(c)&&(ja.delete(c),i.push(c)),c=c.parent;for(let d=i.length-1;d>=0;d--){const v=i[d];(v.f&(Pa|ia))===0&&js(v)}}ja.clear()}}ja=null}}function Lr(a,e,t,r){if(!t.has(a)&&(t.add(a),a.reactions!==null))for(const n of a.reactions){const i=n.f;(i&Lt)!==0?Lr(n,e,t,r):(i&(Mn|Ma))!==0&&(i&Vt)===0&&Ur(n,e,r)&&($t(n,Vt),Ca(n))}}function Ur(a,e,t){const r=t.get(a);if(r!==void 0)return r;if(a.deps!==null)for(const n of a.deps){if(e.includes(n))return!0;if((n.f&Lt)!==0&&Ur(n,e,t))return t.set(n,!0),!0}return t.set(a,!1),!1}function Ca(a){for(var e=en=a;e.parent!==null;){e=e.parent;var t=e.f;if(yn&&e===at&&(t&Ma)!==0&&(t&Ar)===0)return;if((t&(as|za))!==0){if((t&Xt)===0)return;e.f^=Xt}}ra.push(e)}function yl(a){let e=0,t=Ka(0),r;return()=>{In()&&(s(t),an(()=>(e===0&&(r=Ja(()=>a(()=>Ss(t)))),e+=1,()=>{xa(()=>{e-=1,e===0&&(r?.(),r=void 0,Ss(t))})})))}}var wl=Ba|ps|Rn;function kl(a,e,t){new xl(a,e,t)}class xl{parent;is_pending=!1;#e;#s=null;#t;#r;#i;#n=null;#a=null;#l=null;#o=null;#c=null;#v=0;#d=0;#p=!1;#f=!1;#h=new Set;#_=new Set;#u=null;#w=yl(()=>(this.#u=Ka(this.#v),()=>{this.#u=null}));constructor(e,t,r){this.#e=e,this.#t=t,this.#r=r,this.parent=at.b,this.is_pending=!!this.#t.pending,this.#i=zs(()=>{at.b=this;{var n=this.#m();try{this.#n=va(()=>r(n))}catch(i){this.error(i)}this.#d>0?this.#b():this.is_pending=!1}return()=>{this.#c?.remove()}},wl)}#k(){try{this.#n=va(()=>this.#r(this.#e))}catch(e){this.error(e)}}#x(){const e=this.#t.pending;e&&(this.#a=va(()=>e(this.#e)),xa(()=>{var t=this.#m();this.#n=this.#g(()=>(La.ensure(),va(()=>this.#r(t)))),this.#d>0?this.#b():(Za(this.#a,()=>{this.#a=null}),this.is_pending=!1)}))}#m(){var e=this.#e;return this.is_pending&&(this.#c=Na(),this.#e.before(this.#c),e=this.#c),e}defer_effect(e){Ir(e,this.#h,this.#_)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#t.pending}#g(e){var t=at,r=He,n=Tt;Sa(this.#i),ta(this.#i),vs(this.#i.ctx);try{return e()}catch(i){return $r(i),null}finally{Sa(t),ta(r),vs(n)}}#b(){const e=this.#t.pending;this.#n!==null&&(this.#o=document.createDocumentFragment(),this.#o.append(this.#c),ii(this.#n,this.#o)),this.#a===null&&(this.#a=va(()=>e(this.#e)))}#y(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(e);return}if(this.#d+=e,this.#d===0){this.is_pending=!1;for(const t of this.#h)$t(t,Vt),Ca(t);for(const t of this.#_)$t(t,Da),Ca(t);this.#h.clear(),this.#_.clear(),this.#a&&Za(this.#a,()=>{this.#a=null}),this.#o&&(this.#e.before(this.#o),this.#o=null)}}update_pending_count(e){this.#y(e),this.#v+=e,!(!this.#u||this.#p)&&(this.#p=!0,xa(()=>{this.#p=!1,this.#u&&ds(this.#u,this.#v)}))}get_effect_pending(){return this.#w(),s(this.#u)}error(e){var t=this.#t.onerror;let r=this.#t.failed;if(this.#f||!t&&!r)throw e;this.#n&&(sa(this.#n),this.#n=null),this.#a&&(sa(this.#a),this.#a=null),this.#l&&(sa(this.#l),this.#l=null);var n=!1,i=!1;const c=()=>{if(n){dl();return}n=!0,i&&Qi(),La.ensure(),this.#v=0,this.#l!==null&&Za(this.#l,()=>{this.#l=null}),this.is_pending=this.has_pending_snippet(),this.#n=this.#g(()=>(this.#f=!1,va(()=>this.#r(this.#e)))),this.#d>0?this.#b():this.is_pending=!1};var d=He;try{ta(null),i=!0,t?.(e,c),i=!1}catch(v){us(v,this.#i&&this.#i.parent)}finally{ta(d)}r&&xa(()=>{this.#l=this.#g(()=>{La.ensure(),this.#f=!0;try{return va(()=>{r(this.#e,()=>e,()=>c)})}catch(v){return us(v,this.#i.parent),null}finally{this.#f=!1}})})}}function Sl(a,e,t,r){const n=Rs()?Cs:Dn;var i=a.filter(_=>!_.settled);if(t.length===0&&i.length===0){r(e.map(n));return}var c=tt,d=at,v=Tl(),f=i.length===1?i[0].promise:i.length>1?Promise.all(i.map(_=>_.promise)):null;function p(_){v();try{r(_)}catch(b){(d.f&Pa)===0&&us(b,d)}c?.deactivate(),wn()}if(t.length===0){f.then(()=>p(e.map(n)));return}function h(){v(),Promise.all(t.map(_=>El(_))).then(_=>p([...e.map(n),..._])).catch(_=>us(_,d))}f?f.then(h):h()}function Tl(){var a=at,e=He,t=Tt,r=tt;return function(i=!0){Sa(a),ta(e),vs(t),i&&r?.activate()}}function wn(){Sa(null),ta(null),vs(null)}function Cs(a){var e=Lt|Vt,t=He!==null&&(He.f&Lt)!==0?He:null;return at!==null&&(at.f|=ps),{ctx:Tt,deps:null,effects:null,equals:Mr,f:e,fn:a,reactions:null,rv:0,v:Ft,wv:0,parent:t??at,ac:null}}function El(a,e,t){let r=at;r===null&&Bi();var n=r.b,i=void 0,c=Ka(Ft),d=!He,v=new Map;return $l(()=>{var f=qr();i=f.promise;try{Promise.resolve(a()).then(f.resolve,f.reject).then(()=>{p===tt&&p.committed&&p.deactivate(),wn()})}catch(b){f.reject(b),wn()}var p=tt;if(d){var h=n.is_rendered();n.update_pending_count(1),p.increment(h),v.get(p)?.reject(cs),v.delete(p),v.set(p,f)}const _=(b,x=void 0)=>{if(p.activate(),x)x!==cs&&(c.f|=Fa,ds(c,x));else{(c.f&Fa)!==0&&(c.f^=Fa),ds(c,b);for(const[S,w]of v){if(v.delete(S),S===p)break;w.reject(cs)}}d&&(n.update_pending_count(-1),p.decrement(h))};f.promise.then(_,b=>_(null,b||"unknown"))}),Fn(()=>{for(const f of v.values())f.reject(cs)}),new Promise(f=>{function p(h){function _(){h===i?f(c):p(i)}h.then(_,_)}p(i)})}function Ze(a){const e=Cs(a);return li(e),e}function Dn(a){const e=Cs(a);return e.equals=zr,e}function Br(a){var e=a.effects;if(e!==null){a.effects=null;for(var t=0;t<e.length;t+=1)sa(e[t])}}function ql(a){for(var e=a.parent;e!==null;){if((e.f&Lt)===0)return(e.f&Pa)===0?e:null;e=e.parent}return null}function $n(a){var e,t=at;Sa(ql(a));try{a.f&=~Qa,Br(a),e=ui(a)}finally{Sa(t)}return e}function Gr(a){var e=$n(a);if(!a.equals(e)&&(a.wv=ci(),(!tt?.is_fork||a.deps===null)&&(a.v=e,a.deps===null))){$t(a,Xt);return}Ga||(_a!==null?(In()||tt?.is_fork)&&_a.set(a,e):zn(a))}let kn=new Set;const Ua=new Map;let Jr=!1;function Ka(a,e){var t={f:0,v:a,reactions:null,equals:Mr,rv:0,wv:0};return t}function y(a,e){const t=Ka(a);return li(t),t}function jl(a,e=!1,t=!0){const r=Ka(a);return e||(r.equals=zr),hs&&t&&Tt!==null&&Tt.l!==null&&(Tt.l.s??=[]).push(r),r}function u(a,e,t=!1){He!==null&&(!ga||(He.f&sr)!==0)&&Rs()&&(He.f&(Lt|Ma|Mn|sr))!==0&&!Ra?.includes(a)&&Vi();let r=t?Ce(e):e;return ds(a,r)}function ds(a,e){if(!a.equals(e)){var t=a.v;Ga?Ua.set(a,e):Ua.set(a,t),a.v=e;var r=La.ensure();if(r.capture(a,t),(a.f&Lt)!==0){const n=a;(a.f&Vt)!==0&&$n(n),zn(n)}a.wv=ci(),Yr(a,Vt),Rs()&&at!==null&&(at.f&Xt)!==0&&(at.f&(za|as))===0&&(ca===null?Il([a]):ca.push(a)),!r.is_fork&&kn.size>0&&!Jr&&Al()}return e}function Al(){Jr=!1;for(const a of kn)(a.f&Xt)!==0&&$t(a,Da),Ds(a)&&js(a);kn.clear()}function is(a,e=1){var t=s(a),r=e===1?t++:t--;return u(a,t),r}function Ss(a){u(a,a.v+1)}function Yr(a,e){var t=a.reactions;if(t!==null)for(var r=Rs(),n=t.length,i=0;i<n;i++){var c=t[i],d=c.f;if(!(!r&&c===at)){var v=(d&Vt)===0;if(v&&$t(c,e),(d&Lt)!==0){var f=c;_a?.delete(f),(d&Qa)===0&&(d&ua&&(c.f|=Qa),Yr(f,Da))}else v&&((d&Ma)!==0&&ja!==null&&ja.add(c),Ca(c))}}}function Ce(a){if(typeof a!="object"||a===null||ka in a)return a;const e=Nn(a);if(e!==Ii&&e!==Fi)return a;var t=new Map,r=Qs(a),n=y(0),i=Va,c=d=>{if(Va===i)return d();var v=He,f=Va;ta(null),or(i);var p=d();return ta(v),or(f),p};return r&&t.set("length",y(a.length)),new Proxy(a,{defineProperty(d,v,f){(!("value"in f)||f.configurable===!1||f.enumerable===!1||f.writable===!1)&&Wi();var p=t.get(v);return p===void 0?p=c(()=>{var h=y(f.value);return t.set(v,h),h}):u(p,f.value,!0),!0},deleteProperty(d,v){var f=t.get(v);if(f===void 0){if(v in d){const p=c(()=>y(Ft));t.set(v,p),Ss(n)}}else u(f,Ft),Ss(n);return!0},get(d,v,f){if(v===ka)return a;var p=t.get(v),h=v in d;if(p===void 0&&(!h||Ia(d,v)?.writable)&&(p=c(()=>{var b=Ce(h?d[v]:Ft),x=y(b);return x}),t.set(v,p)),p!==void 0){var _=s(p);return _===Ft?void 0:_}return Reflect.get(d,v,f)},getOwnPropertyDescriptor(d,v){var f=Reflect.getOwnPropertyDescriptor(d,v);if(f&&"value"in f){var p=t.get(v);p&&(f.value=s(p))}else if(f===void 0){var h=t.get(v),_=h?.v;if(h!==void 0&&_!==Ft)return{enumerable:!0,configurable:!0,value:_,writable:!0}}return f},has(d,v){if(v===ka)return!0;var f=t.get(v),p=f!==void 0&&f.v!==Ft||Reflect.has(d,v);if(f!==void 0||at!==null&&(!p||Ia(d,v)?.writable)){f===void 0&&(f=c(()=>{var _=p?Ce(d[v]):Ft,b=y(_);return b}),t.set(v,f));var h=s(f);if(h===Ft)return!1}return p},set(d,v,f,p){var h=t.get(v),_=v in d;if(r&&v==="length")for(var b=f;b<h.v;b+=1){var x=t.get(b+"");x!==void 0?u(x,Ft):b in d&&(x=c(()=>y(Ft)),t.set(b+"",x))}if(h===void 0)(!_||Ia(d,v)?.writable)&&(h=c(()=>y(void 0)),u(h,Ce(f)),t.set(v,h));else{_=h.v!==Ft;var S=c(()=>Ce(f));u(h,S)}var w=Reflect.getOwnPropertyDescriptor(d,v);if(w?.set&&w.set.call(p,f),!_){if(r&&typeof v=="string"){var k=t.get("length"),R=Number(v);Number.isInteger(R)&&R>=k.v&&u(k,R+1)}Ss(n)}return!0},ownKeys(d){s(n);var v=Reflect.ownKeys(d).filter(h=>{var _=t.get(h);return _===void 0||_.v!==Ft});for(var[f,p]of t)p.v!==Ft&&!(f in d)&&v.push(f);return v},setPrototypeOf(){Zi()}})}function rr(a){try{if(a!==null&&typeof a=="object"&&ka in a)return a[ka]}catch{}return a}function Pl(a,e){return Object.is(rr(a),rr(e))}var xn,Xr,Hr,Wr;function Nl(){if(xn===void 0){xn=window,Xr=/Firefox/.test(navigator.userAgent);var a=Element.prototype,e=Node.prototype,t=Text.prototype;Hr=Ia(e,"firstChild").get,Wr=Ia(e,"nextSibling").get,ar(a)&&(a.__click=void 0,a.__className=void 0,a.__attributes=null,a.__style=void 0,a.__e=void 0),ar(t)&&(t.__t=void 0)}}function Na(a=""){return document.createTextNode(a)}function Oa(a){return Hr.call(a)}function Ms(a){return Wr.call(a)}function l(a,e){return Oa(a)}function qe(a,e=!1){{var t=Oa(a);return t instanceof Comment&&t.data===""?Ms(t):t}}function o(a,e=1,t=!1){let r=a;for(;e--;)r=Ms(r);return r}function Rl(a){a.textContent=""}function Zr(){return!1}function Vr(a,e){{const t=document.body;a.autofocus=!0,xa(()=>{document.activeElement===t&&a.focus()})}}let ir=!1;function Cl(){ir||(ir=!0,document.addEventListener("reset",a=>{Promise.resolve().then(()=>{if(!a.defaultPrevented)for(const e of a.target.elements)e.__on_r?.()})},{capture:!0}))}function tn(a){var e=He,t=at;ta(null),Sa(null);try{return a()}finally{ta(e),Sa(t)}}function On(a,e,t,r=t){a.addEventListener(e,()=>tn(t));const n=a.__on_r;n?a.__on_r=()=>{n(),r(!0)}:a.__on_r=()=>r(!0),Cl()}function Qr(a){at===null&&(He===null&&Yi(),Ji()),Ga&&Gi()}function Ml(a,e){var t=e.last;t===null?e.last=e.first=a:(t.next=a,a.prev=t,e.last=a)}function Ta(a,e,t){var r=at;r!==null&&(r.f&ia)!==0&&(a|=ia);var n={ctx:Tt,deps:null,nodes:null,f:a|Vt|ua,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(t)try{js(n),n.f|=Cn}catch(d){throw sa(n),d}else e!==null&&Ca(n);var i=n;if(t&&i.deps===null&&i.teardown===null&&i.nodes===null&&i.first===i.last&&(i.f&ps)===0&&(i=i.first,(a&Ma)!==0&&(a&Ba)!==0&&i!==null&&(i.f|=Ba)),i!==null&&(i.parent=r,r!==null&&Ml(i,r),He!==null&&(He.f&Lt)!==0&&(a&as)===0)){var c=He;(c.effects??=[]).push(i)}return n}function In(){return He!==null&&!ga}function Fn(a){const e=Ta(Ns,null,!1);return $t(e,Xt),e.teardown=a,e}function Ut(a){Qr();var e=at.f,t=!He&&(e&za)!==0&&(e&Cn)===0;if(t){var r=Tt;(r.e??=[]).push(a)}else return Kr(a)}function Kr(a){return Ta(Js|Pr,a,!1)}function zl(a){return Qr(),Ta(Ns|Pr,a,!0)}function Dl(a){La.ensure();const e=Ta(as|ps,a,!0);return(t={})=>new Promise(r=>{t.outro?Za(e,()=>{sa(e),r(void 0)}):(sa(e),r(void 0))})}function Ln(a){return Ta(Js,a,!1)}function $l(a){return Ta(Mn|ps,a,!0)}function an(a,e=0){return Ta(Ns|e,a,!0)}function Y(a,e=[],t=[],r=[]){Sl(r,e,t,n=>{Ta(Ns,()=>a(...n.map(s)),!0)})}function zs(a,e=0){var t=Ta(Ma|e,a,!0);return t}function va(a){return Ta(za|ps,a,!0)}function ei(a){var e=a.teardown;if(e!==null){const t=Ga,r=He;lr(!0),ta(null);try{e.call(null)}finally{lr(t),ta(r)}}}function ti(a,e=!1){var t=a.first;for(a.first=a.last=null;t!==null;){const n=t.ac;n!==null&&tn(()=>{n.abort(cs)});var r=t.next;(t.f&as)!==0?t.parent=null:sa(t,e),t=r}}function Ol(a){for(var e=a.first;e!==null;){var t=e.next;(e.f&za)===0&&sa(e),e=t}}function sa(a,e=!0){var t=!1;(e||(a.f&Ar)!==0)&&a.nodes!==null&&a.nodes.end!==null&&(ai(a.nodes.start,a.nodes.end),t=!0),ti(a,e&&!t),Xs(a,0),$t(a,Pa);var r=a.nodes&&a.nodes.t;if(r!==null)for(const i of r)i.stop();ei(a);var n=a.parent;n!==null&&n.first!==null&&si(a),a.next=a.prev=a.teardown=a.ctx=a.deps=a.fn=a.nodes=a.ac=null}function ai(a,e){for(;a!==null;){var t=a===e?null:Ms(a);a.remove(),a=t}}function si(a){var e=a.parent,t=a.prev,r=a.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===a&&(e.first=r),e.last===a&&(e.last=t))}function Za(a,e,t=!0){var r=[];ni(a,r,!0);var n=()=>{t&&sa(a),e&&e()},i=r.length;if(i>0){var c=()=>--i||n();for(var d of r)d.out(c)}else n()}function ni(a,e,t){if((a.f&ia)===0){a.f^=ia;var r=a.nodes&&a.nodes.t;if(r!==null)for(const d of r)(d.is_global||t)&&e.push(d);for(var n=a.first;n!==null;){var i=n.next,c=(n.f&Ba)!==0||(n.f&za)!==0&&(a.f&Ma)!==0;ni(n,e,c?t:!1),n=i}}}function Un(a){ri(a,!0)}function ri(a,e){if((a.f&ia)!==0){a.f^=ia,(a.f&Xt)===0&&($t(a,Vt),Ca(a));for(var t=a.first;t!==null;){var r=t.next,n=(t.f&Ba)!==0||(t.f&za)!==0;ri(t,n?e:!1),t=r}var i=a.nodes&&a.nodes.t;if(i!==null)for(const c of i)(c.is_global||e)&&c.in()}}function ii(a,e){if(a.nodes)for(var t=a.nodes.start,r=a.nodes.end;t!==null;){var n=t===r?null:Ms(t);e.append(t),t=n}}let Gs=!1,Ga=!1;function lr(a){Ga=a}let He=null,ga=!1;function ta(a){He=a}let at=null;function Sa(a){at=a}let Ra=null;function li(a){He!==null&&(Ra===null?Ra=[a]:Ra.push(a))}let Kt=null,na=0,ca=null;function Il(a){ca=a}let oi=1,Ha=0,Va=Ha;function or(a){Va=a}function ci(){return++oi}function Ds(a){var e=a.f;if((e&Vt)!==0)return!0;if(e&Lt&&(a.f&=~Qa),(e&Da)!==0){for(var t=a.deps,r=t.length,n=0;n<r;n++){var i=t[n];if(Ds(i)&&Gr(i),i.wv>a.wv)return!0}(e&ua)!==0&&_a===null&&$t(a,Xt)}return!1}function vi(a,e,t=!0){var r=a.reactions;if(r!==null&&!Ra?.includes(a))for(var n=0;n<r.length;n++){var i=r[n];(i.f&Lt)!==0?vi(i,e,!1):e===i&&(t?$t(i,Vt):(i.f&Xt)!==0&&$t(i,Da),Ca(i))}}function ui(a){var e=Kt,t=na,r=ca,n=He,i=Ra,c=Tt,d=ga,v=Va,f=a.f;Kt=null,na=0,ca=null,He=(f&(za|as))===0?a:null,Ra=null,vs(a.ctx),ga=!1,Va=++Ha,a.ac!==null&&(tn(()=>{a.ac.abort(cs)}),a.ac=null);try{a.f|=mn;var p=a.fn,h=p(),_=a.deps;if(Kt!==null){var b;if(Xs(a,na),_!==null&&na>0)for(_.length=na+Kt.length,b=0;b<Kt.length;b++)_[na+b]=Kt[b];else a.deps=_=Kt;if(In()&&(a.f&ua)!==0)for(b=na;b<_.length;b++)(_[b].reactions??=[]).push(a)}else _!==null&&na<_.length&&(Xs(a,na),_.length=na);if(Rs()&&ca!==null&&!ga&&_!==null&&(a.f&(Lt|Da|Vt))===0)for(b=0;b<ca.length;b++)vi(ca[b],a);if(n!==null&&n!==a){if(Ha++,n.deps!==null)for(let x=0;x<t;x+=1)n.deps[x].rv=Ha;if(e!==null)for(const x of e)x.rv=Ha;ca!==null&&(r===null?r=ca:r.push(...ca))}return(a.f&Fa)!==0&&(a.f^=Fa),h}catch(x){return $r(x)}finally{a.f^=mn,Kt=e,na=t,ca=r,He=n,Ra=i,vs(c),ga=d,Va=v}}function Fl(a,e){let t=e.reactions;if(t!==null){var r=$i.call(t,a);if(r!==-1){var n=t.length-1;n===0?t=e.reactions=null:(t[r]=t[n],t.pop())}}if(t===null&&(e.f&Lt)!==0&&(Kt===null||!Kt.includes(e))){var i=e;(i.f&ua)!==0&&(i.f^=ua,i.f&=~Qa),zn(i),Br(i),Xs(i,0)}}function Xs(a,e){var t=a.deps;if(t!==null)for(var r=e;r<t.length;r++)Fl(a,t[r])}function js(a){var e=a.f;if((e&Pa)===0){$t(a,Xt);var t=at,r=Gs;at=a,Gs=!0;try{(e&(Ma|jr))!==0?Ol(a):ti(a),ei(a);var n=ui(a);a.teardown=typeof n=="function"?n:null,a.wv=oi;var i;gn&&pl&&(a.f&Vt)!==0&&a.deps}finally{Gs=r,at=t}}}async function Ll(){await Promise.resolve(),bl()}function s(a){var e=a.f,t=(e&Lt)!==0;if(He!==null&&!ga){var r=at!==null&&(at.f&Pa)!==0;if(!r&&!Ra?.includes(a)){var n=He.deps;if((He.f&mn)!==0)a.rv<Ha&&(a.rv=Ha,Kt===null&&n!==null&&n[na]===a?na++:Kt===null?Kt=[a]:Kt.push(a));else{(He.deps??=[]).push(a);var i=a.reactions;i===null?a.reactions=[He]:i.includes(He)||i.push(He)}}}if(Ga&&Ua.has(a))return Ua.get(a);if(t){var c=a;if(Ga){var d=c.v;return((c.f&Xt)===0&&c.reactions!==null||fi(c))&&(d=$n(c)),Ua.set(c,d),d}var v=(c.f&ua)===0&&!ga&&He!==null&&(Gs||(He.f&ua)!==0),f=c.deps===null;Ds(c)&&(v&&(c.f|=ua),Gr(c)),v&&!f&&di(c)}if(_a?.has(a))return _a.get(a);if((a.f&Fa)!==0)throw a.v;return a.v}function di(a){if(a.deps!==null){a.f|=ua;for(const e of a.deps)(e.reactions??=[]).push(a),(e.f&Lt)!==0&&(e.f&ua)===0&&di(e)}}function fi(a){if(a.v===Ft)return!0;if(a.deps===null)return!1;for(const e of a.deps)if(Ua.has(e)||(e.f&Lt)!==0&&fi(e))return!0;return!1}function Ja(a){var e=ga;try{return ga=!0,a()}finally{ga=e}}function Ul(a){if(!(typeof a!="object"||!a||a instanceof EventTarget)){if(ka in a)Sn(a);else if(!Array.isArray(a))for(let e in a){const t=a[e];typeof t=="object"&&t&&ka in t&&Sn(t)}}}function Sn(a,e=new Set){if(typeof a=="object"&&a!==null&&!(a instanceof EventTarget)&&!e.has(a)){e.add(a),a instanceof Date&&a.getTime();for(let r in a)try{Sn(a[r],e)}catch{}const t=Nn(a);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=Er(t);for(let n in r){const i=r[n].get;if(i)try{i.call(a)}catch{}}}}}const Bl=["touchstart","touchmove"];function Gl(a){return Bl.includes(a)}const pi=new Set,Tn=new Set;function Jl(a,e,t,r={}){function n(i){if(r.capture||ys.call(e,i),!i.cancelBubble)return tn(()=>t?.call(this,i))}return a.startsWith("pointer")||a.startsWith("touch")||a==="wheel"?xa(()=>{e.addEventListener(a,n,r)}):e.addEventListener(a,n,r),n}function ba(a,e,t,r,n){var i={capture:r,passive:n},c=Jl(a,e,t,i);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Fn(()=>{e.removeEventListener(a,c,i)})}function bt(a){for(var e=0;e<a.length;e++)pi.add(a[e]);for(var t of Tn)t(a)}let cr=null;function ys(a){var e=this,t=e.ownerDocument,r=a.type,n=a.composedPath?.()||[],i=n[0]||a.target;cr=a;var c=0,d=cr===a&&a.__root;if(d){var v=n.indexOf(d);if(v!==-1&&(e===document||e===window)){a.__root=e;return}var f=n.indexOf(e);if(f===-1)return;v<=f&&(c=v)}if(i=n[c]||a.target,i!==e){Oi(a,"currentTarget",{configurable:!0,get(){return i||t}});var p=He,h=at;ta(null),Sa(null);try{for(var _,b=[];i!==null;){var x=i.assignedSlot||i.parentNode||i.host||null;try{var S=i["__"+r];S!=null&&(!i.disabled||a.target===i)&&S.call(i,a)}catch(w){_?b.push(w):_=w}if(a.cancelBubble||x===e||x===null)break;i=x}if(_){for(let w of b)queueMicrotask(()=>{throw w});throw _}}finally{a.__root=e,delete a.currentTarget,ta(p),Sa(h)}}}function hi(a){var e=document.createElement("template");return e.innerHTML=a.replaceAll("<!>","<!---->"),e.content}function As(a,e){var t=at;t.nodes===null&&(t.nodes={start:a,end:e,a:null,t:null})}function m(a,e){var t=(e&ol)!==0,r=(e&cl)!==0,n,i=!a.startsWith("<!>");return()=>{n===void 0&&(n=hi(i?a:"<!>"+a),t||(n=Oa(n)));var c=r||Xr?document.importNode(n,!0):n.cloneNode(!0);if(t){var d=Oa(c),v=c.lastChild;As(d,v)}else As(c,c);return c}}function _i(a=""){{var e=Na(a+"");return As(e,e),e}}function it(){var a=document.createDocumentFragment(),e=document.createComment(""),t=Na();return a.append(e,t),As(e,t),a}function g(a,e){a!==null&&a.before(e)}function T(a,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(a.__t??=a.nodeValue)&&(a.__t=t,a.nodeValue=t+"")}function Yl(a,e){return Xl(a,e)}const ls=new Map;function Xl(a,{target:e,anchor:t,props:r={},events:n,context:i,intro:c=!0}){Nl();var d=new Set,v=h=>{for(var _=0;_<h.length;_++){var b=h[_];if(!d.has(b)){d.add(b);var x=Gl(b);e.addEventListener(b,ys,{passive:x});var S=ls.get(b);S===void 0?(document.addEventListener(b,ys,{passive:x}),ls.set(b,1)):ls.set(b,S+1)}}};v(Ks(pi)),Tn.add(v);var f=void 0,p=Dl(()=>{var h=t??e.appendChild(Na());return kl(h,{pending:()=>{}},_=>{if(i){lt({});var b=Tt;b.c=i}n&&(r.$$events=n),f=a(_,r)||{},i&&ot()}),()=>{for(var _ of d){e.removeEventListener(_,ys);var b=ls.get(_);--b===0?(document.removeEventListener(_,ys),ls.delete(_)):ls.set(_,b)}Tn.delete(v),h!==t&&h.parentNode?.removeChild(h)}});return Hl.set(f,p),f}let Hl=new WeakMap;class Bn{anchor;#e=new Map;#s=new Map;#t=new Map;#r=new Set;#i=!0;constructor(e,t=!0){this.anchor=e,this.#i=t}#n=()=>{var e=tt;if(this.#e.has(e)){var t=this.#e.get(e),r=this.#s.get(t);if(r)Un(r),this.#r.delete(t);else{var n=this.#t.get(t);n&&(this.#s.set(t,n.effect),this.#t.delete(t),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),r=n.effect)}for(const[i,c]of this.#e){if(this.#e.delete(i),i===e)break;const d=this.#t.get(c);d&&(sa(d.effect),this.#t.delete(c))}for(const[i,c]of this.#s){if(i===t||this.#r.has(i))continue;const d=()=>{if(Array.from(this.#e.values()).includes(i)){var f=document.createDocumentFragment();ii(c,f),f.append(Na()),this.#t.set(i,{effect:c,fragment:f})}else sa(c);this.#r.delete(i),this.#s.delete(i)};this.#i||!r?(this.#r.add(i),Za(c,d,!1)):d()}}};#a=e=>{this.#e.delete(e);const t=Array.from(this.#e.values());for(const[r,n]of this.#t)t.includes(r)||(sa(n.effect),this.#t.delete(r))};ensure(e,t){var r=tt,n=Zr();if(t&&!this.#s.has(e)&&!this.#t.has(e))if(n){var i=document.createDocumentFragment(),c=Na();i.append(c),this.#t.set(e,{effect:va(()=>t(c)),fragment:i})}else this.#s.set(e,va(()=>t(this.anchor)));if(this.#e.set(r,e),n){for(const[d,v]of this.#s)d===e?r.skipped_effects.delete(v):r.skipped_effects.add(v);for(const[d,v]of this.#t)d===e?r.skipped_effects.delete(v.effect):r.skipped_effects.add(v.effect);r.oncommit(this.#n),r.ondiscard(this.#a)}else this.#n()}}function L(a,e,t=!1){var r=new Bn(a),n=t?Ba:0;function i(c,d){r.ensure(c,d)}zs(()=>{var c=!1;e((d,v=!0)=>{c=!0,i(v,d)}),c||i(!1,null)},n)}function Ue(a,e){return e}function Wl(a,e,t){for(var r=[],n=e.length,i,c=e.length,d=0;d<n;d++){let h=e[d];Za(h,()=>{if(i){if(i.pending.delete(h),i.done.add(h),i.pending.size===0){var _=a.outrogroups;En(Ks(i.done)),_.delete(i),_.size===0&&(a.outrogroups=null)}}else c-=1},!1)}if(c===0){var v=r.length===0&&t!==null;if(v){var f=t,p=f.parentNode;Rl(p),p.append(f),a.items.clear()}En(e,!v)}else i={pending:new Set(e),done:new Set},(a.outrogroups??=new Set).add(i)}function En(a,e=!0){for(var t=0;t<a.length;t++)sa(a[t],e)}var vr;function Ne(a,e,t,r,n,i=null){var c=a,d=new Map,v=(e&Cr)!==0;if(v){var f=a;c=f.appendChild(Na())}var p=null,h=Dn(()=>{var k=t();return Qs(k)?k:k==null?[]:Ks(k)}),_,b=!0;function x(){w.fallback=p,Zl(w,_,c,e,r),p!==null&&(_.length===0?(p.f&Aa)===0?Un(p):(p.f^=Aa,ws(p,null,c)):Za(p,()=>{p=null}))}var S=zs(()=>{_=s(h);for(var k=_.length,R=new Set,N=tt,A=Zr(),$=0;$<k;$+=1){var O=_[$],J=r(O,$),X=b?null:d.get(J);X?(X.v&&ds(X.v,O),X.i&&ds(X.i,$),A&&N.skipped_effects.delete(X.e)):(X=Vl(d,b?c:vr??=Na(),O,J,$,n,e,t),b||(X.e.f|=Aa),d.set(J,X)),R.add(J)}if(k===0&&i&&!p&&(b?p=va(()=>i(c)):(p=va(()=>i(vr??=Na())),p.f|=Aa)),!b)if(A){for(const[G,ae]of d)R.has(G)||N.skipped_effects.add(ae.e);N.oncommit(x),N.ondiscard(()=>{})}else x();s(h)}),w={effect:S,items:d,outrogroups:null,fallback:p};b=!1}function Zl(a,e,t,r,n){var i=(r&tl)!==0,c=e.length,d=a.items,v=a.effect.first,f,p=null,h,_=[],b=[],x,S,w,k;if(i)for(k=0;k<c;k+=1)x=e[k],S=n(x,k),w=d.get(S).e,(w.f&Aa)===0&&(w.nodes?.a?.measure(),(h??=new Set).add(w));for(k=0;k<c;k+=1){if(x=e[k],S=n(x,k),w=d.get(S).e,a.outrogroups!==null)for(const ae of a.outrogroups)ae.pending.delete(w),ae.done.delete(w);if((w.f&Aa)!==0)if(w.f^=Aa,w===v)ws(w,null,t);else{var R=p?p.next:v;w===a.effect.last&&(a.effect.last=w.prev),w.prev&&(w.prev.next=w.next),w.next&&(w.next.prev=w.prev),$a(a,p,w),$a(a,w,R),ws(w,R,t),p=w,_=[],b=[],v=p.next;continue}if((w.f&ia)!==0&&(Un(w),i&&(w.nodes?.a?.unfix(),(h??=new Set).delete(w))),w!==v){if(f!==void 0&&f.has(w)){if(_.length<b.length){var N=b[0],A;p=N.prev;var $=_[0],O=_[_.length-1];for(A=0;A<_.length;A+=1)ws(_[A],N,t);for(A=0;A<b.length;A+=1)f.delete(b[A]);$a(a,$.prev,O.next),$a(a,p,$),$a(a,O,N),v=N,p=O,k-=1,_=[],b=[]}else f.delete(w),ws(w,v,t),$a(a,w.prev,w.next),$a(a,w,p===null?a.effect.first:p.next),$a(a,p,w),p=w;continue}for(_=[],b=[];v!==null&&v!==w;)(f??=new Set).add(v),b.push(v),v=v.next;if(v===null)continue}(w.f&Aa)===0&&_.push(w),p=w,v=w.next}if(a.outrogroups!==null){for(const ae of a.outrogroups)ae.pending.size===0&&(En(Ks(ae.done)),a.outrogroups?.delete(ae));a.outrogroups.size===0&&(a.outrogroups=null)}if(v!==null||f!==void 0){var J=[];if(f!==void 0)for(w of f)(w.f&ia)===0&&J.push(w);for(;v!==null;)(v.f&ia)===0&&v!==a.fallback&&J.push(v),v=v.next;var X=J.length;if(X>0){var G=(r&Cr)!==0&&c===0?t:null;if(i){for(k=0;k<X;k+=1)J[k].nodes?.a?.measure();for(k=0;k<X;k+=1)J[k].nodes?.a?.fix()}Wl(a,J,G)}}i&&xa(()=>{if(h!==void 0)for(w of h)w.nodes?.a?.apply()})}function Vl(a,e,t,r,n,i,c,d){var v=(c&Ki)!==0?(c&al)===0?jl(t,!1,!1):Ka(t):null,f=(c&el)!==0?Ka(n):null;return{v,i:f,e:va(()=>(i(e,v??t,f??n,d),()=>{a.delete(r)}))}}function ws(a,e,t){if(a.nodes)for(var r=a.nodes.start,n=a.nodes.end,i=e&&(e.f&Aa)===0?e.nodes.start:t;r!==null;){var c=Ms(r);if(i.before(r),r===n)return;r=c}}function $a(a,e,t){e===null?a.effect.first=t:e.next=t,t===null?a.effect.last=e:t.prev=e}function Ql(a,e,t=!1,r=!1,n=!1){var i=a,c="";Y(()=>{var d=at;if(c!==(c=e()??"")&&(d.nodes!==null&&(ai(d.nodes.start,d.nodes.end),d.nodes=null),c!=="")){var v=c+"";t?v=`<svg>${v}</svg>`:r&&(v=`<math>${v}</math>`);var f=hi(v);if((t||r)&&(f=Oa(f)),As(Oa(f),f.lastChild),t||r)for(;Oa(f);)i.before(Oa(f));else i.before(f)}})}function Kl(a,e,...t){var r=new Bn(a);zs(()=>{const n=e()??null;r.ensure(n,n&&(i=>n(i,...t)))},Ba)}function eo(a,e,t){var r=new Bn(a);zs(()=>{var n=e()??null;r.ensure(n,n&&(i=>t(i,n)))},Ba)}const ur=[...` 	
\r\fÂ \v\uFEFF`];function to(a,e,t){var r=a==null?"":""+a;if(e&&(r=r?r+" "+e:e),t){for(var n in t)if(t[n])r=r?r+" "+n:n;else if(r.length)for(var i=n.length,c=0;(c=r.indexOf(n,c))>=0;){var d=c+i;(c===0||ur.includes(r[c-1]))&&(d===r.length||ur.includes(r[d]))?r=(c===0?"":r.substring(0,c))+r.substring(d+1):c=d}}return r===""?null:r}function ao(a,e){return a==null?null:String(a)}function Fe(a,e,t,r,n,i){var c=a.__className;if(c!==t||c===void 0){var d=to(t,r,i);d==null?a.removeAttribute("class"):a.className=d,a.__className=t}else if(i&&n!==i)for(var v in i){var f=!!i[v];(n==null||f!==!!n[v])&&a.classList.toggle(v,f)}return i}function $s(a,e,t,r){var n=a.__style;if(n!==e){var i=ao(e);i==null?a.removeAttribute("style"):a.style.cssText=i,a.__style=e}return r}function fs(a,e,t=!1){if(a.multiple){if(e==null)return;if(!Qs(e))return ul();for(var r of a.options)r.selected=e.includes(Ts(r));return}for(r of a.options){var n=Ts(r);if(Pl(n,e)){r.selected=!0;return}}(!t||e!==void 0)&&(a.selectedIndex=-1)}function Ps(a){var e=new MutationObserver(()=>{fs(a,a.__value)});e.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Fn(()=>{e.disconnect()})}function qt(a,e,t=e){var r=new WeakSet,n=!0;On(a,"change",i=>{var c=i?"[selected]":":checked",d;if(a.multiple)d=[].map.call(a.querySelectorAll(c),Ts);else{var v=a.querySelector(c)??a.querySelector("option:not([disabled])");d=v&&Ts(v)}t(d),tt!==null&&r.add(tt)}),Ln(()=>{var i=e();if(a===document.activeElement){var c=Ys??tt;if(r.has(c))return}if(fs(a,i,n),n&&i===void 0){var d=a.querySelector(":checked");d!==null&&(i=Ts(d),t(i))}a.__value=i,n=!1}),Ps(a)}function Ts(a){return"__value"in a?a.__value:a.value}const so=Symbol("is custom element"),no=Symbol("is html");function os(a,e){var t=Gn(a);t.value===(t.value=e??void 0)||a.value===e&&(e!==0||a.nodeName!=="PROGRESS")||(a.value=e??"")}function vn(a,e){var t=Gn(a);t.checked!==(t.checked=e??void 0)&&(a.checked=e)}function Ke(a,e,t,r){var n=Gn(a);n[e]!==(n[e]=t)&&(e==="loading"&&(a[Ui]=t),t==null?a.removeAttribute(e):typeof t!="string"&&ro(a).includes(e)?a[e]=t:a.setAttribute(e,t))}function Gn(a){return a.__attributes??={[so]:a.nodeName.includes("-"),[no]:a.namespaceURI===vl}}var dr=new Map;function ro(a){var e=a.getAttribute("is")||a.nodeName,t=dr.get(e);if(t)return t;dr.set(e,t=[]);for(var r,n=a,i=Element.prototype;i!==n;){r=Er(n);for(var c in r)r[c].set&&t.push(c);n=Nn(n)}return t}function Pe(a,e,t=e){var r=new WeakSet;On(a,"input",async n=>{var i=n?a.defaultValue:a.value;if(i=un(a)?dn(i):i,t(i),tt!==null&&r.add(tt),await Ll(),i!==(i=e())){var c=a.selectionStart,d=a.selectionEnd,v=a.value.length;if(a.value=i??"",d!==null){var f=a.value.length;c===d&&d===v&&f>v?(a.selectionStart=f,a.selectionEnd=f):(a.selectionStart=c,a.selectionEnd=Math.min(d,f))}}}),Ja(e)==null&&a.value&&(t(un(a)?dn(a.value):a.value),tt!==null&&r.add(tt)),an(()=>{var n=e();if(a===document.activeElement){var i=Ys??tt;if(r.has(i))return}un(a)&&n===dn(a.value)||a.type==="date"&&!n&&!a.value||n!==a.value&&(a.value=n??"")})}function io(a,e,t=e){On(a,"change",r=>{var n=r?a.defaultChecked:a.checked;t(n)}),Ja(e)==null&&t(a.checked),an(()=>{var r=e();a.checked=!!r})}function un(a){var e=a.type;return e==="number"||e==="range"}function dn(a){return a===""?null:+a}class Jn{#e=new WeakMap;#s;#t;static entries=new WeakMap;constructor(e){this.#t=e}observe(e,t){var r=this.#e.get(e)||new Set;return r.add(t),this.#e.set(e,r),this.#r().observe(e,this.#t),()=>{var n=this.#e.get(e);n.delete(t),n.size===0&&(this.#e.delete(e),this.#s.unobserve(e))}}#r(){return this.#s??(this.#s=new ResizeObserver(e=>{for(var t of e){Jn.entries.set(t.target,t);for(var r of this.#e.get(t.target)||[])r(t)}}))}}var lo=new Jn({box:"border-box"});function fr(a,e,t){var r=lo.observe(a,()=>t(a[e]));Ln(()=>(Ja(()=>t(a[e])),r))}function pr(a,e){return a===e||a?.[ka]===e}function Hs(a={},e,t,r){return Ln(()=>{var n,i;return an(()=>{n=i,i=[],Ja(()=>{a!==t(...i)&&(e(a,...i),n&&pr(t(...n),a)&&e(null,...n))})}),()=>{xa(()=>{i&&pr(t(...i),a)&&e(null,...i)})}}),a}function oo(a=!1){const e=Tt,t=e.l.u;if(!t)return;let r=()=>Ul(e.s);if(a){let n=0,i={};const c=Cs(()=>{let d=!1;const v=e.s;for(const f in v)v[f]!==i[f]&&(i[f]=v[f],d=!0);return d&&n++,n});r=()=>s(c)}t.b.length&&zl(()=>{hr(e,r),bn(t.b)}),Ut(()=>{const n=Ja(()=>t.m.map(Li));return()=>{for(const i of n)typeof i=="function"&&i()}}),t.a.length&&Ut(()=>{hr(e,r),bn(t.a)})}function hr(a,e){if(a.l.s)for(const t of a.l.s)s(t);e()}let Fs=!1;function co(a){var e=Fs;try{return Fs=!1,[a(),Fs]}finally{Fs=e}}const vo={get(a,e){let t=a.props.length;for(;t--;){let r=a.props[t];if(gs(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r)return r[e]}},set(a,e,t){let r=a.props.length;for(;r--;){let n=a.props[r];gs(n)&&(n=n());const i=Ia(n,e);if(i&&i.set)return i.set(t),!0}return!1},getOwnPropertyDescriptor(a,e){let t=a.props.length;for(;t--;){let r=a.props[t];if(gs(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r){const n=Ia(r,e);return n&&!n.configurable&&(n.configurable=!0),n}}},has(a,e){if(e===ka||e===Nr)return!1;for(let t of a.props)if(gs(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(a){const e=[];for(let t of a.props)if(gs(t)&&(t=t()),!!t){for(const r in t)e.includes(r)||e.push(r);for(const r of Object.getOwnPropertySymbols(t))e.includes(r)||e.push(r)}return e}};function uo(...a){return new Proxy({props:a},vo)}function kt(a,e,t,r){var n=!hs||(t&nl)!==0,i=(t&il)!==0,c=(t&ll)!==0,d=r,v=!0,f=()=>(v&&(v=!1,d=c?Ja(r):r),d),p;if(i){var h=ka in a||Nr in a;p=Ia(a,e)?.set??(h&&e in a?N=>a[e]=N:void 0)}var _,b=!1;i?[_,b]=co(()=>a[e]):_=a[e],_===void 0&&r!==void 0&&(_=f(),p&&(n&&Hi(),p(_)));var x;if(n?x=()=>{var N=a[e];return N===void 0?f():(v=!0,N)}:x=()=>{var N=a[e];return N!==void 0&&(d=void 0),N===void 0?d:N},n&&(t&rl)===0)return x;if(p){var S=a.$$legacy;return(function(N,A){return arguments.length>0?((!n||!A||S||b)&&p(A?x():N),N):x()})}var w=!1,k=((t&sl)!==0?Cs:Dn)(()=>(w=!1,x()));i&&s(k);var R=at;return(function(N,A){if(arguments.length>0){const $=A?s(k):n&&i?Ce(N):N;return u(k,$),w=!0,d!==void 0&&(d=$),N}return Ga&&w||(R.f&Pa)!==0?k.v:s(k)})}function Ht(a){Tt===null&&Rr(),hs&&Tt.l!==null?ho(Tt).m.push(a):Ut(()=>{const e=Ja(a);if(typeof e=="function")return e})}function fo(a,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(a,{detail:e,bubbles:t,cancelable:r})}function po(){const a=Tt;return a===null&&Rr(),(e,t,r)=>{const n=a.s.$$events?.[e];if(n){const i=Qs(n)?n.slice():[n],c=fo(e,t,r);for(const d of i)d.call(a.x,c);return!c.defaultPrevented}return!0}}function ho(a){var e=a.l;return e.u??={a:[],b:[],m:[]}}const _o="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(_o);hl();function es(a){window.history.pushState({},"",a),window.dispatchEvent(new Event("popstate"))}let qn=Ce({path:window.location.pathname});if(typeof window<"u"){const a=history.pushState;history.pushState=function(...e){a.apply(this,e),qn.path=window.location.pathname,window.dispatchEvent(new Event("popstate"))},window.addEventListener("popstate",()=>{qn.path=window.location.pathname})}const Ea={get path(){return qn.path}};var go=m("<p>404 Not Found</p>");function bo(a,e){lt(e,!0);let t=y(Ce(window.location.pathname)),r=y(null);function n(){u(t,window.location.pathname,!0)}Ut(()=>{let p=s(t),h=null;if(!e.routes)return;const _=Object.keys(e.routes).sort((b,x)=>x.length-b.length);for(const b of _){if(b===p){h=e.routes[b];break}if(p.startsWith(b)&&b!=="/"){h=e.routes[b];break}}h||(h=e.routes["/"]||null),u(r,h,!0)});let i=Ze(()=>{if(typeof window>"u")return{};const p=new URLSearchParams(window.location.search),h={};for(const[_,b]of p.entries())h[_]=b;return h});Ht(()=>(window.addEventListener("popstate",n),()=>{window.removeEventListener("popstate",n)}));var c=it(),d=qe(c);{var v=p=>{var h=it(),_=qe(h);eo(_,()=>s(r),(b,x)=>{x(b,uo(()=>s(i)))}),g(p,h)},f=p=>{var h=go();g(p,h)};L(d,p=>{s(r)?p(v):p(f,!1)})}g(a,c),ot()}const Re=Ce({userRole:localStorage.getItem("user_role")||"admin",isLoading:!1,notifications:[],addNotification(a,e="info"){const t=Date.now();this.notifications.push({id:t,message:a,type:e}),setTimeout(()=>{this.notifications=this.notifications.filter(r=>r.id!==t)},5e3)},setRole(a){this.userRole=a,localStorage.setItem("user_role",a)}}),_r="/api";function ma(a={}){return{"X-User-Role":localStorage.getItem("user_role")||"admin",...a}}class mo{constructor(e){this.baseUrl=`${e}/documents`}async fetchDocuments(e={}){const t=new URLSearchParams(e),r=await fetch(`${this.baseUrl}/?${t.toString()}`,{headers:ma()});if(!r.ok)throw new Error("Failed to fetch documents");return await r.json()}async updateStatus(e,t){const r=await fetch(`${this.baseUrl}/${e}/status`,{method:"PUT",headers:ma({"Content-Type":"application/json"}),body:JSON.stringify({status:t})});if(!r.ok)throw new Error("Failed to update status");return await r.json()}async fetchDashboardStats(){const e=await fetch(`${this.baseUrl}/dashboard/stats`,{headers:ma()});if(!e.ok)throw new Error("Failed to fetch dashboard stats");return await e.json()}async createDocument(e){const t=await fetch(`${this.baseUrl}/`,{method:"POST",headers:ma({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to create document");return await t.json()}async updateDocument(e,t){const r=await fetch(`${this.baseUrl}/${e}`,{method:"PUT",headers:ma({"Content-Type":"application/json"}),body:JSON.stringify(t)});if(!r.ok)throw new Error("Failed to update document");return await r.json()}async deleteDocument(e){const t=await fetch(`${this.baseUrl}/${e}`,{method:"DELETE",headers:ma()});if(!t.ok)throw new Error("Failed to delete document");return await t.json()}async downloadDocumentZip(e){window.location.href=`${this.baseUrl}/${e}/zip`}async deleteAttachment(e){const t=await fetch(`${_r}/attachments/${e}`,{method:"DELETE",headers:ma()});if(!t.ok)throw new Error("Failed to delete attachment");return await t.json()}async uploadFile(e){const t=await fetch(`${_r}/upload`,{method:"POST",headers:ma(),body:e});if(!t.ok)throw new Error("Failed to upload file");return await t.json()}async createOrder(e,t){const r=await fetch(`${this.baseUrl}/create-order`,{method:"POST",headers:ma({"Content-Type":"application/json"}),body:JSON.stringify({name:e,items:t})});if(!r.ok)throw new Error("Failed to create order");return await r.json()}async fetchTags(){const e=await fetch(`${this.baseUrl}/tags`,{headers:ma()});if(!e.ok)throw new Error("Failed to fetch tags");return await e.json()}}const fn="/api";function Ls(a={}){return{"X-User-Role":localStorage.getItem("user_role")||"admin",...a}}class yo{constructor(e){this.baseUrl=`${e}/journal`}async fetchJournal(e=0,t=100){const r=await fetch(`${this.baseUrl}/?skip=${e}&limit=${t}`,{headers:Ls()});if(!r.ok)throw new Error("Failed to fetch journal");return await r.json()}async createEntry(e){const t=await fetch(`${fn}/journal/`,{method:"POST",headers:Ls({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to create journal entry");return await t.json()}async deleteEntry(e){const t=await fetch(`${fn}/journal/${e}`,{method:"DELETE",headers:Ls()});if(!t.ok)throw new Error("Failed to delete journal entry");return await t.json()}async updateEntry(e,t){const r=await fetch(`${fn}/journal/${e}`,{method:"PUT",headers:Ls({"Content-Type":"application/json"}),body:JSON.stringify(t)});if(!r.ok)throw new Error("Failed to update journal entry");return await r.json()}}const pn="/api";function ya(a={}){return{"X-User-Role":localStorage.getItem("user_role")||"admin",...a}}class wo{constructor(e){this.baseUrl=`${e}/settings`}async fetchSetting(e){const t=await fetch(`${this.baseUrl}/${e}`,{headers:ya()});if(!t.ok)throw new Error("Failed to fetch setting");return await t.json()}async updateSetting(e,t){const r=await fetch(`${this.baseUrl}/`,{method:"PUT",headers:ya({"Content-Type":"application/json"}),body:JSON.stringify({key:e,value:t})});if(!r.ok){const n=await r.json().catch(()=>({}));throw new Error(n.detail||"Failed to update setting")}return await r.json()}async testPath(e){const t=await fetch(`${this.baseUrl}/test-path`,{method:"POST",headers:ya({"Content-Type":"application/json"}),body:JSON.stringify({path:e})});if(!t.ok)throw new Error("Failed to test path");return await t.json()}async fetchAssignees(){const e=await fetch(`${this.baseUrl}/assignees/list`,{headers:ya()});if(!e.ok)throw new Error("Failed to fetch assignees");return await e.json()}async createAssignee(e){const t=await fetch(`${this.baseUrl}/assignees`,{method:"POST",headers:ya({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to create assignee");return await t.json()}async updateAssignee(e,t){const r=await fetch(`${this.baseUrl}/assignees/${e}`,{method:"PUT",headers:ya({"Content-Type":"application/json"}),body:JSON.stringify({name:t})});if(!r.ok)throw new Error("Failed to update assignee");return await r.json()}async deleteAssignee(e){const t=await fetch(`${this.baseUrl}/assignees/${e}`,{method:"DELETE",headers:ya()});if(!t.ok)throw new Error("Failed to delete assignee");return await t.json()}async fetchDatabaseConfig(){const e=await fetch(`${pn}/settings/database/config`,{headers:ya()});if(!e.ok)throw new Error("Failed to fetch database config");return await e.json()}async updateDatabaseConfig(e){const t=await fetch(`${pn}/settings/database/config`,{method:"PUT",headers:ya({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to update database config");return await t.json()}async triggerRescan(){const e=await fetch(`${pn}/inventory/rescan`,{method:"POST",headers:ya()});if(!e.ok)throw new Error("Failed to trigger rescan");return await e.json()}}function Qt(a={}){return{"X-User-Role":localStorage.getItem("user_role")||"admin",...a}}class ko{constructor(e){this.baseUrl=e}async fetchMaterials(){const e=await fetch(`${this.baseUrl}/materials/`,{headers:Qt()});if(!e.ok)throw new Error("Failed to fetch materials");return await e.json()}async createMaterial(e){const t=await fetch(`${this.baseUrl}/materials/`,{method:"POST",headers:Qt({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to create material");return await t.json()}async updateMaterial(e,t){const r=await fetch(`${this.baseUrl}/materials/${e}?name=${encodeURIComponent(t)}`,{method:"PUT",headers:Qt()});if(!r.ok)throw new Error("Failed to update material");return await r.json()}async deleteMaterial(e){const t=await fetch(`${this.baseUrl}/materials/${e}`,{method:"DELETE",headers:Qt()});if(!t.ok)throw new Error("Failed to delete material");return await t.json()}async fetchParts(e=0,t=100,r={}){const n=new URLSearchParams({skip:String(e),limit:String(t)});r.search&&n.append("search",r.search),r.material_id&&n.append("material_id",r.material_id),r.min_width&&n.append("min_width",r.min_width),r.max_width&&n.append("max_width",r.max_width),r.min_height&&n.append("min_height",r.min_height),r.max_height&&n.append("max_height",r.max_height);const i=await fetch(`${this.baseUrl}/parts/?${n.toString()}`,{headers:Qt()});if(!i.ok)throw new Error("Failed to fetch parts");return await i.json()}async createPart(e){const t=await fetch(`${this.baseUrl}/parts/`,{method:"POST",headers:Qt({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to create part");return await t.json()}async updatePart(e,t){const r=await fetch(`${this.baseUrl}/parts/${e}`,{method:"PUT",headers:Qt({"Content-Type":"application/json"}),body:JSON.stringify(t)});if(!r.ok)throw new Error("Failed to update part");return await r.json()}async deletePart(e){const t=await fetch(`${this.baseUrl}/parts/${e}`,{method:"DELETE",headers:Qt()});if(!t.ok)throw new Error("Failed to delete part");return await t.json()}async fetchStock(){const e=await fetch(`${this.baseUrl}/stock/`,{headers:Qt()});if(!e.ok)throw new Error("Failed to fetch stock");return await e.json()}async createStockItem(e){const t=await fetch(`${this.baseUrl}/stock/`,{method:"POST",headers:Qt({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to create stock item");return await t.json()}async deleteStockItem(e){const t=await fetch(`${this.baseUrl}/stock/${e}`,{method:"DELETE",headers:Qt()});if(!t.ok)throw new Error("Failed to delete stock item");return await t.json()}async fetchPartGnc(e){const t=await fetch(`${this.baseUrl}/parts/${e}/gnc`,{headers:Qt()});if(!t.ok)throw new Error("Failed to fetch part GNC");return await t.json()}async fetchLibraryParts(){const e=await fetch(`${this.baseUrl}/gnc/library-parts`,{headers:Qt()});if(!e.ok)throw new Error("Failed to fetch library parts");return await e.json()}async rescanParts(){const e=await fetch(`${this.baseUrl}/inventory/rescan`,{method:"POST",headers:Qt()});if(!e.ok)throw new Error("Failed to trigger rescan");return await e.json()}}const Us="/api";function wa(a={}){return{"X-User-Role":localStorage.getItem("user_role")||"admin",...a}}class xo{constructor(e){this.baseUrl=`${e}/jobs`}async fetchJobs(e=0,t=100,r={}){const n=new URLSearchParams({skip:e.toString(),limit:t.toString(),...r}),i=await fetch(`${this.baseUrl}/?${n.toString()}`,{headers:wa()});if(!i.ok)throw new Error("Failed to fetch jobs");return await i.json()}async getJob(e){const t=await fetch(`${this.baseUrl}/${e}`,{headers:wa()});if(!t.ok)throw new Error("Failed to fetch job");return await t.json()}async createJob(e){const t=await fetch(`${this.baseUrl}/`,{method:"POST",headers:wa({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to create job");return await t.json()}async updateJob(e,t){const r=await fetch(`${this.baseUrl}/${e}`,{method:"PUT",headers:wa({"Content-Type":"application/json"}),body:JSON.stringify(t)});if(!r.ok)throw new Error("Failed to update job");return await r.json()}async updateJobStatus(e,t){const r=await fetch(`${this.baseUrl}/${e}/status?status=${encodeURIComponent(t)}`,{method:"PATCH",headers:wa()});if(!r.ok)throw new Error("Failed to update job status");return await r.json()}async deleteJob(e){const t=await fetch(`${this.baseUrl}/${e}`,{method:"DELETE",headers:wa()});if(!t.ok)throw new Error("Failed to delete job");return await t.json()}async fetchOrderTasks(e){const t=await fetch(`${Us}/gnc/orders/${e}/tasks`,{headers:wa()});if(!t.ok)throw new Error("Failed to fetch order tasks");return await t.json()}async saveOrderNesting(e){const t=await fetch(`${Us}/gnc/save-order-nesting`,{method:"POST",headers:wa({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to save order nesting");return await t.json()}async fetchOrderNestingProject(e){const t=await fetch(`${Us}/gnc/orders/${e}/project`,{headers:wa()});if(!t.ok)throw new Error("Failed to fetch nesting project");return await t.json()}async saveAsNewOrder(e,t,r){const n=await fetch(`${Us}/documents/save-as-new-order`,{method:"POST",headers:wa({"Content-Type":"application/json"}),body:JSON.stringify({name:e,sheets:t,original_document_id:r})});if(!n.ok)throw new Error("Failed to save as new order");return await n.json()}}function hn(a={}){return{"X-User-Role":localStorage.getItem("user_role")||"admin",...a}}class So{constructor(e){this.baseUrl=`${e}/gnc`}async parseGnc(e){const t=new FormData;t.append("file",e);const r=await fetch(`${this.baseUrl}/parse`,{method:"POST",headers:hn(),body:t});if(!r.ok){const n=await r.json().catch(()=>({}));throw new Error(n.detail||"Failed to parse GNC file")}return await r.json()}async saveGnc(e,t,r=!0){const n=await fetch(`${this.baseUrl}/save`,{method:"PUT",headers:hn({"Content-Type":"application/json"}),body:JSON.stringify({sheet:e,filename:t,overwrite:r})});if(!n.ok){const i=await n.json().catch(()=>({}));throw new Error(i.detail||"Failed to save GNC file")}return await n.json()}async scanParts(e){const t=await fetch(`${this.baseUrl}/scan`,{method:"POST",headers:hn()});if(!t.ok)throw new Error("Failed to start scan");const r=t.body.getReader(),n=new TextDecoder;for(;;){const{done:i,value:c}=await r.read();if(i)break;const v=n.decode(c).split(`
`).filter(f=>f.trim());for(const f of v)try{const p=JSON.parse(f);e(p)}catch{console.error("Failed to parse progress:",f)}}}}const _s="/api",aa=new mo(_s),Wa=new yo(_s),Xe=new wo(_s),Dt=new ko(_s),ea=new xo(_s),gr=new So(_s),wt=Ce({userRole:(typeof window<"u"?localStorage.getItem("user_role"):"admin")||"admin",configStatus:"unknown",currentDocument:null,settings:{ocrUrl:"",docNameRegex:"",syncMihtavPath:"",syncSidraPath:""},partTray:[],trayVisible:!1,menuActions:[]});function To(a){wt.configStatus=a}function ss(a){wt.menuActions=a}function ns(){wt.menuActions=[]}function Eo(a){const e=wt.partTray.find(t=>t.part.id===a.id);e?e.quantity+=1:wt.partTray.push({part:a,quantity:1}),wt.trayVisible=!0}function gi(a){wt.partTray=wt.partTray.filter(e=>e.part.id!==a)}function br(a,e){const t=wt.partTray.find(r=>r.part.id===a);t&&(t.quantity+=e,t.quantity<=0&&gi(a))}function mr(){wt.partTray=[]}function _n(){wt.trayVisible=!wt.trayVisible}var qo=m('<div class="loading-container svelte-plcxj0"><div class="spinner svelte-plcxj0"></div> <p>Gathering insights...</p></div>'),jo=m('<div class="error-container svelte-plcxj0"><span class="error-icon svelte-plcxj0">â ï¸</span> <p> </p> <button class="svelte-plcxj0">Retry</button></div>'),Ao=m('<div class="task-bar-item svelte-plcxj0"><div class="bar-header svelte-plcxj0"><span class="status-name svelte-plcxj0"> </span> <span class="status-count svelte-plcxj0"> </span></div> <div class="bar-track svelte-plcxj0"><div></div></div></div>'),Po=m('<div class="feed-item svelte-plcxj0"><span class="action-icon svelte-plcxj0"> </span> <div class="feed-content svelte-plcxj0"><p class="svelte-plcxj0"><strong> </strong> </p> <span class="feed-time svelte-plcxj0"> </span></div></div>'),No=m('<p class="empty-feed">No recent activity detected.</p>'),Ro=m('<div class="assignee-item svelte-plcxj0"><span class="assignee-name svelte-plcxj0"> </span> <span class="assignee-count svelte-plcxj0"> </span></div>'),Co=m('<div class="alert-box error svelte-plcxj0"><span class="alert-count svelte-plcxj0"> </span> <span class="alert-text svelte-plcxj0">Critical Errors</span></div>'),Mo=m('<div class="alert-box warning svelte-plcxj0"><span class="alert-count svelte-plcxj0"> </span> <span class="alert-text svelte-plcxj0">System Warnings</span></div>'),zo=m('<div class="bento-item journal-alerts svelte-plcxj0"><h3 class="svelte-plcxj0">â ï¸ System Alerts</h3> <div class="alerts-list svelte-plcxj0"><!> <!></div></div>'),Do=m('<header class="dashboard-header svelte-plcxj0"><h1 class="svelte-plcxj0">Workspace Overview</h1> <p class="subtitle svelte-plcxj0">Operational metrics and recent activity</p></header> <div class="bento-grid svelte-plcxj0"><div class="bento-item stats-overview svelte-plcxj0"><div class="stat-main svelte-plcxj0"><span class="stat-value svelte-plcxj0"> </span> <span class="stat-label svelte-plcxj0">Total Documents</span></div> <div class="stat-sub-grid svelte-plcxj0"><div class="stat-sub svelte-plcxj0"><span class="sub-label svelte-plcxj0">In Progress</span> <span class="sub-value progress svelte-plcxj0"> </span></div> <div class="stat-sub svelte-plcxj0"><span class="sub-label svelte-plcxj0">Completed</span> <span class="sub-value done svelte-plcxj0"> </span></div></div></div> <div class="bento-item task-distribution svelte-plcxj0"><h3 class="svelte-plcxj0">Task Allocation</h3> <div class="task-bars svelte-plcxj0"></div></div> <div class="bento-item inventory-card svelte-plcxj0"><h3 class="svelte-plcxj0">ð¦ Inventory</h3> <div class="inv-metrics svelte-plcxj0"><div class="inv-item svelte-plcxj0"><span class="inv-label svelte-plcxj0">Materials</span> <span class="inv-value svelte-plcxj0"> </span></div> <div class="inv-item svelte-plcxj0"><span class="inv-label svelte-plcxj0">Total Stock</span> <span class="inv-value svelte-plcxj0"> </span></div> <div class="inv-item svelte-plcxj0"><span class="inv-label svelte-plcxj0">Reserved</span> <span class="inv-value highlight svelte-plcxj0"> </span></div></div></div> <div class="bento-item activity-feed svelte-plcxj0"><h3 class="svelte-plcxj0">Activity Stream</h3> <div class="feed-list svelte-plcxj0"></div></div> <div class="bento-item workload-grid svelte-plcxj0"><h3 class="svelte-plcxj0">Assignee Distribution</h3> <div class="assignee-list svelte-plcxj0"></div></div> <!></div>',1),$o=m('<div class="dashboard-wrapper svelte-plcxj0"><!></div>');function Oo(a,e){lt(e,!0);let t=y(null),r=y(!0),n=y(null);Ht(()=>(i(),ss([{label:"Dashboard",items:[{label:"Refresh",action:i}]}]),()=>{ns()}));async function i(){u(r,!0),u(n,null);try{u(t,await aa.fetchDashboardStats(),!0)}catch(b){console.error("Failed to load dashboard data",b),u(n,"Failed to load dashboard statistics. Please try again later."),Re.addNotification("Dashboard stats failed","error")}finally{u(r,!1)}}function c(b){return b?new Date(b).toLocaleString():""}function d(b){switch(b){case"POST":return"â";case"PUT":return"ð";case"DELETE":return"ðï¸";default:return"â¡"}}function v(b){return b.split("_").map(x=>x.charAt(0).toUpperCase()+x.slice(1)).join(" ")}var f=$o(),p=l(f);{var h=b=>{var x=qo();g(b,x)},_=b=>{var x=it(),S=qe(x);{var w=R=>{var N=jo(),A=o(l(N),2),$=l(A),O=o(A,2);O.__click=i,Y(()=>T($,s(n))),g(R,N)},k=R=>{var N=it(),A=qe(N);{var $=O=>{var J=Do(),X=o(qe(J),2),G=l(X),ae=l(G),le=l(ae),q=l(le),F=o(ae,2),te=l(F),oe=o(l(te),2),ee=l(oe),ve=o(te,2),re=o(l(ve),2),_e=l(re),me=o(G,2),ke=o(l(me),2);Ne(ke,21,()=>Object.entries(s(t).task_stats.by_status),Ue,(z,C)=>{var V=Ze(()=>qs(s(C),2));let H=()=>s(V)[0],fe=()=>s(V)[1];var ce=Ao(),j=l(ce),E=l(j),ne=l(E),he=o(E,2),De=l(he),Me=o(j,2),Ge=l(Me);Y(()=>{T(ne,H()),T(De,fe()),Fe(Ge,1,`bar-fill ${H()??""}`,"svelte-plcxj0"),$s(Ge,`width: ${fe()/s(t).task_stats.total*100||0}%`)}),g(z,ce)});var je=o(me,2),D=o(l(je),2),P=l(D),B=o(l(P),2),ie=l(B),se=o(P,2),de=o(l(se),2),ze=l(de),Se=o(se,2),we=o(l(Se),2),pe=l(we),Ae=o(je,2),ge=o(l(Ae),2);Ne(ge,21,()=>s(t).recent_activity,Ue,(z,C)=>{var V=Po(),H=l(V),fe=l(H),ce=o(H,2),j=l(ce),E=l(j),ne=l(E),he=o(E),De=o(j,2),Me=l(De);Y((Ge,Le,Ve,ue)=>{T(fe,Ge),T(ne,s(C).actor),T(he,` ${Le??""}
                                    ${Ve??""} #${s(C).entity_id??""}`),T(Me,ue)},[()=>d(s(C).action),()=>s(C).action.toLowerCase()==="post"?"created":s(C).action.toLowerCase()==="put"?"updated":"removed",()=>v(s(C).entity),()=>c(s(C).timestamp)]),g(z,V)},z=>{var C=No();g(z,C)});var Te=o(Ae,2),M=o(l(Te),2);Ne(M,21,()=>Object.entries(s(t).task_stats.by_assignee),Ue,(z,C)=>{var V=Ze(()=>qs(s(C),2));let H=()=>s(V)[0],fe=()=>s(V)[1];var ce=Ro(),j=l(ce),E=l(j),ne=o(j,2),he=l(ne);Y(()=>{T(E,H()),T(he,`${fe()??""} tasks`)}),g(z,ce)});var Z=o(Te,2);{var W=z=>{var C=zo(),V=o(l(C),2),H=l(V);{var fe=E=>{var ne=Co(),he=l(ne),De=l(he);Y(()=>T(De,s(t).journal_summary.error)),g(E,ne)};L(H,E=>{s(t).journal_summary.error&&E(fe)})}var ce=o(H,2);{var j=E=>{var ne=Mo(),he=l(ne),De=l(he);Y(()=>T(De,s(t).journal_summary.warning)),g(E,ne)};L(ce,E=>{s(t).journal_summary.warning&&E(j)})}g(z,C)};L(Z,z=>{(s(t).journal_summary.warning||s(t).journal_summary.error)&&z(W)})}Y(()=>{T(q,s(t).document_stats.total),T(ee,s(t).document_stats.by_status.in_progress||0),T(_e,s(t).document_stats.by_status.done||0),T(ie,s(t).inventory.total_materials),T(ze,s(t).inventory.total_quantity),T(pe,s(t).inventory.total_reserved)}),g(O,J)};L(A,O=>{s(t)&&O($)},!0)}g(R,N)};L(S,R=>{s(n)?R(w):R(k,!1)},!0)}g(b,x)};L(p,b=>{s(r)?b(h):b(_,!1)})}g(a,f),ot()}bt(["click"]);var Io=m('<div class="modal-backdrop svelte-5awcn0" role="button" tabindex="0"><div class="modal-content svelte-5awcn0" role="document" tabindex="0"><button class="close-btn svelte-5awcn0">&times;</button> <!></div></div>');function bi(a,e){lt(e,!0);let t=kt(e,"maxWidth",3,"500px");function r(d){d.key==="Escape"&&e.close()}var n=it(),i=qe(n);{var c=d=>{var v=Io();v.__click=function(..._){e.close?.apply(this,_)},v.__keydown=r;var f=l(v);f.__click=_=>_.stopPropagation(),f.__keydown=_=>_.stopPropagation();var p=l(f);p.__click=function(..._){e.close?.apply(this,_)};var h=o(p,2);Kl(h,()=>e.children),Y(()=>$s(f,`max-width: ${t()??""}`)),g(d,v)};L(i,d=>{e.isOpen&&d(c)})}g(a,n),ot()}bt(["click","keydown"]);function Yn(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var rs=Yn();function mi(a){rs=a}var Es={exec:()=>null};function et(a,e=""){let t=typeof a=="string"?a:a.source,r={replace:(n,i)=>{let c=typeof i=="string"?i:i.source;return c=c.replace(Zt.caret,"$1"),t=t.replace(n,c),r},getRegex:()=>new RegExp(t,e)};return r}var Fo=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Zt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:a=>new RegExp(`^( {0,3}${a})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:a=>new RegExp(`^ {0,${Math.min(3,a-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:a=>new RegExp(`^ {0,${Math.min(3,a-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:a=>new RegExp(`^ {0,${Math.min(3,a-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:a=>new RegExp(`^ {0,${Math.min(3,a-1)}}#`),htmlBeginRegex:a=>new RegExp(`^ {0,${Math.min(3,a-1)}}<(?:[a-z].*>|!--)`,"i")},Lo=/^(?:[ \t]*(?:\n|$))+/,Uo=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Bo=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Os=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Go=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Xn=/(?:[*+-]|\d{1,9}[.)])/,yi=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,wi=et(yi).replace(/bull/g,Xn).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Jo=et(yi).replace(/bull/g,Xn).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Hn=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Yo=/^[^\n]+/,Wn=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Xo=et(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Wn).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Ho=et(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Xn).getRegex(),sn="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Zn=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Wo=et("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Zn).replace("tag",sn).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ki=et(Hn).replace("hr",Os).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",sn).getRegex(),Zo=et(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ki).getRegex(),Vn={blockquote:Zo,code:Uo,def:Xo,fences:Bo,heading:Go,hr:Os,html:Wo,lheading:wi,list:Ho,newline:Lo,paragraph:ki,table:Es,text:Yo},yr=et("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Os).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",sn).getRegex(),Vo={...Vn,lheading:Jo,table:yr,paragraph:et(Hn).replace("hr",Os).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",yr).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",sn).getRegex()},Qo={...Vn,html:et(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Zn).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Es,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:et(Hn).replace("hr",Os).replace("heading",` *#{1,6} *[^
]`).replace("lheading",wi).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Ko=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,ec=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,xi=/^( {2,}|\\)\n(?!\s*$)/,tc=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,nn=/[\p{P}\p{S}]/u,Qn=/[\s\p{P}\p{S}]/u,Si=/[^\s\p{P}\p{S}]/u,ac=et(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Qn).getRegex(),Ti=/(?!~)[\p{P}\p{S}]/u,sc=/(?!~)[\s\p{P}\p{S}]/u,nc=/(?:[^\s\p{P}\p{S}]|~)/u,rc=et(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Fo?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Ei=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,ic=et(Ei,"u").replace(/punct/g,nn).getRegex(),lc=et(Ei,"u").replace(/punct/g,Ti).getRegex(),qi="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",oc=et(qi,"gu").replace(/notPunctSpace/g,Si).replace(/punctSpace/g,Qn).replace(/punct/g,nn).getRegex(),cc=et(qi,"gu").replace(/notPunctSpace/g,nc).replace(/punctSpace/g,sc).replace(/punct/g,Ti).getRegex(),vc=et("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Si).replace(/punctSpace/g,Qn).replace(/punct/g,nn).getRegex(),uc=et(/\\(punct)/,"gu").replace(/punct/g,nn).getRegex(),dc=et(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),fc=et(Zn).replace("(?:-->|$)","-->").getRegex(),pc=et("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",fc).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ws=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,hc=et(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Ws).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ji=et(/^!?\[(label)\]\[(ref)\]/).replace("label",Ws).replace("ref",Wn).getRegex(),Ai=et(/^!?\[(ref)\](?:\[\])?/).replace("ref",Wn).getRegex(),_c=et("reflink|nolink(?!\\()","g").replace("reflink",ji).replace("nolink",Ai).getRegex(),wr=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Kn={_backpedal:Es,anyPunctuation:uc,autolink:dc,blockSkip:rc,br:xi,code:ec,del:Es,emStrongLDelim:ic,emStrongRDelimAst:oc,emStrongRDelimUnd:vc,escape:Ko,link:hc,nolink:Ai,punctuation:ac,reflink:ji,reflinkSearch:_c,tag:pc,text:tc,url:Es},gc={...Kn,link:et(/^!?\[(label)\]\((.*?)\)/).replace("label",Ws).getRegex(),reflink:et(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ws).getRegex()},jn={...Kn,emStrongRDelimAst:cc,emStrongLDelim:lc,url:et(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",wr).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:et(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",wr).getRegex()},bc={...jn,br:et(xi).replace("{2,}","*").getRegex(),text:et(jn.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Bs={normal:Vn,gfm:Vo,pedantic:Qo},bs={normal:Kn,gfm:jn,breaks:bc,pedantic:gc},mc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},kr=a=>mc[a];function qa(a,e){if(e){if(Zt.escapeTest.test(a))return a.replace(Zt.escapeReplace,kr)}else if(Zt.escapeTestNoEncode.test(a))return a.replace(Zt.escapeReplaceNoEncode,kr);return a}function xr(a){try{a=encodeURI(a).replace(Zt.percentDecode,"%")}catch{return null}return a}function Sr(a,e){let t=a.replace(Zt.findPipe,(i,c,d)=>{let v=!1,f=c;for(;--f>=0&&d[f]==="\\";)v=!v;return v?"|":" |"}),r=t.split(Zt.splitPipe),n=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;n<r.length;n++)r[n]=r[n].trim().replace(Zt.slashPipe,"|");return r}function ms(a,e,t){let r=a.length;if(r===0)return"";let n=0;for(;n<r&&a.charAt(r-n-1)===e;)n++;return a.slice(0,r-n)}function yc(a,e){if(a.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<a.length;r++)if(a[r]==="\\")r++;else if(a[r]===e[0])t++;else if(a[r]===e[1]&&(t--,t<0))return r;return t>0?-2:-1}function Tr(a,e,t,r,n){let i=e.href,c=e.title||null,d=a[1].replace(n.other.outputLinkReplace,"$1");r.state.inLink=!0;let v={type:a[0].charAt(0)==="!"?"image":"link",raw:t,href:i,title:c,text:d,tokens:r.inlineTokens(d)};return r.state.inLink=!1,v}function wc(a,e,t){let r=a.match(t.other.indentCodeCompensation);if(r===null)return e;let n=r[1];return e.split(`
`).map(i=>{let c=i.match(t.other.beginningSpace);if(c===null)return i;let[d]=c;return d.length>=n.length?i.slice(n.length):i}).join(`
`)}var Zs=class{options;rules;lexer;constructor(a){this.options=a||rs}space(a){let e=this.rules.block.newline.exec(a);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(a){let e=this.rules.block.code.exec(a);if(e){let t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:ms(t,`
`)}}}fences(a){let e=this.rules.block.fences.exec(a);if(e){let t=e[0],r=wc(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(a){let e=this.rules.block.heading.exec(a);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){let r=ms(t,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(t=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(a){let e=this.rules.block.hr.exec(a);if(e)return{type:"hr",raw:ms(e[0],`
`)}}blockquote(a){let e=this.rules.block.blockquote.exec(a);if(e){let t=ms(e[0],`
`).split(`
`),r="",n="",i=[];for(;t.length>0;){let c=!1,d=[],v;for(v=0;v<t.length;v++)if(this.rules.other.blockquoteStart.test(t[v]))d.push(t[v]),c=!0;else if(!c)d.push(t[v]);else break;t=t.slice(v);let f=d.join(`
`),p=f.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${f}`:f,n=n?`${n}
${p}`:p;let h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(p,i,!0),this.lexer.state.top=h,t.length===0)break;let _=i.at(-1);if(_?.type==="code")break;if(_?.type==="blockquote"){let b=_,x=b.raw+`
`+t.join(`
`),S=this.blockquote(x);i[i.length-1]=S,r=r.substring(0,r.length-b.raw.length)+S.raw,n=n.substring(0,n.length-b.text.length)+S.text;break}else if(_?.type==="list"){let b=_,x=b.raw+`
`+t.join(`
`),S=this.list(x);i[i.length-1]=S,r=r.substring(0,r.length-_.raw.length)+S.raw,n=n.substring(0,n.length-b.raw.length)+S.raw,t=x.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:i,text:n}}}list(a){let e=this.rules.block.list.exec(a);if(e){let t=e[1].trim(),r=t.length>1,n={type:"list",raw:"",ordered:r,start:r?+t.slice(0,-1):"",loose:!1,items:[]};t=r?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=r?t:"[*+-]");let i=this.rules.other.listItemRegex(t),c=!1;for(;a;){let v=!1,f="",p="";if(!(e=i.exec(a))||this.rules.block.hr.test(a))break;f=e[0],a=a.substring(f.length);let h=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,S=>" ".repeat(3*S.length)),_=a.split(`
`,1)[0],b=!h.trim(),x=0;if(this.options.pedantic?(x=2,p=h.trimStart()):b?x=e[1].length+1:(x=e[2].search(this.rules.other.nonSpaceChar),x=x>4?1:x,p=h.slice(x),x+=e[1].length),b&&this.rules.other.blankLine.test(_)&&(f+=_+`
`,a=a.substring(_.length+1),v=!0),!v){let S=this.rules.other.nextBulletRegex(x),w=this.rules.other.hrRegex(x),k=this.rules.other.fencesBeginRegex(x),R=this.rules.other.headingBeginRegex(x),N=this.rules.other.htmlBeginRegex(x);for(;a;){let A=a.split(`
`,1)[0],$;if(_=A,this.options.pedantic?(_=_.replace(this.rules.other.listReplaceNesting,"  "),$=_):$=_.replace(this.rules.other.tabCharGlobal,"    "),k.test(_)||R.test(_)||N.test(_)||S.test(_)||w.test(_))break;if($.search(this.rules.other.nonSpaceChar)>=x||!_.trim())p+=`
`+$.slice(x);else{if(b||h.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||k.test(h)||R.test(h)||w.test(h))break;p+=`
`+_}!b&&!_.trim()&&(b=!0),f+=A+`
`,a=a.substring(A.length+1),h=$.slice(x)}}n.loose||(c?n.loose=!0:this.rules.other.doubleBlankLine.test(f)&&(c=!0)),n.items.push({type:"list_item",raw:f,task:!!this.options.gfm&&this.rules.other.listIsTask.test(p),loose:!1,text:p,tokens:[]}),n.raw+=f}let d=n.items.at(-1);if(d)d.raw=d.raw.trimEnd(),d.text=d.text.trimEnd();else return;n.raw=n.raw.trimEnd();for(let v of n.items){if(this.lexer.state.top=!1,v.tokens=this.lexer.blockTokens(v.text,[]),v.task){if(v.text=v.text.replace(this.rules.other.listReplaceTask,""),v.tokens[0]?.type==="text"||v.tokens[0]?.type==="paragraph"){v.tokens[0].raw=v.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),v.tokens[0].text=v.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let p=this.lexer.inlineQueue.length-1;p>=0;p--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[p].src)){this.lexer.inlineQueue[p].src=this.lexer.inlineQueue[p].src.replace(this.rules.other.listReplaceTask,"");break}}let f=this.rules.other.listTaskCheckbox.exec(v.raw);if(f){let p={type:"checkbox",raw:f[0]+" ",checked:f[0]!=="[ ]"};v.checked=p.checked,n.loose?v.tokens[0]&&["paragraph","text"].includes(v.tokens[0].type)&&"tokens"in v.tokens[0]&&v.tokens[0].tokens?(v.tokens[0].raw=p.raw+v.tokens[0].raw,v.tokens[0].text=p.raw+v.tokens[0].text,v.tokens[0].tokens.unshift(p)):v.tokens.unshift({type:"paragraph",raw:p.raw,text:p.raw,tokens:[p]}):v.tokens.unshift(p)}}if(!n.loose){let f=v.tokens.filter(h=>h.type==="space"),p=f.length>0&&f.some(h=>this.rules.other.anyLine.test(h.raw));n.loose=p}}if(n.loose)for(let v of n.items){v.loose=!0;for(let f of v.tokens)f.type==="text"&&(f.type="paragraph")}return n}}html(a){let e=this.rules.block.html.exec(a);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(a){let e=this.rules.block.def.exec(a);if(e){let t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",n=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:r,title:n}}}table(a){let e=this.rules.block.table.exec(a);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let t=Sr(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),n=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===r.length){for(let c of r)this.rules.other.tableAlignRight.test(c)?i.align.push("right"):this.rules.other.tableAlignCenter.test(c)?i.align.push("center"):this.rules.other.tableAlignLeft.test(c)?i.align.push("left"):i.align.push(null);for(let c=0;c<t.length;c++)i.header.push({text:t[c],tokens:this.lexer.inline(t[c]),header:!0,align:i.align[c]});for(let c of n)i.rows.push(Sr(c,i.header.length).map((d,v)=>({text:d,tokens:this.lexer.inline(d),header:!1,align:i.align[v]})));return i}}lheading(a){let e=this.rules.block.lheading.exec(a);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(a){let e=this.rules.block.paragraph.exec(a);if(e){let t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(a){let e=this.rules.block.text.exec(a);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(a){let e=this.rules.inline.escape.exec(a);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(a){let e=this.rules.inline.tag.exec(a);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(a){let e=this.rules.inline.link.exec(a);if(e){let t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;let i=ms(t.slice(0,-1),"\\");if((t.length-i.length)%2===0)return}else{let i=yc(e[2],"()");if(i===-2)return;if(i>-1){let c=(e[0].indexOf("!")===0?5:4)+e[1].length+i;e[2]=e[2].substring(0,i),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let r=e[2],n="";if(this.options.pedantic){let i=this.rules.other.pedanticHrefTitle.exec(r);i&&(r=i[1],n=i[3])}else n=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?r=r.slice(1):r=r.slice(1,-1)),Tr(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:n&&n.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(a,e){let t;if((t=this.rules.inline.reflink.exec(a))||(t=this.rules.inline.nolink.exec(a))){let r=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),n=e[r.toLowerCase()];if(!n){let i=t[0].charAt(0);return{type:"text",raw:i,text:i}}return Tr(t,n,t[0],this.lexer,this.rules)}}emStrong(a,e,t=""){let r=this.rules.inline.emStrongLDelim.exec(a);if(!(!r||r[3]&&t.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!t||this.rules.inline.punctuation.exec(t))){let n=[...r[0]].length-1,i,c,d=n,v=0,f=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(f.lastIndex=0,e=e.slice(-1*a.length+n);(r=f.exec(e))!=null;){if(i=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!i)continue;if(c=[...i].length,r[3]||r[4]){d+=c;continue}else if((r[5]||r[6])&&n%3&&!((n+c)%3)){v+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d+v);let p=[...r[0]][0].length,h=a.slice(0,n+r.index+p+c);if(Math.min(n,c)%2){let b=h.slice(1,-1);return{type:"em",raw:h,text:b,tokens:this.lexer.inlineTokens(b)}}let _=h.slice(2,-2);return{type:"strong",raw:h,text:_,tokens:this.lexer.inlineTokens(_)}}}}codespan(a){let e=this.rules.inline.code.exec(a);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(t),n=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return r&&n&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(a){let e=this.rules.inline.br.exec(a);if(e)return{type:"br",raw:e[0]}}del(a){let e=this.rules.inline.del.exec(a);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(a){let e=this.rules.inline.autolink.exec(a);if(e){let t,r;return e[2]==="@"?(t=e[1],r="mailto:"+t):(t=e[1],r=t),{type:"link",raw:e[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}url(a){let e;if(e=this.rules.inline.url.exec(a)){let t,r;if(e[2]==="@")t=e[0],r="mailto:"+t;else{let n;do n=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(n!==e[0]);t=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(a){let e=this.rules.inline.text.exec(a);if(e){let t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},pa=class An{tokens;options;state;inlineQueue;tokenizer;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||rs,this.options.tokenizer=this.options.tokenizer||new Zs,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:Zt,block:Bs.normal,inline:bs.normal};this.options.pedantic?(t.block=Bs.pedantic,t.inline=bs.pedantic):this.options.gfm&&(t.block=Bs.gfm,this.options.breaks?t.inline=bs.breaks:t.inline=bs.gfm),this.tokenizer.rules=t}static get rules(){return{block:Bs,inline:bs}}static lex(e,t){return new An(t).lex(e)}static lexInline(e,t){return new An(t).inlineTokens(e)}lex(e){e=e.replace(Zt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],r=!1){for(this.options.pedantic&&(e=e.replace(Zt.tabCharGlobal,"    ").replace(Zt.spaceLine,""));e;){let n;if(this.options.extensions?.block?.some(c=>(n=c.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))continue;if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length);let c=t.at(-1);n.raw.length===1&&c!==void 0?c.raw+=`
`:t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length);let c=t.at(-1);c?.type==="paragraph"||c?.type==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+n.raw,c.text+=`
`+n.text,this.inlineQueue.at(-1).src=c.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length);let c=t.at(-1);c?.type==="paragraph"||c?.type==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+n.raw,c.text+=`
`+n.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title},t.push(n));continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}let i=e;if(this.options.extensions?.startBlock){let c=1/0,d=e.slice(1),v;this.options.extensions.startBlock.forEach(f=>{v=f.call({lexer:this},d),typeof v=="number"&&v>=0&&(c=Math.min(c,v))}),c<1/0&&c>=0&&(i=e.substring(0,c+1))}if(this.state.top&&(n=this.tokenizer.paragraph(i))){let c=t.at(-1);r&&c?.type==="paragraph"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+n.raw,c.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):t.push(n),r=i.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length);let c=t.at(-1);c?.type==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+n.raw,c.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):t.push(n);continue}if(e){let c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r=e,n=null;if(this.tokens.links){let v=Object.keys(this.tokens.links);if(v.length>0)for(;(n=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)v.includes(n[0].slice(n[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(n=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,n.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let i;for(;(n=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)i=n[2]?n[2].length:0,r=r.slice(0,n.index+i)+"["+"a".repeat(n[0].length-i-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=this.options.hooks?.emStrongMask?.call({lexer:this},r)??r;let c=!1,d="";for(;e;){c||(d=""),c=!1;let v;if(this.options.extensions?.inline?.some(p=>(v=p.call({lexer:this},e,t))?(e=e.substring(v.raw.length),t.push(v),!0):!1))continue;if(v=this.tokenizer.escape(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.tag(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.link(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(v.raw.length);let p=t.at(-1);v.type==="text"&&p?.type==="text"?(p.raw+=v.raw,p.text+=v.text):t.push(v);continue}if(v=this.tokenizer.emStrong(e,r,d)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.codespan(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.br(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.del(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.autolink(e)){e=e.substring(v.raw.length),t.push(v);continue}if(!this.state.inLink&&(v=this.tokenizer.url(e))){e=e.substring(v.raw.length),t.push(v);continue}let f=e;if(this.options.extensions?.startInline){let p=1/0,h=e.slice(1),_;this.options.extensions.startInline.forEach(b=>{_=b.call({lexer:this},h),typeof _=="number"&&_>=0&&(p=Math.min(p,_))}),p<1/0&&p>=0&&(f=e.substring(0,p+1))}if(v=this.tokenizer.inlineText(f)){e=e.substring(v.raw.length),v.raw.slice(-1)!=="_"&&(d=v.raw.slice(-1)),c=!0;let p=t.at(-1);p?.type==="text"?(p.raw+=v.raw,p.text+=v.text):t.push(v);continue}if(e){let p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return t}},Vs=class{options;parser;constructor(a){this.options=a||rs}space(a){return""}code({text:a,lang:e,escaped:t}){let r=(e||"").match(Zt.notSpaceStart)?.[0],n=a.replace(Zt.endingNewline,"")+`
`;return r?'<pre><code class="language-'+qa(r)+'">'+(t?n:qa(n,!0))+`</code></pre>
`:"<pre><code>"+(t?n:qa(n,!0))+`</code></pre>
`}blockquote({tokens:a}){return`<blockquote>
${this.parser.parse(a)}</blockquote>
`}html({text:a}){return a}def(a){return""}heading({tokens:a,depth:e}){return`<h${e}>${this.parser.parseInline(a)}</h${e}>
`}hr(a){return`<hr>
`}list(a){let e=a.ordered,t=a.start,r="";for(let c=0;c<a.items.length;c++){let d=a.items[c];r+=this.listitem(d)}let n=e?"ol":"ul",i=e&&t!==1?' start="'+t+'"':"";return"<"+n+i+`>
`+r+"</"+n+`>
`}listitem(a){return`<li>${this.parser.parse(a.tokens)}</li>
`}checkbox({checked:a}){return"<input "+(a?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:a}){return`<p>${this.parser.parseInline(a)}</p>
`}table(a){let e="",t="";for(let n=0;n<a.header.length;n++)t+=this.tablecell(a.header[n]);e+=this.tablerow({text:t});let r="";for(let n=0;n<a.rows.length;n++){let i=a.rows[n];t="";for(let c=0;c<i.length;c++)t+=this.tablecell(i[c]);r+=this.tablerow({text:t})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow({text:a}){return`<tr>
${a}</tr>
`}tablecell(a){let e=this.parser.parseInline(a.tokens),t=a.header?"th":"td";return(a.align?`<${t} align="${a.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:a}){return`<strong>${this.parser.parseInline(a)}</strong>`}em({tokens:a}){return`<em>${this.parser.parseInline(a)}</em>`}codespan({text:a}){return`<code>${qa(a,!0)}</code>`}br(a){return"<br>"}del({tokens:a}){return`<del>${this.parser.parseInline(a)}</del>`}link({href:a,title:e,tokens:t}){let r=this.parser.parseInline(t),n=xr(a);if(n===null)return r;a=n;let i='<a href="'+a+'"';return e&&(i+=' title="'+qa(e)+'"'),i+=">"+r+"</a>",i}image({href:a,title:e,text:t,tokens:r}){r&&(t=this.parser.parseInline(r,this.parser.textRenderer));let n=xr(a);if(n===null)return qa(t);a=n;let i=`<img src="${a}" alt="${t}"`;return e&&(i+=` title="${qa(e)}"`),i+=">",i}text(a){return"tokens"in a&&a.tokens?this.parser.parseInline(a.tokens):"escaped"in a&&a.escaped?a.text:qa(a.text)}},er=class{strong({text:a}){return a}em({text:a}){return a}codespan({text:a}){return a}del({text:a}){return a}html({text:a}){return a}text({text:a}){return a}link({text:a}){return""+a}image({text:a}){return""+a}br(){return""}checkbox({raw:a}){return a}},ha=class Pn{options;renderer;textRenderer;constructor(e){this.options=e||rs,this.options.renderer=this.options.renderer||new Vs,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new er}static parse(e,t){return new Pn(t).parse(e)}static parseInline(e,t){return new Pn(t).parseInline(e)}parse(e){let t="";for(let r=0;r<e.length;r++){let n=e[r];if(this.options.extensions?.renderers?.[n.type]){let c=n,d=this.options.extensions.renderers[c.type].call({parser:this},c);if(d!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(c.type)){t+=d||"";continue}}let i=n;switch(i.type){case"space":{t+=this.renderer.space(i);break}case"hr":{t+=this.renderer.hr(i);break}case"heading":{t+=this.renderer.heading(i);break}case"code":{t+=this.renderer.code(i);break}case"table":{t+=this.renderer.table(i);break}case"blockquote":{t+=this.renderer.blockquote(i);break}case"list":{t+=this.renderer.list(i);break}case"checkbox":{t+=this.renderer.checkbox(i);break}case"html":{t+=this.renderer.html(i);break}case"def":{t+=this.renderer.def(i);break}case"paragraph":{t+=this.renderer.paragraph(i);break}case"text":{t+=this.renderer.text(i);break}default:{let c='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return t}parseInline(e,t=this.renderer){let r="";for(let n=0;n<e.length;n++){let i=e[n];if(this.options.extensions?.renderers?.[i.type]){let d=this.options.extensions.renderers[i.type].call({parser:this},i);if(d!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){r+=d||"";continue}}let c=i;switch(c.type){case"escape":{r+=t.text(c);break}case"html":{r+=t.html(c);break}case"link":{r+=t.link(c);break}case"image":{r+=t.image(c);break}case"checkbox":{r+=t.checkbox(c);break}case"strong":{r+=t.strong(c);break}case"em":{r+=t.em(c);break}case"codespan":{r+=t.codespan(c);break}case"br":{r+=t.br(c);break}case"del":{r+=t.del(c);break}case"text":{r+=t.text(c);break}default:{let d='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(d),"";throw new Error(d)}}}return r}},ks=class{options;block;constructor(a){this.options=a||rs}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(a){return a}postprocess(a){return a}processAllTokens(a){return a}emStrongMask(a){return a}provideLexer(){return this.block?pa.lex:pa.lexInline}provideParser(){return this.block?ha.parse:ha.parseInline}},kc=class{defaults=Yn();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=ha;Renderer=Vs;TextRenderer=er;Lexer=pa;Tokenizer=Zs;Hooks=ks;constructor(...a){this.use(...a)}walkTokens(a,e){let t=[];for(let r of a)switch(t=t.concat(e.call(this,r)),r.type){case"table":{let n=r;for(let i of n.header)t=t.concat(this.walkTokens(i.tokens,e));for(let i of n.rows)for(let c of i)t=t.concat(this.walkTokens(c.tokens,e));break}case"list":{let n=r;t=t.concat(this.walkTokens(n.items,e));break}default:{let n=r;this.defaults.extensions?.childTokens?.[n.type]?this.defaults.extensions.childTokens[n.type].forEach(i=>{let c=n[i].flat(1/0);t=t.concat(this.walkTokens(c,e))}):n.tokens&&(t=t.concat(this.walkTokens(n.tokens,e)))}}return t}use(...a){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return a.forEach(t=>{let r={...t};if(r.async=this.defaults.async||r.async||!1,t.extensions&&(t.extensions.forEach(n=>{if(!n.name)throw new Error("extension name required");if("renderer"in n){let i=e.renderers[n.name];i?e.renderers[n.name]=function(...c){let d=n.renderer.apply(this,c);return d===!1&&(d=i.apply(this,c)),d}:e.renderers[n.name]=n.renderer}if("tokenizer"in n){if(!n.level||n.level!=="block"&&n.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let i=e[n.level];i?i.unshift(n.tokenizer):e[n.level]=[n.tokenizer],n.start&&(n.level==="block"?e.startBlock?e.startBlock.push(n.start):e.startBlock=[n.start]:n.level==="inline"&&(e.startInline?e.startInline.push(n.start):e.startInline=[n.start]))}"childTokens"in n&&n.childTokens&&(e.childTokens[n.name]=n.childTokens)}),r.extensions=e),t.renderer){let n=this.defaults.renderer||new Vs(this.defaults);for(let i in t.renderer){if(!(i in n))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;let c=i,d=t.renderer[c],v=n[c];n[c]=(...f)=>{let p=d.apply(n,f);return p===!1&&(p=v.apply(n,f)),p||""}}r.renderer=n}if(t.tokenizer){let n=this.defaults.tokenizer||new Zs(this.defaults);for(let i in t.tokenizer){if(!(i in n))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;let c=i,d=t.tokenizer[c],v=n[c];n[c]=(...f)=>{let p=d.apply(n,f);return p===!1&&(p=v.apply(n,f)),p}}r.tokenizer=n}if(t.hooks){let n=this.defaults.hooks||new ks;for(let i in t.hooks){if(!(i in n))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;let c=i,d=t.hooks[c],v=n[c];ks.passThroughHooks.has(i)?n[c]=f=>{if(this.defaults.async&&ks.passThroughHooksRespectAsync.has(i))return(async()=>{let h=await d.call(n,f);return v.call(n,h)})();let p=d.call(n,f);return v.call(n,p)}:n[c]=(...f)=>{if(this.defaults.async)return(async()=>{let h=await d.apply(n,f);return h===!1&&(h=await v.apply(n,f)),h})();let p=d.apply(n,f);return p===!1&&(p=v.apply(n,f)),p}}r.hooks=n}if(t.walkTokens){let n=this.defaults.walkTokens,i=t.walkTokens;r.walkTokens=function(c){let d=[];return d.push(i.call(this,c)),n&&(d=d.concat(n.call(this,c))),d}}this.defaults={...this.defaults,...r}}),this}setOptions(a){return this.defaults={...this.defaults,...a},this}lexer(a,e){return pa.lex(a,e??this.defaults)}parser(a,e){return ha.parse(a,e??this.defaults)}parseMarkdown(a){return(e,t)=>{let r={...t},n={...this.defaults,...r},i=this.onError(!!n.silent,!!n.async);if(this.defaults.async===!0&&r.async===!1)return i(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return i(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(n.hooks&&(n.hooks.options=n,n.hooks.block=a),n.async)return(async()=>{let c=n.hooks?await n.hooks.preprocess(e):e,d=await(n.hooks?await n.hooks.provideLexer():a?pa.lex:pa.lexInline)(c,n),v=n.hooks?await n.hooks.processAllTokens(d):d;n.walkTokens&&await Promise.all(this.walkTokens(v,n.walkTokens));let f=await(n.hooks?await n.hooks.provideParser():a?ha.parse:ha.parseInline)(v,n);return n.hooks?await n.hooks.postprocess(f):f})().catch(i);try{n.hooks&&(e=n.hooks.preprocess(e));let c=(n.hooks?n.hooks.provideLexer():a?pa.lex:pa.lexInline)(e,n);n.hooks&&(c=n.hooks.processAllTokens(c)),n.walkTokens&&this.walkTokens(c,n.walkTokens);let d=(n.hooks?n.hooks.provideParser():a?ha.parse:ha.parseInline)(c,n);return n.hooks&&(d=n.hooks.postprocess(d)),d}catch(c){return i(c)}}}onError(a,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,a){let r="<p>An error occurred:</p><pre>"+qa(t.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(t);throw t}}},ts=new kc;function ut(a,e){return ts.parse(a,e)}ut.options=ut.setOptions=function(a){return ts.setOptions(a),ut.defaults=ts.defaults,mi(ut.defaults),ut};ut.getDefaults=Yn;ut.defaults=rs;ut.use=function(...a){return ts.use(...a),ut.defaults=ts.defaults,mi(ut.defaults),ut};ut.walkTokens=function(a,e){return ts.walkTokens(a,e)};ut.parseInline=ts.parseInline;ut.Parser=ha;ut.parser=ha.parse;ut.Renderer=Vs;ut.TextRenderer=er;ut.Lexer=pa;ut.lexer=pa.lex;ut.Tokenizer=Zs;ut.Hooks=ks;ut.parse=ut;ut.options;ut.setOptions;ut.use;ut.walkTokens;ut.parseInline;ha.parse;pa.lex;var xc=m('<input type="text" class="edit-input svelte-1b0y5ne"/>'),Sc=m('<button class="btn-icon svelte-1b0y5ne" title="Save">â</button> <button class="btn-icon svelte-1b0y5ne" title="Cancel">â</button>',1),Tc=m('<button class="btn-icon svelte-1b0y5ne" title="Edit">âï¸</button> <button class="btn-icon delete svelte-1b0y5ne" title="Delete">ðï¸</button>',1),Ec=m('<tr class="svelte-1b0y5ne"><td class="svelte-1b0y5ne"><!></td><td class="svelte-1b0y5ne"><!></td></tr>'),qc=m('<div class="empty-state svelte-1b0y5ne">No materials yet. Add one above.</div>'),jc=m('<div class="modal-overlay svelte-1b0y5ne"><div class="modal-content svelte-1b0y5ne"><div class="modal-header svelte-1b0y5ne"><h3 class="svelte-1b0y5ne">Material Library</h3> <button class="close-btn svelte-1b0y5ne">&times;</button></div> <div class="modal-body svelte-1b0y5ne"><div class="add-section svelte-1b0y5ne"><input type="text" placeholder="New material name..." class="svelte-1b0y5ne"/> <button class="btn-add svelte-1b0y5ne">Add</button></div> <table class="materials-table svelte-1b0y5ne"><thead><tr><th class="svelte-1b0y5ne">Name</th><th class="svelte-1b0y5ne">Actions</th></tr></thead><tbody></tbody></table> <!></div></div></div>');function Ac(a,e){lt(e,!0);let t=y(Ce([])),r=y(""),n=y(null),i=y("");async function c(){if(e.isOpen)try{u(t,await Dt.fetchMaterials(),!0)}catch(S){console.error(S),Re.addNotification("Failed to load materials","error")}}Ut(()=>{c()});async function d(){if(s(r).trim())try{await Dt.createMaterial({name:s(r).trim()}),u(r,""),Re.addNotification("Material added","info"),await c()}catch(S){console.error(S),Re.addNotification("Failed to add material","error")}}function v(S){u(n,S.id,!0),u(i,S.name,!0)}async function f(){if(!(!s(i).trim()||s(n)===null))try{await Dt.updateMaterial(s(n),s(i).trim()),u(n,null),u(i,""),Re.addNotification("Material updated","info"),await c()}catch(S){console.error(S),Re.addNotification("Failed to update material","error")}}function p(){u(n,null),u(i,"")}async function h(S){if(confirm("Delete this material?"))try{await Dt.deleteMaterial(S),Re.addNotification("Material deleted","info"),await c()}catch(w){console.error(w),Re.addNotification("Failed to delete material","error")}}var _=it(),b=qe(_);{var x=S=>{var w=jc();w.__click=function(...q){e.close?.apply(this,q)};var k=l(w);k.__click=q=>q.stopPropagation();var R=l(k),N=o(l(R),2);N.__click=function(...q){e.close?.apply(this,q)};var A=o(R,2),$=l(A),O=l($);O.__keydown=q=>q.key==="Enter"&&d();var J=o(O,2);J.__click=d;var X=o($,2),G=o(l(X));Ne(G,21,()=>s(t),q=>q.id,(q,F)=>{var te=Ec(),oe=l(te),ee=l(oe);{var ve=D=>{var P=xc();P.__keydown=B=>{B.key==="Enter"&&f(),B.key==="Escape"&&p()},Pe(P,()=>s(i),B=>u(i,B)),g(D,P)},re=D=>{var P=_i();Y(()=>T(P,s(F).name)),g(D,P)};L(ee,D=>{s(n)===s(F).id?D(ve):D(re,!1)})}var _e=o(oe),me=l(_e);{var ke=D=>{var P=Sc(),B=qe(P);B.__click=f;var ie=o(B,2);ie.__click=p,g(D,P)},je=D=>{var P=Tc(),B=qe(P);B.__click=()=>v(s(F));var ie=o(B,2);ie.__click=()=>h(s(F).id),g(D,P)};L(me,D=>{s(n)===s(F).id?D(ke):D(je,!1)})}g(q,te)});var ae=o(X,2);{var le=q=>{var F=qc();g(q,F)};L(ae,q=>{s(t).length===0&&q(le)})}Pe(O,()=>s(r),q=>u(r,q)),g(S,w)};L(b,S=>{e.isOpen&&S(x)})}g(a,_),ot()}bt(["click","keydown"]);var Pc=m('<input type="text" class="edit-input svelte-1w6q42o"/>'),Nc=m('<button class="btn-icon svelte-1w6q42o" title="Save">â</button> <button class="btn-icon svelte-1w6q42o" title="Cancel">â</button>',1),Rc=m('<button class="btn-icon svelte-1w6q42o" title="Edit">âï¸</button> <button class="btn-icon delete svelte-1w6q42o" title="Delete">ðï¸</button>',1),Cc=m('<tr class="svelte-1w6q42o"><td class="svelte-1w6q42o"><!></td><td class="svelte-1w6q42o"><!></td></tr>'),Mc=m('<div class="empty-state svelte-1w6q42o">No assignees yet. Add one above.</div>'),zc=m('<div class="modal-overlay svelte-1w6q42o"><div class="modal-content svelte-1w6q42o"><div class="modal-header svelte-1w6q42o"><h3 class="svelte-1w6q42o">Assignee Library</h3> <button class="close-btn svelte-1w6q42o">&times;</button></div> <div class="modal-body svelte-1w6q42o"><div class="add-section svelte-1w6q42o"><input type="text" placeholder="New assignee name..." class="svelte-1w6q42o"/> <button class="btn-add svelte-1w6q42o">Add</button></div> <table class="assignees-table svelte-1w6q42o"><thead><tr><th class="svelte-1w6q42o">Name</th><th class="svelte-1w6q42o">Actions</th></tr></thead><tbody></tbody></table> <!></div></div></div>');function Pi(a,e){lt(e,!0);let t=y(Ce([])),r=y(""),n=y(null),i=y("");async function c(){e.isOpen&&u(t,await Xe.fetchAssignees(),!0)}Ut(()=>{c()});async function d(){if(s(r).trim())try{await Xe.createAssignee({name:s(r).trim()}),u(r,""),await c()}catch(S){console.error(S),alert("Failed to add assignee")}}function v(S){u(n,S.id,!0),u(i,S.name,!0)}async function f(){if(!(!s(i).trim()||s(n)===null))try{await Xe.updateAssignee(s(n),s(i).trim()),u(n,null),u(i,""),await c()}catch(S){console.error(S),alert("Failed to update assignee")}}function p(){u(n,null),u(i,"")}async function h(S){if(confirm("Delete this assignee?"))try{await Xe.deleteAssignee(S),await c()}catch(w){console.error(w),alert("Failed to delete assignee")}}var _=it(),b=qe(_);{var x=S=>{var w=zc();w.__click=function(...q){e.close?.apply(this,q)};var k=l(w);k.__click=q=>q.stopPropagation();var R=l(k),N=o(l(R),2);N.__click=function(...q){e.close?.apply(this,q)};var A=o(R,2),$=l(A),O=l($);O.__keydown=q=>q.key==="Enter"&&d();var J=o(O,2);J.__click=d;var X=o($,2),G=o(l(X));Ne(G,21,()=>s(t),q=>q.id,(q,F)=>{var te=Cc(),oe=l(te),ee=l(oe);{var ve=D=>{var P=Pc();Vr(P),P.__keydown=B=>{B.key==="Enter"&&f(),B.key==="Escape"&&p()},Pe(P,()=>s(i),B=>u(i,B)),g(D,P)},re=D=>{var P=_i();Y(()=>T(P,s(F).name)),g(D,P)};L(ee,D=>{s(n)===s(F).id?D(ve):D(re,!1)})}var _e=o(oe),me=l(_e);{var ke=D=>{var P=Nc(),B=qe(P);B.__click=f;var ie=o(B,2);ie.__click=p,g(D,P)},je=D=>{var P=Rc(),B=qe(P);B.__click=()=>v(s(F));var ie=o(B,2);ie.__click=()=>h(s(F).id),g(D,P)};L(me,D=>{s(n)===s(F).id?D(ke):D(je,!1)})}g(q,te)});var ae=o(X,2);{var le=q=>{var F=Mc();g(q,F)};L(ae,q=>{s(t).length===0&&q(le)})}Pe(O,()=>s(r),q=>u(r,q)),g(S,w)};L(b,S=>{e.isOpen&&S(x)})}g(a,_),ot()}bt(["click","keydown"]);var Dc=m("<option> </option>"),$c=m('<div class="part-item svelte-1iwbfq1"><span class="part-name svelte-1iwbfq1"> </span> <span class="part-qty svelte-1iwbfq1"> </span></div>'),Oc=m('<div class="form-group svelte-1iwbfq1"><label class="svelte-1iwbfq1">Associated Parts</label> <div class="parts-list svelte-1iwbfq1"></div></div>'),Ic=m("<option> </option>"),Fc=m('<div class="modal-overlay svelte-1iwbfq1"><div class="modal-content svelte-1iwbfq1"><div class="modal-header svelte-1iwbfq1"><h3 class="svelte-1iwbfq1"> </h3> <button class="close-btn svelte-1iwbfq1">&times;</button></div> <form class="modal-body svelte-1iwbfq1"><div class="form-group svelte-1iwbfq1"><label for="name" class="svelte-1iwbfq1">Task Name</label> <input id="name" type="text" placeholder="Enter task name..." required class="svelte-1iwbfq1"/></div> <div class="form-group svelte-1iwbfq1"><label for="material" class="svelte-1iwbfq1">Material</label> <div class="material-row svelte-1iwbfq1"><select id="material" class="material-select svelte-1iwbfq1"><option>-- No Material --</option><!></select> <button type="button" class="btn-library svelte-1iwbfq1" title="Edit Material Library">ð</button></div></div> <div class="form-group svelte-1iwbfq1"><label for="gnc_path" class="svelte-1iwbfq1">GNC File Path</label> <input id="gnc_path" type="text" placeholder="e.g. Z:\\Sidra\\Part1.gnc" class="svelte-1iwbfq1"/></div> <!> <div class="form-group svelte-1iwbfq1"><label for="assignee" class="svelte-1iwbfq1">Assignee</label> <div class="material-row svelte-1iwbfq1"><select id="assignee" class="material-select svelte-1iwbfq1"><option>-- No Assignee --</option><!></select> <button type="button" class="btn-library svelte-1iwbfq1" title="Edit Assignee Library">ð¥</button></div></div> <div class="actions svelte-1iwbfq1"><button type="button" class="btn-secondary svelte-1iwbfq1">Cancel</button> <button type="submit" class="btn-primary svelte-1iwbfq1"> </button></div></form></div></div>'),Lc=m("<!> <!> <!>",1);function Uc(a,e){lt(e,!0);let t=kt(e,"task",3,null),r=y(""),n=y(""),i=y(null),c=y(""),d=y(!1),v=y(Ce([])),f=y(Ce([])),p=y(!1),h=y(!1);async function _(){u(v,await Dt.fetchMaterials(),!0)}async function b(){u(f,await Xe.fetchAssignees(),!0)}Ut(()=>{e.isOpen&&(console.log("TaskModal Opened. Task:",t()),t()?(u(r,t().name,!0),u(n,t().assignee||"",!0),u(i,t().material_id||(t().material?t().material.id:null),!0),u(c,t().gnc_file_path||"",!0)):(u(n,localStorage.getItem("task_assignee")||"",!0),u(r,""),u(i,null),u(c,"")),_(),b())});async function x(X){if(X.preventDefault(),!!s(r)){u(d,!0);try{s(n)&&!t()&&localStorage.setItem("task_assignee",s(n)),await e.onSubmit({id:t()?t().id:void 0,name:s(r),assignee:s(n),material_id:s(i),gnc_file_path:s(c)}),e.close()}catch(G){console.error(G),alert("Failed to add task")}finally{u(d,!1)}}}function S(){u(p,!0)}function w(){u(p,!1),_()}function k(){u(h,!0)}function R(){u(h,!1),b()}var N=Lc(),A=qe(N);{var $=X=>{var G=Fc();G.__click=function(...W){e.close?.apply(this,W)};var ae=l(G);ae.__click=W=>W.stopPropagation();var le=l(ae),q=l(le),F=l(q),te=o(q,2);te.__click=function(...W){e.close?.apply(this,W)};var oe=o(le,2),ee=l(oe),ve=o(l(ee),2);Vr(ve);var re=o(ee,2),_e=o(l(re),2),me=l(_e),ke=l(me);ke.value=(ke.__value=null)??"";var je=o(ke);Ne(je,17,()=>s(v),Ue,(W,z)=>{var C=Dc(),V=l(C),H={};Y(()=>{T(V,s(z).name),H!==(H=s(z).id)&&(C.value=(C.__value=s(z).id)??"")}),g(W,C)});var D=o(me,2);D.__click=S;var P=o(re,2),B=o(l(P),2),ie=o(P,2);{var se=W=>{var z=Oc(),C=o(l(z),2);Ne(C,21,()=>t().part_associations,Ue,(V,H)=>{var fe=$c(),ce=l(fe),j=l(ce),E=o(ce,2),ne=l(E);Y(()=>{Ke(ce,"title",s(H).part.name),T(j,s(H).part.name),T(ne,`x${s(H).quantity??""}`)}),g(V,fe)}),g(W,z)};L(ie,W=>{t()&&t().part_associations&&t().part_associations.length>0&&W(se)})}var de=o(ie,2),ze=o(l(de),2),Se=l(ze),we=l(Se);we.value=we.__value="";var pe=o(we);Ne(pe,17,()=>s(f),Ue,(W,z)=>{var C=Ic(),V=l(C),H={};Y(()=>{T(V,s(z).name),H!==(H=s(z).name)&&(C.value=(C.__value=s(z).name)??"")}),g(W,C)});var Ae=o(Se,2);Ae.__click=k;var ge=o(de,2),Te=l(ge);Te.__click=function(...W){e.close?.apply(this,W)};var M=o(Te,2),Z=l(M);Y(()=>{T(F,t()?"Edit Task":"Add Task"),M.disabled=s(d),T(Z,s(d)?t()?"Saving...":"Adding...":t()?"Save Changes":"Add Task")}),ba("submit",oe,x),Pe(ve,()=>s(r),W=>u(r,W)),qt(me,()=>s(i),W=>u(i,W)),Pe(B,()=>s(c),W=>u(c,W)),qt(Se,()=>s(n),W=>u(n,W)),g(X,G)};L(A,X=>{e.isOpen&&X($)})}var O=o(A,2);Ac(O,{get isOpen(){return s(p)},close:w});var J=o(O,2);Pi(J,{get isOpen(){return s(h)},close:R}),g(a,N),ot()}bt(["click"]);var Bc=m('<div class="material-group-header svelte-ty272s"><span class="material-group-name svelte-ty272s"> </span> <span class="material-group-count svelte-ty272s"> </span></div>'),Gc=m("<option> </option>"),Jc=m('<span class="material-badge svelte-ty272s"> </span>'),Yc=m('<div class="task-item svelte-ty272s"><div class="task-line-1 svelte-ty272s"><span> </span> <div class="task-right-group svelte-ty272s"><select><option>Planned</option><option>Pending</option><option>Done</option></select> <div class="task-actions svelte-ty272s"><button class="edit-btn svelte-ty272s" title="Edit">â</button> <button class="delete-btn svelte-ty272s" title="Delete">Ã</button></div></div></div> <div class="task-line-2 svelte-ty272s"><div class="assignee-container svelte-ty272s"><select class="assignee-select svelte-ty272s"><option>Assignee</option><!></select> <button class="assignee-add-btn svelte-ty272s" title="Manage Assignees">+</button></div> <!></div></div>'),Xc=m("<!> <!>",1),Hc=m('<div class="empty-tasks svelte-ty272s"> </div>'),Wc=m('<div class="embedded-tasks svelte-ty272s"><div class="tasks-header svelte-ty272s"><h4 class="svelte-ty272s">Tasks</h4> <div class="header-actions svelte-ty272s"><button class="group-toggle-btn svelte-ty272s"> </button> <select class="filter-select svelte-ty272s"><option>Hide Done</option><option>Show All</option><option>Pending</option></select> <button class="add-task-btn svelte-ty272s">+ Add</button></div></div> <div class="tasks-list svelte-ty272s"><!> <!></div></div> <!> <!>',1);function Ni(a,e){lt(e,!0);let t=kt(e,"filterAssignee",3,""),r=kt(e,"partSearch",3,""),n=y(Ce(e.document.tasks||[]));Ut(()=>{u(n,e.document.tasks||[],!0)});let i=y("hide_done"),c=y(!1),d=y(null),v=y(!0),f=y(Ce([])),p=y(!1);Ht(async()=>{u(f,await Xe.fetchAssignees(),!0)});async function h(){u(f,await Xe.fetchAssignees(),!0)}let _=Ze(()=>[...s(n)].sort((P,B)=>P.status==="done"&&B.status!=="done"?1:P.status!=="done"&&B.status==="done"?-1:0)),b=Ze(()=>s(_).filter(P=>{if(s(i)==="hide_done"&&P.status==="done"||s(i)==="pending"&&P.status!=="pending")return!1;if(s(i)==="all"){if(t()&&t().trim()){const B=(P.assignee||"").toLowerCase(),ie=t().toLowerCase();return B.includes(ie)}return!0}if(t()&&t().trim()){const B=(P.assignee||"").toLowerCase(),ie=t().toLowerCase();if(!B.includes(ie))return!1}if(r()&&r().trim()){if(!P.part_associations||P.part_associations.length===0)return!1;const B=r().toLowerCase();if(!P.part_associations.some(se=>{const de=se.part;return de?de.name&&de.name.toLowerCase().includes(B)||de.registration_number&&de.registration_number.toLowerCase().includes(B):!1}))return!1}return!0})),x=Ze(()=>()=>{if(!s(v))return{"All Tasks":s(b)};const P={};s(b).forEach(se=>{const de=se.material?se.material.name:"(No Material)";P[de]||(P[de]=[]),P[de].push(se)});const B={};return Object.keys(P).sort((se,de)=>se==="(No Material)"?1:de==="(No Material)"?-1:se.localeCompare(de)).forEach(se=>{B[se]=P[se]}),B});async function S(P,B){try{P.status=B,await ea.updateJobStatus(P.id,B),e.refresh()}catch(ie){console.error(ie)}}async function w(P,B){try{await ea.updateJob(P.id,{...P,assignee:B})}catch(ie){console.error(ie)}}async function k(P){if(confirm("Delete task?"))try{await ea.deleteJob(P),u(n,s(n).filter(B=>B.id!==P),!0),e.refresh()}catch(B){console.error(B)}}async function R(P){try{if(P.id){const B=await ea.updateJob(P.id,{id:P.id,name:P.name,assignee:P.assignee,material_id:P.material_id,gnc_file_path:P.gnc_file_path,document_id:e.document.id});u(n,s(n).map(ie=>ie.id===P.id?{...ie,...B}:ie),!0),e.refresh()}else{const B=await ea.createJob({name:P.name,assignee:P.assignee,status:"planned",material_id:P.material_id,gnc_file_path:P.gnc_file_path,document_id:e.document.id});u(n,[...s(n),B],!0),e.refresh()}}catch(B){throw console.error(B),B}}function N(){u(p,!0)}function A(){u(p,!1),h()}function $(){console.log("Opening Add Modal"),u(d,null),u(c,!0)}function O(P){console.log("Opening Edit Modal for:",P),u(d,P,!0),u(c,!0)}var J=Wc(),X=qe(J),G=l(X),ae=o(l(G),2),le=l(ae);le.__click=()=>u(v,!s(v));var q=l(le),F=o(le,2),te=l(F);te.value=te.__value="hide_done";var oe=o(te);oe.value=oe.__value="all";var ee=o(oe);ee.value=ee.__value="pending";var ve=o(F,2);ve.__click=$;var re=o(G,2),_e=l(re);Ne(_e,17,()=>Object.entries(s(x)()),([P,B])=>P,(P,B)=>{var ie=Ze(()=>qs(s(B),2));let se=()=>s(ie)[0],de=()=>s(ie)[1];var ze=Xc(),Se=qe(ze);{var we=Ae=>{var ge=Bc(),Te=l(ge),M=l(Te),Z=o(Te,2),W=l(Z);Y(()=>{T(M,se()),T(W,`(${de().length??""})`)}),g(Ae,ge)};L(Se,Ae=>{s(v)&&Object.keys(s(x)()).length>1&&Ae(we)})}var pe=o(Se,2);Ne(pe,17,de,Ae=>Ae.id,(Ae,ge)=>{var Te=Yc(),M=l(Te),Z=l(M),W=l(Z),z=o(Z,2),C=l(z);C.__change=U=>S(s(ge),U.currentTarget.value);var V=l(C);V.value=V.__value="planned";var H=o(V);H.value=H.__value="pending";var fe=o(H);fe.value=fe.__value="done";var ce;Ps(C);var j=o(C,2),E=l(j);E.__click=()=>O(s(ge));var ne=o(E,2);ne.__click=()=>k(s(ge).id);var he=o(M,2),De=l(he),Me=l(De);Me.__change=U=>w(s(ge),U.currentTarget.value);var Ge=l(Me);Ge.value=Ge.__value="";var Le=o(Ge);Ne(Le,17,()=>s(f),Ue,(U,be)=>{var Oe=Gc(),st=l(Oe),ct={};Y(()=>{T(st,s(be).name),ct!==(ct=s(be).name)&&(Oe.value=(Oe.__value=s(be).name)??"")}),g(U,Oe)});var Ve;Ps(Me);var ue=o(Me,2);ue.__click=N;var Q=o(De,2);{var Ie=U=>{var be=Jc(),Oe=l(be);Y(()=>{Ke(be,"title",`Material: ${s(ge).material.name??""}`),T(Oe,`ð¦ ${s(ge).material.name??""}`)}),g(U,be)};L(Q,U=>{s(ge).material&&U(Ie)})}Y(()=>{Fe(Z,1,`task-name ${s(ge).status==="done"?"done-text":""}`,"svelte-ty272s"),Ke(Z,"title",s(ge).name),T(W,s(ge).name),Fe(C,1,`status-select ${s(ge).status??""}`,"svelte-ty272s"),ce!==(ce=s(ge).status)&&(C.value=(C.__value=s(ge).status)??"",fs(C,s(ge).status)),Ve!==(Ve=s(ge).assignee||"")&&(Me.value=(Me.__value=s(ge).assignee||"")??"",fs(Me,s(ge).assignee||""))}),g(Ae,Te)}),g(P,ze)});var me=o(_e,2);{var ke=P=>{var B=Hc(),ie=l(B);Y(()=>T(ie,s(n).length>0?"No tasks match filter.":"No tasks yet.")),g(P,B)};L(me,P=>{s(b).length===0&&P(ke)})}var je=o(X,2);Uc(je,{get isOpen(){return s(c)},close:()=>u(c,!1),onSubmit:R,get task(){return s(d)}});var D=o(je,2);Pi(D,{get isOpen(){return s(p)},close:A}),Y(()=>{Ke(le,"title",s(v)?"Show flat list":"Group by material"),T(q,s(v)?"ð¦":"ð")}),qt(F,()=>s(i),P=>u(i,P)),g(a,J),ot()}bt(["click","change"]);var Zc=m('<span class="author"> </span>'),Vc=m('<span class="date"> </span>'),Qc=m('<span class="tag-badge svelte-187zyvb"> </span>'),Kc=m('<div class="tags-row svelte-187zyvb"></div>'),ev=m('<img class="svelte-187zyvb"/>'),tv=m('<div class="attachment-card svelte-187zyvb"><!> <a target="_blank" rel="noreferrer" class="svelte-187zyvb"> </a></div>'),av=m('<div class="attachments svelte-187zyvb"><h3 class="svelte-187zyvb">Attachments</h3> <div class="grid svelte-187zyvb"></div></div>'),sv=m('<a target="_blank" rel="noreferrer" class="note-attachment-link svelte-187zyvb"> </a>'),nv=m('<div class="note-attachments svelte-187zyvb"><strong class="svelte-187zyvb">Attachments:</strong> <!></div>'),rv=m('<div class="note-card svelte-187zyvb"><div class="note-header svelte-187zyvb"><span> </span> <span class="note-author svelte-187zyvb"> </span> <span class="note-date svelte-187zyvb"> </span> <span> </span></div> <p class="note-text svelte-187zyvb"> </p> <!></div>'),iv=m('<div class="notes-section svelte-187zyvb"><h3 class="svelte-187zyvb">Notes</h3> <div class="notes-list svelte-187zyvb"></div></div>'),lv=m('<div class="document-view"><h2 class="svelte-187zyvb"> </h2> <div class="meta svelte-187zyvb"><span> </span> <span> </span> <span class="date"> </span> <!> <!></div> <!> <div class="content markdown-body svelte-187zyvb"><!></div> <!> <!> <div class="tasks-section"><!></div></div>');function ov(a,e){lt(e,!0);let t=kt(e,"document",15),r=Ze(()=>t()&&t().content?ut.parse(t().content):"<p>No content available.</p>");var n=lv(),i=l(n),c=l(i),d=o(i,2),v=l(d),f=l(v),p=o(v,2),h=l(p),_=o(p,2),b=l(_),x=o(_,2);{var S=q=>{var F=Zc(),te=l(F);Y(()=>T(te,`By ${t().author??""}`)),g(q,F)};L(x,q=>{t()?.author&&q(S)})}var w=o(x,2);{var k=q=>{var F=Vc(),te=l(F);Y(()=>T(te,`Done: ${t().done_date??""}`)),g(q,F)};L(w,q=>{t()?.done_date&&q(k)})}var R=o(d,2);{var N=q=>{var F=Kc();Ne(F,21,()=>t().tags,Ue,(te,oe)=>{var ee=Qc(),ve=l(ee);Y(()=>T(ve,`#${s(oe).name??""}`)),g(te,ee)}),g(q,F)};L(R,q=>{t()?.tags?.length>0&&q(N)})}var A=o(R,2),$=l(A);Ql($,()=>s(r));var O=o(A,2);{var J=q=>{var F=av(),te=o(l(F),2);Ne(te,21,()=>t().attachments,Ue,(oe,ee)=>{var ve=tv(),re=l(ve);{var _e=je=>{var D=ev();Y(()=>{Ke(D,"src",s(ee).file_path),Ke(D,"alt",s(ee).filename)}),g(je,D)};L(re,je=>{s(ee).media_type&&s(ee).media_type.startsWith("image/")&&je(_e)})}var me=o(re,2),ke=l(me);Y(()=>{Ke(me,"href",s(ee).file_path),T(ke,s(ee).filename)}),g(oe,ve)}),g(q,F)};L(O,q=>{t()?.attachments?.length>0&&q(J)})}var X=o(O,2);{var G=q=>{var F=iv(),te=o(l(F),2);Ne(te,21,()=>t().journal_entries,Ue,(oe,ee)=>{var ve=rv(),re=l(ve),_e=l(re),me=l(_e),ke=o(_e,2),je=l(ke),D=o(ke,2),P=l(D),B=o(D,2),ie=l(B),se=o(re,2),de=l(se),ze=o(se,2);{var Se=we=>{var pe=nv(),Ae=o(l(pe),2);Ne(Ae,17,()=>s(ee).attachments,Ue,(ge,Te)=>{var M=sv(),Z=l(M);Y(()=>{Ke(M,"href",s(Te).file_path),T(Z,`ð ${s(Te).filename??""}`)}),g(ge,M)}),g(we,pe)};L(ze,we=>{s(ee).attachments?.length>0&&we(Se)})}Y(()=>{Fe(_e,1,`note-badge ${s(ee).type??""}`,"svelte-187zyvb"),T(me,s(ee).type),T(je,s(ee).author||"Unknown"),T(P,s(ee).created_at),Fe(B,1,`note-status ${s(ee).status??""}`,"svelte-187zyvb"),T(ie,s(ee).status),T(de,s(ee).text)}),g(oe,ve)}),g(q,F)};L(X,q=>{t()?.journal_entries?.length>0&&q(G)})}var ae=o(X,2),le=l(ae);Ni(le,{get document(){return t()},refresh:()=>window.location.reload()}),Y(q=>{T(c,t()?.name),Fe(v,1,`badge ${t()?.type??""}`,"svelte-187zyvb"),T(f,t()?.type),Fe(p,1,`badge status-${t()?.status??""}`,"svelte-187zyvb"),T(h,q),T(b,t()?.registration_date)},[()=>t()?.status.replace("_"," ")]),g(a,n),ot()}var cv=m('<p class="upload-status svelte-1yijx0t">Uploading...</p>'),vv=m('<div class="attachment-item svelte-1yijx0t"><span class="attachment-name svelte-1yijx0t"> </span> <button type="button" class="remove-btn svelte-1yijx0t">Ã</button></div>'),uv=m('<div class="attachments-list svelte-1yijx0t"></div>'),dv=m('<div class="modal-overlay svelte-1yijx0t"><div class="modal-content svelte-1yijx0t"><div class="modal-header svelte-1yijx0t"><h3 class="svelte-1yijx0t"> </h3> <button class="close-btn svelte-1yijx0t">&times;</button></div> <form class="modal-body svelte-1yijx0t"><div class="form-group svelte-1yijx0t"><label for="author" class="svelte-1yijx0t">Author</label> <input id="author" type="text" placeholder="Your Name" class="svelte-1yijx0t"/></div> <div class="form-group svelte-1yijx0t"><label for="type" class="svelte-1yijx0t">Type</label> <select id="type" class="svelte-1yijx0t"><option>Info</option><option>Warning</option><option>Error</option></select></div> <div class="form-group svelte-1yijx0t"><label for="text" class="svelte-1yijx0t">Message</label> <textarea id="text" required rows="4" class="svelte-1yijx0t"></textarea></div> <div class="form-group svelte-1yijx0t"><label for="attachments" class="svelte-1yijx0t">Attachments</label> <div class="file-upload-wrapper svelte-1yijx0t"><input id="attachments" type="file" multiple class="svelte-1yijx0t"/> <!></div> <!></div> <div class="actions svelte-1yijx0t"><button type="button" class="btn-secondary svelte-1yijx0t">Cancel</button> <button type="submit" class="btn-primary svelte-1yijx0t"> </button></div></form></div></div>');function Ri(a,e){lt(e,!0);let t=kt(e,"entry",3,null),r=y(""),n=y("info"),i=y(""),c=y(!1),d=y(Ce([])),v=y(!1);Ut(()=>{e.isOpen&&(t()?(u(r,t().text||"",!0),u(n,t().type||"info",!0),u(i,t().author||"",!0),u(d,t().attachments||[],!0)):(u(i,localStorage.getItem("journal_author")||"",!0),u(r,""),u(n,"info"),u(d,[],!0)))});async function f(S){const w=Array.from(S.target.files);if(w.length!==0){u(v,!0);try{for(const k of w){const R=await aa.uploadFile(k);s(d).push({file_path:R.file_path,filename:R.filename,media_type:R.media_type})}}catch(k){console.error("Upload failed",k),alert("Failed to upload attachment")}finally{u(v,!1),S.target.value=""}}}function p(S){s(d).splice(S,1)}async function h(S){S.preventDefault(),u(c,!0),s(i)&&localStorage.setItem("journal_author",s(i));try{const w={text:s(r),type:s(n),status:t()?.status||"pending",author:s(i),document_id:e.documentId,attachments:s(d)};t()?await Wa.updateEntry(t().id,w):await Wa.createEntry(w),window.dispatchEvent(new CustomEvent("journal-entries-updated")),e.close()}catch(w){console.error(w),alert(t()?"Failed to update note":"Failed to create note")}finally{u(c,!1)}}var _=it(),b=qe(_);{var x=S=>{var w=dv();w.__click=function(...se){e.close?.apply(this,se)};var k=l(w);k.__click=se=>se.stopPropagation();var R=l(k),N=l(R),A=l(N),$=o(N,2);$.__click=function(...se){e.close?.apply(this,se)};var O=o(R,2),J=l(O),X=o(l(J),2),G=o(J,2),ae=o(l(G),2),le=l(ae);le.value=le.__value="info";var q=o(le);q.value=q.__value="warning";var F=o(q);F.value=F.__value="error";var te=o(G,2),oe=o(l(te),2),ee=o(te,2),ve=o(l(ee),2),re=l(ve);re.__change=f;var _e=o(re,2);{var me=se=>{var de=cv();g(se,de)};L(_e,se=>{s(v)&&se(me)})}var ke=o(ve,2);{var je=se=>{var de=uv();Ne(de,21,()=>s(d),Ue,(ze,Se,we)=>{var pe=vv(),Ae=l(pe),ge=l(Ae),Te=o(Ae,2);Te.__click=()=>p(we),Y(()=>T(ge,s(Se).filename)),g(ze,pe)}),g(se,de)};L(ke,se=>{s(d).length>0&&se(je)})}var D=o(ee,2),P=l(D);P.__click=function(...se){e.close?.apply(this,se)};var B=o(P,2),ie=l(B);Y(()=>{T(A,t()?"Edit Note":`Add Note to ${e.documentName}`),re.disabled=s(v),B.disabled=s(c),T(ie,s(c)?"Saving...":t()?"Update Note":"Add Note")}),ba("submit",O,h),Pe(X,()=>s(i),se=>u(i,se)),qt(ae,()=>s(n),se=>u(n,se)),Pe(oe,()=>s(r),se=>u(r,se)),g(S,w)};L(b,S=>{e.isOpen&&S(x)})}g(a,_),ot()}bt(["click","change"]);var fv=m('<img class="svelte-jm2ier"/>'),pv=m('<div class="file-placeholder svelte-jm2ier"><span> </span> <a target="_blank" rel="noreferrer">Download</a></div>'),hv=m('<div class="image-wrapper svelte-jm2ier"><!></div>'),_v=m('<div class="modal-overlay svelte-jm2ier"><div class="modal-content svelte-jm2ier"><button class="close-btn svelte-jm2ier">&times;</button> <div class="gallery svelte-jm2ier"></div></div></div>');function Ci(a,e){var t=it(),r=qe(t);{var n=i=>{var c=_v();c.__click=function(...p){e.close?.apply(this,p)};var d=l(c);d.__click=p=>p.stopPropagation();var v=l(d);v.__click=function(...p){e.close?.apply(this,p)};var f=o(v,2);Ne(f,21,()=>e.attachments,Ue,(p,h)=>{var _=hv(),b=l(_);{var x=w=>{var k=fv();Y(()=>{Ke(k,"src",s(h).file_path),Ke(k,"alt",s(h).filename)}),g(w,k)},S=w=>{var k=pv(),R=l(k),N=l(R),A=o(R,2);Y(()=>{T(N,`ð ${s(h).filename??""}`),Ke(A,"href",s(h).file_path)}),g(w,k)};L(b,w=>{s(h).media_type&&s(h).media_type.startsWith("image/")?w(x):w(S,!1)})}g(p,_)}),g(i,c)};L(r,i=>{e.isOpen&&i(n)})}g(a,t)}bt(["click"]);var gv=m("<option> </option>"),bv=m("<option> </option>"),mv=m('<div class="modal-overlay svelte-12q38jy"><div class="modal-content svelte-12q38jy"><div class="modal-header svelte-12q38jy"><h3 class="svelte-12q38jy">ð Filter Documents</h3> <button class="close-btn svelte-12q38jy">&times;</button></div> <div class="modal-body svelte-12q38jy"><div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Document Type</h4> <select class="filter-input svelte-12q38jy"><option>All Types</option><option>Plan</option><option>Mail</option><option>Other</option></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Status</h4> <select class="filter-input svelte-12q38jy"><option>All Statuses</option><option>In Progress</option><option>Done</option></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Tag</h4> <input type="text" placeholder="Filter by tag..." class="filter-input svelte-12q38jy"/></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Part Number / Name</h4> <input type="text" placeholder="Search for parts..." class="filter-input svelte-12q38jy"/></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Assignee</h4> <select class="filter-input svelte-12q38jy"><option>All Assignees</option><!></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Material</h4> <select class="filter-input svelte-12q38jy"><option>All Materials</option><!></select></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Task Types (Show documents with these task types)</h4> <div class="checkbox-group svelte-12q38jy"><label class="checkbox-label svelte-12q38jy"><input type="checkbox" class="svelte-12q38jy"/> <span class="checkbox-text svelte-12q38jy">Planned</span></label> <label class="checkbox-label svelte-12q38jy"><input type="checkbox" class="svelte-12q38jy"/> <span class="checkbox-text svelte-12q38jy">Pending</span></label> <label class="checkbox-label svelte-12q38jy"><input type="checkbox" class="svelte-12q38jy"/> <span class="checkbox-text svelte-12q38jy">Done</span></label></div></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Date Range</h4> <select class="filter-input svelte-12q38jy"><option>Registration Date</option><option>Done Date</option></select> <div class="date-range svelte-12q38jy"><input type="date" class="filter-input svelte-12q38jy" placeholder="Start Date"/> <span class="date-separator svelte-12q38jy">to</span> <input type="date" class="filter-input svelte-12q38jy" placeholder="End Date"/></div></div> <div class="filter-section svelte-12q38jy"><h4 class="svelte-12q38jy">Sort By</h4> <div class="sort-controls svelte-12q38jy"><select class="filter-input svelte-12q38jy"><option>Date</option><option>Name</option><option>Author</option><option>Status</option><option>Done Date</option></select> <button class="sort-order-btn svelte-12q38jy" title="Toggle sort order"> </button></div></div></div> <div class="modal-footer svelte-12q38jy"><button class="btn-secondary svelte-12q38jy">Reset All</button> <button class="btn-primary svelte-12q38jy">Apply Filters</button></div></div></div>');function yv(a,e){lt(e,!0);let t=y(Ce({filterType:"",filterStatus:"",filterTag:"",filterAssignee:"",partSearch:"",filterMaterial:"",filterTaskTypes:[],startDate:"",endDate:"",dateField:"registration_date",sortBy:"registration_date",sortOrder:"desc"})),r=y(Ce([])),n=y(Ce([])),i=!1;Ut(()=>{e.isOpen&&!i&&(e.filters&&(u(t,{...e.filters},!0),Array.isArray(s(t).filterTaskTypes)||(s(t).filterTaskTypes=[])),c(),d()),i=e.isOpen});async function c(){try{u(r,await Dt.fetchMaterials(),!0)}catch(x){console.error("Failed to load materials",x)}}async function d(){try{u(n,await Xe.fetchAssignees(),!0)}catch(x){console.error("Failed to load assignees",x)}}function v(){e.onApply(s(t)),e.close()}function f(){u(t,{filterType:"",filterStatus:"",filterTag:"",filterAssignee:"",partSearch:"",filterMaterial:"",filterTaskTypes:[],startDate:"",endDate:"",dateField:"registration_date",sortBy:"registration_date",sortOrder:"desc"},!0)}function p(x){s(t).filterTaskTypes.includes(x)?s(t).filterTaskTypes=s(t).filterTaskTypes.filter(S=>S!==x):s(t).filterTaskTypes=[...s(t).filterTaskTypes,x]}var h=it(),_=qe(h);{var b=x=>{var S=mv();S.__click=function(...Q){e.close?.apply(this,Q)};var w=l(S);w.__click=Q=>Q.stopPropagation();var k=l(w),R=o(l(k),2);R.__click=function(...Q){e.close?.apply(this,Q)};var N=o(k,2),A=l(N),$=o(l(A),2),O=l($);O.value=O.__value="";var J=o(O);J.value=J.__value="plan";var X=o(J);X.value=X.__value="mail";var G=o(X);G.value=G.__value="other";var ae=o(A,2),le=o(l(ae),2),q=l(le);q.value=q.__value="";var F=o(q);F.value=F.__value="in_progress";var te=o(F);te.value=te.__value="done";var oe=o(ae,2),ee=o(l(oe),2),ve=o(oe,2),re=o(l(ve),2),_e=o(ve,2),me=o(l(_e),2),ke=l(me);ke.value=ke.__value="";var je=o(ke);Ne(je,17,()=>s(n),Ue,(Q,Ie)=>{var U=gv(),be=l(U),Oe={};Y(()=>{T(be,s(Ie).name),Oe!==(Oe=s(Ie).name)&&(U.value=(U.__value=s(Ie).name)??"")}),g(Q,U)});var D=o(_e,2),P=o(l(D),2),B=l(P);B.value=B.__value="";var ie=o(B);Ne(ie,17,()=>s(r),Ue,(Q,Ie)=>{var U=bv(),be=l(U),Oe={};Y(()=>{T(be,s(Ie).name),Oe!==(Oe=s(Ie).id)&&(U.value=(U.__value=s(Ie).id)??"")}),g(Q,U)});var se=o(D,2),de=o(l(se),2),ze=l(de),Se=l(ze);Se.__change=()=>p("planned");var we=o(ze,2),pe=l(we);pe.__change=()=>p("pending");var Ae=o(we,2),ge=l(Ae);ge.__change=()=>p("done");var Te=o(se,2),M=o(l(Te),2),Z=l(M);Z.value=Z.__value="registration_date";var W=o(Z);W.value=W.__value="done_date";var z=o(M,2),C=l(z),V=o(C,4),H=o(Te,2),fe=o(l(H),2),ce=l(fe),j=l(ce);j.value=j.__value="registration_date";var E=o(j);E.value=E.__value="name";var ne=o(E);ne.value=ne.__value="author";var he=o(ne);he.value=he.__value="status";var De=o(he);De.value=De.__value="done_date";var Me=o(ce,2);Me.__click=()=>s(t).sortOrder=s(t).sortOrder==="desc"?"asc":"desc";var Ge=l(Me),Le=o(N,2),Ve=l(Le);Ve.__click=f;var ue=o(Ve,2);ue.__click=v,Y((Q,Ie,U)=>{vn(Se,Q),vn(pe,Ie),vn(ge,U),T(Ge,s(t).sortOrder==="desc"?"â Desc":"â Asc")},[()=>s(t).filterTaskTypes.includes("planned"),()=>s(t).filterTaskTypes.includes("pending"),()=>s(t).filterTaskTypes.includes("done")]),qt($,()=>s(t).filterType,Q=>s(t).filterType=Q),qt(le,()=>s(t).filterStatus,Q=>s(t).filterStatus=Q),Pe(ee,()=>s(t).filterTag,Q=>s(t).filterTag=Q),Pe(re,()=>s(t).partSearch,Q=>s(t).partSearch=Q),qt(me,()=>s(t).filterAssignee,Q=>s(t).filterAssignee=Q),qt(P,()=>s(t).filterMaterial,Q=>s(t).filterMaterial=Q),qt(M,()=>s(t).dateField,Q=>s(t).dateField=Q),Pe(C,()=>s(t).startDate,Q=>s(t).startDate=Q),Pe(V,()=>s(t).endDate,Q=>s(t).endDate=Q),qt(ce,()=>s(t).sortBy,Q=>s(t).sortBy=Q),g(x,S)};L(_,x=>{e.isOpen&&x(b)})}g(a,h),ot()}bt(["click","change"]);var wv=m('<span class="tag-chip svelte-1qsxu3n"> <button type="button" class="svelte-1qsxu3n">&times;</button></span>'),kv=m('<li class="svelte-1qsxu3n"> </li>'),xv=m('<ul class="suggestions svelte-1qsxu3n"></ul>'),Sv=m('<div class="tag-input-container svelte-1qsxu3n"><!> <div class="input-wrapper svelte-1qsxu3n"><input type="text" class="svelte-1qsxu3n"/> <!></div></div>');function Tv(a,e){lt(e,!0);let t=kt(e,"selectedTags",31,()=>Ce([])),r=kt(e,"placeholder",3,"Add tag..."),n=y(""),i=y(Ce([])),c=y(Ce([])),d=y(!1),v;Ht(async()=>{try{u(i,await aa.fetchTags(),!0)}catch(N){console.error("Failed to fetch tags",N)}});function f(N){if(u(n,N.target.value,!0),s(n).includes(",")){const A=s(n).split(",");for(let $ of A)$=$.trim(),$&&(t().includes($)||t([...t(),$]));u(n,""),u(d,!1);return}s(n)?(u(c,s(i).filter(A=>A.name.toLowerCase().includes(s(n).toLowerCase())&&!t().includes(A.name)),!0),u(d,!0)):u(d,!1)}function p(N){N&&!t().includes(N)&&t([...t(),N]),u(n,""),u(d,!1),v.focus()}function h(N){t(t().filter(A=>A!==N))}function _(N){N.key==="Enter"?(N.preventDefault(),s(n).trim()&&p(s(n).trim())):N.key==="Backspace"&&!s(n)&&t().length>0&&h(t()[t().length-1])}var b=Sv(),x=l(b);Ne(x,17,t,Ue,(N,A)=>{var $=wv(),O=l($),J=o(O);J.__click=()=>h(s(A)),Y(()=>T(O,`${s(A)??""} `)),g(N,$)});var S=o(x,2),w=l(S);w.__input=f,w.__keydown=_,Hs(w,N=>v=N,()=>v);var k=o(w,2);{var R=N=>{var A=xv();Ne(A,21,()=>s(c),Ue,($,O)=>{var J=kv();J.__click=()=>p(s(O).name);var X=l(J);Y(()=>T(X,s(O).name)),g($,J)}),g(N,A)};L(k,N=>{s(d)&&s(c).length>0&&N(R)})}Y(()=>Ke(w,"placeholder",r())),ba("blur",w,()=>setTimeout(()=>u(d,!1),200)),ba("focus",w,()=>s(n)&&u(d,!0)),Pe(w,()=>s(n),N=>u(n,N)),g(a,b),ot()}bt(["click","input","keydown"]);var Ev=m('<span class="filter-badge svelte-s90sg6">â</span>'),qv=m('<div class="card-desc svelte-s90sg6"> </div>'),jv=m('<span class="tag-badge svelte-s90sg6"> </span>'),Av=m('<button class="icon-badge attachment-badge svelte-s90sg6" title="View Attachments"> </button>'),Pv=m('<span class="icon-badge task-planned svelte-s90sg6" title="Planned Tasks"> </span>'),Nv=m('<span class="icon-badge task-pending svelte-s90sg6" title="Pending Tasks"> </span>'),Rv=m('<span class="icon-badge task-done svelte-s90sg6" title="Completed Tasks"> </span>'),Cv=m("<!> <!> <!>",1),Mv=m('<span class="icon-badge journal-info svelte-s90sg6" title="Info Notes"> </span>'),zv=m('<span class="icon-badge journal-warning svelte-s90sg6" title="Warnings"> </span>'),Dv=m('<span class="icon-badge journal-error svelte-s90sg6" title="Errors"> </span>'),$v=m("<!> <!> <!>",1),Ov=m('<div class="badges-tags-row svelte-s90sg6"><!> <!> <!> <!></div>'),Iv=m('<div class="meta-item svelte-s90sg6"><span class="label svelte-s90sg6">Done:</span> <span class="value"> </span></div>'),Fv=m('<button class="note-attachment-btn svelte-s90sg6"> </button>'),Lv=m('<div><div class="note-header svelte-s90sg6"><span> </span> <span class="note-author svelte-s90sg6"> </span> <span class="note-date svelte-s90sg6"> </span> <!> <button class="note-edit-btn svelte-s90sg6" title="Edit note">âï¸</button> <button> </button></div> <p class="note-text svelte-s90sg6"> </p></div>'),Uv=m('<div class="embedded-notes svelte-s90sg6"><h4 class="svelte-s90sg6">Notes</h4> <div class="notes-list svelte-s90sg6"></div></div>'),Bv=m('<button class="action-btn primary-btn svelte-s90sg6" title="Register Document"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg> Register</button>'),Gv=m('<button class="action-btn primary-btn svelte-s90sg6" title="View Content"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg> View</button>'),Jv=m('<button class="dropdown-item svelte-s90sg6">ð¦ Download Zip</button> <button class="dropdown-item svelte-s90sg6">âï¸ Edit in GNC Editor</button>',1),Yv=m('<div class="dropdown-menu svelte-s90sg6"><button class="dropdown-item svelte-s90sg6">ð Add Note</button> <button class="dropdown-item svelte-s90sg6"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg> Edit</button> <!> <button class="dropdown-item delete-item svelte-s90sg6"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg> Delete</button></div>'),Xv=m('<div class="card svelte-s90sg6"><div class="card-header svelte-s90sg6"><div class="title-group svelte-s90sg6"><h3 class="svelte-s90sg6"> </h3> <span class="badge badge-type svelte-s90sg6"> </span></div> <select><option>Unregistered</option><option>In Progress</option><option>Done</option></select></div> <!> <!> <div class="card-meta svelte-s90sg6"><div class="meta-item svelte-s90sg6"><span class="label svelte-s90sg6">Author:</span> <span class="value"> </span></div> <div class="meta-item svelte-s90sg6"><span class="label svelte-s90sg6">Date:</span> <span class="value"> </span></div> <!></div> <!> <!> <div class="card-actions svelte-s90sg6"><!> <div class="dropdown-container svelte-s90sg6"><button class="action-btn dropdown-btn svelte-s90sg6" title="More actions"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle></svg></button> <!></div></div></div>'),Hv=m('<div class="empty-state svelte-s90sg6"><p>No documents found.</p></div>'),Wv=m('<div class="list-container svelte-s90sg6"><div class="filters-bar svelte-s90sg6"><div class="main-filters svelte-s90sg6"><div class="search-box svelte-s90sg6"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon svelte-s90sg6"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> <input type="text" placeholder="Search documents..." class="svelte-s90sg6"/></div> <button class="filter-btn svelte-s90sg6" title="Filter &amp; Sort"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon></svg> Filters <!></button></div></div> <div class="cards-wrapper svelte-s90sg6"><!> <!></div> <!> <!> <!> <!></div>');function Zv(a,e){lt(e,!0);let t=y(Ce([])),r=y(""),n=y(""),i=y(""),c=y(""),d=y(""),v=y(""),f=y(""),p=y(Ce([])),h=y(""),_=y(""),b=y("registration_date"),x=y(Ce([])),S=y(null),w=y(null),k=y(null),R=y(null),N=y(!1),A=y("registration_date"),$=y("desc"),O=y(null);async function J(){try{let j=await aa.fetchDocuments({search:s(r),type:s(i),status:s(c),sort_by:s(A),sort_order:s($),tag:s(d),start_date:s(h),end_date:s(_),date_field:s(b),assignee:s(v),part_search:s(n)});s(p)&&s(p).length>0&&(j=j.filter(E=>!E.tasks||E.tasks.length===0?!1:E.tasks.some(ne=>s(p).includes(ne.status)))),s(f)&&(j=j.filter(E=>!E.tasks||E.tasks.length===0?!1:E.tasks.some(ne=>ne.material_id&&ne.material_id.toString()===s(f).toString()))),u(t,j,!0)}catch(j){console.error("Failed to load documents",j),Re.addNotification("Failed to load documents","error")}}async function X(){try{const j=await fetch("/api/filter-presets");u(x,await j.json(),!0)}catch(j){console.error(j)}}Ht(()=>{const j=new URLSearchParams(window.location.search);j.has("part_search")&&u(n,j.get("part_search"),!0),J(),X()});async function G(j,E){try{await aa.updateStatus(j.id,E),J(),Re.addNotification(`Status updated to ${E}`,"info")}catch{Re.addNotification("Failed to update status","error")}}async function ae(j){if(confirm("Are you sure you want to delete this document?"))try{await aa.deleteDocument(j),J(),Re.addNotification("Document deleted","info")}catch{Re.addNotification("Failed to delete document","error")}}function le(){J()}function q(j){u(S,j,!0)}function F(){u(S,null)}function te(j){u(w,j,!0),u(k,null)}function oe(j,E){u(w,j,!0),u(k,E,!0)}function ee(){u(w,null),u(k,null),J()}async function ve(j,E){const ne=E==="pending"?"done":"pending";try{await Wa.updateEntry(j,{status:ne}),J(),window.dispatchEvent(new CustomEvent("journal-entries-updated"))}catch(he){console.error("Failed to update note status",he),Re.addNotification("Failed to update note status","error")}}function re(j){u(R,j,!0)}function _e(){u(R,null)}function me(j){if(!j)return null;const E={planned:0,pending:0,done:0};return j.forEach(ne=>{E[ne.status]!==void 0&&E[ne.status]++}),E}function ke(j){if(!j)return null;const E={info:0,warning:0,error:0};return j.forEach(ne=>{E[ne.type]!==void 0&&E[ne.type]++}),E}function je(){u(N,!0)}function D(){u(N,!1)}function P(j){u(i,j.filterType,!0),u(c,j.filterStatus,!0),u(d,j.filterTag,!0),u(v,j.filterAssignee,!0),u(n,j.partSearch||"",!0),u(f,j.filterMaterial||"",!0),u(p,j.filterTaskTypes||[],!0),u(h,j.startDate,!0),u(_,j.endDate,!0),u(b,j.dateField,!0),u(A,j.sortBy,!0),u($,j.sortOrder,!0),J()}function B(j){u(O,s(O)===j?null:j,!0)}function ie(){u(O,null)}async function se(j){try{await aa.downloadDocumentZip(j.id)}catch(E){console.error(E),alert("Failed to download zip. Ensure the source folder exists on the server.")}}var de={refresh:J},ze=Wv(),Se=l(ze),we=l(Se),pe=l(we),Ae=o(l(pe),2);Ae.__input=le;var ge=o(pe,2);ge.__click=je;var Te=o(l(ge),2);{var M=j=>{var E=Ev();g(j,E)};L(Te,j=>{(s(i)||s(c)||s(d)||s(v)||s(h)||s(_)||s(p)&&s(p).length>0)&&j(M)})}var Z=o(Se,2),W=l(Z);Ne(W,17,()=>s(t),j=>j.id,(j,E)=>{const ne=Ze(()=>me(s(E).tasks)),he=Ze(()=>ke(s(E).journal_entries));var De=Xv(),Me=l(De),Ge=l(Me),Le=l(Ge),Ve=l(Le),ue=o(Le,2),Q=l(ue),Ie=o(Ge,2);Ie.__change=Ee=>G(s(E),Ee.currentTarget.value);var U=l(Ie);U.value=U.__value="unregistered";var be=o(U);be.value=be.__value="in_progress";var Oe=o(be);Oe.value=Oe.__value="done";var st;Ps(Ie);var ct=o(Me,2);{var _t=Ee=>{var We=qv(),nt=l(We);Y(()=>T(nt,s(E).description)),g(Ee,We)};L(ct,Ee=>{s(E).description&&Ee(_t)})}var mt=o(ct,2);{var Bt=Ee=>{var We=Ov(),nt=l(We);{var Et=$e=>{var Ye=it(),pt=qe(Ye);Ne(pt,17,()=>s(E).tags,Ue,(ht,St)=>{var zt=jv(),Yt=l(zt);Y(()=>T(Yt,`#${s(St).name??""}`)),g(ht,zt)}),g($e,Ye)};L(nt,$e=>{s(E).tags&&s(E).tags.length>0&&$e(Et)})}var Je=o(nt,2);{var yt=$e=>{var Ye=Av();Ye.__click=()=>re(s(E).attachments);var pt=l(Ye);Y(()=>T(pt,`ð· ${s(E).attachments.length??""}`)),g($e,Ye)};L(Je,$e=>{s(E).attachments&&s(E).attachments.length>0&&$e(yt)})}var vt=o(Je,2);{var Nt=$e=>{var Ye=Cv(),pt=qe(Ye);{var ht=rt=>{var ft=Pv(),It=l(ft);Y(()=>T(It,`ð ${s(ne).planned??""}`)),g(rt,ft)};L(pt,rt=>{s(ne).planned>0&&rt(ht)})}var St=o(pt,2);{var zt=rt=>{var ft=Nv(),It=l(ft);Y(()=>T(It,`â³ ${s(ne).pending??""}`)),g(rt,ft)};L(St,rt=>{s(ne).pending>0&&rt(zt)})}var Yt=o(St,2);{var fa=rt=>{var ft=Rv(),It=l(ft);Y(()=>T(It,`â ${s(ne).done??""}`)),g(rt,ft)};L(Yt,rt=>{s(ne).done>0&&rt(fa)})}g($e,Ye)};L(vt,$e=>{s(ne)&&$e(Nt)})}var Ot=o(vt,2);{var Jt=$e=>{var Ye=$v(),pt=qe(Ye);{var ht=rt=>{var ft=Mv(),It=l(ft);Y(()=>T(It,`â¹ï¸ ${s(he).info??""}`)),g(rt,ft)};L(pt,rt=>{s(he).info>0&&rt(ht)})}var St=o(pt,2);{var zt=rt=>{var ft=zv(),It=l(ft);Y(()=>T(It,`â ï¸ ${s(he).warning??""}`)),g(rt,ft)};L(St,rt=>{s(he).warning>0&&rt(zt)})}var Yt=o(St,2);{var fa=rt=>{var ft=Dv(),It=l(ft);Y(()=>T(It,`â ${s(he).error??""}`)),g(rt,ft)};L(Yt,rt=>{s(he).error>0&&rt(fa)})}g($e,Ye)};L(Ot,$e=>{s(he)&&$e(Jt)})}g(Ee,We)};L(mt,Ee=>{(s(E).tags&&s(E).tags.length>0||s(E).attachments&&s(E).attachments.length>0||s(ne)||s(he))&&Ee(Bt)})}var Rt=o(mt,2),I=l(Rt),K=o(l(I),2),ye=l(K),Be=o(I,2),Ct=o(l(Be),2),Qe=l(Ct),xe=o(Be,2);{var dt=Ee=>{var We=Iv(),nt=o(l(We),2),Et=l(nt);Y(()=>T(Et,s(E).done_date)),g(Ee,We)};L(xe,Ee=>{s(E).done_date&&Ee(dt)})}var jt=o(Rt,2);Ni(jt,{get document(){return s(E)},refresh:J,get filterAssignee(){return s(v)},get partSearch(){return s(n)}});var At=o(jt,2);{var Pt=Ee=>{var We=Uv(),nt=o(l(We),2);Ne(nt,21,()=>s(E).journal_entries,Ue,(Et,Je)=>{var yt=Lv(),vt=l(yt),Nt=l(vt),Ot=l(Nt),Jt=o(Nt,2),$e=l(Jt),Ye=o(Jt,2),pt=l(Ye),ht=o(Ye,2);{var St=It=>{var Ya=Fv();Ya.__click=()=>re(s(Je).attachments);var rn=l(Ya);Y(()=>{Ke(Ya,"title",`View attachments (${s(Je).attachments.length??""})`),T(rn,`ð ${s(Je).attachments.length??""}`)}),g(It,Ya)};L(ht,It=>{s(Je).attachments&&s(Je).attachments.length>0&&It(St)})}var zt=o(ht,2);zt.__click=()=>oe(s(E),s(Je));var Yt=o(zt,2);Yt.__click=()=>ve(s(Je).id,s(Je).status);var fa=l(Yt),rt=o(vt,2),ft=l(rt);Y(()=>{Fe(yt,1,`note-item ${s(Je).type??""}`,"svelte-s90sg6"),Fe(Nt,1,`note-badge ${s(Je).type??""}`,"svelte-s90sg6"),T(Ot,s(Je).type),T($e,s(Je).author||"Unknown"),T(pt,s(Je).created_at),Fe(Yt,1,`note-status-btn ${s(Je).status??""}`,"svelte-s90sg6"),Ke(Yt,"title",s(Je).status==="pending"?"Click to mark as done":"Click to mark as pending"),T(fa,s(Je).status),T(ft,s(Je).text)}),g(Et,yt)}),g(Ee,We)};L(At,Ee=>{s(E).journal_entries&&s(E).journal_entries.length>0&&Ee(Pt)})}var gt=o(At,2),la=l(gt);{var oa=Ee=>{var We=Bv();We.__click=()=>e.onEdit(s(E)),g(Ee,We)},da=Ee=>{var We=Gv();We.__click=()=>q(s(E)),g(Ee,We)};L(la,Ee=>{s(E).status==="unregistered"?Ee(oa):Ee(da,!1)})}var Wt=o(la,2),Gt=l(Wt);Gt.__click=()=>B(s(E).id);var Mt=o(Gt,2);{var xt=Ee=>{var We=Yv(),nt=l(We);nt.__click=()=>{te(s(E)),ie()};var Et=o(nt,2);Et.__click=()=>{e.onEdit(s(E)),ie()};var Je=o(Et,2);{var yt=Nt=>{var Ot=Jv(),Jt=qe(Ot);Jt.__click=()=>{se(s(E)),ie()};var $e=o(Jt,2);$e.__click=()=>{es(`/gnc?orderId=${s(E).id}`),ie()},g(Nt,Ot)};L(Je,Nt=>{s(E).type==="order"&&Nt(yt)})}var vt=o(Je,2);vt.__click=()=>{ae(s(E).id),ie()},g(Ee,We)};L(Mt,Ee=>{s(O)===s(E).id&&Ee(xt)})}Y(()=>{T(Ve,s(E).name),T(Q,s(E).type),Fe(Ie,1,`status-select ${s(E).status??""}`,"svelte-s90sg6"),U.disabled=s(E).status!=="unregistered",st!==(st=s(E).status)&&(Ie.value=(Ie.__value=s(E).status)??"",fs(Ie,s(E).status)),T(ye,s(E).author||"-"),T(Qe,s(E).registration_date)}),g(j,De)});var z=o(W,2);{var C=j=>{var E=Hv();g(j,E)};L(z,j=>{s(t).length===0&&j(C)})}var V=o(Z,2);{let j=Ze(()=>!!s(S));bi(V,{get isOpen(){return s(j)},close:F,maxWidth:"800px",children:(E,ne)=>{ov(E,{get document(){return s(S)}})},$$slots:{default:!0}})}var H=o(V,2);{let j=Ze(()=>!!s(w)),E=Ze(()=>s(w)?.id),ne=Ze(()=>s(w)?.name);Ri(H,{get isOpen(){return s(j)},close:ee,get documentId(){return s(E)},get documentName(){return s(ne)},get entry(){return s(k)}})}var fe=o(H,2);{let j=Ze(()=>!!s(R)),E=Ze(()=>s(R)||[]);Ci(fe,{get isOpen(){return s(j)},close:_e,get attachments(){return s(E)}})}var ce=o(fe,2);{let j=Ze(()=>({filterType:s(i),filterStatus:s(c),filterTag:s(d),filterAssignee:s(v),filterMaterial:s(f),filterTaskTypes:s(p),startDate:s(h),endDate:s(_),dateField:s(b),sortBy:s(A),sortOrder:s($)}));yv(ce,{get isOpen(){return s(N)},close:D,get filters(){return s(j)},onApply:P})}return Pe(Ae,()=>s(r),j=>u(r,j)),g(a,ze),ot(de)}bt(["input","click","change"]);var Vv=m('<button type="button" class="btn-outline svelte-f0yvr0">ð· View Gallery</button>'),Qv=m('<p class="info-text svelte-f0yvr0">Uploading...</p>'),Kv=m('<p class="error-text svelte-f0yvr0"> </p>'),eu=m('<div class="attachment-item svelte-f0yvr0"><span class="file-name svelte-f0yvr0"> </span> <button type="button" class="remove-btn svelte-f0yvr0">â</button></div>'),tu=m('<div class="attachment-item new svelte-f0yvr0"><span class="file-name svelte-f0yvr0"> </span> <button type="button" class="remove-btn svelte-f0yvr0">â</button></div>'),au=m('<div class="attachments-list svelte-f0yvr0"><!> <!></div>'),su=m('<span class="part-dims svelte-f0yvr0"> </span>'),nu=m('<li class="part-item-li svelte-f0yvr0"><span class="part-name svelte-f0yvr0"> </span> <span class="part-reg svelte-f0yvr0"> </span> <!></li>'),ru=m('<ul class="parts-list svelte-f0yvr0"></ul>'),iu=m('<p class="no-parts svelte-f0yvr0">No linked parts found in GNC.</p>'),lu=m('<details class="task-item svelte-f0yvr0"><summary class="svelte-f0yvr0"><span class="task-icon">âï¸</span> <span class="task-name svelte-f0yvr0"> </span> <span> </span></summary> <div class="task-details svelte-f0yvr0"><div class="task-meta svelte-f0yvr0"><div class="meta-item svelte-f0yvr0"><span class="label svelte-f0yvr0">Assignee:</span> <span> </span></div> <div class="meta-item svelte-f0yvr0"><span class="label svelte-f0yvr0">Material:</span> <span> </span></div> <div class="meta-item svelte-f0yvr0"><span class="label svelte-f0yvr0">GNC Path:</span> <span class="path svelte-f0yvr0"> </span></div></div> <div class="linked-parts-section svelte-f0yvr0"><h5 class="svelte-f0yvr0"> </h5> <!></div></div></details>'),ou=m('<div class="form-section svelte-f0yvr0"><h4 class="svelte-f0yvr0"> </h4> <div class="task-list svelte-f0yvr0"></div></div>'),cu=m('<div class="form-group svelte-f0yvr0"><button type="button" class="btn-gnc svelte-f0yvr0">âï¸ Edit in GNC</button></div>'),vu=m('<div class="form-container svelte-f0yvr0"><h3 class="svelte-f0yvr0"> </h3> <form><div class="form-section upload-section svelte-f0yvr0"><h4 class="svelte-f0yvr0">Files & Scanning</h4> <div class="upload-buttons"><div class="upload-btn-wrapper svelte-f0yvr0"><button type="button" class="btn-outline svelte-f0yvr0">ð Add Attachments</button> <input type="file" multiple title="Add Attachments (No Scan)" class="svelte-f0yvr0"/></div> <!></div> <!> <!> <!></div> <div class="form-group svelte-f0yvr0"><label for="name" class="svelte-f0yvr0">Name</label> <input id="name" type="text" required placeholder="e.g. Project Alpha Specs" class="svelte-f0yvr0"/></div> <div class="form-group svelte-f0yvr0"><label for="description" class="svelte-f0yvr0">Description</label> <textarea id="description" rows="3" placeholder="Brief description of the document..." class="svelte-f0yvr0"></textarea></div> <!> <div class="form-group svelte-f0yvr0"><label for="tags" class="svelte-f0yvr0">Tags</label> <!></div> <div class="form-group svelte-f0yvr0"><label for="content" class="svelte-f0yvr0">Recognized Content (Markdown)</label> <textarea id="content" rows="10" placeholder="Recognized document content will appear here..." class="svelte-f0yvr0"></textarea></div> <div class="row svelte-f0yvr0"><div class="form-group half svelte-f0yvr0"><label for="type" class="svelte-f0yvr0">Type</label> <select id="type" class="svelte-f0yvr0"><option>Plan</option><option>Mail</option><option>Order</option><option>Other</option></select></div> <div class="form-group half svelte-f0yvr0"><label for="status" class="svelte-f0yvr0">Status</label> <select id="status" class="svelte-f0yvr0"><option>In Progress</option><option>Done</option></select></div></div> <!> <div class="row svelte-f0yvr0"><div class="form-group half svelte-f0yvr0"><label for="date" class="svelte-f0yvr0">Registration Date</label> <input id="date" type="date" class="svelte-f0yvr0"/></div> <div class="form-group half svelte-f0yvr0"><label for="done_date" class="svelte-f0yvr0">Done Date</label> <input id="done_date" type="date" class="svelte-f0yvr0"/></div></div> <div class="form-group svelte-f0yvr0"><label for="author" class="svelte-f0yvr0">Author</label> <input id="author" type="text" placeholder="Your Name" class="svelte-f0yvr0"/></div> <div class="actions svelte-f0yvr0"><button type="button" class="btn-secondary svelte-f0yvr0">Cancel</button> <button type="submit" class="btn-primary svelte-f0yvr0"> </button></div></form> <!></div>');function uu(a,e){lt(e,!0);let t=kt(e,"document",3,null),r=y(""),n=y(""),i=y("plan"),c=y("in_progress"),d=y(""),v=y(""),f=y(""),p=y(""),h=y(Ce([])),_=y(Ce([])),b=y(Ce([]));Ut(()=>{if(t())u(r,t().name||"",!0),u(n,t().description||"",!0),u(i,t().type||"plan",!0),u(c,t().status||"in_progress",!0),u(d,t().registration_date||"",!0),u(v,t().content||"",!0),u(f,t().author||"",!0),u(p,t().done_date||"",!0),u(h,t().attachments||[],!0),t().tags?u(b,t().tags.map(U=>typeof U=="string"?U:U.name),!0):u(b,[],!0);else{const U=typeof localStorage<"u"?localStorage.getItem("doc_author"):"";U&&u(f,U,!0)}});let x=y(!1),S=y(!1),w=y(""),k=y(null);Ht(()=>{if(s(c)==="unregistered"&&u(c,"in_progress"),!t()){const U=localStorage.getItem("doc_author");U&&u(f,U,!0)}}),Ut(()=>{s(c)==="done"&&!s(p)&&u(p,new Date().toISOString().split("T")[0],!0)});async function R(U){const be=Array.from(U.target.files);if(be.length!==0){u(x,!0);try{for(const Oe of be){const st=await aa.uploadFile(Oe);s(_).push({file_path:st.file_path,filename:st.filename,media_type:st.media_type})}}catch(Oe){console.error("Upload failed",Oe),alert("Failed to upload attachment")}finally{u(x,!1),U.target.value=""}}}function N(){u(k,[...s(h),...s(_)],!0)}async function A(U,be){if(be)s(_).splice(U,1);else{if(!confirm("Permanently delete this attachment?"))return;const Oe=s(h)[U];try{await aa.deleteAttachment(Oe.id),s(h).splice(U,1)}catch(st){console.error("Failed to delete attachment",st),alert("Failed to delete attachment")}}}async function $(U){U.preventDefault(),u(S,!0),u(w,"");try{s(f)&&localStorage.setItem("doc_author",s(f));const be={name:s(r),description:s(n),type:s(i),status:s(c),registration_date:s(d)||void 0,content:s(v),author:s(f),done_date:s(p)||void 0,attachments:s(_),tags:s(b)};t()?(await aa.updateDocument(t().id,be),Re.addNotification("Document updated","info")):(await aa.createDocument(be),Re.addNotification("Document registered","info")),t()||(u(r,""),u(n,""),u(i,"plan"),u(c,"in_progress"),u(d,""),u(v,""),u(f,localStorage.getItem("doc_author")||"",!0),u(p,""),u(_,[],!0),u(b,[],!0)),e.onDocumentCreated()}catch(be){console.error("Failed to save document:",be),u(w,"Failed to save document. Please try again.")}finally{u(S,!1)}}var O=vu(),J=l(O),X=l(J),G=o(J,2),ae=l(G),le=o(l(ae),2),q=l(le),F=o(l(q),2);F.__change=R;var te=o(q,2);{var oe=U=>{var be=Vv();be.__click=N,g(U,be)};L(te,U=>{(s(h).length>0||s(_).length>0)&&U(oe)})}var ee=o(le,2);{var ve=U=>{var be=Qv();g(U,be)};L(ee,U=>{s(x)&&U(ve)})}var re=o(ee,2);{var _e=U=>{var be=Kv(),Oe=l(be);Y(()=>T(Oe,s(w))),g(U,be)};L(re,U=>{s(w)&&U(_e)})}var me=o(re,2);{var ke=U=>{var be=au(),Oe=l(be);Ne(Oe,17,()=>s(h),Ue,(ct,_t,mt)=>{var Bt=eu(),Rt=l(Bt),I=l(Rt),K=o(Rt,2);K.__click=()=>A(mt,!1),Y(()=>{Ke(Rt,"title",s(_t).filename),T(I,s(_t).filename)}),g(ct,Bt)});var st=o(Oe,2);Ne(st,17,()=>s(_),Ue,(ct,_t,mt)=>{var Bt=tu(),Rt=l(Bt),I=l(Rt),K=o(Rt,2);K.__click=()=>A(mt,!0),Y(()=>{Ke(Rt,"title",s(_t).filename),T(I,`(New) ${s(_t).filename??""}`)}),g(ct,Bt)}),g(U,be)};L(me,U=>{(s(h).length>0||s(_).length>0)&&U(ke)})}var je=o(ae,2),D=o(l(je),2),P=o(je,2),B=o(l(P),2),ie=o(P,2);{var se=U=>{var be=ou(),Oe=l(be),st=l(Oe),ct=o(Oe,2);Ne(ct,21,()=>t().tasks,Ue,(_t,mt)=>{var Bt=lu(),Rt=l(Bt),I=o(l(Rt),2),K=l(I),ye=o(I,2),Be=l(ye),Ct=o(Rt,2),Qe=l(Ct),xe=l(Qe),dt=o(l(xe),2),jt=l(dt),At=o(xe,2),Pt=o(l(At),2),gt=l(Pt),la=o(At,2),oa=o(l(la),2),da=l(oa),Wt=o(Qe,2),Gt=l(Wt),Mt=l(Gt),xt=o(Gt,2);{var Ee=nt=>{var Et=ru();Ne(Et,21,()=>s(mt).parts,Ue,(Je,yt)=>{var vt=nu(),Nt=l(vt),Ot=l(Nt),Jt=o(Nt,2),$e=l(Jt),Ye=o(Jt,2);{var pt=ht=>{var St=su(),zt=l(St);Y((Yt,fa)=>T(zt,`${Yt??""} x ${fa??""}`),[()=>Math.round(s(yt).width),()=>Math.round(s(yt).height)]),g(ht,St)};L(Ye,ht=>{(s(yt).width||s(yt).height)&&ht(pt)})}Y(()=>{T(Ot,s(yt).name),T($e,`[${s(yt).registration_number??""}]`)}),g(Je,vt)}),g(nt,Et)},We=nt=>{var Et=iu();g(nt,Et)};L(xt,nt=>{s(mt).parts?.length>0?nt(Ee):nt(We,!1)})}Y(()=>{T(K,s(mt).name),Fe(ye,1,`task-status-badge ${s(mt).status??""}`,"svelte-f0yvr0"),T(Be,s(mt).status),T(jt,s(mt).assignee||"Unassigned"),T(gt,s(mt).material?.name||"Unknown"),Ke(oa,"title",s(mt).gnc_file_path),T(da,s(mt).gnc_file_path||"N/A"),T(Mt,`Linked Parts (${(s(mt).parts?.length||0)??""})`)}),g(_t,Bt)}),Y(()=>T(st,`Tasks (${t().tasks.length??""})`)),g(U,be)};L(ie,U=>{t()?.tasks?.length>0&&U(se)})}var de=o(ie,2),ze=o(l(de),2);Tv(ze,{get selectedTags(){return s(b)},set selectedTags(U){u(b,U,!0)}});var Se=o(de,2),we=o(l(Se),2),pe=o(Se,2),Ae=l(pe),ge=o(l(Ae),2),Te=l(ge);Te.value=Te.__value="plan";var M=o(Te);M.value=M.__value="mail";var Z=o(M);Z.value=Z.__value="order";var W=o(Z);W.value=W.__value="other";var z=o(Ae,2),C=o(l(z),2),V=l(C);V.value=V.__value="in_progress";var H=o(V);H.value=H.__value="done";var fe=o(pe,2);{var ce=U=>{var be=cu(),Oe=l(be);Oe.__click=()=>window.location.hash=`#/gnc?orderId=${t().id}`,g(U,be)};L(fe,U=>{t()&&s(i)==="order"&&U(ce)})}var j=o(fe,2),E=l(j),ne=o(l(E),2),he=o(E,2),De=o(l(he),2),Me=o(j,2),Ge=o(l(Me),2),Le=o(Me,2),Ve=l(Le);Ve.__click=function(...U){e.onCancel?.apply(this,U)};var ue=o(Ve,2),Q=l(ue),Ie=o(G,2);{let U=Ze(()=>!!s(k)),be=Ze(()=>s(k)||[]);Ci(Ie,{get isOpen(){return s(U)},close:()=>u(k,null),get attachments(){return s(be)}})}Y(()=>{T(X,t()?"Edit Document":"New Document"),De.disabled=s(c)!=="done",ue.disabled=s(S)||s(x),T(Q,s(S)?"Saving...":t()?"Save Changes":"Register Document")}),ba("submit",G,$),Pe(D,()=>s(r),U=>u(r,U)),Pe(B,()=>s(n),U=>u(n,U)),Pe(we,()=>s(v),U=>u(v,U)),qt(ge,()=>s(i),U=>u(i,U)),qt(C,()=>s(c),U=>u(c,U)),Pe(ne,()=>s(d),U=>u(d,U)),Pe(De,()=>s(p),U=>u(p,U)),Pe(Ge,()=>s(f),U=>u(f,U)),g(a,O),ot()}bt(["change","click"]);var du=m('<div class="page-container svelte-14q2aho"><!> <!></div>');function fu(a,e){lt(e,!0);let t=y(!1),r=y(null),n=y(null);function i(){u(r,null),u(t,!0)}function c(b){u(r,b,!0),u(t,!0)}function d(){u(t,!1),u(r,null)}function v(){s(n)&&s(n).refresh&&s(n).refresh()}function f(){d(),v()}Ht(()=>(ss([{label:"Documents",items:[{label:"New Document",action:i},{label:"Refresh",action:v}]}]),()=>{ns()}));var p=du(),h=l(p);Hs(Zv(h,{onEdit:c}),b=>u(n,b,!0),()=>s(n));var _=o(h,2);bi(_,{get isOpen(){return s(t)},close:d,children:(b,x)=>{uu(b,{onDocumentCreated:f,onCancel:d,get document(){return s(r)}})},$$slots:{default:!0}}),g(a,p),ot()}var pu=m('<span class="att-badge svelte-v5qqzx"> </span>'),hu=m('<div class="attachments-preview svelte-v5qqzx"></div>'),_u=m('<div class="entry-form svelte-v5qqzx"><input type="text" placeholder="Author" class="author-input svelte-v5qqzx"/> <select class="svelte-v5qqzx"><option>Info</option><option>Warning</option><option>Error</option></select> <textarea placeholder="Message..." class="svelte-v5qqzx"></textarea> <div class="file-input-group svelte-v5qqzx"><input type="file" multiple class="svelte-v5qqzx"/> <!></div> <button>Save</button></div>'),gu=m("<p>Loading...</p>"),bu=m('<p class="empty">No entries found.</p>'),mu=m('<span class="doc-ref svelte-v5qqzx"> </span>'),yu=m('<a target="_blank" class="svelte-v5qqzx"><img class="svelte-v5qqzx"/></a>'),wu=m('<a target="_blank" class="svelte-v5qqzx"> </a>'),ku=m('<div class="attachment-thumb svelte-v5qqzx"><!></div>'),xu=m('<div class="entry-attachments svelte-v5qqzx"></div>'),Su=m('<div><div class="entry-header svelte-v5qqzx"><span> </span> <span class="author svelte-v5qqzx"> </span> <span class="date"> </span> <!> <div class="actions svelte-v5qqzx"><button class="edit-btn svelte-v5qqzx">âï¸ Edit</button> <button class="status-btn svelte-v5qqzx"> </button> <button class="delete-btn svelte-v5qqzx">ð</button></div></div> <p class="text svelte-v5qqzx"> </p> <!></div>'),Tu=m('<div class="journal-container svelte-v5qqzx"><div class="toolbar svelte-v5qqzx"><div class="filters svelte-v5qqzx"><select class="svelte-v5qqzx"><option>All Types</option><option>Info</option><option>Warning</option><option>Error</option></select> <select class="svelte-v5qqzx"><option>All Statuses</option><option>Pending</option><option>Done</option></select></div></div> <!> <div class="entries-list svelte-v5qqzx"><!></div> <!></div>');function Eu(a,e){lt(e,!0);let t=y(Ce([])),r=y(!1),n=y(null),i=y(""),c=y(""),d=y(!1),v=y(""),f=y("info"),p=y(""),h=y(Ce([]));async function _(){u(r,!0);try{u(t,await Wa.fetchJournal(0,100),!0),s(i)&&u(t,s(t).filter(D=>D.type===s(i)),!0),s(c)&&u(t,s(t).filter(D=>D.status===s(c)),!0)}catch(D){console.error(D),Re.addNotification("Failed to load journal entries","error")}finally{u(r,!1)}}function b(){u(d,!s(d))}Ht(()=>{u(p,localStorage.getItem("journal_author")||"",!0),_();const D=()=>{_()};return window.addEventListener("journal-entries-updated",D),ss([{label:"Journal",items:[{label:"New Entry",action:b},{label:"Refresh",action:_}]}]),()=>{window.removeEventListener("journal-entries-updated",D),ns()}});async function x(D){const P=Array.from(D.target.files);if(P.length!==0){for(const B of P)try{const ie=await aa.uploadFile(B);s(h).push(ie)}catch(ie){console.error("Upload failed",ie),alert("Upload failed for "+B.name)}D.target.value=""}}async function S(){if(!(!s(v)&&s(h).length===0)){s(p)&&localStorage.setItem("journal_author",s(p));try{await Wa.createEntry({text:s(v),type:s(f),status:"pending",author:s(p)}),u(v,""),u(h,[],!0),u(d,!1),_(),Re.addNotification("Journal entry added","info")}catch(D){console.error("Failed to add entry",D),Re.addNotification("Failed to add entry","error")}}}async function w(D){const P=D.status==="pending"?"done":"pending";try{await Wa.updateEntry(D.id,{status:P}),_()}catch(B){console.error(B)}}async function k(D){if(confirm("Are you sure?"))try{await Wa.deleteEntry(D),_(),Re.addNotification("Entry deleted","info")}catch(P){console.error(P),Re.addNotification("Failed to delete entry","error")}}function R(D){u(n,D,!0)}function N(){u(n,null),_()}Ut(()=>{_()});var A=Tu(),$=l(A),O=l($),J=l(O);J.__change=_;var X=l(J);X.value=X.__value="";var G=o(X);G.value=G.__value="info";var ae=o(G);ae.value=ae.__value="warning";var le=o(ae);le.value=le.__value="error";var q=o(J,2);q.__change=_;var F=l(q);F.value=F.__value="";var te=o(F);te.value=te.__value="pending";var oe=o(te);oe.value=oe.__value="done";var ee=o($,2);{var ve=D=>{var P=_u(),B=l(P),ie=o(B,2),se=l(ie);se.value=se.__value="info";var de=o(se);de.value=de.__value="warning";var ze=o(de);ze.value=ze.__value="error";var Se=o(ie,2),we=o(Se,2),pe=l(we);pe.__change=x;var Ae=o(pe,2);{var ge=M=>{var Z=hu();Ne(Z,21,()=>s(h),Ue,(W,z)=>{var C=pu(),V=l(C);Y(()=>T(V,s(z).filename)),g(W,C)}),g(M,Z)};L(Ae,M=>{s(h).length>0&&M(ge)})}var Te=o(we,2);Te.__click=S,Pe(B,()=>s(p),M=>u(p,M)),qt(ie,()=>s(f),M=>u(f,M)),Pe(Se,()=>s(v),M=>u(v,M)),g(D,P)};L(ee,D=>{s(d)&&D(ve)})}var re=o(ee,2),_e=l(re);{var me=D=>{var P=gu();g(D,P)},ke=D=>{var P=it(),B=qe(P);{var ie=de=>{var ze=bu();g(de,ze)},se=de=>{var ze=it(),Se=qe(ze);Ne(Se,17,()=>s(t),Ue,(we,pe)=>{var Ae=Su(),ge=l(Ae),Te=l(ge),M=l(Te),Z=o(Te,2),W=l(Z),z=o(Z,2),C=l(z),V=o(z,2);{var H=Le=>{var Ve=mu(),ue=l(Ve);Y(()=>T(ue,`Ref: Doc #${s(pe).document_id??""}`)),g(Le,Ve)};L(V,Le=>{s(pe).document_id&&Le(H)})}var fe=o(V,2),ce=l(fe);ce.__click=()=>R(s(pe));var j=o(ce,2);j.__click=()=>w(s(pe));var E=l(j),ne=o(j,2);ne.__click=()=>k(s(pe).id);var he=o(ge,2),De=l(he),Me=o(he,2);{var Ge=Le=>{var Ve=xu();Ne(Ve,21,()=>s(pe).attachments,Ue,(ue,Q)=>{var Ie=ku(),U=l(Ie);{var be=st=>{var ct=yu(),_t=l(ct);Y(()=>{Ke(ct,"href",s(Q).file_path),Ke(_t,"src",s(Q).file_path),Ke(_t,"alt",s(Q).filename)}),g(st,ct)},Oe=st=>{var ct=wu(),_t=l(ct);Y(()=>{Ke(ct,"href",s(Q).file_path),T(_t,`ð ${s(Q).filename??""}`)}),g(st,ct)};L(U,st=>{s(Q).media_type&&s(Q).media_type.startsWith("image/")?st(be):st(Oe,!1)})}g(ue,Ie)}),g(Le,Ve)};L(Me,Le=>{s(pe).attachments&&s(pe).attachments.length>0&&Le(Ge)})}Y(()=>{Fe(Ae,1,`entry-card ${s(pe).type??""} ${s(pe).status??""}`,"svelte-v5qqzx"),Fe(Te,1,`badge ${s(pe).type??""}`,"svelte-v5qqzx"),T(M,s(pe).type),T(W,s(pe).author||"Unknown"),T(C,s(pe).created_at),T(E,s(pe).status==="pending"?"â Mark Done":"â© Reopen"),T(De,s(pe).text)}),g(we,Ae)}),g(de,ze)};L(B,de=>{s(t).length===0?de(ie):de(se,!1)},!0)}g(D,P)};L(_e,D=>{s(r)?D(me):D(ke,!1)})}var je=o(re,2);{let D=Ze(()=>!!s(n)),P=Ze(()=>s(n)?.document_id);Ri(je,{get isOpen(){return s(D)},close:N,get documentId(){return s(P)},documentName:"Journal Entry",get entry(){return s(n)}})}qt(J,()=>s(i),D=>u(i,D)),qt(q,()=>s(c),D=>u(c,D)),g(a,A),ot()}bt(["change","click"]);var qu=m('<div class="loading-state svelte-g0byll">Loading tasks...</div>'),ju=m('<div class="empty-state svelte-g0byll">Enter an assignee name above to view their tasks.</div>'),Au=m('<div class="empty-state svelte-g0byll">No pending or planned tasks found for this assignee.</div>'),Pu=m('<div><div class="task-info svelte-g0byll"><span> </span> <button class="btn-done svelte-g0byll" title="Mark as done">â</button> <span class="task-name svelte-g0byll"> </span></div></div>'),Nu=m('<div class="material-group svelte-g0byll"><div class="material-header svelte-g0byll"><span class="material-name svelte-g0byll"> </span> <span class="task-count svelte-g0byll"> </span></div> <div class="tasks-list svelte-g0byll"></div></div>'),Ru=m('<div class="doc-group svelte-g0byll"><div class="doc-header svelte-g0byll"><h3 class="svelte-g0byll"> </h3> <span> </span></div> <!></div>'),Cu=m('<div class="documents-list svelte-g0byll"></div>'),Mu=m('<div class="job-view svelte-g0byll"><div class="assignee-filter svelte-g0byll"><label for="assignee" class="svelte-g0byll">Assignee:</label> <input id="assignee" type="text" placeholder="Enter assignee name..." class="svelte-g0byll"/> <button class="btn-load svelte-g0byll"> </button></div> <!></div>');function zu(a,e){lt(e,!0);let t=y(Ce([])),r=y(""),n=y(!1);Ht(()=>(u(r,localStorage.getItem("job_assignee")||"",!0),s(r)&&i(),ss([{label:"Job",items:[{label:"Refresh",action:i}]}]),()=>{ns()}));async function i(){if(!s(r).trim()){u(t,[],!0);return}u(n,!0);try{const k=await ea.fetchJobs(0,1e3,{assignee:s(r),status:"pending"}),[R,N]=await Promise.all([ea.fetchJobs(0,1e3,{assignee:s(r),status:"pending"}),ea.fetchJobs(0,1e3,{assignee:s(r),status:"planned"})]),A=[...R,...N],$=await aa.fetchDocuments(),O=new Map($.map(X=>[X.id,X])),J={};A.forEach(X=>{if(!J[X.document_id]){const G=O.get(X.document_id);J[X.document_id]={id:X.document_id,name:G?G.name:`Doc ${X.document_id}`,type:G?G.type:"other",tasks:[]}}J[X.document_id].tasks.push(X)}),u(t,Object.values(J),!0)}catch(k){console.error(k),Re.addNotification("Failed to load jobs","error")}finally{u(n,!1)}}function c(){localStorage.setItem("job_assignee",s(r)),i()}async function d(k){try{await ea.updateJobStatus(k,"done"),await i(),Re.addNotification("Task marked as done","info")}catch(R){console.error(R),Re.addNotification("Failed to update task status","error")}}function v(k){const N=[...k.tasks||[]].sort(($,O)=>$.status==="pending"&&O.status!=="pending"?-1:$.status!=="pending"&&O.status==="pending"?1:0),A={};return N.forEach($=>{const O=$.material?$.material.name:"(No Material)";A[O]||(A[O]=[]),A[O].push($)}),A}var f=Mu(),p=l(f),h=o(l(p),2);h.__change=c;var _=o(h,2);_.__click=i;var b=l(_),x=o(p,2);{var S=k=>{var R=qu();g(k,R)},w=k=>{var R=it(),N=qe(R);{var A=O=>{var J=ju();g(O,J)},$=O=>{var J=it(),X=qe(J);{var G=le=>{var q=Au();g(le,q)},ae=le=>{var q=Cu();Ne(q,21,()=>s(t),F=>F.id,(F,te)=>{const oe=Ze(()=>v(s(te)));var ee=Ru(),ve=l(ee),re=l(ve),_e=l(re),me=o(re,2),ke=l(me),je=o(ve,2);Ne(je,17,()=>Object.entries(s(oe)),Ue,(D,P)=>{var B=Ze(()=>qs(s(P),2));let ie=()=>s(B)[0],se=()=>s(B)[1];var de=Nu(),ze=l(de),Se=l(ze),we=l(Se),pe=o(Se,2),Ae=l(pe),ge=o(ze,2);Ne(ge,21,se,Te=>Te.id,(Te,M)=>{var Z=Pu(),W=l(Z),z=l(W),C=l(z),V=o(z,2);V.__click=()=>d(s(M).id);var H=o(V,2),fe=l(H);Y(()=>{Fe(Z,1,`task-row ${s(M).status??""}`,"svelte-g0byll"),Fe(z,1,`task-status-badge ${s(M).status??""}`,"svelte-g0byll"),T(C,s(M).status),T(fe,s(M).name)}),g(Te,Z)}),Y(()=>{T(we,`ð¦ ${ie()??""}`),T(Ae,`${se().length??""} task${se().length!==1?"s":""}`)}),g(D,de)}),Y(()=>{T(_e,s(te).name),Fe(me,1,`doc-badge ${s(te).type??""}`,"svelte-g0byll"),T(ke,s(te).type)}),g(F,ee)}),g(le,q)};L(X,le=>{s(t).length===0?le(G):le(ae,!1)},!0)}g(O,J)};L(N,O=>{s(r).trim()?O($,!1):O(A)},!0)}g(k,R)};L(x,k=>{s(n)?k(S):k(w,!1)})}Y(k=>{_.disabled=k,T(b,s(n)?"Loading...":"Load")},[()=>s(n)||!s(r).trim()]),Pe(h,()=>s(r),k=>u(r,k)),g(a,f),ot()}bt(["change","click"]);var Du=m('<img class="thumbnail-img svelte-10wfxqz"/>'),$u=m('<div class="thumbnail card svelte-10wfxqz" role="button" tabindex="0"><div class="preview svelte-10wfxqz"><!> <div class="placeholder-geo svelte-10wfxqz"><span>âï¸</span></div> <div class="overlay-actions svelte-10wfxqz"><button class="action-btn svelte-10wfxqz" title="Edit Part">âï¸</button> <button class="action-btn svelte-10wfxqz" title="Preview">ðï¸</button> <button class="action-btn svelte-10wfxqz" title="Add to Order">+</button> <button class="action-btn svelte-10wfxqz" title="Filter in Docs">ð</button></div></div> <div class="info svelte-10wfxqz"><h4 class="name svelte-10wfxqz"> </h4> <div class="card-meta svelte-10wfxqz"><div class="meta-item svelte-10wfxqz"><span class="label svelte-10wfxqz">Registration:</span> <span class="value svelte-10wfxqz"> </span></div> <div class="meta-item svelte-10wfxqz"><span class="label svelte-10wfxqz">Dimensions:</span> <span class="value svelte-10wfxqz"> </span></div> <div class="meta-item svelte-10wfxqz"><span class="label svelte-10wfxqz">Material:</span> <span class="value svelte-10wfxqz"> </span></div></div></div></div>');function Ou(a,e){lt(e,!0);let t=Ze(()=>e.part.material?e.part.material.name:"Unknown Material"),r=Ze(()=>`${e.part.width||"?"} x ${e.part.height||"?"}`);function n(F){F.stopPropagation(),e.onedit&&e.onedit(e.part)}function i(F){F.stopPropagation(),e.onpreview&&e.onpreview(e.part)}var c=$u();c.__click=function(...F){e.onclick?.apply(this,F)},c.__keydown=F=>F.key==="Enter"&&e.onclick&&e.onclick();var d=l(c),v=l(d);{var f=F=>{var te=Du();Y(()=>{Ke(te,"src",`/uploads/thumbnails/${(e.part.registration_number||e.part.id)??""}.svg`),Ke(te,"alt",e.part.name)}),ba("error",te,oe=>{oe.currentTarget.style.display="none"}),g(F,te)};L(v,F=>{e.part.gnc_file_path&&F(f)})}var p=o(v,2),h=o(p,2),_=l(h);_.__click=n;var b=o(_,2);b.__click=i;var x=o(b,2);x.__click=F=>{F.stopPropagation(),e.onclick&&e.onclick()};var S=o(x,2);S.__click=F=>{F.stopPropagation(),e.onfilter&&e.onfilter(e.part)};var w=o(d,2),k=l(w),R=l(k),N=o(k,2),A=l(N),$=o(l(A),2),O=l($),J=o(A,2),X=o(l(J),2),G=l(X),ae=o(J,2),le=o(l(ae),2),q=l(le);Y(()=>{$s(p,e.part.gnc_file_path?"display: none;":""),Ke(k,"title",e.part.name),T(R,e.part.name),T(O,e.part.registration_number||"-"),T(G,`${s(r)??""} mm`),T(q,s(t))}),g(a,c),ot()}bt(["click","keydown"]);var Iu=m('<div class="tray-item svelte-15dteus"><img class="thumb svelte-15dteus"/> <div class="details svelte-15dteus"><span class="name svelte-15dteus"> </span> <div class="qty-controls svelte-15dteus"><button class="svelte-15dteus">-</button> <span class="qty svelte-15dteus"> </span> <button class="svelte-15dteus">+</button></div></div> <button class="remove-btn svelte-15dteus" title="Remove">ðï¸</button></div>'),Fu=m('<div class="empty svelte-15dteus">Tray is empty. Add parts from the library.</div>'),Lu=m('<div class="tray-backdrop svelte-15dteus"></div> <aside class="tray-panel svelte-15dteus"><header class="svelte-15dteus"><h3 class="svelte-15dteus">Order Tray</h3> <button class="close-btn svelte-15dteus">&times;</button></header> <div class="items svelte-15dteus"><!> <!></div> <footer class="svelte-15dteus"><div class="input-group svelte-15dteus"><label for="order-name" class="svelte-15dteus">Order Name</label> <input id="order-name" type="text" placeholder="e.g. ORDER-2024-001" class="svelte-15dteus"/></div> <div class="actions svelte-15dteus"><button class="clear-btn svelte-15dteus">Clear</button> <button class="create-btn svelte-15dteus"> </button></div></footer></aside>',1);function Uu(a,e){lt(e,!0);let t=y(!1),r=y("");async function n(){if(wt.partTray.length!==0){if(!s(r))return alert("Please enter an Order Name");u(t,!0);try{const v=wt.partTray.map(f=>({id:f.part.id,qty:f.quantity}));await aa.createOrder(s(r),v),mr(),_n(),alert("Order created successfully!")}catch(v){console.error(v),alert("Failed to create order: "+v.message)}finally{u(t,!1)}}}var i=it(),c=qe(i);{var d=v=>{var f=Lu(),p=qe(f);p.__click=function(...G){_n?.apply(this,G)};var h=o(p,2),_=l(h),b=o(l(_),2);b.__click=function(...G){_n?.apply(this,G)};var x=o(_,2),S=l(x);Ne(S,17,()=>wt.partTray,G=>G.part.id,(G,ae)=>{var le=Iu(),q=l(le),F=o(q,2),te=l(F),oe=l(te),ee=o(te,2),ve=l(ee);ve.__click=()=>br(s(ae).part.id,-1);var re=o(ve,2),_e=l(re),me=o(re,2);me.__click=()=>br(s(ae).part.id,1);var ke=o(F,2);ke.__click=()=>gi(s(ae).part.id),Y(()=>{Ke(q,"src",s(ae).part.thumbnail_url||"/placeholder.png"),Ke(q,"alt",s(ae).part.name),T(oe,s(ae).part.name),ve.disabled=s(ae).quantity<=1,T(_e,s(ae).quantity)}),g(G,le)});var w=o(S,2);{var k=G=>{var ae=Fu();g(G,ae)};L(w,G=>{wt.partTray.length===0&&G(k)})}var R=o(x,2),N=l(R),A=o(l(N),2),$=o(N,2),O=l($);O.__click=function(...G){mr?.apply(this,G)};var J=o(O,2);J.__click=n;var X=l(J);Y(()=>{O.disabled=wt.partTray.length===0,J.disabled=wt.partTray.length===0||s(t)||!s(r),T(X,s(t)?"Creating...":"Create Order")}),Pe(A,()=>s(r),G=>u(r,G)),g(v,f)};L(c,v=>{wt.trayVisible&&v(d)})}g(a,i),ot()}bt(["click"]);var Bu=m('<div class="message svelte-1y39gna"> </div>'),Gu=m('<div class="modal-overlay svelte-1y39gna"><div class="modal svelte-1y39gna"><h2 class="svelte-1y39gna">Scanning Library</h2> <div class="progress-container svelte-1y39gna"><div class="progress-bar svelte-1y39gna"><div class="progress-fill svelte-1y39gna"></div></div> <span class="progress-text svelte-1y39gna"> </span></div> <div class="status svelte-1y39gna"><strong>Status:</strong> </div> <!> <div class="actions svelte-1y39gna"><button class="svelte-1y39gna"> </button></div></div></div>');function Ju(a,e){lt(e,!0);const t=po();let r=kt(e,"show",15,!1),n=kt(e,"progress",3,0),i=kt(e,"status",3,""),c=kt(e,"message",3,"");function d(){i()!=="scanning"&&(r(!1),t("close"))}var v=it(),f=qe(v);{var p=h=>{var _=Gu();_.__click=d;var b=l(_);b.__click=ae=>ae.stopPropagation();var x=o(l(b),2),S=l(x),w=l(S),k=o(S,2),R=l(k),N=o(x,2),A=o(l(N)),$=o(N,2);{var O=ae=>{var le=Bu(),q=l(le);Y(()=>T(q,c())),g(ae,le)};L($,ae=>{c()&&ae(O)})}var J=o($,2),X=l(J);X.__click=d;var G=l(X);Y(()=>{$s(w,`width: ${n()??""}%`),T(R,`${n()??""}%`),T(A,` ${i()??""}`),X.disabled=i()==="scanning",T(G,i()==="scanning"?"Scanning...":"Close")}),g(h,_)};L(f,h=>{r()&&h(p)})}g(a,v),ot()}bt(["click"]);var Yu=m("<option> </option>"),Xu=m('<div class="modal-overlay svelte-1fna2hh"><div class="modal svelte-1fna2hh"><h2 class="svelte-1fna2hh">Edit Part</h2> <div class="form svelte-1fna2hh"><div class="field svelte-1fna2hh"><label for="name" class="svelte-1fna2hh">Name</label> <input id="name" type="text" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="reg" class="svelte-1fna2hh">Registration Number</label> <input id="reg" type="text" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="width" class="svelte-1fna2hh">Width (mm)</label> <input id="width" type="number" step="0.01" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="height" class="svelte-1fna2hh">Height (mm)</label> <input id="height" type="number" step="0.01" class="svelte-1fna2hh"/></div> <div class="field svelte-1fna2hh"><label for="material" class="svelte-1fna2hh">Material</label> <select id="material" class="svelte-1fna2hh"><option>No Material</option><!></select></div></div> <div class="actions svelte-1fna2hh"><button class="secondary svelte-1fna2hh">Cancel</button> <button class="primary svelte-1fna2hh">Save</button></div></div></div>');function Hu(a,e){lt(e,!0);let t=kt(e,"show",15,!1),r=kt(e,"part",3,null),n=y(Ce([])),i=y(Ce({name:"",registration_number:"",width:0,height:0,material_id:null}));Ut(()=>{t()&&r()&&(u(i,{name:r().name||"",registration_number:r().registration_number||"",width:r().width||0,height:r().height||0,material_id:r().material_id||null},!0),c())});async function c(){try{u(n,await Dt.fetchMaterials(),!0)}catch(_){console.error("Failed to load materials:",_)}}function d(){t(!1)}function v(){e.onsave&&e.onsave(s(i)),d()}var f=it(),p=qe(f);{var h=_=>{var b=Xu();b.__click=d;var x=l(b);x.__click=oe=>oe.stopPropagation();var S=o(l(x),2),w=l(S),k=o(l(w),2),R=o(w,2),N=o(l(R),2),A=o(R,2),$=o(l(A),2),O=o(A,2),J=o(l(O),2),X=o(O,2),G=o(l(X),2),ae=l(G);ae.value=(ae.__value=null)??"";var le=o(ae);Ne(le,17,()=>s(n),Ue,(oe,ee)=>{var ve=Yu(),re=l(ve),_e={};Y(()=>{T(re,s(ee).name),_e!==(_e=s(ee).id)&&(ve.value=(ve.__value=s(ee).id)??"")}),g(oe,ve)});var q=o(S,2),F=l(q);F.__click=d;var te=o(F,2);te.__click=v,Pe(k,()=>s(i).name,oe=>s(i).name=oe),Pe(N,()=>s(i).registration_number,oe=>s(i).registration_number=oe),Pe($,()=>s(i).width,oe=>s(i).width=oe),Pe(J,()=>s(i).height,oe=>s(i).height=oe),qt(G,()=>s(i).material_id,oe=>s(i).material_id=oe),g(_,b)};L(p,_=>{t()&&_(h)})}g(a,f),ot()}bt(["click"]);var Wu=m('<img class="preview-img svelte-17z6zdn"/>'),Zu=m('<div class="no-preview svelte-17z6zdn">No preview available</div>'),Vu=m('<div class="modal-backdrop svelte-17z6zdn"><div class="modal svelte-17z6zdn"><header class="svelte-17z6zdn"><h3 class="svelte-17z6zdn"> </h3> <button class="close-btn svelte-17z6zdn">&times;</button></header> <div class="content svelte-17z6zdn"><!> <div class="details svelte-17z6zdn"><p><strong>Registration:</strong> </p> <p><strong>Dimensions:</strong> </p></div></div></div></div>');function Qu(a,e){lt(e,!0);let t=kt(e,"show",15,!1);function r(){t(!1)}function n(v){v.key==="Escape"&&r()}var i=it();ba("keydown",xn,n);var c=qe(i);{var d=v=>{var f=Vu();f.__click=r;var p=l(f);p.__click=X=>X.stopPropagation();var h=l(p),_=l(h),b=l(_),x=o(_,2);x.__click=r;var S=o(h,2),w=l(S);{var k=X=>{var G=Wu();Y(()=>{Ke(G,"src",`/uploads/thumbnails/${(e.part.registration_number||e.part.id)??""}.svg`),Ke(G,"alt",e.part.name)}),g(X,G)},R=X=>{var G=Zu();g(X,G)};L(w,X=>{e.part.gnc_file_path?X(k):X(R,!1)})}var N=o(w,2),A=l(N),$=o(l(A)),O=o(A,2),J=o(l(O));Y(()=>{T(b,e.part.name),T($,` ${(e.part.registration_number||"-")??""}`),T(J,` ${(e.part.width||"?")??""} x ${(e.part.height||"?")??""} mm`)}),g(v,f)};L(c,v=>{t()&&e.part&&v(d)})}g(a,i),ot()}bt(["click"]);var Ku=m("<option> </option>"),ed=m('<div class="loading svelte-xfu7xu">Loading parts...</div>'),td=m('<div class="empty svelte-xfu7xu">No parts found matching filters.</div>'),ad=m("<div></div>"),sd=m('<div class="parts-layout svelte-xfu7xu"><aside class="sidebar svelte-xfu7xu"><h3 class="svelte-xfu7xu">Filters</h3> <div class="filter-group svelte-xfu7xu"><label for="search" class="svelte-xfu7xu">Search</label> <input id="search" type="text" placeholder="Name or Reg #" class="svelte-xfu7xu"/></div> <div class="filter-group svelte-xfu7xu"><label for="material" class="svelte-xfu7xu">Material</label> <select id="material" class="svelte-xfu7xu"><option>All Materials</option><!></select></div> <div class="filter-group svelte-xfu7xu"><span class="filter-label svelte-xfu7xu">Width (mm)</span> <div class="range svelte-xfu7xu"><input type="number" placeholder="Min" class="svelte-xfu7xu"/> <span>-</span> <input type="number" placeholder="Max" class="svelte-xfu7xu"/></div></div> <div class="filter-group svelte-xfu7xu"><span class="filter-label svelte-xfu7xu">Height (mm)</span> <div class="range svelte-xfu7xu"><input type="number" placeholder="Min" class="svelte-xfu7xu"/> <span>-</span> <input type="number" placeholder="Max" class="svelte-xfu7xu"/></div></div> <button class="reset-btn svelte-xfu7xu">Reset Filters</button></aside> <main class="content svelte-xfu7xu"><header class="svelte-xfu7xu"><div class="title-row svelte-xfu7xu"><h2 class="svelte-xfu7xu">Parts Library</h2></div></header> <!></main> <!> <!> <!> <!></div>');function nd(a,e){lt(e,!0);let t=y(Ce([])),r=y(Ce([])),n=y(""),i=y(""),c=y(""),d=y(""),v=y(""),f=y(""),p=y(!1),h=y(0);const _=50;let b=y(!1),x=y(0),S=y(""),w=y(""),k=y(!1),R=y(null),N=y(!1),A=y(null);async function $(){u(p,!0);try{const z={};s(n)&&(z.search=s(n)),s(i)&&(z.material_id=s(i)),s(c)&&(z.min_width=s(c)),s(d)&&(z.max_width=s(d)),s(v)&&(z.min_height=s(v)),s(f)&&(z.max_height=s(f));const[C,V]=await Promise.all([Dt.fetchParts(s(h)*_,_,z),s(r).length===0?Dt.fetchMaterials():Promise.resolve(s(r))]);u(t,C,!0),s(r).length===0&&u(r,V,!0)}catch(z){console.error(z),Re.addNotification("Failed to load parts","error")}finally{u(p,!1)}}function O(){u(h,0),$()}let J;function X(){clearTimeout(J),J=setTimeout(()=>{O()},500)}async function G(){u(b,!0),u(x,0),u(S,"starting"),u(w,"Initializing scan...");try{await Dt.rescanParts(),u(x,100),u(S,"complete"),u(w,"Scan triggered successfully. Check back in a few moments."),await $()}catch(z){console.error("Scan error:",z),u(S,"error"),u(w,`Scan failed: ${z.message}`)}}function ae(z){u(R,z,!0),u(k,!0)}function le(z){u(A,z,!0),u(N,!0)}function q(z){es(`/documents?part_search=${encodeURIComponent(z.name)}`)}async function F(z){try{await Dt.updatePart(s(R).id,z),await $(),Re.addNotification("Part updated successfully","info"),u(k,!1)}catch(C){console.error("Update error:",C),Re.addNotification("Failed to update part","error")}}Ht(()=>($(),ss([{label:"Parts",items:[{label:"Rescan Library",action:G},{label:"Refresh",action:$}]}]),()=>{ns()}));var te=sd(),oe=l(te),ee=o(l(oe),2),ve=o(l(ee),2);ve.__input=X;var re=o(ee,2),_e=o(l(re),2);_e.__change=O;var me=l(_e);me.value=me.__value="";var ke=o(me);Ne(ke,17,()=>s(r),Ue,(z,C)=>{var V=Ku(),H=l(V),fe={};Y(()=>{T(H,s(C).name),fe!==(fe=s(C).id)&&(V.value=(V.__value=s(C).id)??"")}),g(z,V)});var je=o(re,2),D=o(l(je),2),P=l(D);P.__change=O;var B=o(P,4);B.__change=O;var ie=o(je,2),se=o(l(ie),2),de=l(se);de.__change=O;var ze=o(de,4);ze.__change=O;var Se=o(ie,2);Se.__click=()=>{u(n,""),u(i,""),u(c,""),u(d,""),u(v,""),u(f,""),O()};var we=o(oe,2),pe=o(l(we),2);{var Ae=z=>{var C=ed();g(z,C)},ge=z=>{var C=it(),V=qe(C);{var H=ce=>{var j=td();g(ce,j)},fe=ce=>{var j=ad();Fe(j,1,"grid grid svelte-xfu7xu"),Ne(j,21,()=>s(t),E=>E.id,(E,ne)=>{Ou(E,{get part(){return s(ne)},onclick:()=>Eo(s(ne)),onedit:ae,onpreview:le,onfilter:q})}),g(ce,j)};L(V,ce=>{s(t).length===0?ce(H):ce(fe,!1)},!0)}g(z,C)};L(pe,z=>{s(p)?z(Ae):z(ge,!1)})}var Te=o(we,2);Ju(Te,{get status(){return s(S)},get message(){return s(w)},get progress(){return s(x)},get show(){return s(b)},set show(z){u(b,z,!0)}});var M=o(Te,2);Hu(M,{get part(){return s(R)},onsave:F,get show(){return s(k)},set show(z){u(k,z,!0)}});var Z=o(M,2);Qu(Z,{get part(){return s(A)},get show(){return s(N)},set show(z){u(N,z,!0)}});var W=o(Z,2);Uu(W,{}),Pe(ve,()=>s(n),z=>u(n,z)),qt(_e,()=>s(i),z=>u(i,z)),Pe(P,()=>s(c),z=>u(c,z)),Pe(B,()=>s(d),z=>u(d,z)),Pe(de,()=>s(v),z=>u(v,z)),Pe(ze,()=>s(f),z=>u(f,z)),g(a,te),ot()}bt(["input","change","click"]);var rd=m('<div class="canvas-container svelte-1eph566"><div class="toolbar svelte-1eph566"><button title="Navigate (Pan)">â</button> <button title="Select">â</button> <button title="Define Nesting Area">ð¯</button></div>  <canvas class="svelte-1eph566"></canvas> <div class="zoom-controls svelte-1eph566"><button title="Reset Zoom" class="svelte-1eph566">â²</button> <span class="zoom-level svelte-1eph566"> </span></div></div>');function id(a,e){lt(e,!0);let t=kt(e,"sheet",3,null),r=kt(e,"onselect",3,null),n=kt(e,"onAreaChange",3,null),i=kt(e,"showDebug",3,!1),c=kt(e,"nestingMode",3,"hull"),d=y(void 0),v=y(800),f=y(600),p=y(void 0),h=y(null),_=y(1),b=y(0),x=y(0),S=y(!1),w=y(0),k=y(0),R=y("navigate"),N=y(!1),A=y(null),$=y(null),O=y(null),J=y(null);const X=Ze(()=>t()?ae(t()):{minX:0,minY:0,maxX:100,maxY:100}),G=Ze(()=>{const M=s(X).maxX-s(X).minX,Z=s(X).maxY-s(X).minY;if(M===0&&Z===0)return{scale:1,startX:0,startY:0,bounds:s(X)};const W=20,z=s(v)-W*2,C=s(f)-W*2,V=z/M,H=C/Z,ce=Math.min(V,H)*.95*s(_),j=M*ce,E=Z*ce;return{scale:ce,startX:(s(v)-j)/2+s(b),startY:(s(f)-E)/2+s(x),bounds:s(X)}});Ut(()=>{s(p)&&s(G)&&q()}),Ht(()=>{s(p)&&(u(h,s(p).getContext("2d"),!0),q())});function ae(M){let Z=1/0,W=1/0,z=-1/0,C=-1/0,V=!1;M.program_width&&M.program_height&&(Z=0,W=0,z=M.program_width,C=M.program_height,V=!0);for(const H of M.parts){H.x,H.y;let fe=0,ce=0;for(const j of H.contours)for(const E of j.commands)if(E.x!==void 0&&(fe=E.x),E.y!==void 0&&(ce=E.y),E.x!==void 0||E.y!==void 0){V=!0;const ne=H.x-(H.minX||0)+fe,he=H.y-(H.minY||0)+ce;ne<Z&&(Z=ne),ne>z&&(z=ne),he<W&&(W=he),he>C&&(C=he)}}return V?{minX:Z,minY:W,maxX:z,maxY:C}:{minX:0,minY:0,maxX:100,maxY:100}}function le(M,Z){return{x:(M-s(G).startX)/s(G).scale+s(G).bounds.minX,y:(s(f)-Z-s(G).startY)/s(G).scale+s(G).bounds.minY}}function q(){if(!s(h)||!t()||!s(G))return;s(h).fillStyle="#1e1e1e",s(h).fillRect(0,0,s(v),s(f));const{scale:M,startX:Z,startY:W,bounds:z}=s(G),C=(H,fe=0)=>Z+(H+fe-z.minX)*M,V=(H,fe=0)=>s(f)-(W+(H+fe-z.minY)*M);if(t().program_width&&t().program_height&&(s(h).strokeStyle="#444",s(h).lineWidth=2,s(h).setLineDash([5,5]),s(h).strokeRect(C(0),V(t().program_height),t().program_width*M,t().program_height*M),s(h).setLineDash([])),t().nestingArea&&(s(h).strokeStyle="rgba(0, 255, 0, 0.5)",s(h).lineWidth=2,s(h).setLineDash([10,5]),s(h).strokeRect(C(t().nestingArea.x),V(t().nestingArea.y+t().nestingArea.height),t().nestingArea.width*M,t().nestingArea.height*M),s(h).fillStyle="rgba(0, 255, 0, 0.05)",s(h).fillRect(C(t().nestingArea.x),V(t().nestingArea.y+t().nestingArea.height),t().nestingArea.width*M,t().nestingArea.height*M),s(h).setLineDash([])),s(N)&&s(A)&&s($)){const H=Math.min(s(A).x,s($).x),fe=Math.min(s(A).y,s($).y),ce=Math.max(s(A).x,s($).x),j=Math.max(s(A).y,s($).y);s(h).strokeStyle="rgba(0, 255, 0, 0.8)",s(h).lineWidth=2,s(h).strokeRect(C(H),V(j),(ce-H)*M,(j-fe)*M)}t().parts.forEach((H,fe)=>{const ce=fe*137%360,j=(H.x||0)-(H.minX||0),E=(H.y||0)-(H.minY||0);H.contours.forEach(ne=>{const he=`${H.id}-${ne.id}`,De=s(O)===he,Me=s(J)===he;s(h).beginPath(),s(h).strokeStyle=De?"#ffffff":Me?"#fbbf24":`hsl(${ce}, 70%, 60%)`,s(h).lineWidth=De||Me?3:1.5,s(h).shadowBlur=De?10:Me?5:0,s(h).shadowColor=De?"#ffffff":Me?"#fbbf24":"transparent";let Ge=null,Le=null,Ve=!1;ne.commands.forEach(ue=>{const Q=Ge,Ie=Le;if(ue.x!==void 0&&(Ge=ue.x),ue.y!==void 0&&(Le=ue.y),!(Ge===null||Le===null)){if(ue.type==="G00"||ue.command==="G"&&ue.value===0)s(h).moveTo(C(Ge,j),V(Le,E)),Ve=!0;else if(ue.type==="G01"||ue.command==="G"&&ue.value===1||ue.type==="MODAL"||ue.type==="G41"||ue.type==="G40")Ve?s(h).lineTo(C(Ge,j),V(Le,E)):(s(h).moveTo(C(Ge,j),V(Le,E)),Ve=!0);else if((ue.type==="G02"||ue.type==="G03"||ue.command==="G"&&(ue.value===2||ue.value===3))&&ue.i!==void 0&&ue.j!==void 0&&Q!==null&&Ie!==null){const U=ue.i,be=ue.j,Oe=Q+U,st=Ie+be,ct=Math.sqrt(U*U+be*be),_t=C(Oe,j),mt=V(st,E),Bt=ct*M,Rt=Math.atan2(V(Ie,E)-mt,C(Q,j)-_t),I=Math.atan2(V(Le,E)-mt,C(Ge,j)-_t),K=ue.type==="G02"||ue.command==="G"&&ue.value===2;s(h).arc(_t,mt,Bt,Rt,I,K)}}}),s(h).stroke(),s(h).shadowBlur=0})}),i()&&t().parts.forEach(H=>{const fe=H.x||0,ce=H.y||0;(c()==="bbox"||!H.polygon)&&(s(h).strokeStyle="rgba(255, 0, 0, 0.8)",s(h).lineWidth=1,s(h).setLineDash([2,2]),s(h).strokeRect(C(0,fe),V(H.height||0,ce),(H.width||0)*M,(H.height||0)*M)),c()==="hull"&&H.polygon&&(s(h).beginPath(),s(h).strokeStyle="rgba(0, 255, 255, 0.8)",s(h).lineWidth=1,s(h).setLineDash([]),H.polygon.forEach((j,E)=>{const ne=C(j.x,fe),he=V(j.y,ce);E===0?s(h).moveTo(ne,he):s(h).lineTo(ne,he)}),s(h).closePath(),s(h).stroke(),s(h).fillStyle="rgba(0, 255, 255, 0.2)",s(h).fill()),s(h).setLineDash([])})}function F(M,Z){if(!t())return null;const W=s(p).getBoundingClientRect(),z=M-W.left,C=Z-W.top,V=le(z,C),H=V.x,fe=V.y,ce=5/s(G).scale;let j=null,E=null,ne=1/0;for(const he of t().parts){const De=(he.x||0)-(he.minX||0),Me=(he.y||0)-(he.minY||0);for(const Ge of he.contours){let Le=null,Ve=null,ue=1/0;for(const Q of Ge.commands){const Ie=Q.x!==void 0?Q.x:Le,U=Q.y!==void 0?Q.y:Ve;let be=1/0;if(Le!==null&&Ve!==null&&Ie!==null&&U!==null){if(Q.type==="G01"||Q.command==="G"&&Q.value===1||Q.type==="MODAL"||Q.type==="G41"||Q.type==="G40")be=oe(H,fe,Le+De,Ve+Me,Ie+De,U+Me);else if(Q.type==="G02"||Q.type==="G03"||Q.command==="G"&&(Q.value===2||Q.value===3)){const Oe=Q.i||0,st=Q.j||0,ct=Le+Oe+De,_t=Ve+st+Me,mt=Math.sqrt(Oe*Oe+st*st),Bt=Math.sqrt((H-ct)**2+(fe-_t)**2);be=Math.abs(Bt-mt);const Rt=Math.atan2(Ve+Me-_t,Le+De-ct),I=Math.atan2(U+Me-_t,Ie+De-ct),K=Math.atan2(fe-_t,H-ct),ye=Q.type==="G02"||Q.command==="G"&&Q.value===2;ke(K,Rt,I,ye)||(be=1/0)}}be<ue&&(ue=be),Le=Ie,Ve=U}ue<ce&&ue<ne&&(ne=ue,j=Ge,E=he)}}return j?{contour:j,part:E}:null}function te(M){const Z=F(M.clientX,M.clientY);Z?(u(O,`${Z.part.id}-${Z.contour.id}`),r()&&r()(Z)):(u(O,null),r()&&r()(null)),q()}function oe(M,Z,W,z,C,V){const H=M-W,fe=Z-z,ce=C-W,j=V-z,E=H*ce+fe*j,ne=ce*ce+j*j;let he=-1;ne!=0&&(he=E/ne);let De,Me;he<0?(De=W,Me=z):he>1?(De=C,Me=V):(De=W+he*ce,Me=z+he*j);const Ge=M-De,Le=Z-Me;return Math.sqrt(Ge*Ge+Le*Le)}function ee(M){M.preventDefault();const Z=s(p).getBoundingClientRect(),W=M.clientX-Z.left,z=M.clientY-Z.top,C=le(W,z),V=M.deltaY>0?.9:1.1,H=Math.max(.1,Math.min(10,s(_)*V));if(s(G).scale===0||s(_)===0)return;const ce=s(G).scale/s(_)*H,j=s(G).bounds.maxX-s(G).bounds.minX,E=s(G).bounds.maxY-s(G).bounds.minY,ne=j*ce,he=E*ce,De=W-(C.x-s(G).bounds.minX)*ce,Me=s(f)-z-(C.y-s(G).bounds.minY)*ce;u(b,De-(s(v)-ne)/2),u(x,Me-(s(f)-he)/2),u(_,H,!0),q()}function ve(M){u(w,M.clientX,!0),u(k,M.clientY,!0);const Z=s(p).getBoundingClientRect();s(R)==="navigate"?u(S,!0):s(R)==="nestArea"&&(u(N,!0),u(A,le(M.clientX-Z.left,M.clientY-Z.top),!0),u($,s(A),!0))}function re(M){if(s(R)==="navigate"&&s(S)){const Z=M.clientX-s(w),W=M.clientY-s(k);u(b,s(b)+Z),u(x,s(x)-W),u(w,M.clientX,!0),u(k,M.clientY,!0),q()}else if(s(R)==="select"){const Z=F(M.clientX,M.clientY),W=Z?`${Z.part.id}-${Z.contour.id}`:null;W!==s(J)&&(u(J,W,!0),q())}else if(s(R)==="nestArea"&&s(N)){const Z=s(p).getBoundingClientRect();u($,le(M.clientX-Z.left,M.clientY-Z.top),!0),q()}}function _e(){s(J)!==null&&(u(J,null),q()),s(S)&&u(S,!1)}function me(M){const Z=Math.abs(M.clientX-s(w)),W=Math.abs(M.clientY-s(k)),z=Z<5&&W<5;if(s(R)==="navigate")u(S,!1);else if(s(R)==="select")z&&te(M);else if(s(R)==="nestArea"&&s(N)){u(N,!1);const C=Math.min(s(A).x,s($).x),V=Math.min(s(A).y,s($).y),H=Math.max(s(A).x,s($).x),fe=Math.max(s(A).y,s($).y),ce={x:C,y:V,width:H-C,height:fe-V};ce.width>5&&ce.height>5&&n()&&n()(ce),q()}}function ke(M,Z,W,z){const C=Math.PI*2,V=(M%C+C)%C,H=(Z%C+C)%C,fe=(W%C+C)%C;if(z){const ce=(H-fe+C)%C;return(H-V+C)%C<=ce}else{const ce=(fe-H+C)%C;return(V-H+C)%C<=ce}}function je(){u(_,1),u(b,0),u(x,0),q()}var D=rd(),P=l(D),B=l(P);B.__click=()=>u(R,"navigate");let ie;var se=o(B,2);se.__click=()=>u(R,"select");let de;var ze=o(se,2);ze.__click=()=>u(R,"nestArea");let Se;var we=o(P,2);we.__mousedown=ve,we.__mousemove=re,we.__mouseup=me,Hs(we,M=>u(p,M),()=>s(p));var pe=o(we,2),Ae=l(pe);Ae.__click=je;var ge=o(Ae,2),Te=l(ge);Hs(D,M=>u(d,M),()=>s(d)),Y(M=>{ie=Fe(B,1,"svelte-1eph566",null,ie,{active:s(R)==="navigate"}),de=Fe(se,1,"svelte-1eph566",null,de,{active:s(R)==="select"}),Se=Fe(ze,1,"svelte-1eph566",null,Se,{active:s(R)==="nestArea"}),Ke(we,"width",s(v)),Ke(we,"height",s(f)),$s(we,`cursor: ${s(R)==="navigate"?s(S)?"grabbing":"grab":"default"}`),T(Te,`${M??""}%`)},[()=>Math.round(s(_)*100)]),ba("wheel",we,ee),ba("mouseleave",we,_e),fr(D,"clientWidth",M=>u(v,M)),fr(D,"clientHeight",M=>u(f,M)),g(a,D),ot()}bt(["click","mousedown","mousemove","mouseup"]);var ld=m('<span class="filename"> </span>'),od=m('<div><button class="sheet-tab svelte-57krl6"> </button> <button class="close-tab svelte-57krl6">Ã</button></div>'),cd=m('<div class="loading svelte-57krl6">Processing...</div>'),vd=m('<div class="placeholder svelte-57krl6"><p>No sheet active.</p> <button class="btn-primary svelte-57krl6">Create Blank Sheet</button></div>'),ud=m('<p class="hint-text">Select or create a sheet.</p>'),dd=m("<option> </option>"),fd=m('<h3>Sheet Properties</h3> <div class="prop-group svelte-57krl6"><span class="label">Sheet Name:</span> <input type="text" placeholder="Sheet Name" class="svelte-57krl6"/></div> <div class="prop-group svelte-57krl6"><span class="label">Program Size (mm):</span> <div class="inline-inputs svelte-57krl6"><input type="number" step="0.1" class="svelte-57krl6"/> <span>Ã</span> <input type="number" step="0.1" class="svelte-57krl6"/></div></div> <div class="prop-group svelte-57krl6"><span class="label">Thickness (mm):</span> <input type="number" step="0.1" class="svelte-57krl6"/></div> <div class="prop-group svelte-57krl6"><span class="label">Cut Count:</span> <input type="number" min="1" class="svelte-57krl6"/></div> <div class="prop-group svelte-57krl6"><span class="label">Material:</span> <select class="svelte-57krl6"><option>Select Material</option><!></select></div> <div class="prop-group svelte-57krl6"><span class="label">Total Parts:</span> <span class="value"> </span></div>',1),pd=m("<option> </option>"),hd=m('<div class="prop-group svelte-57krl6"><span class="label">Part Name:</span> <span class="value"> </span></div> <div class="prop-group svelte-57krl6"><span class="label">Contours:</span> <span class="value"> </span></div>',1),_d=m('<h3>Part Properties</h3> <div class="prop-group svelte-57krl6"><span class="label">Select Part:</span> <select class="svelte-57krl6"></select></div> <!> <button class="delete-btn svelte-57krl6">Remove Part</button>',1),gd=m('<div><div class="info svelte-57krl6"><span class="name svelte-57krl6"> </span> <span class="stats svelte-57krl6"> </span></div> <button class="add-btn svelte-57krl6">+</button></div>'),bd=m('<p class="empty-text">No matching tasks.</p>'),md=m('<button class="lib-item svelte-57krl6"> </button>'),yd=m('<p class="empty-text">No matching library parts.</p>'),wd=m('<div class="pagination-controls svelte-57krl6"><button class="page-btn svelte-57krl6">â</button> <span class="page-info svelte-57krl6"> </span> <button class="page-btn svelte-57krl6">â</button></div>'),kd=m('<h3>Inventory</h3> <div class="search-bar svelte-57krl6"><input type="text" placeholder="Search parts..." class="svelte-57krl6"/></div> <div class="inventory-list"><!> <!></div> <h4 class="section-title svelte-57krl6">Library Parts</h4> <div class="library-grid svelte-57krl6"><!> <!></div> <!>',1),xd=m('<div class="prop-field"><label> </label> <input type="text" class="svelte-57krl6"/></div>'),Sd=m('<p class="empty-props">No parameters found.</p>'),Td=m('<div class="prop-group svelte-57krl6"><span class="label">Contour ID:</span> <span class="value"> </span></div> <h4 class="section-title svelte-57krl6">P-Codes</h4> <div class="p-codes-list"><!></div>',1),Ed=m("<h3>Contour Properties</h3> <!>",1),qd=m('<div class="view-container svelte-57krl6"><div class="header"><input type="file" id="gnc-upload-input" accept=".gnc,.nc" class="hidden-input svelte-57krl6"/> <!> <div class="nest-controls svelte-57krl6"><select class="nest-mode-select svelte-57krl6"><option>Precise Hull</option><option>Bounding Box</option></select> <label class="debug-toggle svelte-57krl6"><input type="checkbox" class="svelte-57krl6"/> Debug</label></div></div> <div class="sheet-tabs svelte-57krl6"><!> <button class="add-sheet-btn svelte-57krl6">+ Add Sheet</button></div> <div class="workspace svelte-57krl6"><div class="canvas-area svelte-57krl6"><!></div> <div class="properties-panel svelte-57krl6"><div class="mode-selector svelte-57krl6"><button>Sheet</button> <button>Part</button> <button>Contour</button> <button>Inventory</button></div> <!></div></div></div>');function jd(a,e){lt(e,!0);let t=kt(e,"documentId",3,null),r=kt(e,"orderId",7,null),n=y(Ce([])),i=y(0),c=Ze(()=>s(n)[s(i)]||null),d=y(null),v=y(""),f=y(!1),p=y(!1),h=y(Ce([])),_=y(Ce([])),b=y(Ce([])),x=y(Ce([])),S=y("sheet"),w=y(null),k=y(24),R=y(""),N=y(1),A=y("hull");const $=Ze(()=>s(_).filter(I=>I.name.toLowerCase().includes(s(R).toLowerCase()))),O=Ze(()=>s(b).filter(I=>I.name.toLowerCase().includes(s(R).toLowerCase()))),J=Ze(()=>Math.ceil(s(O).length/s(k))),X=Ze(()=>s(O).slice((s(N)-1)*s(k),s(N)*s(k)));Ut(()=>{s(R),u(N,1)});async function G(){if(r()||t())try{r()?(u(h,await ea.fetchOrderTasks(r()),!0),await ae()):u(h,await ea.fetchJobs(0,1e3,{document_id:t()}),!0),F()}catch(K){console.error("Failed to load tasks",K),Re.addNotification("Failed to load document tasks","error")}}async function ae(){if(r())try{u(f,!0);const I=await ea.fetchOrderNestingProject(r());I&&I.sheets&&(u(n,I.sheets.map(K=>({...K.data,name:K.name,task_id:K.data.task_id||null})),!0),s(n).length>0&&u(i,0))}catch(I){console.warn("No existing nesting project found for this order, starting fresh.",I)}finally{u(f,!1)}}async function le(I){const K=I.target?I.target.files[0]:I;if(K){u(v,K.name,!0),u(f,!0),u(n,[],!0),u(i,0),u(d,null);try{const ye=await gr.parseGnc(K);if(u(n,[ye],!0),F(),ye?.parts?.length>0&&u(w,ye.parts[0].id,!0),D){const Be=JSON.parse(JSON.stringify(ye));D.postMessage({type:"ANALYZE_SHEET",payload:{sheet:Be}})}Re.addNotification("GNC file parsed successfully","info")}catch(ye){console.error(ye),Re.addNotification("Error parsing GNC file","error")}finally{u(f,!1)}}}function q(){document.getElementById("gnc-upload-input").click()}function F(){if(!s(h)||s(h).length===0){u(_,[],!0);return}const I={};s(n).forEach(K=>{K.parts.forEach(ye=>{const Be=ye.taskId;Be&&(I[Be]=(I[Be]||0)+1)})}),u(_,s(h).map(K=>{const ye=K.quantity||1,Be=I[K.id]||0;return{...K,placed:Be,total:ye,remaining:Math.max(0,ye-Be)}}),!0)}function te(I=null){const K={parts:[],metadata:{},total_parts:0,total_contours:0,program_width:I?.width||3e3,program_height:I?.height||1500,thickness:0,cut_count:1,material:I?.material||"Steel",name:I?.name||`Sheet ${s(n).length+1}`,task_id:I?.task_id||null};u(n,[...s(n),K],!0),u(i,s(n).length-1),re()}function oe(I){s(n).length<=1||(u(n,s(n).filter((K,ye)=>ye!==I),!0),s(i)>=s(n).length&&u(i,s(n).length-1),re(),F())}let ee=y(Ce([])),ve=y(-1);function re(){if(s(n).length===0)return;const I=JSON.parse(JSON.stringify(s(n)));s(ve)<s(ee).length-1&&u(ee,s(ee).slice(0,s(ve)+1),!0),s(ee).push(I),is(ve),s(ee).length>50&&(s(ee).shift(),is(ve,-1))}function _e(){s(ve)>0&&(is(ve,-1),u(n,JSON.parse(JSON.stringify(s(ee)[s(ve)])),!0),F())}function me(){s(ve)<s(ee).length-1&&(is(ve),u(n,JSON.parse(JSON.stringify(s(ee)[s(ve)])),!0),F())}async function ke(I){if(!s(c)){alert("Please create or load a sheet first.");return}if(!(I.remaining<=0&&!s(_).find(K=>K.id===I.id))){if(I.remaining<=0){alert("All instances of this task are already placed.");return}}try{re();let K=null;if(I.part_associations&&I.part_associations.length>0)K=I.part_associations[0].part_id;else if(I.id&&!I.document_id)K=I.id;else{alert("This task is not linked to a part geometry.");return}const ye=await Dt.fetchPartGnc(K);if(!ye||!ye.parts||ye.parts.length===0){Re.addNotification("No geometry found for this part","warning");return}console.log("Placed Part GNC Data:",{partId:K,totalPartsInGnc:ye.parts.length,firstPartContours:ye.parts[0].contours.length,allParts:ye.parts.map(gt=>({name:gt.name,contours:gt.contours.length}))});let Be=ye.parts.find(gt=>gt.name&&(gt.name.includes(I.name)||I.name.includes(gt.name)));Be||(console.warn(`Could not find geometry matching name "${I.name}", defaulting to first part.`),Be=ye.parts[0]);const Ct=Math.max(...s(n).flatMap(gt=>gt.parts).map(gt=>gt.id),0)+1,Qe=50,xe=s(c).program_width||2e3,dt=s(c).program_height||1e3,jt=Qe+Math.random()*Math.max(0,xe-Qe*2-200),At=Qe+Math.random()*Math.max(0,dt-Qe*2-200),Pt={...Be,id:Ct,name:I.name,taskId:I.id,metadata:{...Be.metadata||{},source_part_id:K},x:jt,y:At};if(s(c).parts=[...s(c).parts,Pt],s(c).total_parts=s(c).parts.length,s(c).total_parts=s(c).parts.length,F(),D){const gt=JSON.parse(JSON.stringify(s(c)));D.postMessage({type:"ANALYZE_SHEET",payload:{sheet:gt}})}}catch(K){console.error(K),alert("Failed to place part.")}}function je(I){s(c)&&(re(),s(c).parts=s(c).parts.filter(K=>K.id!==I),s(c).total_parts=s(c).parts.length,s(w)===I&&(u(w,null),u(S,"sheet")),F())}let D=null,P=y(!1),B=y(0);Ut(()=>{(r()||t())&&G()}),Ht(()=>(Dt.fetchLibraryParts().then(I=>u(b,I,!0)).catch(console.error),Dt.fetchMaterials().then(I=>u(x,I,!0)).catch(console.error),Xe.fetchSetting("gnc_library_page_size").then(I=>{I.value&&u(k,parseInt(I.value),!0)}).catch(()=>{}),window.Worker&&(D=new Worker(new URL("/assets/NestingWorker-D-7XhhTZ.js",import.meta.url),{type:"module"}),D.onmessage=I=>{const{type:K,payload:ye}=I.data;if(K==="PROGRESS")u(B,ye,!0);else if(K==="COMPLETE"){u(P,!1),console.log("COMPLETE payload",ye);const{sheets:Be}=ye;u(n,Be,!0),F(),re(),alert("Nesting complete!")}else if(K==="STOPPED")u(P,!1);else if(K==="ANALYSIS_COMPLETE"){const{sheetId:Be,parts:Ct}=ye,Qe=s(n).findIndex(xe=>xe.id===Be||xe.id===void 0&&Be===void 0);Qe!==-1&&(s(n)[Qe].parts=Ct,s(i)===Qe&&u(n,[...s(n)],!0),console.log("Analysis complete for sheet",Be))}}),ss([{label:"File",items:[{label:"Open File",action:q},{label:"Save Changes",action:ze},{label:"Save as New Order",action:Se}]},{label:"Edit",items:[{label:"Undo",action:_e},{label:"Redo",action:me}]},{label:"Nesting",items:[{label:"Auto Nest",action:()=>se(!1)},{label:"Re-nest All",action:()=>se(!0)},{label:"Unplace All",action:ie}]}]),()=>{ns(),D&&D.terminate()}));function ie(){s(c)&&(re(),s(c).parts=[],F())}async function se(I=!1){if(!D||s(n).length===0)return;if(s(P)){D.postMessage({type:"STOP_NESTING"});return}let K=[];I?(K=JSON.parse(JSON.stringify(s(_))).map(xe=>(xe.remaining=xe.total,xe)),s(n).forEach(xe=>{xe.parts.forEach(dt=>{if(!s(_).some(At=>At.id===dt.taskId)){let At=K.find(Pt=>Pt.id===(dt.taskId||dt.id));At?(At.remaining++,At.total++):K.push({...dt,id:dt.taskId||dt.id,total:1,remaining:1,isLibraryPart:!0})}})}),re(),s(n).forEach(xe=>{xe.parts=[]}),F()):K=JSON.parse(JSON.stringify(s(_).filter(xe=>xe.remaining>0))),u(P,!0),u(B,0),console.log(`GncView: Preparing geometries for ${K.length} items (isReNest: ${I})`);for(let xe of K){if(xe.contours&&xe.contours.length>0)continue;let dt=null;if(xe.part_associations&&xe.part_associations.length>0?dt=xe.part_associations[0].part_id:xe.id&&!xe.document_id&&(dt=xe.id),dt)try{const jt=await Dt.fetchPartGnc(dt);if(jt?.parts?.length>0){let At=jt.parts.find(Pt=>Pt.name&&(Pt.name.includes(xe.name)||xe.name.includes(Pt.name)))||jt.parts[0];xe.contours=At.contours,xe.taskId=xe.id}}catch(jt){console.error(`GncView: Failed to fetch geometry for ${xe.name}`,jt)}}let ye=4,Be=10,Ct=5;try{const[xe,dt,jt]=await Promise.all([Xe.fetchSetting("nesting_rotations").catch(()=>({value:"4"})),Xe.fetchSetting("nesting_population").catch(()=>({value:"10"})),Xe.fetchSetting("nesting_spacing").catch(()=>({value:"5"}))]);ye=parseInt(xe.value)||4,Be=parseInt(dt.value)||10,Ct=parseFloat(jt.value)||5}catch(xe){console.warn("Using default nesting settings",xe)}const Qe={rotations:ye,population:Be,spacing:Ct,multiSheet:!0,nestingMode:s(A)};D.postMessage({type:"START_NESTING",payload:{sheets:JSON.parse(JSON.stringify(s(n))),inventory:JSON.parse(JSON.stringify(K)),stock:[],config:Qe}})}function de(I){if(!I){u(d,null);return}I.contour&&(u(d,I.contour,!0),I.part?(u(w,I.part.id,!0),s(S)==="sheet"&&u(S,"contour")):u(S,"contour"))}async function ze(){if(s(n).length!==0)try{u(f,!0);const I={order_id:r(),name:s(v)||"Nesting Project",sheets:s(n).map((K,ye)=>({id:ye,name:K.name||`Sheet ${ye+1}`,data:K})),inventory:s(h),stock:[]};r()?await ea.saveOrderNesting(I):await gr.saveGnc(s(c),s(v),!0),Re.addNotification("Project saved successfully","info")}catch(I){console.error(I),Re.addNotification("Failed to save project","error")}finally{u(f,!1)}}async function Se(){if(s(n).length===0)return;const I=prompt("Enter name for the new Order:");if(I)try{const K=s(n).map((Be,Ct)=>({name:Be.metadata?.program_name||`Sheet ${Ct+1}`,data:Be})),ye=await ea.saveAsNewOrder(I,K,t());Re.addNotification(`New Order "${ye.name}" created`,"info"),es(`/gnc?orderId=${ye.id}`),r(ye.id),G()}catch(K){console.error(K),Re.addNotification("Failed to save as new order","error")}}function we(I,K){s(d)&&s(d).metadata&&(s(d).metadata[I]=K)}function pe(I,K){s(c)&&(s(c)[I]=K)}let Ae=Ze(()=>s(c)?.parts?.find(I=>I.id===s(w)));var ge=qd(),Te=l(ge),M=l(Te);M.__change=le;var Z=o(M,2);{var W=I=>{var K=ld(),ye=l(K);Y(()=>T(ye,s(v))),g(I,K)};L(Z,I=>{s(v)&&I(W)})}var z=o(Z,2),C=l(z),V=l(C);V.value=V.__value="hull";var H=o(V);H.value=H.__value="bbox";var fe=o(C,2),ce=l(fe),j=o(Te,2),E=l(j);Ne(E,17,()=>s(n),Ue,(I,K,ye)=>{var Be=od();let Ct;var Qe=l(Be);Qe.__click=()=>u(i,ye,!0);var xe=l(Qe),dt=o(Qe,2);dt.__click=()=>oe(ye),Y(()=>{Ct=Fe(Be,1,"tab-wrapper svelte-57krl6",null,Ct,{active:s(i)===ye}),T(xe,s(K).name||`Sheet ${ye+1}`)}),g(I,Be)});var ne=o(E,2);ne.__click=()=>te();var he=o(j,2),De=l(he),Me=l(De);{var Ge=I=>{var K=cd();g(I,K)},Le=I=>{var K=it(),ye=qe(K);{var Be=Qe=>{id(Qe,{get sheet(){return s(c)},get showDebug(){return s(p)},get nestingMode(){return s(A)},onselect:de,onAreaChange:xe=>{s(c).nestingArea=xe,re()}})},Ct=Qe=>{var xe=vd(),dt=o(l(xe),2);dt.__click=()=>te(),g(Qe,xe)};L(ye,Qe=>{s(c)?Qe(Be):Qe(Ct,!1)},!0)}g(I,K)};L(Me,I=>{s(f)?I(Ge):I(Le,!1)})}var Ve=o(De,2),ue=l(Ve),Q=l(ue);Q.__click=()=>u(S,"sheet");let Ie;var U=o(Q,2);U.__click=()=>u(S,"part");let be;var Oe=o(U,2);Oe.__click=()=>u(S,"contour");let st;var ct=o(Oe,2);ct.__click=()=>u(S,"inventory");let _t;var mt=o(ue,2);{var Bt=I=>{var K=ud();g(I,K)},Rt=I=>{var K=it(),ye=qe(K);{var Be=Qe=>{var xe=fd(),dt=o(qe(xe),2),jt=o(l(dt),2);jt.__input=vt=>pe("name",vt.currentTarget.value);var At=o(dt,2),Pt=o(l(At),2),gt=l(Pt);gt.__input=vt=>pe("program_width",parseFloat(vt.currentTarget.value));var la=o(gt,4);la.__input=vt=>pe("program_height",parseFloat(vt.currentTarget.value));var oa=o(At,2),da=o(l(oa),2);da.__input=vt=>pe("thickness",parseFloat(vt.currentTarget.value));var Wt=o(oa,2),Gt=o(l(Wt),2);Gt.__input=vt=>pe("cut_count",parseInt(vt.currentTarget.value));var Mt=o(Wt,2),xt=o(l(Mt),2);xt.__change=vt=>pe("material",vt.currentTarget.value);var Ee=l(xt);Ee.value=Ee.__value="";var We=o(Ee);Ne(We,17,()=>s(x),Ue,(vt,Nt)=>{var Ot=dd(),Jt=l(Ot),$e={};Y(()=>{T(Jt,s(Nt).name),$e!==($e=s(Nt).name)&&(Ot.value=(Ot.__value=s(Nt).name)??"")}),g(vt,Ot)});var nt;Ps(xt);var Et=o(Mt,2),Je=o(l(Et),2),yt=l(Je);Y(()=>{os(jt,s(c).name||""),os(gt,s(c).program_width||0),os(la,s(c).program_height||0),os(da,s(c).thickness||0),os(Gt,s(c).cut_count||1),nt!==(nt=s(c).material||"")&&(xt.value=(xt.__value=s(c).material||"")??"",fs(xt,s(c).material||"")),T(yt,s(c).total_parts)}),g(Qe,xe)},Ct=Qe=>{var xe=it(),dt=qe(xe);{var jt=Pt=>{var gt=_d(),la=o(qe(gt),2),oa=o(l(la),2);Ne(oa,21,()=>s(c).parts,Ue,(Mt,xt)=>{var Ee=pd(),We=l(Ee),nt={};Y(()=>{T(We,s(xt).name||`Part ${s(xt).id}`),nt!==(nt=s(xt).id)&&(Ee.value=(Ee.__value=s(xt).id)??"")}),g(Mt,Ee)});var da=o(la,2);{var Wt=Mt=>{var xt=hd(),Ee=qe(xt),We=o(l(Ee),2),nt=l(We),Et=o(Ee,2),Je=o(l(Et),2),yt=l(Je);Y(()=>{T(nt,s(Ae).name||"N/A"),T(yt,s(Ae).contours.length)}),g(Mt,xt)};L(da,Mt=>{s(Ae)&&Mt(Wt)})}var Gt=o(da,2);Gt.__click=()=>je(s(w)),qt(oa,()=>s(w),Mt=>u(w,Mt)),g(Pt,gt)},At=Pt=>{var gt=it(),la=qe(gt);{var oa=Wt=>{var Gt=kd(),Mt=o(qe(Gt),2),xt=l(Mt),Ee=o(Mt,2),We=l(Ee);Ne(We,17,()=>s($),Ue,($e,Ye)=>{var pt=gd();let ht;var St=l(pt),zt=l(St),Yt=l(zt),fa=o(zt,2),rt=l(fa),ft=o(St,2);ft.__click=()=>ke(s(Ye)),Y(()=>{ht=Fe(pt,1,"inventory-item svelte-57krl6",null,ht,{complete:s(Ye).remaining===0}),T(Yt,s(Ye).name),T(rt,`${s(Ye).placed??""} / ${s(Ye).total??""}`),ft.disabled=s(Ye).remaining<=0}),g($e,pt)});var nt=o(We,2);{var Et=$e=>{var Ye=bd();g($e,Ye)};L(nt,$e=>{s($).length===0&&$e(Et)})}var Je=o(Ee,4),yt=l(Je);Ne(yt,17,()=>s(X),Ue,($e,Ye)=>{var pt=md();pt.__click=()=>ke(s(Ye));var ht=l(pt);Y(()=>T(ht,s(Ye).name)),g($e,pt)});var vt=o(yt,2);{var Nt=$e=>{var Ye=yd();g($e,Ye)};L(vt,$e=>{s(O).length===0&&$e(Nt)})}var Ot=o(Je,2);{var Jt=$e=>{var Ye=wd(),pt=l(Ye);pt.__click=()=>is(N,-1);var ht=o(pt,2),St=l(ht),zt=o(ht,2);zt.__click=()=>is(N),Y(()=>{pt.disabled=s(N)===1,T(St,`Page ${s(N)??""} of ${s(J)??""}`),zt.disabled=s(N)===s(J)}),g($e,Ye)};L(Ot,$e=>{s(J)>1&&$e(Jt)})}Pe(xt,()=>s(R),$e=>u(R,$e)),g(Wt,Gt)},da=Wt=>{var Gt=it(),Mt=qe(Gt);{var xt=Ee=>{var We=Ed(),nt=o(qe(We),2);{var Et=Je=>{var yt=Td(),vt=qe(yt),Nt=o(l(vt),2),Ot=l(Nt),Jt=o(vt,4),$e=l(Jt);{var Ye=ht=>{var St=it(),zt=qe(St);Ne(zt,17,()=>Object.entries(s(d).metadata),Ue,(Yt,fa)=>{var rt=Ze(()=>qs(s(fa),2));let ft=()=>s(rt)[0],It=()=>s(rt)[1];var Ya=it(),rn=qe(Ya);{var Mi=ln=>{var tr=xd(),on=l(tr),zi=l(on),cn=o(on,2);cn.__input=Di=>we(ft(),Di.currentTarget.value),Y(()=>{Ke(on,"for",ft()),T(zi,ft()),Ke(cn,"id",ft()),os(cn,It())}),g(ln,tr)};L(rn,ln=>{ft().startsWith("P")&&ln(Mi)})}g(Yt,Ya)}),g(ht,St)},pt=ht=>{var St=Sd();g(ht,St)};L($e,ht=>{s(d).metadata?ht(Ye):ht(pt,!1)})}Y(()=>T(Ot,`#${s(d).id??""}`)),g(Je,yt)};L(nt,Je=>{s(d)&&Je(Et)})}g(Ee,We)};L(Mt,Ee=>{s(S)==="contour"&&Ee(xt)},!0)}g(Wt,Gt)};L(la,Wt=>{s(S)==="inventory"?Wt(oa):Wt(da,!1)},!0)}g(Pt,gt)};L(dt,Pt=>{s(S)==="part"?Pt(jt):Pt(At,!1)},!0)}g(Qe,xe)};L(ye,Qe=>{s(S)==="sheet"?Qe(Be):Qe(Ct,!1)},!0)}g(I,K)};L(mt,I=>{s(c)?I(Rt,!1):I(Bt)})}Y(()=>{Ie=Fe(Q,1,"svelte-57krl6",null,Ie,{active:s(S)==="sheet"}),be=Fe(U,1,"svelte-57krl6",null,be,{active:s(S)==="part"}),st=Fe(Oe,1,"svelte-57krl6",null,st,{active:s(S)==="contour"}),_t=Fe(ct,1,"svelte-57krl6",null,_t,{active:s(S)==="inventory"})}),qt(C,()=>s(A),I=>u(A,I)),io(ce,()=>s(p),I=>u(p,I)),g(a,ge),ot()}bt(["change","click","input"]);var Ad=m("<option> </option>"),Pd=m('<div class="form-panel svelte-gim6qq"><h3>New Stock Item</h3> <div class="form-grid svelte-gim6qq"><div class="field svelte-gim6qq"><label for="stock-mat" class="svelte-gim6qq">Material</label> <select id="stock-mat" class="svelte-gim6qq"><option>Select Material...</option><!></select></div> <div class="field svelte-gim6qq"><label for="stock-width" class="svelte-gim6qq">Width (mm)</label> <input id="stock-width" type="number" min="0" class="svelte-gim6qq"/></div> <div class="field svelte-gim6qq"><label for="stock-height" class="svelte-gim6qq">Height (mm)</label> <input id="stock-height" type="number" min="0" class="svelte-gim6qq"/></div> <div class="field svelte-gim6qq"><label for="stock-qty" class="svelte-gim6qq">Quantity</label> <input id="stock-qty" type="number" min="0" class="svelte-gim6qq"/></div> <div class="field svelte-gim6qq"><label for="stock-loc" class="svelte-gim6qq">Location</label> <input id="stock-loc" type="text" placeholder="e.g. A-01" class="svelte-gim6qq"/></div> <div class="actions"><button class="save-btn svelte-gim6qq">Save Item</button></div></div></div>'),Nd=m('<p class="loading svelte-gim6qq">Loading stock...</p>'),Rd=m('<div class="empty-state svelte-gim6qq"><p>No stock items found.</p></div>'),Cd=m('<tr><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"> </td><td class="svelte-gim6qq"><button class="delete-btn svelte-gim6qq">Delete</button></td></tr>'),Md=m('<div class="table-container svelte-gim6qq"><table class="svelte-gim6qq"><thead><tr><th class="svelte-gim6qq">Material</th><th class="svelte-gim6qq">Dimensions</th><th class="svelte-gim6qq">Qty</th><th class="svelte-gim6qq">Reserved</th><th class="svelte-gim6qq">Location</th><th class="svelte-gim6qq">Actions</th></tr></thead><tbody></tbody></table></div>'),zd=m('<div class="view-container svelte-gim6qq"><div class="header svelte-gim6qq"><h2 class="svelte-gim6qq">Stock Management</h2></div> <!> <!></div>');function Dd(a,e){lt(e,!0);let t=y(Ce([])),r=y(Ce([])),n=y(!0),i=y(!1),c=y(Ce({material_id:"",width:0,height:0,quantity:0,location:""}));async function d(){u(n,!0);try{const[k,R]=await Promise.all([Dt.fetchStock(),Dt.fetchMaterials()]);u(t,k,!0),u(r,R,!0)}catch(k){console.error(k),Re.addNotification("Failed to load stock data","error")}finally{u(n,!1)}}function v(){u(i,!s(i))}async function f(){if(s(c).material_id)try{const k=await Dt.createStockItem(s(c));u(t,[...s(t),k],!0),u(i,!1),u(c,{material_id:"",width:0,height:0,quantity:0,location:""},!0),Re.addNotification("Stock item added","info")}catch(k){console.error(k),Re.addNotification("Failed to add stock item","error")}}async function p(k){if(confirm("Are you sure you want to delete this item?"))try{await Dt.deleteStockItem(k),u(t,s(t).filter(R=>R.id!==k),!0),Re.addNotification("Stock item deleted","info")}catch(R){console.error(R),Re.addNotification("Failed to delete item","error")}}Ht(()=>(d(),ss([{label:"Stock",items:[{label:"Add Stock",action:v},{label:"Refresh",action:d}]}]),()=>{ns()}));var h=zd(),_=o(l(h),2);{var b=k=>{var R=Pd(),N=o(l(R),2),A=l(N),$=o(l(A),2),O=l($);O.value=O.__value="";var J=o(O);Ne(J,17,()=>s(r),Ue,(re,_e)=>{var me=Ad(),ke=l(me),je={};Y(()=>{T(ke,s(_e).name),je!==(je=s(_e).id)&&(me.value=(me.__value=s(_e).id)??"")}),g(re,me)});var X=o(A,2),G=o(l(X),2),ae=o(X,2),le=o(l(ae),2),q=o(ae,2),F=o(l(q),2),te=o(q,2),oe=o(l(te),2),ee=o(te,2),ve=l(ee);ve.__click=f,qt($,()=>s(c).material_id,re=>s(c).material_id=re),Pe(G,()=>s(c).width,re=>s(c).width=re),Pe(le,()=>s(c).height,re=>s(c).height=re),Pe(F,()=>s(c).quantity,re=>s(c).quantity=re),Pe(oe,()=>s(c).location,re=>s(c).location=re),g(k,R)};L(_,k=>{s(i)&&k(b)})}var x=o(_,2);{var S=k=>{var R=Nd();g(k,R)},w=k=>{var R=it(),N=qe(R);{var A=O=>{var J=Rd();g(O,J)},$=O=>{var J=Md(),X=l(J),G=o(l(X));Ne(G,21,()=>s(t),Ue,(ae,le)=>{var q=Cd(),F=l(q),te=l(F),oe=o(F),ee=l(oe),ve=o(oe),re=l(ve),_e=o(ve),me=l(_e),ke=o(_e),je=l(ke),D=o(ke),P=l(D);P.__click=()=>p(s(le).id),Y(()=>{T(te,s(le).material?s(le).material.name:"Unknown"),T(ee,`${s(le).width??""} x ${s(le).height??""}`),T(re,s(le).quantity),T(me,s(le).reserved),T(je,s(le).location||"-")}),g(ae,q)}),g(O,J)};L(N,O=>{s(t).length===0?O(A):O($,!1)},!0)}g(k,R)};L(x,k=>{s(n)?k(S):k(w,!1)})}g(a,h),ot()}bt(["click"]);var $d=m("<p> </p>"),Od=m(`<div class="setup-container svelte-1125czv"><div class="card svelte-1125czv"><h1 class="svelte-1125czv">Welcome to DocuFlow</h1> <p class="subtitle svelte-1125czv">Please configure the database connection.</p> <div class="field svelte-1125czv"><label for="db-path" class="svelte-1125czv">Database File Path</label> <p class="help-text svelte-1125czv">Enter the full path to the SQLite database file. For network
                sharing, use a path on the shared drive (e.g., <code>Z:\\DocuFlow\\data.db</code>).</p> <div class="input-group svelte-1125czv"><input id="db-path" type="text" placeholder="C:\\DocuFlow\\data.db" class="svelte-1125czv"/> <button class="svelte-1125czv"> </button></div> <!></div> <div class="actions"><button class="primary svelte-1125czv"> </button></div></div></div>`);function Id(a,e){lt(e,!0);let t=y(""),r=y(!1),n=y(null),i=y(!1);Ht(async()=>{try{const A=await Xe.fetchDatabaseConfig();A.database_path&&u(t,A.database_path,!0)}catch(A){console.error(A)}});async function c(){if(s(t)){u(r,!0),u(n,null);try{const A=await Xe.testPath(s(t));u(n,{ok:A.accessible||!A.exists,message:A.accessible?"Path exists and is readable.":A.exists?"Path exists but not readable.":"File does not exist (will be created)."},!0)}catch(A){u(n,{ok:!1,message:A.message},!0)}finally{u(r,!1)}}}async function d(){u(i,!0);try{(await Xe.updateDatabaseConfig({database_path:s(t)})).ok?(Re.addNotification("Configuration saved. Application will restart.","info"),wt.configStatus="configured",setTimeout(()=>{es("/"),window.location.reload()},3e3)):Re.addNotification("Failed to save configuration","error")}catch(A){Re.addNotification("Error saving configuration","error"),console.error(A)}finally{u(i,!1)}}var v=Od(),f=l(v),p=o(l(f),4),h=o(l(p),4),_=l(h),b=o(_,2);b.__click=c;var x=l(b),S=o(h,2);{var w=A=>{var $=$d(),O=l($);Y(()=>{Fe($,1,`result ${s(n).ok?"success":"warn"}`,"svelte-1125czv"),T(O,s(n).message)}),g(A,$)};L(S,A=>{s(n)&&A(w)})}var k=o(p,2),R=l(k);R.__click=d;var N=l(R);Y(()=>{b.disabled=s(r),T(x,s(r)?"Testing...":"Test Path"),R.disabled=s(i)||!s(t),T(N,s(i)?"Saving...":"Save Configuration")}),Pe(_,()=>s(t),A=>u(t,A)),g(a,v),ot()}bt(["click"]);var Fd=m('<p class="loading svelte-k2dnon">Loading settings...</p>'),Ld=m("<span> </span>"),Ud=m("<span> </span>"),Bd=m(`<div class="card svelte-k2dnon"><div class="field svelte-k2dnon"><label for="regex" class="svelte-k2dnon">Document Name Regex</label> <input id="regex" type="text" placeholder="Regex Pattern" class="svelte-k2dnon"/></div> <hr class="divider svelte-k2dnon"/> <h3 class="section-title svelte-k2dnon">Sync Folder Paths</h3> <p class="section-hint svelte-k2dnon">Configure paths to network folders for automatic
                            file import.</p> <div class="field path-field svelte-k2dnon"><label for="mihtav-path" class="svelte-k2dnon">Mihtav (Orders) Path</label> <div class="path-input-group svelte-k2dnon"><input id="mihtav-path" type="text" placeholder="Z:\\Mihtavim or \\\\server\\share\\orders" class="svelte-k2dnon"/> <button class="test-btn svelte-k2dnon"> </button></div> <!></div> <div class="field path-field svelte-k2dnon"><label for="sidra-path" class="svelte-k2dnon">Sidra (Parts Library) Path</label> <div class="path-input-group svelte-k2dnon"><input id="sidra-path" type="text" placeholder="Z:\\Sidra or \\\\server\\share\\parts" class="svelte-k2dnon"/> <button class="test-btn svelte-k2dnon"> </button></div> <!></div> <div class="field svelte-k2dnon"><label for="rescan-interval" class="svelte-k2dnon">Auto-Rescan Interval (minutes)</label> <div class="path-input-group svelte-k2dnon"><input id="rescan-interval" type="number" min="1" placeholder="60" class="svelte-k2dnon"/> <button class="test-btn svelte-k2dnon"> </button></div> <p class="hint svelte-k2dnon">How often to scan folders for new files. Set to
                                0 to disable auto-scan.</p></div> <div class="field svelte-k2dnon"><label for="role" class="svelte-k2dnon">User Mode (Simulated)</label> <select id="role" class="svelte-k2dnon"><option class="svelte-k2dnon">Operator (Read-Only)</option><option class="svelte-k2dnon">Admin (Full Access)</option></select> <p class="hint svelte-k2dnon">Switching mode will reload the application.</p></div> <hr class="divider svelte-k2dnon"/> <h3 class="section-title svelte-k2dnon">Editor Settings</h3> <div class="field svelte-k2dnon"><label for="gnc-page-size" class="svelte-k2dnon">GNC Library Page Size</label> <input id="gnc-page-size" type="number" min="1" max="100" class="svelte-k2dnon"/> <p class="hint svelte-k2dnon">Number of parts to show per page in the GNC
                                Editor's library.</p></div></div>`),Gd=m(`<div class="card svelte-k2dnon"><h3 class="section-title svelte-k2dnon">Auto-Nesting Configuration</h3> <p class="section-hint svelte-k2dnon">Adjust parameters for the nesting algorithm
                            (SVGnest).</p> <div class="field svelte-k2dnon"><label for="rotations" class="svelte-k2dnon">Rotations</label> <input id="rotations" type="number" min="1" max="360" class="svelte-k2dnon"/> <p class="hint svelte-k2dnon">Number of rotation steps (e.g., 4 = 0, 90, 180,
                                270).</p></div> <div class="field svelte-k2dnon"><label for="population" class="svelte-k2dnon">Population Size</label> <input id="population" type="number" min="5" max="100" class="svelte-k2dnon"/> <p class="hint svelte-k2dnon">Higher values check more combinations but run
                                slower.</p></div> <div class="field svelte-k2dnon"><label for="spacing" class="svelte-k2dnon">Part Spacing (mm)</label> <input id="spacing" type="number" min="0" step="0.5" class="svelte-k2dnon"/> <p class="hint svelte-k2dnon">Minimum distance between parts.</p></div></div>`),Jd=m('<div class="refresh-overlay svelte-k2dnon"><div class="spinner svelte-k2dnon"></div> <p class="svelte-k2dnon">Applying changes and refreshing system...</p></div>'),Yd=m(`<div class="card svelte-k2dnon"><h3 class="section-title svelte-k2dnon">Database Storage</h3> <p class="section-hint svelte-k2dnon">Configure the location of the SQLite database file.</p> <div class="field svelte-k2dnon"><label for="db-path" class="svelte-k2dnon">Database Path</label> <input id="db-path" type="text" placeholder="e.g., sql_app.db or data/production.db" class="svelte-k2dnon"/> <p class="hint svelte-k2dnon">Provide a relative or absolute path. If the
                                directory doesn't exist, it will be created.</p></div> <!></div>`),Xd=m('<div class="content-wrapper svelte-k2dnon"><div class="tabs svelte-k2dnon"><button>General</button> <button>Nesting</button> <button>Database</button></div> <div class="tab-content svelte-k2dnon"><!></div></div>'),Hd=m('<div class="settings-view svelte-k2dnon"><div class="page-header svelte-k2dnon"><h2 class="svelte-k2dnon">Settings</h2> <button class="save-btn svelte-k2dnon">Save Changes</button></div> <!></div>');function Wd(a,e){lt(e,!0);let t=y("general"),r=y(""),n=y("admin"),i=y(""),c=y(""),d=y(60),v=y(!1),f=y(""),p=y(!1),h=y(4),_=y(10),b=y(5),x=y(24),S=y(!0),w=Ce({mihtav:!1,sidra:!1}),k=Ce({mihtav:null,sidra:null});async function R(){u(S,!0);try{const[q,F,te,oe,ee,ve,re,_e,me]=await Promise.all([Xe.fetchSetting("doc_name_regex").catch(()=>({value:""})),Xe.fetchSetting("sync_mihtav_path").catch(()=>({value:""})),Xe.fetchSetting("sync_sidra_path").catch(()=>({value:""})),Xe.fetchSetting("nesting_rotations").catch(()=>({value:"4"})),Xe.fetchSetting("nesting_population").catch(()=>({value:"10"})),Xe.fetchSetting("nesting_spacing").catch(()=>({value:"5"})),Xe.fetchSetting("gnc_library_page_size").catch(()=>({value:"24"})),Xe.fetchDatabaseConfig().catch(()=>({database_path:"sql_app.db"})),Xe.fetchSetting("sync_rescan_interval").catch(()=>({value:"60"}))]);u(r,q.value||"",!0),u(i,F.value||"",!0),u(c,te.value||"",!0),u(h,parseInt(oe.value)||4,!0),u(_,parseInt(ee.value)||10,!0),u(b,parseFloat(ve?.value)||5,!0),u(x,parseInt(re?.value)||24,!0),u(f,_e.database_path,!0),u(d,parseInt(me?.value)||60,!0);const ke=localStorage.getItem("user_role");ke&&u(n,ke,!0)}catch(q){console.error(q)}finally{u(S,!1)}}async function N(q){const F=s(q==="mihtav"?i:c);if(!F){k[q]={accessible:!1,error:"Path is empty"};return}w[q]=!0;try{const te=await Xe.testPath(F);k[q]={accessible:te.ok,error:te.error}}catch(te){k[q]={accessible:!1,error:te.message}}finally{w[q]=!1}}async function A(){try{await Promise.all([Xe.updateSetting("doc_name_regex",s(r)),Xe.updateSetting("sync_mihtav_path",s(i)),Xe.updateSetting("sync_sidra_path",s(c)),Xe.updateSetting("nesting_population",s(_).toString()),Xe.updateSetting("nesting_rotations",s(h).toString()),Xe.updateSetting("nesting_spacing",s(b).toString()),Xe.updateSetting("gnc_library_page_size",s(x).toString()),Xe.updateSetting("sync_rescan_interval",s(d).toString()),Xe.updateDatabaseConfig({database_path:s(f)}).then(q=>{q.ok&&(u(p,!0),setTimeout(()=>{window.location.reload()},3e3))})]),localStorage.setItem("user_role",s(n)),Re.addNotification("Settings saved successfully","info"),s(p)||window.location.reload()}catch(q){Re.addNotification("Failed to save settings. Admin access required.","error"),console.error(q)}}async function $(){u(v,!0);try{await Xe.triggerRescan(),Re.addNotification("Rescan triggered successfully","info")}catch(q){Re.addNotification("Failed to trigger rescan","error"),console.error(q)}finally{u(v,!1)}}Ht(()=>{R()});var O=Hd(),J=l(O),X=o(l(J),2);X.__click=A;var G=o(J,2);{var ae=q=>{var F=Fd();g(q,F)},le=q=>{var F=Xd(),te=l(F),oe=l(te);oe.__click=()=>u(t,"general");let ee;var ve=o(oe,2);ve.__click=()=>u(t,"nesting");let re;var _e=o(ve,2);_e.__click=()=>u(t,"database");let me;var ke=o(te,2),je=l(ke);{var D=B=>{var ie=Bd(),se=l(ie),de=o(l(se),2),ze=o(se,8),Se=o(l(ze),2),we=l(Se),pe=o(we,2);pe.__click=()=>N("mihtav");var Ae=l(pe),ge=o(Se,2);{var Te=ue=>{var Q=Ld();let Ie;var U=l(Q);Y(()=>{Ie=Fe(Q,1,"test-result svelte-k2dnon",null,Ie,{success:k.mihtav.accessible,error:!k.mihtav.accessible}),T(U,k.mihtav.accessible?"â Path accessible":`â ${k.mihtav.error||"Path not accessible"}`)}),g(ue,Q)};L(ge,ue=>{k.mihtav&&ue(Te)})}var M=o(ze,2),Z=o(l(M),2),W=l(Z),z=o(W,2);z.__click=()=>N("sidra");var C=l(z),V=o(Z,2);{var H=ue=>{var Q=Ud();let Ie;var U=l(Q);Y(()=>{Ie=Fe(Q,1,"test-result svelte-k2dnon",null,Ie,{success:k.sidra.accessible,error:!k.sidra.accessible}),T(U,k.sidra.accessible?"â Path accessible":`â ${k.sidra.error||"Path not accessible"}`)}),g(ue,Q)};L(V,ue=>{k.sidra&&ue(H)})}var fe=o(M,2),ce=o(l(fe),2),j=l(ce),E=o(j,2);E.__click=$;var ne=l(E),he=o(fe,2),De=o(l(he),2),Me=l(De);Me.value=Me.__value="operator";var Ge=o(Me);Ge.value=Ge.__value="admin";var Le=o(he,6),Ve=o(l(Le),2);Y(()=>{pe.disabled=w.mihtav,T(Ae,w.mihtav?"Testing...":"Test"),z.disabled=w.sidra,T(C,w.sidra?"Testing...":"Test"),E.disabled=s(v),T(ne,s(v)?"Scanning...":"Rescan Now")}),Pe(de,()=>s(r),ue=>u(r,ue)),Pe(we,()=>s(i),ue=>u(i,ue)),Pe(W,()=>s(c),ue=>u(c,ue)),Pe(j,()=>s(d),ue=>u(d,ue)),qt(De,()=>s(n),ue=>u(n,ue)),Pe(Ve,()=>s(x),ue=>u(x,ue)),g(B,ie)},P=B=>{var ie=it(),se=qe(ie);{var de=Se=>{var we=Gd(),pe=o(l(we),4),Ae=o(l(pe),2),ge=o(pe,2),Te=o(l(ge),2),M=o(ge,2),Z=o(l(M),2);Pe(Ae,()=>s(h),W=>u(h,W)),Pe(Te,()=>s(_),W=>u(_,W)),Pe(Z,()=>s(b),W=>u(b,W)),g(Se,we)},ze=Se=>{var we=it(),pe=qe(we);{var Ae=ge=>{var Te=Yd(),M=o(l(Te),4),Z=o(l(M),2),W=o(M,2);{var z=C=>{var V=Jd();g(C,V)};L(W,C=>{s(p)&&C(z)})}Pe(Z,()=>s(f),C=>u(f,C)),g(ge,Te)};L(pe,ge=>{s(t)==="database"&&ge(Ae)},!0)}g(Se,we)};L(se,Se=>{s(t)==="nesting"?Se(de):Se(ze,!1)},!0)}g(B,ie)};L(je,B=>{s(t)==="general"?B(D):B(P,!1)})}Y(()=>{ee=Fe(oe,1,"svelte-k2dnon",null,ee,{active:s(t)==="general"}),re=Fe(ve,1,"svelte-k2dnon",null,re,{active:s(t)==="nesting"}),me=Fe(_e,1,"svelte-k2dnon",null,me,{active:s(t)==="database"})}),g(q,F)};L(G,q=>{s(S)?q(ae):q(le,!1)})}g(a,O),ot()}bt(["click"]);const Zd={"/":Oo,"/documents":fu,"/journal":Eu,"/job":zu,"/parts":nd,"/gnc":jd,"/stock":Dd,"/setup":Id,"/settings":Wd};var Vd=m('<button class="svelte-zne36e"> </button>'),Qd=m('<div class="submenu-group svelte-zne36e"><div class="submenu-title svelte-zne36e"> </div> <!></div>'),Kd=m('<div class="divider-vertical svelte-zne36e"></div> <div class="dynamic-actions svelte-zne36e"></div>',1),ef=m('<div class="dropdown-menu svelte-zne36e"><div class="submenu-group svelte-zne36e"><div class="submenu-title svelte-zne36e">Views</div> <button>Dashboard</button> <button>Documents</button> <button>Parts Library</button> <button>GNC Editor</button> <button>Job Processing</button> <button>Stock</button> <button>Journal</button> <div class="divider svelte-zne36e"></div> <button>Settings</button></div> <!></div>'),tf=m('<header class="app-header svelte-zne36e"><div class="menu-container svelte-zne36e"><button class="menu-btn svelte-zne36e" aria-label="Menu"><span class="icon">â°</span></button> <!></div> <div class="logo svelte-zne36e"><span class="logo-text">DocuFlow</span></div></header>');function af(a,e){lt(e,!0);let t=y(!1);function r(){u(t,!s(t))}function n(){u(t,!1)}function i(){u(t,!0)}function c(){u(t,!1)}function d(x){es(x),n()}function v(x){x&&x(),n()}var f=tf(),p=l(f),h=l(p);h.__click=r;var _=o(h,2);{var b=x=>{var S=ef(),w=l(S),k=o(l(w),2);k.__click=()=>d("/");let R;var N=o(k,2);N.__click=()=>d("/documents");let A;var $=o(N,2);$.__click=()=>d("/parts");let O;var J=o($,2);J.__click=()=>d("/gnc");let X;var G=o(J,2);G.__click=()=>d("/job");let ae;var le=o(G,2);le.__click=()=>d("/stock");let q;var F=o(le,2);F.__click=()=>d("/journal");let te;var oe=o(F,4);oe.__click=()=>d("/settings");let ee;var ve=o(w,2);{var re=_e=>{var me=Kd(),ke=o(qe(me),2);Ne(ke,21,()=>wt.menuActions,Ue,(je,D)=>{var P=Qd(),B=l(P),ie=l(B),se=o(B,2);Ne(se,17,()=>s(D).items,Ue,(de,ze)=>{var Se=Vd();Se.__click=()=>v(s(ze).action);var we=l(Se);Y(()=>T(we,s(ze).label)),g(de,Se)}),Y(()=>T(ie,s(D).label)),g(je,P)}),g(_e,me)};L(ve,_e=>{wt.menuActions&&wt.menuActions.length>0&&_e(re)})}Y((_e,me,ke,je,D,P,B)=>{R=Fe(k,1,"svelte-zne36e",null,R,{active:Ea.path==="/"}),A=Fe(N,1,"svelte-zne36e",null,A,_e),O=Fe($,1,"svelte-zne36e",null,O,me),X=Fe(J,1,"svelte-zne36e",null,X,ke),ae=Fe(G,1,"svelte-zne36e",null,ae,je),q=Fe(le,1,"svelte-zne36e",null,q,D),te=Fe(F,1,"svelte-zne36e",null,te,P),ee=Fe(oe,1,"svelte-zne36e",null,ee,B)},[()=>({active:Ea.path.includes("/documents")}),()=>({active:Ea.path.includes("/parts")}),()=>({active:Ea.path.includes("/gnc")}),()=>({active:Ea.path.includes("/job")}),()=>({active:Ea.path.includes("/stock")}),()=>({active:Ea.path.includes("/journal")}),()=>({active:Ea.path.includes("/settings")})]),g(x,S)};L(_,x=>{s(t)&&x(b)})}ba("mouseenter",p,i),ba("mouseleave",p,c),g(a,f),ot()}bt(["click"]);var sf=m('<div class="app-container svelte-1n46o8q"><!> <main class="main-content svelte-1n46o8q"><div class="route-content svelte-1n46o8q"><!></div></main></div>');function nf(a,e){lt(e,!1),Ht(async()=>{try{const f=await(await fetch("/api/config-check")).json();To(f.status),f.needs_setup&&es("/setup")}catch(v){console.error("Config check failed",v),es("/setup")}}),oo();var t=sf(),r=l(t);{var n=v=>{af(v,{})};L(r,v=>{Ea.path!=="/setup"&&v(n)})}var i=o(r,2),c=l(i),d=l(c);bo(d,{get routes(){return Zd}}),g(a,t),ot()}window.onerror=function(a,e,t,r,n){const i=document.createElement("div");i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.background="#fee2e2",i.style.color="#991b1b",i.style.padding="20px",i.style.zIndex="999999",i.style.borderBottom="2px solid #7f1d1d",i.innerHTML=`<strong>Error:</strong> ${a}<br><small>${e}:${t}:${r}</small><pre>${n?.stack||""}</pre>`,document.body.appendChild(i)};window.onunhandledrejection=function(a){const e=document.createElement("div");e.innerHTML+=`<br><strong>Unhandled Rejection:</strong> ${a.reason}`,document.body.prepend(e)};Yl(nf,{target:document.getElementById("app")});
